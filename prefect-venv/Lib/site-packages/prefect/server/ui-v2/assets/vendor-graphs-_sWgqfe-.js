const hx={markdown:"ArtifactMarkdown",table:"ArtifactTable",result:"ArtifactResult",image:"ArtifactImage",progress:"ArtifactProgress",rich:"Artifact",unknown:"Artifact"},lx=["flow-run","task-run"];function gu(r){return lx.includes(r.kind)}function ux(r){return r.kind==="artifact"}function cx(r){return r.kind==="artifacts"}function dx(r){return r.kind==="state"}function fx(r){return r.kind==="event"}function px(r){return r.kind==="events"}function sD(r){return["waterfall","nearest-parent","duration-sorted"].includes(r)}function oD(r){return["temporal","dependency","left-aligned"].includes(r)}const Eg="nodes-container",mx="node-container",gx="edge-container",yx=1,Ag=20,vx=200,_x=.2,xx=.2,wx=.2,bx=.1,Sg=10,Cg=4,Mg=20,Bd=64,aD=.25,Ud=30,Tx=260,Rg=250,Ex=1,Ax=2,Sx=3,Cx=4,Pg=0,Ig=2,Mx=1,Rx=2,Px=3,Dg=4,Ha=5;var Mn=(r=>(r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",r))(Mn||{}),Og=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS",r))(Og||{}),yu=(r=>(r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL",r))(yu||{}),gt=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR",r))(gt||{}),Rr=(r=>(r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r))(Rr||{}),Q=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))(Q||{}),Qn=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(Qn||{}),pt=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(pt||{}),st=(r=>(r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT",r))(st||{}),qr=(r=>(r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR",r))(qr||{}),Ir=(r=>(r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r))(Ir||{}),Fr=(r=>(r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL",r))(Fr||{}),be=(r=>(r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",r))(be||{}),Cr=(r=>(r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT",r))(Cr||{}),Oc=(r=>(r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL",r))(Oc||{}),Ye=(r=>(r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp",r))(Ye||{}),re=(r=>(r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR",r))(re||{}),Zt=(r=>(r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH",r))(Zt||{}),Dr=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(Dr||{});const Ix={createCanvas:(r,t)=>{const e=document.createElement("canvas");return e.width=r,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,t)=>fetch(r,t),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")},ot={ADAPTER:Ix,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Qh=/iPhone/i,Hd=/iPod/i,Gd=/iPad/i,zd=/\biOS-universal(?:.+)Mac\b/i,Jh=/\bAndroid(?:.+)Mobile\b/i,jd=/Android/i,Fn=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Xo=/Silk/i,jr=/Windows Phone/i,Wd=/\bWindows(?:.+)ARM\b/i,Xd=/BlackBerry/i,Vd=/BB10/i,$d=/Opera Mini/i,Yd=/\b(CriOS|Chrome)(?:.+)Mobile/i,qd=/Mobile(?:.+)Firefox\b/i,Zd=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function Dx(r){return function(t){return t.test(r)}}function Kd(r){var t={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?t.userAgent=r:r&&r.userAgent&&(t={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var n=Dx(e),s={apple:{phone:n(Qh)&&!n(jr),ipod:n(Hd),tablet:!n(Qh)&&(n(Gd)||Zd(t))&&!n(jr),universal:n(zd),device:(n(Qh)||n(Hd)||n(Gd)||n(zd)||Zd(t))&&!n(jr)},amazon:{phone:n(Fn),tablet:!n(Fn)&&n(Xo),device:n(Fn)||n(Xo)},android:{phone:!n(jr)&&n(Fn)||!n(jr)&&n(Jh),tablet:!n(jr)&&!n(Fn)&&!n(Jh)&&(n(Xo)||n(jd)),device:!n(jr)&&(n(Fn)||n(Xo)||n(Jh)||n(jd))||n(/\bokhttp\b/i)},windows:{phone:n(jr),tablet:n(Wd),device:n(jr)||n(Wd)},other:{blackberry:n(Xd),blackberry10:n(Vd),opera:n($d),firefox:n(qd),chrome:n(Yd),device:n(Xd)||n(Vd)||n($d)||n(qd)||n(Yd)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}const Ox=Kd.default??Kd,Zr=Ox(globalThis.navigator);ot.RETINA_PREFIX=/@([0-9\.]+)x/;ot.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var qe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bo(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function kx(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var t=r.default;if(typeof t=="function"){var e=function i(){var n=!1;try{n=this instanceof i}catch{}return n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}),e}var Qd={exports:{}},Jd;function Nx(){return Jd||(Jd=1,(function(r){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function n(h,l,u){this.fn=h,this.context=l,this.once=u||!1}function s(h,l,u,c,d){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new n(u,c||h,d),p=e?e+l:l;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],l,u;if(this._eventsCount===0)return h;for(u in l=this._events)t.call(l,u)&&h.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(l)):h},a.prototype.listeners=function(h){var l=e?e+h:h,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var c=0,d=u.length,f=new Array(d);c<d;c++)f[c]=u[c].fn;return f},a.prototype.listenerCount=function(h){var l=e?e+h:h,u=this._events[l];return u?u.fn?1:u.length:0},a.prototype.emit=function(h,l,u,c,d,f){var p=e?e+h:h;if(!this._events[p])return!1;var m=this._events[p],g=arguments.length,v,w;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),g){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,u),!0;case 4:return m.fn.call(m.context,l,u,c),!0;case 5:return m.fn.call(m.context,l,u,c,d),!0;case 6:return m.fn.call(m.context,l,u,c,d,f),!0}for(w=1,v=new Array(g-1);w<g;w++)v[w-1]=arguments[w];m.fn.apply(m.context,v)}else{var _=m.length,T;for(w=0;w<_;w++)switch(m[w].once&&this.removeListener(h,m[w].fn,void 0,!0),g){case 1:m[w].fn.call(m[w].context);break;case 2:m[w].fn.call(m[w].context,l);break;case 3:m[w].fn.call(m[w].context,l,u);break;case 4:m[w].fn.call(m[w].context,l,u,c);break;default:if(!v)for(T=1,v=new Array(g-1);T<g;T++)v[T-1]=arguments[T];m[w].fn.apply(m[w].context,v)}}return!0},a.prototype.on=function(h,l,u){return s(this,h,l,u,!1)},a.prototype.once=function(h,l,u){return s(this,h,l,u,!0)},a.prototype.removeListener=function(h,l,u,c){var d=e?e+h:h;if(!this._events[d])return this;if(!l)return o(this,d),this;var f=this._events[d];if(f.fn)f.fn===l&&(!c||f.once)&&(!u||f.context===u)&&o(this,d);else{for(var p=0,m=[],g=f.length;p<g;p++)(f[p].fn!==l||c&&!f[p].once||u&&f[p].context!==u)&&m.push(f[p]);m.length?this._events[d]=m.length===1?m[0]:m:o(this,d)}return this},a.prototype.removeAllListeners=function(h){var l;return h?(l=e?e+h:h,this._events[l]&&o(this,l)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,r.exports=a})(Qd)),Qd.exports}var Fx=Nx();const To=bo(Fx);var Vo={exports:{}},tf;function Lx(){if(tf)return Vo.exports;tf=1,Vo.exports=r,Vo.exports.default=r;function r(E,A,C){C=C||2;var B=A&&A.length,I=B?A[0]*C:E.length,M=t(E,0,I,C,!0),k=[];if(!M||M.next===M.prev)return k;var L,V,$,tt,et,K,U;if(B&&(M=h(E,A,M,C)),E.length>80*C){L=$=E[0],V=tt=E[1];for(var X=C;X<I;X+=C)et=E[X],K=E[X+1],et<L&&(L=et),K<V&&(V=K),et>$&&($=et),K>tt&&(tt=K);U=Math.max($-L,tt-V),U=U!==0?32767/U:0}return i(M,k,C,L,V,U,0),k}function t(E,A,C,B,I){var M,k;if(I===j(E,A,C,B)>0)for(M=A;M<C;M+=B)k=N(M,E[M],E[M+1],k);else for(M=C-B;M>=A;M-=B)k=N(M,E[M],E[M+1],k);return k&&T(k,k.next)&&(P(k),k=k.next),k}function e(E,A){if(!E)return E;A||(A=E);var C=E,B;do if(B=!1,!C.steiner&&(T(C,C.next)||_(C.prev,C,C.next)===0)){if(P(C),C=A=C.prev,C===C.next)break;B=!0}else C=C.next;while(B||C!==A);return A}function i(E,A,C,B,I,M,k){if(E){!k&&M&&f(E,B,I,M);for(var L=E,V,$;E.prev!==E.next;){if(V=E.prev,$=E.next,M?s(E,B,I,M):n(E)){A.push(V.i/C|0),A.push(E.i/C|0),A.push($.i/C|0),P(E),E=$.next,L=$.next;continue}if(E=$,E===L){k?k===1?(E=o(e(E),A,C),i(E,A,C,B,I,M,2)):k===2&&a(E,A,C,B,I,M):i(e(E),A,C,B,I,M,1);break}}}}function n(E){var A=E.prev,C=E,B=E.next;if(_(A,C,B)>=0)return!1;for(var I=A.x,M=C.x,k=B.x,L=A.y,V=C.y,$=B.y,tt=I<M?I<k?I:k:M<k?M:k,et=L<V?L<$?L:$:V<$?V:$,K=I>M?I>k?I:k:M>k?M:k,U=L>V?L>$?L:$:V>$?V:$,X=B.next;X!==A;){if(X.x>=tt&&X.x<=K&&X.y>=et&&X.y<=U&&v(I,L,M,V,k,$,X.x,X.y)&&_(X.prev,X,X.next)>=0)return!1;X=X.next}return!0}function s(E,A,C,B){var I=E.prev,M=E,k=E.next;if(_(I,M,k)>=0)return!1;for(var L=I.x,V=M.x,$=k.x,tt=I.y,et=M.y,K=k.y,U=L<V?L<$?L:$:V<$?V:$,X=tt<et?tt<K?tt:K:et<K?et:K,q=L>V?L>$?L:$:V>$?V:$,z=tt>et?tt>K?tt:K:et>K?et:K,at=m(U,X,A,C,B),nt=m(q,z,A,C,B),J=E.prevZ,ht=E.nextZ;J&&J.z>=at&&ht&&ht.z<=nt;){if(J.x>=U&&J.x<=q&&J.y>=X&&J.y<=z&&J!==I&&J!==k&&v(L,tt,V,et,$,K,J.x,J.y)&&_(J.prev,J,J.next)>=0||(J=J.prevZ,ht.x>=U&&ht.x<=q&&ht.y>=X&&ht.y<=z&&ht!==I&&ht!==k&&v(L,tt,V,et,$,K,ht.x,ht.y)&&_(ht.prev,ht,ht.next)>=0))return!1;ht=ht.nextZ}for(;J&&J.z>=at;){if(J.x>=U&&J.x<=q&&J.y>=X&&J.y<=z&&J!==I&&J!==k&&v(L,tt,V,et,$,K,J.x,J.y)&&_(J.prev,J,J.next)>=0)return!1;J=J.prevZ}for(;ht&&ht.z<=nt;){if(ht.x>=U&&ht.x<=q&&ht.y>=X&&ht.y<=z&&ht!==I&&ht!==k&&v(L,tt,V,et,$,K,ht.x,ht.y)&&_(ht.prev,ht,ht.next)>=0)return!1;ht=ht.nextZ}return!0}function o(E,A,C){var B=E;do{var I=B.prev,M=B.next.next;!T(I,M)&&b(I,B,B.next,M)&&D(I,M)&&D(M,I)&&(A.push(I.i/C|0),A.push(B.i/C|0),A.push(M.i/C|0),P(B),P(B.next),B=E=M),B=B.next}while(B!==E);return e(B)}function a(E,A,C,B,I,M){var k=E;do{for(var L=k.next.next;L!==k.prev;){if(k.i!==L.i&&w(k,L)){var V=O(k,L);k=e(k,k.next),V=e(V,V.next),i(k,A,C,B,I,M,0),i(V,A,C,B,I,M,0);return}L=L.next}k=k.next}while(k!==E)}function h(E,A,C,B){var I=[],M,k,L,V,$;for(M=0,k=A.length;M<k;M++)L=A[M]*B,V=M<k-1?A[M+1]*B:E.length,$=t(E,L,V,B,!1),$===$.next&&($.steiner=!0),I.push(g($));for(I.sort(l),M=0;M<I.length;M++)C=u(I[M],C);return C}function l(E,A){return E.x-A.x}function u(E,A){var C=c(E,A);if(!C)return A;var B=O(C,E);return e(B,B.next),e(C,C.next)}function c(E,A){var C=A,B=E.x,I=E.y,M=-1/0,k;do{if(I<=C.y&&I>=C.next.y&&C.next.y!==C.y){var L=C.x+(I-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(L<=B&&L>M&&(M=L,k=C.x<C.next.x?C:C.next,L===B))return k}C=C.next}while(C!==A);if(!k)return null;var V=k,$=k.x,tt=k.y,et=1/0,K;C=k;do B>=C.x&&C.x>=$&&B!==C.x&&v(I<tt?B:M,I,$,tt,I<tt?M:B,I,C.x,C.y)&&(K=Math.abs(I-C.y)/(B-C.x),D(C,E)&&(K<et||K===et&&(C.x>k.x||C.x===k.x&&d(k,C)))&&(k=C,et=K)),C=C.next;while(C!==V);return k}function d(E,A){return _(E.prev,E,A.prev)<0&&_(A.next,E,E.next)<0}function f(E,A,C,B){var I=E;do I.z===0&&(I.z=m(I.x,I.y,A,C,B)),I.prevZ=I.prev,I.nextZ=I.next,I=I.next;while(I!==E);I.prevZ.nextZ=null,I.prevZ=null,p(I)}function p(E){var A,C,B,I,M,k,L,V,$=1;do{for(C=E,E=null,M=null,k=0;C;){for(k++,B=C,L=0,A=0;A<$&&(L++,B=B.nextZ,!!B);A++);for(V=$;L>0||V>0&&B;)L!==0&&(V===0||!B||C.z<=B.z)?(I=C,C=C.nextZ,L--):(I=B,B=B.nextZ,V--),M?M.nextZ=I:E=I,I.prevZ=M,M=I;C=B}M.nextZ=null,$*=2}while(k>1);return E}function m(E,A,C,B,I){return E=(E-C)*I|0,A=(A-B)*I|0,E=(E|E<<8)&16711935,E=(E|E<<4)&252645135,E=(E|E<<2)&858993459,E=(E|E<<1)&1431655765,A=(A|A<<8)&16711935,A=(A|A<<4)&252645135,A=(A|A<<2)&858993459,A=(A|A<<1)&1431655765,E|A<<1}function g(E){var A=E,C=E;do(A.x<C.x||A.x===C.x&&A.y<C.y)&&(C=A),A=A.next;while(A!==E);return C}function v(E,A,C,B,I,M,k,L){return(I-k)*(A-L)>=(E-k)*(M-L)&&(E-k)*(B-L)>=(C-k)*(A-L)&&(C-k)*(M-L)>=(I-k)*(B-L)}function w(E,A){return E.next.i!==A.i&&E.prev.i!==A.i&&!S(E,A)&&(D(E,A)&&D(A,E)&&G(E,A)&&(_(E.prev,E,A.prev)||_(E,A.prev,A))||T(E,A)&&_(E.prev,E,E.next)>0&&_(A.prev,A,A.next)>0)}function _(E,A,C){return(A.y-E.y)*(C.x-A.x)-(A.x-E.x)*(C.y-A.y)}function T(E,A){return E.x===A.x&&E.y===A.y}function b(E,A,C,B){var I=y(_(E,A,C)),M=y(_(E,A,B)),k=y(_(C,B,E)),L=y(_(C,B,A));return!!(I!==M&&k!==L||I===0&&x(E,C,A)||M===0&&x(E,B,A)||k===0&&x(C,E,B)||L===0&&x(C,A,B))}function x(E,A,C){return A.x<=Math.max(E.x,C.x)&&A.x>=Math.min(E.x,C.x)&&A.y<=Math.max(E.y,C.y)&&A.y>=Math.min(E.y,C.y)}function y(E){return E>0?1:E<0?-1:0}function S(E,A){var C=E;do{if(C.i!==E.i&&C.next.i!==E.i&&C.i!==A.i&&C.next.i!==A.i&&b(C,C.next,E,A))return!0;C=C.next}while(C!==E);return!1}function D(E,A){return _(E.prev,E,E.next)<0?_(E,A,E.next)>=0&&_(E,E.prev,A)>=0:_(E,A,E.prev)<0||_(E,E.next,A)<0}function G(E,A){var C=E,B=!1,I=(E.x+A.x)/2,M=(E.y+A.y)/2;do C.y>M!=C.next.y>M&&C.next.y!==C.y&&I<(C.next.x-C.x)*(M-C.y)/(C.next.y-C.y)+C.x&&(B=!B),C=C.next;while(C!==E);return B}function O(E,A){var C=new F(E.i,E.x,E.y),B=new F(A.i,A.x,A.y),I=E.next,M=A.prev;return E.next=A,A.prev=E,C.next=I,I.prev=C,B.next=C,C.prev=B,M.next=B,B.prev=M,B}function N(E,A,C,B){var I=new F(E,A,C);return B?(I.next=B.next,I.prev=B,B.next.prev=I,B.next=I):(I.prev=I,I.next=I),I}function P(E){E.next.prev=E.prev,E.prev.next=E.next,E.prevZ&&(E.prevZ.nextZ=E.nextZ),E.nextZ&&(E.nextZ.prevZ=E.prevZ)}function F(E,A,C){this.i=E,this.x=A,this.y=C,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}r.deviation=function(E,A,C,B){var I=A&&A.length,M=I?A[0]*C:E.length,k=Math.abs(j(E,0,M,C));if(I)for(var L=0,V=A.length;L<V;L++){var $=A[L]*C,tt=L<V-1?A[L+1]*C:E.length;k-=Math.abs(j(E,$,tt,C))}var et=0;for(L=0;L<B.length;L+=3){var K=B[L]*C,U=B[L+1]*C,X=B[L+2]*C;et+=Math.abs((E[K]-E[X])*(E[U+1]-E[K+1])-(E[K]-E[U])*(E[X+1]-E[K+1]))}return k===0&&et===0?0:Math.abs((et-k)/k)};function j(E,A,C,B){for(var I=0,M=A,k=C-B;M<C;M+=B)I+=(E[k]-E[M])*(E[M+1]+E[k+1]),k=M;return I}return r.flatten=function(E){for(var A=E[0][0].length,C={vertices:[],holes:[],dimensions:A},B=0,I=0;I<E.length;I++){for(var M=0;M<E[I].length;M++)for(var k=0;k<A;k++)C.vertices.push(E[I][M][k]);I>0&&(B+=E[I-1].length,C.holes.push(B))}return C},Vo.exports}var Bx=Lx();const Ux=bo(Bx);var $i={},_a={exports:{}},Hx=_a.exports,ef;function Gx(){return ef||(ef=1,(function(r,t){(function(e){var i=t&&!t.nodeType&&t,n=r&&!r.nodeType&&r,s=typeof qe=="object"&&qe;(s.global===s||s.window===s||s.self===s)&&(e=s);var o,a=2147483647,h=36,l=1,u=26,c=38,d=700,f=72,p=128,m="-",g=/^xn--/,v=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=h-l,b=Math.floor,x=String.fromCharCode,y;function S(I){throw new RangeError(_[I])}function D(I,M){for(var k=I.length,L=[];k--;)L[k]=M(I[k]);return L}function G(I,M){var k=I.split("@"),L="";k.length>1&&(L=k[0]+"@",I=k[1]),I=I.replace(w,".");var V=I.split("."),$=D(V,M).join(".");return L+$}function O(I){for(var M=[],k=0,L=I.length,V,$;k<L;)V=I.charCodeAt(k++),V>=55296&&V<=56319&&k<L?($=I.charCodeAt(k++),($&64512)==56320?M.push(((V&1023)<<10)+($&1023)+65536):(M.push(V),k--)):M.push(V);return M}function N(I){return D(I,function(M){var k="";return M>65535&&(M-=65536,k+=x(M>>>10&1023|55296),M=56320|M&1023),k+=x(M),k}).join("")}function P(I){return I-48<10?I-22:I-65<26?I-65:I-97<26?I-97:h}function F(I,M){return I+22+75*(I<26)-((M!=0)<<5)}function j(I,M,k){var L=0;for(I=k?b(I/d):I>>1,I+=b(I/M);I>T*u>>1;L+=h)I=b(I/T);return b(L+(T+1)*I/(I+c))}function E(I){var M=[],k=I.length,L,V=0,$=p,tt=f,et,K,U,X,q,z,at,nt,J;for(et=I.lastIndexOf(m),et<0&&(et=0),K=0;K<et;++K)I.charCodeAt(K)>=128&&S("not-basic"),M.push(I.charCodeAt(K));for(U=et>0?et+1:0;U<k;){for(X=V,q=1,z=h;U>=k&&S("invalid-input"),at=P(I.charCodeAt(U++)),(at>=h||at>b((a-V)/q))&&S("overflow"),V+=at*q,nt=z<=tt?l:z>=tt+u?u:z-tt,!(at<nt);z+=h)J=h-nt,q>b(a/J)&&S("overflow"),q*=J;L=M.length+1,tt=j(V-X,L,X==0),b(V/L)>a-$&&S("overflow"),$+=b(V/L),V%=L,M.splice(V++,0,$)}return N(M)}function A(I){var M,k,L,V,$,tt,et,K,U,X,q,z=[],at,nt,J,ht;for(I=O(I),at=I.length,M=p,k=0,$=f,tt=0;tt<at;++tt)q=I[tt],q<128&&z.push(x(q));for(L=V=z.length,V&&z.push(m);L<at;){for(et=a,tt=0;tt<at;++tt)q=I[tt],q>=M&&q<et&&(et=q);for(nt=L+1,et-M>b((a-k)/nt)&&S("overflow"),k+=(et-M)*nt,M=et,tt=0;tt<at;++tt)if(q=I[tt],q<M&&++k>a&&S("overflow"),q==M){for(K=k,U=h;X=U<=$?l:U>=$+u?u:U-$,!(K<X);U+=h)ht=K-X,J=h-X,z.push(x(F(X+ht%J,0))),K=b(ht/J);z.push(x(F(K,0))),$=j(k,nt,L==V),k=0,++L}++k,++M}return z.join("")}function C(I){return G(I,function(M){return g.test(M)?E(M.slice(4).toLowerCase()):M})}function B(I){return G(I,function(M){return v.test(M)?"xn--"+A(M):M})}if(o={version:"1.4.1",ucs2:{decode:O,encode:N},decode:E,encode:A,toASCII:B,toUnicode:C},i&&n)if(r.exports==i)n.exports=o;else for(y in o)o.hasOwnProperty(y)&&(i[y]=o[y]);else e.punycode=o})(Hx)})(_a,_a.exports)),_a.exports}var rf,nf;function vs(){return nf||(nf=1,rf=TypeError),rf}const zx={},jx=Object.freeze(Object.defineProperty({__proto__:null,default:zx},Symbol.toStringTag,{value:"Module"})),Wx=kx(jx);var tl,sf;function Eh(){if(sf)return tl;sf=1;var r=typeof Map=="function"&&Map.prototype,t=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,e=r&&t&&typeof t.get=="function"?t.get:null,i=r&&Map.prototype.forEach,n=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,o=n&&s&&typeof s.get=="function"?s.get:null,a=n&&Set.prototype.forEach,h=typeof WeakMap=="function"&&WeakMap.prototype,l=h?WeakMap.prototype.has:null,u=typeof WeakSet=="function"&&WeakSet.prototype,c=u?WeakSet.prototype.has:null,d=typeof WeakRef=="function"&&WeakRef.prototype,f=d?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,m=Object.prototype.toString,g=Function.prototype.toString,v=String.prototype.match,w=String.prototype.slice,_=String.prototype.replace,T=String.prototype.toUpperCase,b=String.prototype.toLowerCase,x=RegExp.prototype.test,y=Array.prototype.concat,S=Array.prototype.join,D=Array.prototype.slice,G=Math.floor,O=typeof BigInt=="function"?BigInt.prototype.valueOf:null,N=Object.getOwnPropertySymbols,P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,F=typeof Symbol=="function"&&typeof Symbol.iterator=="object",j=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===F||!0)?Symbol.toStringTag:null,E=Object.prototype.propertyIsEnumerable,A=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(W){return W.__proto__}:null);function C(W,Y){if(W===1/0||W===-1/0||W!==W||W&&W>-1e3&&W<1e3||x.call(/e/,Y))return Y;var At=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof W=="number"){var Et=W<0?-G(-W):G(W);if(Et!==W){var Rt=String(Et),_t=w.call(Y,Rt.length+1);return _.call(Rt,At,"$&_")+"."+_.call(_.call(_t,/([0-9]{3})/g,"$&_"),/_$/,"")}}return _.call(Y,At,"$&_")}var B=Wx,I=B.custom,M=nt(I)?I:null,k={__proto__:null,double:'"',single:"'"},L={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};tl=function W(Y,At,Et,Rt){var _t=At||{};if(Ct(_t,"quoteStyle")&&!Ct(k,_t.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ct(_t,"maxStringLength")&&(typeof _t.maxStringLength=="number"?_t.maxStringLength<0&&_t.maxStringLength!==1/0:_t.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var _r=Ct(_t,"customInspect")?_t.customInspect:!0;if(typeof _r!="boolean"&&_r!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ct(_t,"indent")&&_t.indent!==null&&_t.indent!=="	"&&!(parseInt(_t.indent,10)===_t.indent&&_t.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ct(_t,"numericSeparator")&&typeof _t.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var nr=_t.numericSeparator;if(typeof Y>"u")return"undefined";if(Y===null)return"null";if(typeof Y=="boolean")return Y?"true":"false";if(typeof Y=="string")return Hi(Y,_t);if(typeof Y=="number"){if(Y===0)return 1/0/Y>0?"0":"-0";var te=String(Y);return nr?C(Y,te):te}if(typeof Y=="bigint"){var He=String(Y)+"n";return nr?C(Y,He):He}var Gi=typeof _t.depth>"u"?5:_t.depth;if(typeof Et>"u"&&(Et=0),Et>=Gi&&Gi>0&&typeof Y=="object")return et(Y)?"[Array]":"[Object]";var xr=Yh(_t,Et);if(typeof Rt>"u")Rt=[];else if(xe(Rt,Y)>=0)return"[Circular]";function ue(mi,kn,Zh){if(kn&&(Rt=D.call(Rt),Rt.push(kn)),Zh){var wr={depth:_t.depth};return Ct(_t,"quoteStyle")&&(wr.quoteStyle=_t.quoteStyle),W(mi,wr,Et+1,Rt)}return W(mi,_t,Et+1,Rt)}if(typeof Y=="function"&&!U(Y)){var Oo=ir(Y),ko=Gr(Y,ue);return"[Function"+(Oo?": "+Oo:" (anonymous)")+"]"+(ko.length>0?" { "+S.call(ko,", ")+" }":"")}if(nt(Y)){var No=F?_.call(String(Y),/^(Symbol\(.*\))_[^)]*$/,"$1"):P.call(Y);return typeof Y=="object"&&!F?pi(No):No}if($h(Y)){for(var zi="<"+b.call(String(Y.nodeName)),Ts=Y.attributes||[],ji=0;ji<Ts.length;ji++)zi+=" "+Ts[ji].name+"="+V($(Ts[ji].value),"double",_t);return zi+=">",Y.childNodes&&Y.childNodes.length&&(zi+="..."),zi+="</"+b.call(String(Y.nodeName))+">",zi}if(et(Y)){if(Y.length===0)return"[]";var Wi=Gr(Y,ue);return xr&&!Do(Wi)?"["+On(Wi,xr)+"]":"[ "+S.call(Wi,", ")+" ]"}if(X(Y)){var sr=Gr(Y,ue);return!("cause"in Error.prototype)&&"cause"in Y&&!E.call(Y,"cause")?"{ ["+String(Y)+"] "+S.call(y.call("[cause]: "+ue(Y.cause),sr),", ")+" }":sr.length===0?"["+String(Y)+"]":"{ ["+String(Y)+"] "+S.call(sr,", ")+" }"}if(typeof Y=="object"&&_r){if(M&&typeof Y[M]=="function"&&B)return B(Y,{depth:Gi-Et});if(_r!=="symbol"&&typeof Y.inspect=="function")return Y.inspect()}if(ci(Y)){var Fo=[];return i&&i.call(Y,function(mi,kn){Fo.push(ue(kn,Y,!0)+" => "+ue(mi,Y))}),bs("Map",e.call(Y),Fo,xr)}if(Xh(Y)){var Lo=[];return a&&a.call(Y,function(mi){Lo.push(ue(mi,Y))}),bs("Set",o.call(Y),Lo,xr)}if(di(Y))return we("WeakMap");if(Vh(Y))return we("WeakSet");if(fi(Y))return we("WeakRef");if(z(Y))return pi(ue(Number(Y)));if(J(Y))return pi(ue(O.call(Y)));if(at(Y))return pi(p.call(Y));if(q(Y))return pi(ue(String(Y)));if(typeof window<"u"&&Y===window)return"{ [object Window] }";if(typeof globalThis<"u"&&Y===globalThis||typeof qe<"u"&&Y===qe)return"{ [object globalThis] }";if(!K(Y)&&!U(Y)){var Es=Gr(Y,ue),Bo=A?A(Y)===Object.prototype:Y instanceof Object||Y.constructor===Object,As=Y instanceof Object?"":"null prototype",Ge=!Bo&&j&&Object(Y)===Y&&j in Y?w.call(Pt(Y),8,-1):As?"Object":"",qh=Bo||typeof Y.constructor!="function"?"":Y.constructor.name?Y.constructor.name+" ":"",Ss=qh+(Ge||As?"["+S.call(y.call([],Ge||[],As||[]),": ")+"] ":"");return Es.length===0?Ss+"{}":xr?Ss+"{"+On(Es,xr)+"}":Ss+"{ "+S.call(Es,", ")+" }"}return String(Y)};function V(W,Y,At){var Et=At.quoteStyle||Y,Rt=k[Et];return Rt+W+Rt}function $(W){return _.call(String(W),/"/g,"&quot;")}function tt(W){return!j||!(typeof W=="object"&&(j in W||typeof W[j]<"u"))}function et(W){return Pt(W)==="[object Array]"&&tt(W)}function K(W){return Pt(W)==="[object Date]"&&tt(W)}function U(W){return Pt(W)==="[object RegExp]"&&tt(W)}function X(W){return Pt(W)==="[object Error]"&&tt(W)}function q(W){return Pt(W)==="[object String]"&&tt(W)}function z(W){return Pt(W)==="[object Number]"&&tt(W)}function at(W){return Pt(W)==="[object Boolean]"&&tt(W)}function nt(W){if(F)return W&&typeof W=="object"&&W instanceof Symbol;if(typeof W=="symbol")return!0;if(!W||typeof W!="object"||!P)return!1;try{return P.call(W),!0}catch{}return!1}function J(W){if(!W||typeof W!="object"||!O)return!1;try{return O.call(W),!0}catch{}return!1}var ht=Object.prototype.hasOwnProperty||function(W){return W in this};function Ct(W,Y){return ht.call(W,Y)}function Pt(W){return m.call(W)}function ir(W){if(W.name)return W.name;var Y=v.call(g.call(W),/^function\s*([\w$]+)/);return Y?Y[1]:null}function xe(W,Y){if(W.indexOf)return W.indexOf(Y);for(var At=0,Et=W.length;At<Et;At++)if(W[At]===Y)return At;return-1}function ci(W){if(!e||!W||typeof W!="object")return!1;try{e.call(W);try{o.call(W)}catch{return!0}return W instanceof Map}catch{}return!1}function di(W){if(!l||!W||typeof W!="object")return!1;try{l.call(W,l);try{c.call(W,c)}catch{return!0}return W instanceof WeakMap}catch{}return!1}function fi(W){if(!f||!W||typeof W!="object")return!1;try{return f.call(W),!0}catch{}return!1}function Xh(W){if(!o||!W||typeof W!="object")return!1;try{o.call(W);try{e.call(W)}catch{return!0}return W instanceof Set}catch{}return!1}function Vh(W){if(!c||!W||typeof W!="object")return!1;try{c.call(W,c);try{l.call(W,l)}catch{return!0}return W instanceof WeakSet}catch{}return!1}function $h(W){return!W||typeof W!="object"?!1:typeof HTMLElement<"u"&&W instanceof HTMLElement?!0:typeof W.nodeName=="string"&&typeof W.getAttribute=="function"}function Hi(W,Y){if(W.length>Y.maxStringLength){var At=W.length-Y.maxStringLength,Et="... "+At+" more character"+(At>1?"s":"");return Hi(w.call(W,0,Y.maxStringLength),Y)+Et}var Rt=L[Y.quoteStyle||"single"];Rt.lastIndex=0;var _t=_.call(_.call(W,Rt,"\\$1"),/[\x00-\x1f]/g,ws);return V(_t,"single",Y)}function ws(W){var Y=W.charCodeAt(0),At={8:"b",9:"t",10:"n",12:"f",13:"r"}[Y];return At?"\\"+At:"\\x"+(Y<16?"0":"")+T.call(Y.toString(16))}function pi(W){return"Object("+W+")"}function we(W){return W+" { ? }"}function bs(W,Y,At,Et){var Rt=Et?On(At,Et):S.call(At,", ");return W+" ("+Y+") {"+Rt+"}"}function Do(W){for(var Y=0;Y<W.length;Y++)if(xe(W[Y],`
`)>=0)return!1;return!0}function Yh(W,Y){var At;if(W.indent==="	")At="	";else if(typeof W.indent=="number"&&W.indent>0)At=S.call(Array(W.indent+1)," ");else return null;return{base:At,prev:S.call(Array(Y+1),At)}}function On(W,Y){if(W.length===0)return"";var At=`
`+Y.prev+Y.base;return At+S.call(W,","+At)+`
`+Y.prev}function Gr(W,Y){var At=et(W),Et=[];if(At){Et.length=W.length;for(var Rt=0;Rt<W.length;Rt++)Et[Rt]=Ct(W,Rt)?Y(W[Rt],W):""}var _t=typeof N=="function"?N(W):[],_r;if(F){_r={};for(var nr=0;nr<_t.length;nr++)_r["$"+_t[nr]]=_t[nr]}for(var te in W)Ct(W,te)&&(At&&String(Number(te))===te&&te<W.length||F&&_r["$"+te]instanceof Symbol||(x.call(/[^\w$]/,te)?Et.push(Y(te,W)+": "+Y(W[te],W)):Et.push(te+": "+Y(W[te],W))));if(typeof N=="function")for(var He=0;He<_t.length;He++)E.call(W,_t[He])&&Et.push("["+Y(_t[He])+"]: "+Y(W[_t[He]],W));return Et}return tl}var el,of;function Xx(){if(of)return el;of=1;var r=Eh(),t=vs(),e=function(a,h,l){for(var u=a,c;(c=u.next)!=null;u=c)if(c.key===h)return u.next=c.next,l||(c.next=a.next,a.next=c),c},i=function(a,h){if(a){var l=e(a,h);return l&&l.value}},n=function(a,h,l){var u=e(a,h);u?u.value=l:a.next={key:h,next:a.next,value:l}},s=function(a,h){return a?!!e(a,h):!1},o=function(a,h){if(a)return e(a,h,!0)};return el=function(){var a,h={assert:function(l){if(!h.has(l))throw new t("Side channel does not contain "+r(l))},delete:function(l){var u=a&&a.next,c=o(a,l);return c&&u&&u===c&&(a=void 0),!!c},get:function(l){return i(a,l)},has:function(l){return s(a,l)},set:function(l,u){a||(a={next:void 0}),n(a,l,u)}};return h},el}var af,hf;function kg(){return hf||(hf=1,af=Object),af}var lf,uf;function Vx(){return uf||(uf=1,lf=Error),lf}var cf,df;function $x(){return df||(df=1,cf=EvalError),cf}var ff,pf;function Yx(){return pf||(pf=1,ff=RangeError),ff}var mf,gf;function qx(){return gf||(gf=1,mf=ReferenceError),mf}var yf,vf;function Zx(){return vf||(vf=1,yf=SyntaxError),yf}var _f,xf;function Kx(){return xf||(xf=1,_f=URIError),_f}var wf,bf;function Qx(){return bf||(bf=1,wf=Math.abs),wf}var Tf,Ef;function Jx(){return Ef||(Ef=1,Tf=Math.floor),Tf}var Af,Sf;function tw(){return Sf||(Sf=1,Af=Math.max),Af}var Cf,Mf;function ew(){return Mf||(Mf=1,Cf=Math.min),Cf}var Rf,Pf;function rw(){return Pf||(Pf=1,Rf=Math.pow),Rf}var If,Df;function iw(){return Df||(Df=1,If=Math.round),If}var Of,kf;function nw(){return kf||(kf=1,Of=Number.isNaN||function(r){return r!==r}),Of}var rl,Nf;function sw(){if(Nf)return rl;Nf=1;var r=nw();return rl=function(t){return r(t)||t===0?t:t<0?-1:1},rl}var Ff,Lf;function ow(){return Lf||(Lf=1,Ff=Object.getOwnPropertyDescriptor),Ff}var il,Bf;function Ng(){if(Bf)return il;Bf=1;var r=ow();if(r)try{r([],"length")}catch{r=null}return il=r,il}var nl,Uf;function aw(){if(Uf)return nl;Uf=1;var r=Object.defineProperty||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}return nl=r,nl}var Hf,Gf;function hw(){return Gf||(Gf=1,Hf=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var r={},t=Symbol("test"),e=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(e)!=="[object Symbol]")return!1;var i=42;r[t]=i;for(var n in r)return!1;if(typeof Object.keys=="function"&&Object.keys(r).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(r).length!==0)return!1;var s=Object.getOwnPropertySymbols(r);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(r,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(r,t);if(o.value!==i||o.enumerable!==!0)return!1}return!0}),Hf}var sl,zf;function lw(){if(zf)return sl;zf=1;var r=typeof Symbol<"u"&&Symbol,t=hw();return sl=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},sl}var jf,Wf;function Fg(){return Wf||(Wf=1,jf=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),jf}var ol,Xf;function Lg(){if(Xf)return ol;Xf=1;var r=kg();return ol=r.getPrototypeOf||null,ol}var al,Vf;function uw(){if(Vf)return al;Vf=1;var r="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,e=Math.max,i="[object Function]",n=function(a,h){for(var l=[],u=0;u<a.length;u+=1)l[u]=a[u];for(var c=0;c<h.length;c+=1)l[c+a.length]=h[c];return l},s=function(a,h){for(var l=[],u=h,c=0;u<a.length;u+=1,c+=1)l[c]=a[u];return l},o=function(a,h){for(var l="",u=0;u<a.length;u+=1)l+=a[u],u+1<a.length&&(l+=h);return l};return al=function(a){var h=this;if(typeof h!="function"||t.apply(h)!==i)throw new TypeError(r+h);for(var l=s(arguments,1),u,c=function(){if(this instanceof u){var g=h.apply(this,n(l,arguments));return Object(g)===g?g:this}return h.apply(a,n(l,arguments))},d=e(0,h.length-l.length),f=[],p=0;p<d;p++)f[p]="$"+p;if(u=Function("binder","return function ("+o(f,",")+"){ return binder.apply(this,arguments); }")(c),h.prototype){var m=function(){};m.prototype=h.prototype,u.prototype=new m,m.prototype=null}return u},al}var hl,$f;function Ah(){if($f)return hl;$f=1;var r=uw();return hl=Function.prototype.bind||r,hl}var Yf,qf;function kc(){return qf||(qf=1,Yf=Function.prototype.call),Yf}var Zf,Kf;function Bg(){return Kf||(Kf=1,Zf=Function.prototype.apply),Zf}var Qf,Jf;function cw(){return Jf||(Jf=1,Qf=typeof Reflect<"u"&&Reflect&&Reflect.apply),Qf}var ll,tp;function dw(){if(tp)return ll;tp=1;var r=Ah(),t=Bg(),e=kc(),i=cw();return ll=i||r.call(e,t),ll}var ul,ep;function Ug(){if(ep)return ul;ep=1;var r=Ah(),t=vs(),e=kc(),i=dw();return ul=function(n){if(n.length<1||typeof n[0]!="function")throw new t("a function is required");return i(r,e,n)},ul}var cl,rp;function fw(){if(rp)return cl;rp=1;var r=Ug(),t=Ng(),e;try{e=[].__proto__===Array.prototype}catch(o){if(!o||typeof o!="object"||!("code"in o)||o.code!=="ERR_PROTO_ACCESS")throw o}var i=!!e&&t&&t(Object.prototype,"__proto__"),n=Object,s=n.getPrototypeOf;return cl=i&&typeof i.get=="function"?r([i.get]):typeof s=="function"?(function(o){return s(o==null?o:n(o))}):!1,cl}var dl,ip;function pw(){if(ip)return dl;ip=1;var r=Fg(),t=Lg(),e=fw();return dl=r?function(i){return r(i)}:t?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return t(i)}:e?function(i){return e(i)}:null,dl}var fl,np;function mw(){if(np)return fl;np=1;var r=Function.prototype.call,t=Object.prototype.hasOwnProperty,e=Ah();return fl=e.call(r,t),fl}var pl,sp;function Nc(){if(sp)return pl;sp=1;var r,t=kg(),e=Vx(),i=$x(),n=Yx(),s=qx(),o=Zx(),a=vs(),h=Kx(),l=Qx(),u=Jx(),c=tw(),d=ew(),f=rw(),p=iw(),m=sw(),g=Function,v=function(U){try{return g('"use strict"; return ('+U+").constructor;")()}catch{}},w=Ng(),_=aw(),T=function(){throw new a},b=w?(function(){try{return arguments.callee,T}catch{try{return w(arguments,"callee").get}catch{return T}}})():T,x=lw()(),y=pw(),S=Lg(),D=Fg(),G=Bg(),O=kc(),N={},P=typeof Uint8Array>"u"||!y?r:y(Uint8Array),F={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":x&&y?y([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":N,"%AsyncGenerator%":N,"%AsyncGeneratorFunction%":N,"%AsyncIteratorPrototype%":N,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":e,"%eval%":eval,"%EvalError%":i,"%Float16Array%":typeof Float16Array>"u"?r:Float16Array,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":g,"%GeneratorFunction%":N,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":x&&y?y(y([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!x||!y?r:y(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":w,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":n,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!x||!y?r:y(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":x&&y?y(""[Symbol.iterator]()):r,"%Symbol%":x?Symbol:r,"%SyntaxError%":o,"%ThrowTypeError%":b,"%TypedArray%":P,"%TypeError%":a,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":h,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet,"%Function.prototype.call%":O,"%Function.prototype.apply%":G,"%Object.defineProperty%":_,"%Object.getPrototypeOf%":S,"%Math.abs%":l,"%Math.floor%":u,"%Math.max%":c,"%Math.min%":d,"%Math.pow%":f,"%Math.round%":p,"%Math.sign%":m,"%Reflect.getPrototypeOf%":D};if(y)try{null.error}catch(U){var j=y(y(U));F["%Error.prototype%"]=j}var E=function U(X){var q;if(X==="%AsyncFunction%")q=v("async function () {}");else if(X==="%GeneratorFunction%")q=v("function* () {}");else if(X==="%AsyncGeneratorFunction%")q=v("async function* () {}");else if(X==="%AsyncGenerator%"){var z=U("%AsyncGeneratorFunction%");z&&(q=z.prototype)}else if(X==="%AsyncIteratorPrototype%"){var at=U("%AsyncGenerator%");at&&y&&(q=y(at.prototype))}return F[X]=q,q},A={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},C=Ah(),B=mw(),I=C.call(O,Array.prototype.concat),M=C.call(G,Array.prototype.splice),k=C.call(O,String.prototype.replace),L=C.call(O,String.prototype.slice),V=C.call(O,RegExp.prototype.exec),$=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,tt=/\\(\\)?/g,et=function(U){var X=L(U,0,1),q=L(U,-1);if(X==="%"&&q!=="%")throw new o("invalid intrinsic syntax, expected closing `%`");if(q==="%"&&X!=="%")throw new o("invalid intrinsic syntax, expected opening `%`");var z=[];return k(U,$,function(at,nt,J,ht){z[z.length]=J?k(ht,tt,"$1"):nt||at}),z},K=function(U,X){var q=U,z;if(B(A,q)&&(z=A[q],q="%"+z[0]+"%"),B(F,q)){var at=F[q];if(at===N&&(at=E(q)),typeof at>"u"&&!X)throw new a("intrinsic "+U+" exists, but is not available. Please file an issue!");return{alias:z,name:q,value:at}}throw new o("intrinsic "+U+" does not exist!")};return pl=function(U,X){if(typeof U!="string"||U.length===0)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof X!="boolean")throw new a('"allowMissing" argument must be a boolean');if(V(/^%?[^%]*%?$/,U)===null)throw new o("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var q=et(U),z=q.length>0?q[0]:"",at=K("%"+z+"%",X),nt=at.name,J=at.value,ht=!1,Ct=at.alias;Ct&&(z=Ct[0],M(q,I([0,1],Ct)));for(var Pt=1,ir=!0;Pt<q.length;Pt+=1){var xe=q[Pt],ci=L(xe,0,1),di=L(xe,-1);if((ci==='"'||ci==="'"||ci==="`"||di==='"'||di==="'"||di==="`")&&ci!==di)throw new o("property names with quotes must have matching quotes");if((xe==="constructor"||!ir)&&(ht=!0),z+="."+xe,nt="%"+z+"%",B(F,nt))J=F[nt];else if(J!=null){if(!(xe in J)){if(!X)throw new a("base intrinsic for "+U+" exists, but the property is not available.");return}if(w&&Pt+1>=q.length){var fi=w(J,xe);ir=!!fi,ir&&"get"in fi&&!("originalValue"in fi.get)?J=fi.get:J=J[xe]}else ir=B(J,xe),J=J[xe];ir&&!ht&&(F[nt]=J)}}return J},pl}var ml,op;function Hg(){if(op)return ml;op=1;var r=Nc(),t=Ug(),e=t([r("%String.prototype.indexOf%")]);return ml=function(i,n){var s=r(i,!!n);return typeof s=="function"&&e(i,".prototype.")>-1?t([s]):s},ml}var gl,ap;function Gg(){if(ap)return gl;ap=1;var r=Nc(),t=Hg(),e=Eh(),i=vs(),n=r("%Map%",!0),s=t("Map.prototype.get",!0),o=t("Map.prototype.set",!0),a=t("Map.prototype.has",!0),h=t("Map.prototype.delete",!0),l=t("Map.prototype.size",!0);return gl=!!n&&function(){var u,c={assert:function(d){if(!c.has(d))throw new i("Side channel does not contain "+e(d))},delete:function(d){if(u){var f=h(u,d);return l(u)===0&&(u=void 0),f}return!1},get:function(d){if(u)return s(u,d)},has:function(d){return u?a(u,d):!1},set:function(d,f){u||(u=new n),o(u,d,f)}};return c},gl}var yl,hp;function gw(){if(hp)return yl;hp=1;var r=Nc(),t=Hg(),e=Eh(),i=Gg(),n=vs(),s=r("%WeakMap%",!0),o=t("WeakMap.prototype.get",!0),a=t("WeakMap.prototype.set",!0),h=t("WeakMap.prototype.has",!0),l=t("WeakMap.prototype.delete",!0);return yl=s?(function(){var u,c,d={assert:function(f){if(!d.has(f))throw new n("Side channel does not contain "+e(f))},delete:function(f){if(s&&f&&(typeof f=="object"||typeof f=="function")){if(u)return l(u,f)}else if(i&&c)return c.delete(f);return!1},get:function(f){return s&&f&&(typeof f=="object"||typeof f=="function")&&u?o(u,f):c&&c.get(f)},has:function(f){return s&&f&&(typeof f=="object"||typeof f=="function")&&u?h(u,f):!!c&&c.has(f)},set:function(f,p){s&&f&&(typeof f=="object"||typeof f=="function")?(u||(u=new s),a(u,f,p)):i&&(c||(c=i()),c.set(f,p))}};return d}):i,yl}var vl,lp;function zg(){if(lp)return vl;lp=1;var r=vs(),t=Eh(),e=Xx(),i=Gg(),n=gw(),s=n||i||e;return vl=function(){var o,a={assert:function(h){if(!a.has(h))throw new r("Side channel does not contain "+t(h))},delete:function(h){return!!o&&o.delete(h)},get:function(h){return o&&o.get(h)},has:function(h){return!!o&&o.has(h)},set:function(h,l){o||(o=s()),o.set(h,l)}};return a},vl}var _l,up;function Fc(){if(up)return _l;up=1;var r=String.prototype.replace,t=/%20/g,e={RFC1738:"RFC1738",RFC3986:"RFC3986"};return _l={default:e.RFC3986,formatters:{RFC1738:function(i){return r.call(i,t,"+")},RFC3986:function(i){return String(i)}},RFC1738:e.RFC1738,RFC3986:e.RFC3986},_l}var xl,cp;function jg(){if(cp)return xl;cp=1;var r=Fc(),t=zg(),e=Object.prototype.hasOwnProperty,i=Array.isArray,n=t(),s=function(x,y){return n.set(x,y),x},o=function(x){return n.has(x)},a=function(x){return n.get(x)},h=function(x,y){n.set(x,y)},l=(function(){for(var x=[],y=0;y<256;++y)x.push("%"+((y<16?"0":"")+y.toString(16)).toUpperCase());return x})(),u=function(x){for(;x.length>1;){var y=x.pop(),S=y.obj[y.prop];if(i(S)){for(var D=[],G=0;G<S.length;++G)typeof S[G]<"u"&&D.push(S[G]);y.obj[y.prop]=D}}},c=function(x,y){for(var S=y&&y.plainObjects?{__proto__:null}:{},D=0;D<x.length;++D)typeof x[D]<"u"&&(S[D]=x[D]);return S},d=function x(y,S,D){if(!S)return y;if(typeof S!="object"&&typeof S!="function"){if(i(y))y.push(S);else if(y&&typeof y=="object")if(o(y)){var G=a(y)+1;y[G]=S,h(y,G)}else(D&&(D.plainObjects||D.allowPrototypes)||!e.call(Object.prototype,S))&&(y[S]=!0);else return[y,S];return y}if(!y||typeof y!="object"){if(o(S)){for(var O=Object.keys(S),N=D&&D.plainObjects?{__proto__:null,0:y}:{0:y},P=0;P<O.length;P++){var F=parseInt(O[P],10);N[F+1]=S[O[P]]}return s(N,a(S)+1)}return[y].concat(S)}var j=y;return i(y)&&!i(S)&&(j=c(y,D)),i(y)&&i(S)?(S.forEach(function(E,A){if(e.call(y,A)){var C=y[A];C&&typeof C=="object"&&E&&typeof E=="object"?y[A]=x(C,E,D):y.push(E)}else y[A]=E}),y):Object.keys(S).reduce(function(E,A){var C=S[A];return e.call(E,A)?E[A]=x(E[A],C,D):E[A]=C,E},j)},f=function(x,y){return Object.keys(y).reduce(function(S,D){return S[D]=y[D],S},x)},p=function(x,y,S){var D=x.replace(/\+/g," ");if(S==="iso-8859-1")return D.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(D)}catch{return D}},m=1024,g=function(x,y,S,D,G){if(x.length===0)return x;var O=x;if(typeof x=="symbol"?O=Symbol.prototype.toString.call(x):typeof x!="string"&&(O=String(x)),S==="iso-8859-1")return escape(O).replace(/%u[0-9a-f]{4}/gi,function(C){return"%26%23"+parseInt(C.slice(2),16)+"%3B"});for(var N="",P=0;P<O.length;P+=m){for(var F=O.length>=m?O.slice(P,P+m):O,j=[],E=0;E<F.length;++E){var A=F.charCodeAt(E);if(A===45||A===46||A===95||A===126||A>=48&&A<=57||A>=65&&A<=90||A>=97&&A<=122||G===r.RFC1738&&(A===40||A===41)){j[j.length]=F.charAt(E);continue}if(A<128){j[j.length]=l[A];continue}if(A<2048){j[j.length]=l[192|A>>6]+l[128|A&63];continue}if(A<55296||A>=57344){j[j.length]=l[224|A>>12]+l[128|A>>6&63]+l[128|A&63];continue}E+=1,A=65536+((A&1023)<<10|F.charCodeAt(E)&1023),j[j.length]=l[240|A>>18]+l[128|A>>12&63]+l[128|A>>6&63]+l[128|A&63]}N+=j.join("")}return N},v=function(x){for(var y=[{obj:{o:x},prop:"o"}],S=[],D=0;D<y.length;++D)for(var G=y[D],O=G.obj[G.prop],N=Object.keys(O),P=0;P<N.length;++P){var F=N[P],j=O[F];typeof j=="object"&&j!==null&&S.indexOf(j)===-1&&(y.push({obj:O,prop:F}),S.push(j))}return u(y),x},w=function(x){return Object.prototype.toString.call(x)==="[object RegExp]"},_=function(x){return!x||typeof x!="object"?!1:!!(x.constructor&&x.constructor.isBuffer&&x.constructor.isBuffer(x))},T=function(x,y,S,D){if(o(x)){var G=a(x)+1;return x[G]=y,h(x,G),x}var O=[].concat(x,y);return O.length>S?s(c(O,{plainObjects:D}),O.length-1):O},b=function(x,y){if(i(x)){for(var S=[],D=0;D<x.length;D+=1)S.push(y(x[D]));return S}return y(x)};return xl={arrayToObject:c,assign:f,combine:T,compact:v,decode:p,encode:g,isBuffer:_,isOverflow:o,isRegExp:w,maybeMap:b,merge:d},xl}var wl,dp;function yw(){if(dp)return wl;dp=1;var r=zg(),t=jg(),e=Fc(),i=Object.prototype.hasOwnProperty,n={brackets:function(m){return m+"[]"},comma:"comma",indices:function(m,g){return m+"["+g+"]"},repeat:function(m){return m}},s=Array.isArray,o=Array.prototype.push,a=function(m,g){o.apply(m,s(g)?g:[g])},h=Date.prototype.toISOString,l=e.default,u={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:t.encode,encodeValuesOnly:!1,filter:void 0,format:l,formatter:e.formatters[l],indices:!1,serializeDate:function(m){return h.call(m)},skipNulls:!1,strictNullHandling:!1},c=function(m){return typeof m=="string"||typeof m=="number"||typeof m=="boolean"||typeof m=="symbol"||typeof m=="bigint"},d={},f=function m(g,v,w,_,T,b,x,y,S,D,G,O,N,P,F,j,E,A){for(var C=g,B=A,I=0,M=!1;(B=B.get(d))!==void 0&&!M;){var k=B.get(g);if(I+=1,typeof k<"u"){if(k===I)throw new RangeError("Cyclic object value");M=!0}typeof B.get(d)>"u"&&(I=0)}if(typeof D=="function"?C=D(v,C):C instanceof Date?C=N(C):w==="comma"&&s(C)&&(C=t.maybeMap(C,function(J){return J instanceof Date?N(J):J})),C===null){if(b)return S&&!j?S(v,u.encoder,E,"key",P):v;C=""}if(c(C)||t.isBuffer(C)){if(S){var L=j?v:S(v,u.encoder,E,"key",P);return[F(L)+"="+F(S(C,u.encoder,E,"value",P))]}return[F(v)+"="+F(String(C))]}var V=[];if(typeof C>"u")return V;var $;if(w==="comma"&&s(C))j&&S&&(C=t.maybeMap(C,S)),$=[{value:C.length>0?C.join(",")||null:void 0}];else if(s(D))$=D;else{var tt=Object.keys(C);$=G?tt.sort(G):tt}var et=y?String(v).replace(/\./g,"%2E"):String(v),K=_&&s(C)&&C.length===1?et+"[]":et;if(T&&s(C)&&C.length===0)return K+"[]";for(var U=0;U<$.length;++U){var X=$[U],q=typeof X=="object"&&X&&typeof X.value<"u"?X.value:C[X];if(!(x&&q===null)){var z=O&&y?String(X).replace(/\./g,"%2E"):String(X),at=s(C)?typeof w=="function"?w(K,z):K:K+(O?"."+z:"["+z+"]");A.set(g,I);var nt=r();nt.set(d,A),a(V,m(q,at,w,_,T,b,x,y,w==="comma"&&j&&s(C)?null:S,D,G,O,N,P,F,j,E,nt))}}return V},p=function(m){if(!m)return u;if(typeof m.allowEmptyArrays<"u"&&typeof m.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof m.encodeDotInKeys<"u"&&typeof m.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(m.encoder!==null&&typeof m.encoder<"u"&&typeof m.encoder!="function")throw new TypeError("Encoder has to be a function.");var g=m.charset||u.charset;if(typeof m.charset<"u"&&m.charset!=="utf-8"&&m.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var v=e.default;if(typeof m.format<"u"){if(!i.call(e.formatters,m.format))throw new TypeError("Unknown format option provided.");v=m.format}var w=e.formatters[v],_=u.filter;(typeof m.filter=="function"||s(m.filter))&&(_=m.filter);var T;if(m.arrayFormat in n?T=m.arrayFormat:"indices"in m?T=m.indices?"indices":"repeat":T=u.arrayFormat,"commaRoundTrip"in m&&typeof m.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var b=typeof m.allowDots>"u"?m.encodeDotInKeys===!0?!0:u.allowDots:!!m.allowDots;return{addQueryPrefix:typeof m.addQueryPrefix=="boolean"?m.addQueryPrefix:u.addQueryPrefix,allowDots:b,allowEmptyArrays:typeof m.allowEmptyArrays=="boolean"?!!m.allowEmptyArrays:u.allowEmptyArrays,arrayFormat:T,charset:g,charsetSentinel:typeof m.charsetSentinel=="boolean"?m.charsetSentinel:u.charsetSentinel,commaRoundTrip:!!m.commaRoundTrip,delimiter:typeof m.delimiter>"u"?u.delimiter:m.delimiter,encode:typeof m.encode=="boolean"?m.encode:u.encode,encodeDotInKeys:typeof m.encodeDotInKeys=="boolean"?m.encodeDotInKeys:u.encodeDotInKeys,encoder:typeof m.encoder=="function"?m.encoder:u.encoder,encodeValuesOnly:typeof m.encodeValuesOnly=="boolean"?m.encodeValuesOnly:u.encodeValuesOnly,filter:_,format:v,formatter:w,serializeDate:typeof m.serializeDate=="function"?m.serializeDate:u.serializeDate,skipNulls:typeof m.skipNulls=="boolean"?m.skipNulls:u.skipNulls,sort:typeof m.sort=="function"?m.sort:null,strictNullHandling:typeof m.strictNullHandling=="boolean"?m.strictNullHandling:u.strictNullHandling}};return wl=function(m,g){var v=m,w=p(g),_,T;typeof w.filter=="function"?(T=w.filter,v=T("",v)):s(w.filter)&&(T=w.filter,_=T);var b=[];if(typeof v!="object"||v===null)return"";var x=n[w.arrayFormat],y=x==="comma"&&w.commaRoundTrip;_||(_=Object.keys(v)),w.sort&&_.sort(w.sort);for(var S=r(),D=0;D<_.length;++D){var G=_[D],O=v[G];w.skipNulls&&O===null||a(b,f(O,G,x,y,w.allowEmptyArrays,w.strictNullHandling,w.skipNulls,w.encodeDotInKeys,w.encode?w.encoder:null,w.filter,w.sort,w.allowDots,w.serializeDate,w.format,w.formatter,w.encodeValuesOnly,w.charset,S))}var N=b.join(w.delimiter),P=w.addQueryPrefix===!0?"?":"";return w.charsetSentinel&&(w.charset==="iso-8859-1"?P+="utf8=%26%2310003%3B&":P+="utf8=%E2%9C%93&"),N.length>0?P+N:""},wl}var bl,fp;function vw(){if(fp)return bl;fp=1;var r=jg(),t=Object.prototype.hasOwnProperty,e=Array.isArray,i={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:r.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},n=function(f){return f.replace(/&#(\d+);/g,function(p,m){return String.fromCharCode(parseInt(m,10))})},s=function(f,p,m){if(f&&typeof f=="string"&&p.comma&&f.indexOf(",")>-1)return f.split(",");if(p.throwOnLimitExceeded&&m>=p.arrayLimit)throw new RangeError("Array limit exceeded. Only "+p.arrayLimit+" element"+(p.arrayLimit===1?"":"s")+" allowed in an array.");return f},o="utf8=%26%2310003%3B",a="utf8=%E2%9C%93",h=function(f,p){var m={__proto__:null},g=p.ignoreQueryPrefix?f.replace(/^\?/,""):f;g=g.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var v=p.parameterLimit===1/0?void 0:p.parameterLimit,w=g.split(p.delimiter,p.throwOnLimitExceeded?v+1:v);if(p.throwOnLimitExceeded&&w.length>v)throw new RangeError("Parameter limit exceeded. Only "+v+" parameter"+(v===1?"":"s")+" allowed.");var _=-1,T,b=p.charset;if(p.charsetSentinel)for(T=0;T<w.length;++T)w[T].indexOf("utf8=")===0&&(w[T]===a?b="utf-8":w[T]===o&&(b="iso-8859-1"),_=T,T=w.length);for(T=0;T<w.length;++T)if(T!==_){var x=w[T],y=x.indexOf("]="),S=y===-1?x.indexOf("="):y+1,D,G;if(S===-1?(D=p.decoder(x,i.decoder,b,"key"),G=p.strictNullHandling?null:""):(D=p.decoder(x.slice(0,S),i.decoder,b,"key"),D!==null&&(G=r.maybeMap(s(x.slice(S+1),p,e(m[D])?m[D].length:0),function(N){return p.decoder(N,i.decoder,b,"value")}))),G&&p.interpretNumericEntities&&b==="iso-8859-1"&&(G=n(String(G))),x.indexOf("[]=")>-1&&(G=e(G)?[G]:G),D!==null){var O=t.call(m,D);O&&p.duplicates==="combine"?m[D]=r.combine(m[D],G,p.arrayLimit,p.plainObjects):(!O||p.duplicates==="last")&&(m[D]=G)}}return m},l=function(f,p,m,g){var v=0;if(f.length>0&&f[f.length-1]==="[]"){var w=f.slice(0,-1).join("");v=Array.isArray(p)&&p[w]?p[w].length:0}for(var _=g?p:s(p,m,v),T=f.length-1;T>=0;--T){var b,x=f[T];if(x==="[]"&&m.parseArrays)r.isOverflow(_)?b=_:b=m.allowEmptyArrays&&(_===""||m.strictNullHandling&&_===null)?[]:r.combine([],_,m.arrayLimit,m.plainObjects);else{b=m.plainObjects?{__proto__:null}:{};var y=x.charAt(0)==="["&&x.charAt(x.length-1)==="]"?x.slice(1,-1):x,S=m.decodeDotInKeys?y.replace(/%2E/g,"."):y,D=parseInt(S,10);!m.parseArrays&&S===""?b={0:_}:!isNaN(D)&&x!==S&&String(D)===S&&D>=0&&m.parseArrays&&D<=m.arrayLimit?(b=[],b[D]=_):S!=="__proto__"&&(b[S]=_)}_=b}return _},u=function(f,p){var m=p.allowDots?f.replace(/\.([^.[]+)/g,"[$1]"):f;if(p.depth<=0)return!p.plainObjects&&t.call(Object.prototype,m)&&!p.allowPrototypes?void 0:[m];var g=/(\[[^[\]]*])/,v=/(\[[^[\]]*])/g,w=g.exec(m),_=w?m.slice(0,w.index):m,T=[];if(_){if(!p.plainObjects&&t.call(Object.prototype,_)&&!p.allowPrototypes)return;T.push(_)}for(var b=0;(w=v.exec(m))!==null&&b<p.depth;){b+=1;var x=w[1].slice(1,-1);if(!p.plainObjects&&t.call(Object.prototype,x)&&!p.allowPrototypes)return;T.push(w[1])}if(w){if(p.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+p.depth+" and strictDepth is true");T.push("["+m.slice(w.index)+"]")}return T},c=function(f,p,m,g){if(f){var v=u(f,m);if(v)return l(v,p,m,g)}},d=function(f){if(!f)return i;if(typeof f.allowEmptyArrays<"u"&&typeof f.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof f.decodeDotInKeys<"u"&&typeof f.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(f.decoder!==null&&typeof f.decoder<"u"&&typeof f.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof f.charset<"u"&&f.charset!=="utf-8"&&f.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof f.throwOnLimitExceeded<"u"&&typeof f.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var p=typeof f.charset>"u"?i.charset:f.charset,m=typeof f.duplicates>"u"?i.duplicates:f.duplicates;if(m!=="combine"&&m!=="first"&&m!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var g=typeof f.allowDots>"u"?f.decodeDotInKeys===!0?!0:i.allowDots:!!f.allowDots;return{allowDots:g,allowEmptyArrays:typeof f.allowEmptyArrays=="boolean"?!!f.allowEmptyArrays:i.allowEmptyArrays,allowPrototypes:typeof f.allowPrototypes=="boolean"?f.allowPrototypes:i.allowPrototypes,allowSparse:typeof f.allowSparse=="boolean"?f.allowSparse:i.allowSparse,arrayLimit:typeof f.arrayLimit=="number"?f.arrayLimit:i.arrayLimit,charset:p,charsetSentinel:typeof f.charsetSentinel=="boolean"?f.charsetSentinel:i.charsetSentinel,comma:typeof f.comma=="boolean"?f.comma:i.comma,decodeDotInKeys:typeof f.decodeDotInKeys=="boolean"?f.decodeDotInKeys:i.decodeDotInKeys,decoder:typeof f.decoder=="function"?f.decoder:i.decoder,delimiter:typeof f.delimiter=="string"||r.isRegExp(f.delimiter)?f.delimiter:i.delimiter,depth:typeof f.depth=="number"||f.depth===!1?+f.depth:i.depth,duplicates:m,ignoreQueryPrefix:f.ignoreQueryPrefix===!0,interpretNumericEntities:typeof f.interpretNumericEntities=="boolean"?f.interpretNumericEntities:i.interpretNumericEntities,parameterLimit:typeof f.parameterLimit=="number"?f.parameterLimit:i.parameterLimit,parseArrays:f.parseArrays!==!1,plainObjects:typeof f.plainObjects=="boolean"?f.plainObjects:i.plainObjects,strictDepth:typeof f.strictDepth=="boolean"?!!f.strictDepth:i.strictDepth,strictNullHandling:typeof f.strictNullHandling=="boolean"?f.strictNullHandling:i.strictNullHandling,throwOnLimitExceeded:typeof f.throwOnLimitExceeded=="boolean"?f.throwOnLimitExceeded:!1}};return bl=function(f,p){var m=d(p);if(f===""||f===null||typeof f>"u")return m.plainObjects?{__proto__:null}:{};for(var g=typeof f=="string"?h(f,m):f,v=m.plainObjects?{__proto__:null}:{},w=Object.keys(g),_=0;_<w.length;++_){var T=w[_],b=c(T,g[T],m,typeof f=="string");v=r.merge(v,b,m)}return m.allowSparse===!0?v:r.compact(v)},bl}var Tl,pp;function _w(){if(pp)return Tl;pp=1;var r=yw(),t=vw(),e=Fc();return Tl={formats:e,parse:t,stringify:r},Tl}var mp;function xw(){if(mp)return $i;mp=1;var r=Gx();function t(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var e=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,n=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,s=["<",">",'"',"`"," ","\r",`
`,"	"],o=["{","}","|","\\","^","`"].concat(s),a=["'"].concat(o),h=["%","/","?",";","#"].concat(a),l=["/","?","#"],u=255,c=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},p={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=_w();function v(b,x,y){if(b&&typeof b=="object"&&b instanceof t)return b;var S=new t;return S.parse(b,x,y),S}t.prototype.parse=function(b,x,y){if(typeof b!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof b);var S=b.indexOf("?"),D=S!==-1&&S<b.indexOf("#")?"?":"#",G=b.split(D),O=/\\/g;G[0]=G[0].replace(O,"/"),b=G.join(D);var N=b;if(N=N.trim(),!y&&b.split("#").length===1){var P=n.exec(N);if(P)return this.path=N,this.href=N,this.pathname=P[1],P[2]?(this.search=P[2],x?this.query=g.parse(this.search.substr(1)):this.query=this.search.substr(1)):x&&(this.search="",this.query={}),this}var F=e.exec(N);if(F){F=F[0];var j=F.toLowerCase();this.protocol=j,N=N.substr(F.length)}if(y||F||N.match(/^\/\/[^@/]+@[^@/]+/)){var E=N.substr(0,2)==="//";E&&!(F&&p[F])&&(N=N.substr(2),this.slashes=!0)}if(!p[F]&&(E||F&&!m[F])){for(var A=-1,C=0;C<l.length;C++){var B=N.indexOf(l[C]);B!==-1&&(A===-1||B<A)&&(A=B)}var I,M;A===-1?M=N.lastIndexOf("@"):M=N.lastIndexOf("@",A),M!==-1&&(I=N.slice(0,M),N=N.slice(M+1),this.auth=decodeURIComponent(I)),A=-1;for(var C=0;C<h.length;C++){var B=N.indexOf(h[C]);B!==-1&&(A===-1||B<A)&&(A=B)}A===-1&&(A=N.length),this.host=N.slice(0,A),N=N.slice(A),this.parseHost(),this.hostname=this.hostname||"";var k=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!k)for(var L=this.hostname.split(/\./),C=0,V=L.length;C<V;C++){var $=L[C];if($&&!$.match(c)){for(var tt="",et=0,K=$.length;et<K;et++)$.charCodeAt(et)>127?tt+="x":tt+=$[et];if(!tt.match(c)){var U=L.slice(0,C),X=L.slice(C+1),q=$.match(d);q&&(U.push(q[1]),X.unshift(q[2])),X.length&&(N="/"+X.join(".")+N),this.hostname=U.join(".");break}}}this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),k||(this.hostname=r.toASCII(this.hostname));var z=this.port?":"+this.port:"",at=this.hostname||"";this.host=at+z,this.href+=this.host,k&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),N[0]!=="/"&&(N="/"+N))}if(!f[j])for(var C=0,V=a.length;C<V;C++){var nt=a[C];if(N.indexOf(nt)!==-1){var J=encodeURIComponent(nt);J===nt&&(J=escape(nt)),N=N.split(nt).join(J)}}var ht=N.indexOf("#");ht!==-1&&(this.hash=N.substr(ht),N=N.slice(0,ht));var Ct=N.indexOf("?");if(Ct!==-1?(this.search=N.substr(Ct),this.query=N.substr(Ct+1),x&&(this.query=g.parse(this.query)),N=N.slice(0,Ct)):x&&(this.search="",this.query={}),N&&(this.pathname=N),m[j]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",Pt=this.search||"";this.path=z+Pt}return this.href=this.format(),this};function w(b){return typeof b=="string"&&(b=v(b)),b instanceof t?b.format():t.prototype.format.call(b)}t.prototype.format=function(){var b=this.auth||"";b&&(b=encodeURIComponent(b),b=b.replace(/%3A/i,":"),b+="@");var x=this.protocol||"",y=this.pathname||"",S=this.hash||"",D=!1,G="";this.host?D=b+this.host:this.hostname&&(D=b+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(D+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(G=g.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var O=this.search||G&&"?"+G||"";return x&&x.substr(-1)!==":"&&(x+=":"),this.slashes||(!x||m[x])&&D!==!1?(D="//"+(D||""),y&&y.charAt(0)!=="/"&&(y="/"+y)):D||(D=""),S&&S.charAt(0)!=="#"&&(S="#"+S),O&&O.charAt(0)!=="?"&&(O="?"+O),y=y.replace(/[?#]/g,function(N){return encodeURIComponent(N)}),O=O.replace("#","%23"),x+D+y+O+S};function _(b,x){return v(b,!1,!0).resolve(x)}t.prototype.resolve=function(b){return this.resolveObject(v(b,!1,!0)).format()};function T(b,x){return b?v(b,!1,!0).resolveObject(x):x}return t.prototype.resolveObject=function(b){if(typeof b=="string"){var x=new t;x.parse(b,!1,!0),b=x}for(var y=new t,S=Object.keys(this),D=0;D<S.length;D++){var G=S[D];y[G]=this[G]}if(y.hash=b.hash,b.href==="")return y.href=y.format(),y;if(b.slashes&&!b.protocol){for(var O=Object.keys(b),N=0;N<O.length;N++){var P=O[N];P!=="protocol"&&(y[P]=b[P])}return m[y.protocol]&&y.hostname&&!y.pathname&&(y.pathname="/",y.path=y.pathname),y.href=y.format(),y}if(b.protocol&&b.protocol!==y.protocol){if(!m[b.protocol]){for(var F=Object.keys(b),j=0;j<F.length;j++){var E=F[j];y[E]=b[E]}return y.href=y.format(),y}if(y.protocol=b.protocol,!b.host&&!p[b.protocol]){for(var V=(b.pathname||"").split("/");V.length&&!(b.host=V.shift()););b.host||(b.host=""),b.hostname||(b.hostname=""),V[0]!==""&&V.unshift(""),V.length<2&&V.unshift(""),y.pathname=V.join("/")}else y.pathname=b.pathname;if(y.search=b.search,y.query=b.query,y.host=b.host||"",y.auth=b.auth,y.hostname=b.hostname||b.host,y.port=b.port,y.pathname||y.search){var A=y.pathname||"",C=y.search||"";y.path=A+C}return y.slashes=y.slashes||b.slashes,y.href=y.format(),y}var B=y.pathname&&y.pathname.charAt(0)==="/",I=b.host||b.pathname&&b.pathname.charAt(0)==="/",M=I||B||y.host&&b.pathname,k=M,L=y.pathname&&y.pathname.split("/")||[],V=b.pathname&&b.pathname.split("/")||[],$=y.protocol&&!m[y.protocol];if($&&(y.hostname="",y.port=null,y.host&&(L[0]===""?L[0]=y.host:L.unshift(y.host)),y.host="",b.protocol&&(b.hostname=null,b.port=null,b.host&&(V[0]===""?V[0]=b.host:V.unshift(b.host)),b.host=null),M=M&&(V[0]===""||L[0]==="")),I)y.host=b.host||b.host===""?b.host:y.host,y.hostname=b.hostname||b.hostname===""?b.hostname:y.hostname,y.search=b.search,y.query=b.query,L=V;else if(V.length)L||(L=[]),L.pop(),L=L.concat(V),y.search=b.search,y.query=b.query;else if(b.search!=null){if($){y.host=L.shift(),y.hostname=y.host;var tt=y.host&&y.host.indexOf("@")>0?y.host.split("@"):!1;tt&&(y.auth=tt.shift(),y.hostname=tt.shift(),y.host=y.hostname)}return y.search=b.search,y.query=b.query,(y.pathname!==null||y.search!==null)&&(y.path=(y.pathname?y.pathname:"")+(y.search?y.search:"")),y.href=y.format(),y}if(!L.length)return y.pathname=null,y.search?y.path="/"+y.search:y.path=null,y.href=y.format(),y;for(var et=L.slice(-1)[0],K=(y.host||b.host||L.length>1)&&(et==="."||et==="..")||et==="",U=0,X=L.length;X>=0;X--)et=L[X],et==="."?L.splice(X,1):et===".."?(L.splice(X,1),U++):U&&(L.splice(X,1),U--);if(!M&&!k)for(;U--;U)L.unshift("..");M&&L[0]!==""&&(!L[0]||L[0].charAt(0)!=="/")&&L.unshift(""),K&&L.join("/").substr(-1)!=="/"&&L.push("");var q=L[0]===""||L[0]&&L[0].charAt(0)==="/";if($){y.hostname=q?"":L.length?L.shift():"",y.host=y.hostname;var tt=y.host&&y.host.indexOf("@")>0?y.host.split("@"):!1;tt&&(y.auth=tt.shift(),y.hostname=tt.shift(),y.host=y.hostname)}return M=M||y.host&&L.length,M&&!q&&L.unshift(""),L.length>0?y.pathname=L.join("/"):(y.pathname=null,y.path=null),(y.pathname!==null||y.search!==null)&&(y.path=(y.pathname?y.pathname:"")+(y.search?y.search:"")),y.auth=b.auth||y.auth,y.slashes=y.slashes||b.slashes,y.href=y.format(),y},t.prototype.parseHost=function(){var b=this.host,x=i.exec(b);x&&(x=x[0],x!==":"&&(this.port=x.substr(1)),b=b.substr(0,b.length-x.length)),b&&(this.hostname=b)},$i.parse=v,$i.resolve=_,$i.resolveObject=T,$i.format=w,$i.Url=t,$i}xw();const gp={};function wt(r,t,e=3){if(gp[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`),console.warn(i))),gp[t]=!0}function ar(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function Rs(r){return r.split("?")[0].split("#")[0]}function ww(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function bw(r,t,e){return r.replace(new RegExp(ww(t),"g"),e)}function Tw(r,t){let e="",i=0,n=-1,s=0,o=-1;for(let a=0;a<=r.length;++a){if(a<r.length)o=r.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),n=a,s=0;continue}}else if(e.length===2||e.length===1){e="",i=0,n=a,s=0;continue}}}else e.length>0?e+=`/${r.slice(n+1,a)}`:e=r.slice(n+1,a),i=a-n-1;n=a,s=0}else o===46&&s!==-1?++s:s=-1}return e}const ie={toPosix(r){return bw(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){ar(r),r=this.toPosix(r);const t=/^file:\/\/\//.exec(r);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(r);return e?e[0]:""},toAbsolute(r,t,e){if(ar(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const i=Rs(this.toPosix(t??ot.ADAPTER.getBaseUrl())),n=Rs(this.toPosix(e??this.rootname(i)));return r=this.toPosix(r),r.startsWith("/")?ie.join(n,r.slice(1)):this.isAbsolute(r)?r:this.join(i,r)},normalize(r){if(ar(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let t="";const e=r.startsWith("/");this.hasProtocol(r)&&(t=this.rootname(r),r=r.slice(t.length));const i=r.endsWith("/");return r=Tw(r),r.length>0&&i&&(r+="/"),e?`/${r}`:t+r},isAbsolute(r){return ar(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let t;for(let e=0;e<r.length;++e){const i=r[e];if(ar(i),i.length>0)if(t===void 0)t=i;else{const n=r[e-1]??"";this.extname(n)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(r){if(ar(r),r.length===0)return".";r=this.toPosix(r);let t=r.charCodeAt(0);const e=t===47;let i=-1,n=!0;const s=this.getProtocol(r),o=r;r=r.slice(s.length);for(let a=r.length-1;a>=1;--a)if(t=r.charCodeAt(a),t===47){if(!n){i=a;break}}else n=!1;return i===-1?e?"/":this.isUrl(o)?s+r:s:e&&i===1?"//":s+r.slice(0,i)},rootname(r){ar(r),r=this.toPosix(r);let t="";if(r.startsWith("/")?t="/":t=this.getProtocol(r),this.isUrl(r)){const e=r.indexOf("/",t.length);e!==-1?t=r.slice(0,e):t=r,t.endsWith("/")||(t+="/")}return t},basename(r,t){ar(r),t&&ar(t),r=Rs(this.toPosix(r));let e=0,i=-1,n=!0,s;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t.length===r.length&&t===r)return"";let o=t.length-1,a=-1;for(s=r.length-1;s>=0;--s){const h=r.charCodeAt(s);if(h===47){if(!n){e=s+1;break}}else a===-1&&(n=!1,a=s+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(i=s):(o=-1,i=a))}return e===i?i=a:i===-1&&(i=r.length),r.slice(e,i)}for(s=r.length-1;s>=0;--s)if(r.charCodeAt(s)===47){if(!n){e=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":r.slice(e,i)},extname(r){ar(r),r=Rs(this.toPosix(r));let t=-1,e=0,i=-1,n=!0,s=0;for(let o=r.length-1;o>=0;--o){const a=r.charCodeAt(o);if(a===47){if(!n){e=o+1;break}continue}i===-1&&(n=!1,i=o+1),a===46?t===-1?t=o:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===e+1?"":r.slice(t,i)},parse(r){ar(r);const t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;r=Rs(this.toPosix(r));let e=r.charCodeAt(0);const i=this.isAbsolute(r);let n;t.root=this.rootname(r),i||this.hasProtocol(r)?n=1:n=0;let s=-1,o=0,a=-1,h=!0,l=r.length-1,u=0;for(;l>=n;--l){if(e=r.charCodeAt(l),e===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),e===46?s===-1?s=l:u!==1&&(u=1):s!==-1&&(u=-1)}return s===-1||a===-1||u===0||u===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&i?t.base=t.name=r.slice(1,a):t.base=t.name=r.slice(o,a)):(o===0&&i?(t.name=r.slice(1,s),t.base=r.slice(1,a)):(t.name=r.slice(o,s),t.base=r.slice(o,a)),t.ext=r.slice(s,a)),t.dir=this.dirname(r),t},sep:"/",delimiter:":"};let El;async function Ew(){return El??(El=(async()=>{const r=document.createElement("canvas").getContext("webgl");if(!r)return be.UNPACK;const t=await new Promise(s=>{const o=document.createElement("video");o.onloadeddata=()=>s(o),o.onerror=()=>s(null),o.autoplay=!1,o.crossOrigin="anonymous",o.preload="auto",o.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",o.load()});if(!t)return be.UNPACK;const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);const i=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,i),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t);const n=new Uint8Array(4);return r.readPixels(0,0,1,1,r.RGBA,r.UNSIGNED_BYTE,n),r.deleteFramebuffer(i),r.deleteTexture(e),r.getExtension("WEBGL_lose_context")?.loseContext(),n[0]<=n[3]?be.PMA:be.UNPACK})()),El}let Al;function Aw(){return typeof Al>"u"&&(Al=(function(){const r={stencil:!0,failIfMajorPerformanceCaveat:ot.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!ot.ADAPTER.getWebGLRenderingContext())return!1;const t=ot.ADAPTER.createCanvas();let e=t.getContext("webgl",r)||t.getContext("experimental-webgl",r);const i=!!e?.getContextAttributes()?.stencil;if(e){const n=e.getExtension("WEBGL_lose_context");n&&n.loseContext()}return e=null,i}catch{return!1}})()),Al}var Sw={grad:.9,turn:360,rad:360/(2*Math.PI)},Wr=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},oe=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*r)/e+0},Ze=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),r>e?e:r>t?r:t},Wg=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},yp=function(r){return{r:Ze(r.r,0,255),g:Ze(r.g,0,255),b:Ze(r.b,0,255),a:Ze(r.a)}},Sl=function(r){return{r:oe(r.r),g:oe(r.g),b:oe(r.b),a:oe(r.a,3)}},Cw=/^#([0-9a-f]{3,8})$/i,$o=function(r){var t=r.toString(16);return t.length<2?"0"+t:t},Xg=function(r){var t=r.r,e=r.g,i=r.b,n=r.a,s=Math.max(t,e,i),o=s-Math.min(t,e,i),a=o?s===t?(e-i)/o:s===e?2+(i-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:n}},Vg=function(r){var t=r.h,e=r.s,i=r.v,n=r.a;t=t/360*6,e/=100,i/=100;var s=Math.floor(t),o=i*(1-e),a=i*(1-(t-s)*e),h=i*(1-(1-t+s)*e),l=s%6;return{r:255*[i,a,o,o,h,i][l],g:255*[h,i,i,a,o,o][l],b:255*[o,o,h,i,i,a][l],a:n}},vp=function(r){return{h:Wg(r.h),s:Ze(r.s,0,100),l:Ze(r.l,0,100),a:Ze(r.a)}},_p=function(r){return{h:oe(r.h),s:oe(r.s),l:oe(r.l),a:oe(r.a,3)}},xp=function(r){return Vg((e=(t=r).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},to=function(r){return{h:(t=Xg(r)).h,s:(n=(200-(e=t.s))*(i=t.v)/100)>0&&n<200?e*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a};var t,e,i,n},Mw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Rw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Pw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Iw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,vu={string:[[function(r){var t=Cw.exec(r);return t?(r=t[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?oe(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?oe(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var t=Pw.exec(r)||Iw.exec(r);return t?t[2]!==t[4]||t[4]!==t[6]?null:yp({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(r){var t=Mw.exec(r)||Rw.exec(r);if(!t)return null;var e,i,n=vp({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(Sw[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return xp(n)},"hsl"]],object:[[function(r){var t=r.r,e=r.g,i=r.b,n=r.a,s=n===void 0?1:n;return Wr(t)&&Wr(e)&&Wr(i)?yp({r:Number(t),g:Number(e),b:Number(i),a:Number(s)}):null},"rgb"],[function(r){var t=r.h,e=r.s,i=r.l,n=r.a,s=n===void 0?1:n;if(!Wr(t)||!Wr(e)||!Wr(i))return null;var o=vp({h:Number(t),s:Number(e),l:Number(i),a:Number(s)});return xp(o)},"hsl"],[function(r){var t=r.h,e=r.s,i=r.v,n=r.a,s=n===void 0?1:n;if(!Wr(t)||!Wr(e)||!Wr(i))return null;var o=(function(a){return{h:Wg(a.h),s:Ze(a.s,0,100),v:Ze(a.v,0,100),a:Ze(a.a)}})({h:Number(t),s:Number(e),v:Number(i),a:Number(s)});return Vg(o)},"hsv"]]},wp=function(r,t){for(var e=0;e<t.length;e++){var i=t[e][0](r);if(i)return[i,t[e][1]]}return[null,void 0]},Dw=function(r){return typeof r=="string"?wp(r.trim(),vu.string):typeof r=="object"&&r!==null?wp(r,vu.object):[null,void 0]},Cl=function(r,t){var e=to(r);return{h:e.h,s:Ze(e.s+100*t,0,100),l:e.l,a:e.a}},Ml=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},bp=function(r,t){var e=to(r);return{h:e.h,s:e.s,l:Ze(e.l+100*t,0,100),a:e.a}},_u=(function(){function r(t){this.parsed=Dw(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return oe(Ml(this.rgba),2)},r.prototype.isDark=function(){return Ml(this.rgba)<.5},r.prototype.isLight=function(){return Ml(this.rgba)>=.5},r.prototype.toHex=function(){return t=Sl(this.rgba),e=t.r,i=t.g,n=t.b,o=(s=t.a)<1?$o(oe(255*s)):"","#"+$o(e)+$o(i)+$o(n)+o;var t,e,i,n,s,o},r.prototype.toRgb=function(){return Sl(this.rgba)},r.prototype.toRgbString=function(){return t=Sl(this.rgba),e=t.r,i=t.g,n=t.b,(s=t.a)<1?"rgba("+e+", "+i+", "+n+", "+s+")":"rgb("+e+", "+i+", "+n+")";var t,e,i,n,s},r.prototype.toHsl=function(){return _p(to(this.rgba))},r.prototype.toHslString=function(){return t=_p(to(this.rgba)),e=t.h,i=t.s,n=t.l,(s=t.a)<1?"hsla("+e+", "+i+"%, "+n+"%, "+s+")":"hsl("+e+", "+i+"%, "+n+"%)";var t,e,i,n,s},r.prototype.toHsv=function(){return t=Xg(this.rgba),{h:oe(t.h),s:oe(t.s),v:oe(t.v),a:oe(t.a,3)};var t},r.prototype.invert=function(){return br({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},r.prototype.saturate=function(t){return t===void 0&&(t=.1),br(Cl(this.rgba,t))},r.prototype.desaturate=function(t){return t===void 0&&(t=.1),br(Cl(this.rgba,-t))},r.prototype.grayscale=function(){return br(Cl(this.rgba,-1))},r.prototype.lighten=function(t){return t===void 0&&(t=.1),br(bp(this.rgba,t))},r.prototype.darken=function(t){return t===void 0&&(t=.1),br(bp(this.rgba,-t))},r.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},r.prototype.alpha=function(t){return typeof t=="number"?br({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):oe(this.rgba.a,3);var e},r.prototype.hue=function(t){var e=to(this.rgba);return typeof t=="number"?br({h:t,s:e.s,l:e.l,a:e.a}):oe(e.h)},r.prototype.isEqual=function(t){return this.toHex()===br(t).toHex()},r})(),br=function(r){return r instanceof _u?r:new _u(r)},Tp=[],Ow=function(r){r.forEach(function(t){Tp.indexOf(t)<0&&(t(_u,vu),Tp.push(t))})};function kw(r,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in e)i[e[n]]=n;var s={};r.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,l=i[this.toHex()];if(l)return l;if(o?.closest){var u=this.toRgb(),c=1/0,d="black";if(!s.length)for(var f in e)s[f]=new r(e[f]).toRgb();for(var p in e){var m=(a=u,h=s[p],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));m<c&&(c=m,d=p)}return d}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":e[a];return h?new r(h).toRgb():null},"name"])}Ow([kw]);const Hn=class xa{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof xa)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,s)=>n===e[s]);if(t!==null&&e!==null){const n=Object.keys(t),s=Object.keys(e);return n.length!==s.length?!1:n.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,i,n]=this._components;return{r:t,g:e,b:i,a:n}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,n]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(n*255),t}toRgbArray(t){t=t??[];const[e,i,n]=this._components;return t[0]=e,t[1]=i,t[2]=n,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,n,s]=xa.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=n,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,n=this._int>>8&255,s=this._int&255;return e&&(i=i*t+.5|0,n=n*t+.5|0,s=s*t+.5|0),(t*255<<24)+(i<<16)+(n<<8)+s}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,i,n]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(i*t)/t,this._components[2]=Math.round(n*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,i,n,s]=this._components;return t[0]=e,t[1]=i,t[2]=n,t[3]=s,t}normalize(t){let e,i,n,s;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,i=(o>>8&255)/255,n=(o&255)/255,s=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,n,s=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,n,s=255]=t,e/=255,i/=255,n/=255,s/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=xa.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=br(t);o.isValid()&&({r:e,g:i,b:n,a:s}=o.rgba,e/=255,i/=255,n/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=n,this._components[3]=s,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((n,s)=>{t[s]=Math.min(Math.max(n,e),i)}),t)}};Hn.shared=new Hn,Hn.temp=new Hn,Hn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let kt=Hn;function Nw(r){return wt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),kt.shared.setValue(r).toHex()}function Fw(r){return wt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),kt.shared.setValue(r).toNumber()}function Lw(){const r=[],t=[];for(let i=0;i<32;i++)r[i]=i,t[i]=i;r[gt.NORMAL_NPM]=gt.NORMAL,r[gt.ADD_NPM]=gt.ADD,r[gt.SCREEN_NPM]=gt.SCREEN,t[gt.NORMAL]=gt.NORMAL_NPM,t[gt.ADD]=gt.ADD_NPM,t[gt.SCREEN]=gt.SCREEN_NPM;const e=[];return e.push(t),e.push(r),e}const $g=Lw();function Yg(r,t){return $g[t?1:0][r]}function Bw(r,t=null){const e=r*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let i=0,n=0;i<e;i+=6,n+=4)t[i+0]=n+0,t[i+1]=n+1,t[i+2]=n+2,t[i+3]=n+0,t[i+4]=n+2,t[i+5]=n+3;return t}function qg(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function Ga(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function Ep(r){return!(r&r-1)&&!!r}function Ap(r){let t=(r>65535?1:0)<<4;r>>>=t;let e=(r>255?1:0)<<3;return r>>>=e,t|=e,e=(r>15?1:0)<<2,r>>>=e,t|=e,e=(r>3?1:0)<<1,r>>>=e,t|=e,t|r>>1}function Jn(r,t,e){const i=r.length;let n;if(t>=i||e===0)return;e=t+e>i?i-t:e;const s=i-e;for(n=t;n<s;++n)r[n]=r[n+e];r.length=s}function Ei(r){return r===0?0:r<0?-1:1}let Uw=0;function xn(){return++Uw}const xu=class{constructor(r,t,e,i){this.left=r,this.top=t,this.right=e,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};xu.EMPTY=new xu(0,0,0,0);let Sp=xu;const Cp={},Tr=Object.create(null),_i=Object.create(null);class Hw{constructor(t,e,i){this._canvas=ot.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||ot.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Mp(r,t,e){for(let i=0,n=4*e*t;i<t;++i,n+=4)if(r[n+3]!==0)return!1;return!0}function Rp(r,t,e,i,n){const s=4*t;for(let o=i,a=i*s+4*e;o<=n;++o,a+=s)if(r[a+3]!==0)return!1;return!0}function Gw(r){const{width:t,height:e}=r,i=r.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const n=i.getImageData(0,0,t,e).data;let s=0,o=0,a=t-1,h=e-1;for(;o<e&&Mp(n,t,o);)++o;if(o===e)return Sp.EMPTY;for(;Mp(n,t,h);)--h;for(;Rp(n,t,s,o,h);)++s;for(;Rp(n,t,a,o,h);)--a;return++a,++h,new Sp(s,o,a,h)}function zw(r){const t=Gw(r),{width:e,height:i}=t;let n=null;if(!t.isEmpty()){const s=r.getContext("2d");if(s===null)throw new TypeError("Failed to get canvas 2D context");n=s.getImageData(t.left,t.top,e,i)}return{width:e,height:i,data:n}}function jw(r,t=globalThis.location){if(r.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(r,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function ri(r,t=1){const e=ot.RETINA_PREFIX?.exec(r);return e?parseFloat(e[1]):t}var it=(r=>(r.Renderer="renderer",r.Application="application",r.RendererSystem="renderer-webgl-system",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererSystem="renderer-canvas-system",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r))(it||{});const wu=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},Pp=(r,t)=>wu(r).priority??t,dt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(wu).forEach(t=>{t.type.forEach(e=>this._removeHandlers[e]?.(t))}),this},add(...r){return r.map(wu).forEach(t=>{t.type.forEach(e=>{const i=this._addHandlers,n=this._queue;i[e]?i[e](t):(n[e]=n[e]||[],n[e].push(t))})}),this},handle(r,t,e){const i=this._addHandlers,n=this._removeHandlers;if(i[r]||n[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=t,n[r]=e;const s=this._queue;return s[r]&&(s[r].forEach(o=>t(o)),delete s[r]),this},handleByMap(r,t){return this.handle(r,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(r,t,e=-1){return this.handle(r,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((n,s)=>Pp(s,e)-Pp(n,e)))},i=>{const n=t.indexOf(i.ref);n!==-1&&t.splice(n,1)})}};class bu{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const Ww=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Xw(r){let t="";for(let e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+=`if(test == ${e}.0){}`);return t}function Vw(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const i=Ww.replace(/%forloop%/gi,Xw(r));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}return r}const Rl=0,Pl=1,Il=2,Dl=3,Ol=4,kl=5;class Br{constructor(){this.data=0,this.blendMode=gt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Rl)}set blend(t){!!(this.data&1<<Rl)!==t&&(this.data^=1<<Rl)}get offsets(){return!!(this.data&1<<Pl)}set offsets(t){!!(this.data&1<<Pl)!==t&&(this.data^=1<<Pl)}get culling(){return!!(this.data&1<<Il)}set culling(t){!!(this.data&1<<Il)!==t&&(this.data^=1<<Il)}get depthTest(){return!!(this.data&1<<Dl)}set depthTest(t){!!(this.data&1<<Dl)!==t&&(this.data^=1<<Dl)}get depthMask(){return!!(this.data&1<<kl)}set depthMask(t){!!(this.data&1<<kl)!==t&&(this.data^=1<<kl)}get clockwiseFrontFace(){return!!(this.data&1<<Ol)}set clockwiseFrontFace(t){!!(this.data&1<<Ol)!==t&&(this.data^=1<<Ol)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==gt.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new Br;return t.depthTest=!1,t.blend=!0,t}}Br.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const Tu=[];function Zg(r,t){if(!r)return null;let e="";if(typeof r=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);i&&(e=i[1].toLowerCase())}for(let i=Tu.length-1;i>=0;--i){const n=Tu[i];if(n.test&&n.test(r,e))return new n(r,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class pr{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,n,s,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:u}=this;this._aliasCount++;for(let c=0,d=u.length;c<d;c++)u[c][l](t,e,i,n,s,o,a,h);return u===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(pr.prototype,{dispatch:{value:pr.prototype.emit},run:{value:pr.prototype.emit}});class ho{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new pr("setRealSize"),this.onUpdate=new pr("update"),this.onError=new pr("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Sh extends ho{constructor(t,e){const{width:i,height:n}=e||{};if(!i||!n)throw new Error("BufferResource width or height invalid");super(i,n),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,i){const n=t.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,this.unpackAlignment),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===be.UNPACK);const s=e.realWidth,o=e.realHeight;return i.width===s&&i.height===o?n.texSubImage2D(e.target,0,0,0,s,o,e.format,i.type,this.data):(i.width=s,i.height=o,n.texImage2D(e.target,0,i.internalFormat,s,o,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t===null||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const $w={scaleMode:qr.NEAREST,alphaMode:be.NPM},Eu=class Gn extends To{constructor(t=null,e=null){super(),e=Object.assign({},Gn.defaultOptions,e);const{alphaMode:i,mipmap:n,anisotropicLevel:s,scaleMode:o,width:a,height:h,wrapMode:l,format:u,type:c,target:d,resolution:f,resourceOptions:p}=e;t&&!(t instanceof ho)&&(t=Zg(t,p),t.internal=!0),this.resolution=f||ot.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((h||0)*this.resolution)/this.resolution,this._mipmap=n,this.anisotropicLevel=s,this._wrapMode=l,this._scaleMode=o,this.format=u,this.type=c,this.target=d,this.alphaMode=i,this.uid=xn(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let i;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this}setSize(t,e,i){return i=i||this.resolution,this.setRealSize(t*i,e*i,i)}setRealSize(t,e,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Ep(this.realWidth)&&Ep(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete _i[this.cacheId],delete Tr[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Gn.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,i=ot.STRICT_TEXTURE_CACHE){const n=typeof t=="string";let s=null;if(n)s=t;else{if(!t._pixiId){const a=e?.pixiIdPrefix||"pixiid";t._pixiId=`${a}_${xn()}`}s=t._pixiId}let o=_i[s];if(n&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||(o=new Gn(t,e),o.cacheId=s,Gn.addToCache(o,s)),o}static fromBuffer(t,e,i,n){t=t||new Float32Array(e*i*4);const s=new Sh(t,{width:e,height:i,...n?.resourceOptions});let o,a;return t instanceof Float32Array?(o=Q.RGBA,a=pt.FLOAT):t instanceof Int32Array?(o=Q.RGBA_INTEGER,a=pt.INT):t instanceof Uint32Array?(o=Q.RGBA_INTEGER,a=pt.UNSIGNED_INT):t instanceof Int16Array?(o=Q.RGBA_INTEGER,a=pt.SHORT):t instanceof Uint16Array?(o=Q.RGBA_INTEGER,a=pt.UNSIGNED_SHORT):t instanceof Int8Array?(o=Q.RGBA,a=pt.BYTE):(o=Q.RGBA,a=pt.UNSIGNED_BYTE),s.internal=!0,new Gn(s,Object.assign({},$w,{type:a,format:o},n))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),_i[e]&&_i[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),_i[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=_i[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete _i[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete _i[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};Eu.defaultOptions={mipmap:Fr.POW2,anisotropicLevel:0,scaleMode:qr.LINEAR,wrapMode:Ir.CLAMP,alphaMode:be.UNPACK,target:Qn.TEXTURE_2D,format:Q.RGBA,type:pt.UNSIGNED_BYTE},Eu._globalBatch=0;let vt=Eu;class Au{constructor(){this.texArray=null,this.blend=0,this.type=Rr.TRIANGLES,this.start=0,this.size=0,this.data=null}}let Yw=0;class $t{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=Yw++,this.disposeRunner=new pr("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Dr.ELEMENT_ARRAY_BUFFER:Dr.ARRAY_BUFFER}get index(){return this.type===Dr.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new $t(t)}}class za{constructor(t,e=0,i=!1,n=pt.FLOAT,s,o,a,h=1){this.buffer=t,this.size=e,this.normalized=i,this.type=n,this.stride=s,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,e,i,n,s){return new za(t,e,i,n,s)}}const qw={Float32Array,Uint32Array,Int32Array,Uint8Array};function Zw(r,t){let e=0,i=0;const n={};for(let h=0;h<r.length;h++)i+=t[h],e+=r[h].length;const s=new ArrayBuffer(e*4);let o=null,a=0;for(let h=0;h<r.length;h++){const l=t[h],u=r[h],c=qg(u);n[c]||(n[c]=new qw[c](s)),o=n[c];for(let d=0;d<u.length;d++){const f=(d/l|0)*i+a,p=d%l;o[f+p]=u[d]}a+=l}return new Float32Array(s)}const Ip={5126:4,5123:2,5121:1};let Kw=0;const Qw={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Di{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Kw++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new pr("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,n=!1,s,o,a,h=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof $t||(e instanceof Array&&(e=new Float32Array(e)),e=new $t(e));const l=t.split("|");if(l.length>1){for(let c=0;c<l.length;c++)this.addAttribute(l[c],e,i,n,s);return this}let u=this.buffers.indexOf(e);return u===-1&&(this.buffers.push(e),u=this.buffers.length-1),this.attributes[t]=new za(u,i,n,s,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof $t||(t instanceof Array&&(t=new Uint16Array(t)),t=new $t(t)),t.type=Dr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],i=new $t;let n;for(n in this.attributes){const s=this.attributes[n],o=this.buffers[s.buffer];t.push(o.data),e.push(s.size*Ip[s.type]/4),s.buffer=0}for(i.data=Zw(t,e),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Di;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new $t(this.buffers[e].data.slice(0));for(const e in this.attributes){const i=this.attributes[e];t.attributes[e]=new za(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Dr.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Di,i=[],n=[],s=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)n[h]=n[h]||0,n[h]+=o.buffers[h].data.length,s[h]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new Qw[qg(o.buffers[a].data)](n[a]),e.buffers[a]=new $t(i[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)i[h].set(o.buffers[h].data,s[h]),s[h]+=o.buffers[h].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=Dr.ELEMENT_ARRAY_BUFFER;let a=0,h=0,l=0,u=0;for(let c=0;c<o.buffers.length;c++)if(o.buffers[c]!==o.indexBuffer){u=c;break}for(const c in o.attributes){const d=o.attributes[c];(d.buffer|0)===u&&(h+=d.size*Ip[d.type]/4)}for(let c=0;c<t.length;c++){const d=t[c].indexBuffer.data;for(let f=0;f<d.length;f++)e.indexBuffer.data[f+l]+=a;a+=t[c].buffers[u].data.length/h,l+=d.length}}return e}}class Kg extends Di{constructor(t=!1){super(),this._buffer=new $t(null,t,!1),this._indexBuffer=new $t(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,pt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,pt.FLOAT).addAttribute("aColor",this._buffer,4,!0,pt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,pt.FLOAT).addIndex(this._indexBuffer)}}const ja=Math.PI*2,Jw=180/Math.PI,Su=Math.PI/180;var de=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(de||{});class mt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new mt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}mt.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Yo=[new mt,new mt,new mt,new mt];class yt{constructor(t=0,e=0,i=0,n=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(n),this.type=de.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new yt(0,0,0,0)}clone(){return new yt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const S=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=S)return!1;const D=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>D}const i=this.left,n=this.right,s=this.top,o=this.bottom;if(n<=i||o<=s)return!1;const a=Yo[0].set(t.left,t.top),h=Yo[1].set(t.left,t.bottom),l=Yo[2].set(t.right,t.top),u=Yo[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const c=Math.sign(e.a*e.d-e.b*e.c);if(c===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(u,u),Math.max(a.x,h.x,l.x,u.x)<=i||Math.min(a.x,h.x,l.x,u.x)>=n||Math.max(a.y,h.y,l.y,u.y)<=s||Math.min(a.y,h.y,l.y,u.y)>=o))return!1;const d=c*(h.y-a.y),f=c*(a.x-h.x),p=d*i+f*s,m=d*n+f*s,g=d*i+f*o,v=d*n+f*o;if(Math.max(p,m,g,v)<=d*a.x+f*a.y||Math.min(p,m,g,v)>=d*u.x+f*u.y)return!1;const w=c*(a.y-l.y),_=c*(l.x-a.x),T=w*i+_*s,b=w*n+_*s,x=w*i+_*o,y=w*n+_*o;return!(Math.max(T,b,x,y)<=w*a.x+_*a.y||Math.min(T,b,x,y)>=w*u.x+_*u.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),s=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=n,this.height=Math.max(s-n,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=n-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),s=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=n,this.height=s-n,this}}yt.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Ch{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.radius=i,this.type=de.CIRC}clone(){return new Ch(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let n=this.x-t,s=this.y-e;return n*=n,s*=s,n+s<=i}getBounds(){return new yt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}Ch.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Mh{constructor(t=0,e=0,i=0,n=0){this.x=t,this.y=e,this.width=i,this.height=n,this.type=de.ELIP}clone(){return new Mh(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,n=(e-this.y)/this.height;return i*=i,n*=n,i+n<=1}getBounds(){return new yt(this.x-this.width,this.y-this.height,this.width,this.height)}}Mh.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class dn{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let n=0,s=e.length;n<s;n++)i.push(e[n].x,e[n].y);e=i}this.points=e,this.type=de.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new dn(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let i=!1;const n=this.points.length/2;for(let s=0,o=n-1;s<n;o=s++){const a=this.points[s*2],h=this.points[s*2+1],l=this.points[o*2],u=this.points[o*2+1];h>e!=u>e&&t<(l-a)*((e-h)/(u-h))+a&&(i=!i)}return i}}dn.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((r,t)=>`${r}, ${t}`,"")}]`};class Rh{constructor(t=0,e=0,i=0,n=0,s=20){this.x=t,this.y=e,this.width=i,this.height=n,this.radius=s,this.type=de.RREC}clone(){return new Rh(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let n=t-(this.x+i),s=e-(this.y+i);const o=i*i;if(n*n+s*s<=o||(n=t-(this.x+this.width-i),n*n+s*s<=o)||(s=e-(this.y+this.height-i),n*n+s*s<=o)||(n=t-(this.x+i),n*n+s*s<=o))return!0}return!1}}Rh.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Nt{constructor(t=1,e=0,i=0,n=1,s=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=n,this.tx=s,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,n,s,o){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=s,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new mt;const i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e}applyInverse(t,e){e=e||new mt;const i=1/(this.a*this.d+this.c*-this.b),n=t.x,s=t.y;return e.x=this.d*i*n+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*s+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),n=this.a,s=this.c,o=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=s*e-this.d*i,this.d=s*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,n=this.c,s=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*s,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*s,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*s+this.ty,this}setTransform(t,e,i,n,s,o,a,h,l){return this.a=Math.cos(a+l)*s,this.b=Math.sin(a+l)*s,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+n*this.c),this.ty=e-(i*this.b+n*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,n=this.c,s=this.d,o=t.pivot,a=-Math.atan2(-n,s),h=Math.atan2(i,e),l=Math.abs(a+h);return l<1e-5||Math.abs(ja-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(n*n+s*s),t.position.x=this.tx+(o.x*e+o.y*n),t.position.y=this.ty+(o.x*i+o.y*s),t}invert(){const t=this.a,e=this.b,i=this.c,n=this.d,s=this.tx,o=t*n-e*i;return this.a=n/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-n*s)/o,this.ty=-(t*this.ty-e*s)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Nt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new Nt}static get TEMP_MATRIX(){return new Nt}}Nt.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const Ji=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],tn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],en=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],rn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Cu=[],Qg=[],qo=Math.sign;function tb(){for(let r=0;r<16;r++){const t=[];Cu.push(t);for(let e=0;e<16;e++){const i=qo(Ji[r]*Ji[e]+en[r]*tn[e]),n=qo(tn[r]*Ji[e]+rn[r]*tn[e]),s=qo(Ji[r]*en[e]+en[r]*rn[e]),o=qo(tn[r]*en[e]+rn[r]*rn[e]);for(let a=0;a<16;a++)if(Ji[a]===i&&tn[a]===n&&en[a]===s&&rn[a]===o){t.push(a);break}}}for(let r=0;r<16;r++){const t=new Nt;t.set(Ji[r],tn[r],en[r],rn[r],0,0),Qg.push(t)}}tb();const Ut={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>Ji[r],uY:r=>tn[r],vX:r=>en[r],vY:r=>rn[r],inv:r=>r&8?r&15:-r&7,add:(r,t)=>Cu[r][t],sub:(r,t)=>Cu[r][Ut.inv(t)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,t)=>Math.abs(r)*2<=Math.abs(t)?t>=0?Ut.S:Ut.N:Math.abs(t)*2<=Math.abs(r)?r>0?Ut.E:Ut.W:t>0?r>0?Ut.SE:Ut.SW:r>0?Ut.NE:Ut.NW,matrixAppendRotationInv:(r,t,e=0,i=0)=>{const n=Qg[Ut.inv(t)];n.tx=e,n.ty=i,r.append(n)}};class Kr{constructor(t,e,i=0,n=0){this._x=i,this._y=n,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new Kr(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}Kr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const Mu=class{constructor(){this.worldTransform=new Nt,this.localTransform=new Nt,this.position=new Kr(this.onChange,this,0,0),this.scale=new Kr(this.onChange,this,1,1),this.pivot=new Kr(this.onChange,this,0,0),this.skew=new Kr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(r){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==r._worldID){const e=r.worldTransform,i=this.worldTransform;i.a=t.a*e.a+t.b*e.c,i.b=t.a*e.b+t.b*e.d,i.c=t.c*e.a+t.d*e.c,i.d=t.c*e.b+t.d*e.d,i.tx=t.tx*e.a+t.ty*e.c+e.tx,i.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=r._worldID,this._worldID++}}setFromMatrix(r){r.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(r){this._rotation!==r&&(this._rotation=r,this.updateSkew())}};Mu.IDENTITY=new Mu;let Lc=Mu;Lc.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var eb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,rb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Dp(r,t,e){const i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}function Nl(r){const t=new Array(r);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Jg(r,t){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Nl(2*t);case"bvec3":return Nl(3*t);case"bvec4":return Nl(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const ts=[{test:r=>r.type==="float"&&r.size===1&&!r.isArray,code:r=>`
            if(uv["${r}"] !== ud["${r}"].value)
            {
                ud["${r}"].value = uv["${r}"]
                gl.uniform1f(ud["${r}"].location, uv["${r}"])
            }
            `},{test:(r,t)=>(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(t==null||t.castToBaseTexture!==void 0),code:r=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${r}"], t);

            if(ud["${r}"].value !== t)
            {
                ud["${r}"].value = t;
                gl.uniform1i(ud["${r}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(r,t)=>r.type==="mat3"&&r.size===1&&!r.isArray&&t.a!==void 0,code:r=>`
            gl.uniformMatrix3fv(ud["${r}"].location, false, uv["${r}"].toArray(true));
            `,codeUbo:r=>`
                var ${r}_matrix = uv.${r}.toArray(true);

                data[offset] = ${r}_matrix[0];
                data[offset+1] = ${r}_matrix[1];
                data[offset+2] = ${r}_matrix[2];
        
                data[offset + 4] = ${r}_matrix[3];
                data[offset + 5] = ${r}_matrix[4];
                data[offset + 6] = ${r}_matrix[5];
        
                data[offset + 8] = ${r}_matrix[6];
                data[offset + 9] = ${r}_matrix[7];
                data[offset + 10] = ${r}_matrix[8];
            `},{test:(r,t)=>r.type==="vec2"&&r.size===1&&!r.isArray&&t.x!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${r}"].location, v.x, v.y);
                }`,codeUbo:r=>`
                v = uv.${r};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:r=>r.type==="vec2"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${r}"].location, v[0], v[1]);
                }
            `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.width!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${r}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${r}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(r,t)=>r.type==="vec3"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${r}"].location, v.red, v.green, v.blue)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:r=>r.type==="vec4"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${r}"].location, v[0], v[1], v[2], v[3])
                }`}],ib={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},nb={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function sb(r,t){const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const i in r.uniforms){const n=t[i];if(!n){r.uniforms[i]?.group===!0&&(r.uniforms[i].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}const s=r.uniforms[i];let o=!1;for(let a=0;a<ts.length;a++)if(ts[a].test(n,s)){e.push(ts[a].code(i,s)),o=!0;break}if(!o){const a=(n.size===1&&!n.isArray?ib:nb)[n.type].replace("location",`ud["${i}"].location`);e.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${a};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const t0={};let Zo=t0;function ob(){if(Zo===t0||Zo?.isContextLost()){const r=ot.ADAPTER.createCanvas();let t;ot.PREFER_ENV>=Mn.WEBGL2&&(t=r.getContext("webgl2",{})),t||(t=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Zo=t}return Zo}let Ko;function ab(){if(!Ko){Ko=Ye.MEDIUM;const r=ob();if(r&&r.getShaderPrecisionFormat){const t=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);t&&(Ko=t.precision?Ye.HIGH:Ye.MEDIUM)}}return Ko}function Op(r,t){const e=r.getShaderSource(t).split(`
`).map((l,u)=>`${u}: ${l}`),i=r.getShaderInfoLog(t),n=i.split(`
`),s={},o=n.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!s[l]?(s[l]=!0,!0):!1),a=[""];o.forEach(l=>{e[l-1]=`%c${e[l-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=e.join(`
`);a[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function hb(r,t,e,i){r.getProgramParameter(t,r.LINK_STATUS)||(r.getShaderParameter(e,r.COMPILE_STATUS)||Op(r,e),r.getShaderParameter(i,r.COMPILE_STATUS)||Op(r,i),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(t)))}const lb={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function e0(r){return lb[r]}let Qo=null;const kp={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function r0(r,t){if(!Qo){const e=Object.keys(kp);Qo={};for(let i=0;i<e.length;++i){const n=e[i];Qo[r[n]]=kp[n]}}return Qo[t]}function Np(r,t,e){if(r.substring(0,9)!=="precision"){let i=t;return t===Ye.HIGH&&e!==Ye.HIGH&&(i=Ye.MEDIUM),`precision ${i} float;
${r}`}else if(e!==Ye.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}let Ps;function ub(){if(typeof Ps=="boolean")return Ps;try{Ps=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Ps=!1}return Ps}let cb=0;const Jo={},Ru=class zn{constructor(t,e,i="pixi-shader",n={}){this.extra={},this.id=cb++,this.vertexSrc=t||zn.defaultVertexSrc,this.fragmentSrc=e||zn.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=n,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),Jo[i]?(Jo[i]++,i+=`-${Jo[i]}`):Jo[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=Np(this.vertexSrc,zn.defaultVertexPrecision,Ye.HIGH),this.fragmentSrc=Np(this.fragmentSrc,zn.defaultFragmentPrecision,ab())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return rb}static get defaultFragmentSrc(){return eb}static from(t,e,i){const n=t+e;let s=Cp[n];return s||(Cp[n]=s=new zn(t,e,i)),s}};Ru.defaultVertexPrecision=Ye.HIGH,Ru.defaultFragmentPrecision=Zr.apple.device?Ye.HIGH:Ye.MEDIUM;let Qr=Ru,db=0;class mr{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=db++,this.static=!!e,this.ubo=!!i,t instanceof $t?(this.buffer=t,this.buffer.type=Dr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new $t(new Float32Array(1)),this.buffer.type=Dr.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(!this.ubo)this.uniforms[t]=new mr(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,i){return new mr(t,e,i)}static uboFrom(t,e){return new mr(t,e??!0,!0)}}class Or{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof mr?this.uniformGroup=e:this.uniformGroup=new mr(e):this.uniformGroup=new mr({}),this.disposeRunner=new pr("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const i in e.uniforms){const n=e.uniforms[i];if(n.group===!0&&this.checkUniformExists(t,n))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){const n=Qr.from(t,e);return new Or(n,i)}}class fb{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const i=new Int32Array(t);for(let s=0;s<t;s++)i[s]=s;this.defaultGroupCache[t]=mr.from({uSamplers:i},!0);let n=this.fragTemplate;n=n.replace(/%count%/gi,`${t}`),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Qr(this.vertexSrc,n)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Nt,default:this.defaultGroupCache[t]};return new Or(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Pu{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function pb(){return!Zr.apple.device}function mb(r){let t=!0;const e=ot.ADAPTER.getNavigator();if(Zr.tablet||Zr.phone){if(Zr.apple.device){const i=e.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Zr.android.device){const i=e.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?r:4}class Ph{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var gb=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,yb=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Gs=class lr extends Ph{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=Kg,this.vertexSize=6,this.state=Br.for2d(),this.size=lr.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??mb(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??pb(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return wt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return yb}static get defaultFragmentTemplate(){return gb}setShaderGenerator({vertex:t=lr.defaultVertexSrc,fragment:e=lr.defaultFragmentTemplate}={}){this.shaderGenerator=new fb(t,e)}contextChange(){const t=this.renderer.gl;ot.PREFER_ENV===Mn.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),lr.defaultMaxTextures),this.maxTextures=Vw(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=lr,i=this.size/4,n=Math.floor(i/this.maxTextures)+1;for(;t.length<i;)t.push(new Au);for(;e.length<n;)e.push(new Pu);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,i=lr._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++vt._globalBatch,h=0,l=i[0],u=0;n.copyBoundTextures(s,e);for(let c=0;c<this._bufferSize;++c){const d=t[c];t[c]=null,d._batchEnabled!==a&&(l.count>=e&&(n.boundArray(l,s,a,e),this.buildDrawCalls(l,u,c),u=c,l=i[++h],++a),d._batchEnabled=a,d.touched=o,l.elements[l.count++]=d)}l.count>0&&(n.boundArray(l,s,a,e),this.buildDrawCalls(l,u,this._bufferSize),++h,++a);for(let c=0;c<s.length;c++)s[c]=null;vt._globalBatch=a}buildDrawCalls(t,e,i){const{_bufferedElements:n,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,h=lr._drawCallPool;let l=this._dcIndex,u=this._aIndex,c=this._iIndex,d=h[l];d.start=this._iIndex,d.texArray=t;for(let f=e;f<i;++f){const p=n[f],m=p._texture.baseTexture,g=$g[m.alphaMode?1:0][p.blendMode];n[f]=null,e<f&&d.blend!==g&&(d.size=c-d.start,e=f,d=h[++l],d.texArray=t,d.start=c),this.packInterleavedGeometry(p,s,o,u,c),u+=p.vertexData.length/2*a,c+=p.indices.length,d.blend=g}e<i&&(d.size=c-d.start,++l),this._dcIndex=l,this._aIndex=u,this._iIndex=c}bindAndClearTexArray(t){const e=this.renderer.texture;for(let i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:i}=this;lr.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:i}=this.renderer,n=lr._drawCallPool;let s=null;for(let o=0;o<t;o++){const{texArray:a,type:h,size:l,start:u,blend:c}=n[o];s!==a&&(s=a,this.bindAndClearTexArray(a)),this.state.blendMode=c,i.set(this.state),e.drawElements(h,l,e.UNSIGNED_SHORT,u*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),lr.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=Ga(Math.ceil(t/8)),i=Ap(e),n=e*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._aBuffers[n];return s||(this._aBuffers[n]=s=new bu(n*this.vertexSize*4)),s}getIndexBuffer(t){const e=Ga(Math.ceil(t/12)),i=Ap(e),n=e*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let s=this._iBuffers[i];return s||(this._iBuffers[i]=s=new Uint16Array(n)),s}packInterleavedGeometry(t,e,i,n,s){const{uint32View:o,float32View:a}=e,h=n/this.vertexSize,l=t.uvs,u=t.indices,c=t.vertexData,d=t._texture.baseTexture._batchLocation,f=Math.min(t.worldAlpha,1),p=kt.shared.setValue(t._tintRGB).toPremultiplied(f,t._texture.baseTexture.alphaMode>0);for(let m=0;m<c.length;m+=2)a[n++]=c[m],a[n++]=c[m+1],a[n++]=l[m],a[n++]=l[m+1],o[n++]=p,a[n++]=d;for(let m=0;m<u.length;m++)i[s++]=h+u[m]}};Gs.defaultBatchSize=4096,Gs.extension={name:"batch",type:it.RendererPlugin},Gs._drawCallPool=[],Gs._textureArrayPool=[];let nn=Gs;dt.add(nn);var vb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,_b=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Iu=class zs extends Or{constructor(t,e,i){const n=Qr.from(t||zs.defaultVertexSrc,e||zs.defaultFragmentSrc);super(n,i),this.padding=0,this.resolution=zs.defaultResolution,this.multisample=zs.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Br}apply(t,e,i,n,s){t.applyFilter(this,e,i,n)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return _b}static get defaultFragmentSrc(){return vb}};Iu.defaultResolution=1,Iu.defaultMultisample=Zt.NONE;let ve=Iu;class Wa{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new kt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:i,backgroundAlpha:n}=t,s=i??e;s!==void 0&&(this.color=s),this.alpha=n}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Wa.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Wa.extension={type:[it.RendererSystem,it.CanvasRendererSystem],name:"background"};dt.add(Wa);class i0{constructor(t){this.renderer=t,this.emptyRenderer=new Ph(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:i}=this.renderer.texture;for(let n=e-1;n>=0;--n)t[n]=i[n]||null,t[n]&&(t[n]._batchLocation=n)}boundArray(t,e,i,n){const{elements:s,ids:o,count:a}=t;let h=0;for(let l=0;l<a;l++){const u=s[l],c=u._batchLocation;if(c>=0&&c<n&&e[c]===u){o[l]=c;continue}for(;h<n;){const d=e[h];if(d&&d._batchEnabled===i&&d._batchLocation===h){h++;continue}o[l]=h,u._batchLocation=h,e[h]=u;break}}}destroy(){this.renderer=null}}i0.extension={type:it.RendererSystem,name:"batch"};dt.add(i0);let Fp=0;class Xa{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Fp++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Fp++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(ot.PREFER_ENV>=Mn.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const n=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Xa.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},Xa.extension={type:it.RendererSystem,name:"context"};dt.add(Xa);class Du{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new pr("disposeFramebuffer"),this.multisample=Zt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new vt(null,{scaleMode:qr.NEAREST,resolution:1,mipmap:Fr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new vt(null,{scaleMode:qr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Fr.OFF,format:Q.DEPTH_COMPONENT,type:pt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const n=this.colorTextures[i],s=n.resolution;n.setSize(t/s,e/s)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class n0 extends vt{constructor(t={}){if(typeof t=="number"){const e=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];t={width:e,height:i,scaleMode:n,resolution:s}}t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=Zt.NONE),super(null,t),this.mipmap=Fr.OFF,this.valid=!0,this._clear=new kt([0,0,0,0]),this.framebuffer=new Du(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Oi extends ho{constructor(t){const e=t,i=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;super(i,n),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){i===void 0&&!e.startsWith("data:")?t.crossOrigin=jw(e):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,e,i,n){const s=t.gl,o=e.realWidth,a=e.realHeight;if(n=n||this.source,typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement&&n.readyState<=1)return!1;return s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===be.UNPACK),!this.noSubImage&&e.target===s.TEXTURE_2D&&i.width===o&&i.height===a?s.texSubImage2D(s.TEXTURE_2D,0,0,0,e.format,i.type,n):(i.width=o,i.height=a,s.texImage2D(e.target,0,i.internalFormat,e.format,i.type,n)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}}class s0 extends Oi{constructor(t,e){if(e=e||{},typeof t=="string"){const i=new Image;Oi.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??ot.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,i)=>{const n=this.source;this.url=n.src;const s=()=>{this.destroyed||(n.onload=null,n.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};n.complete&&n.src?s():(n.onload=s,n.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(n=>n.blob()).then(n=>e(n,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===be.UNPACK?"premultiply":"none"})).then(n=>this.destroyed?Promise.reject():(this.bitmap=n,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,i){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let n=!0;const s=e._glTextures;for(const o in s){const a=s[o];if(a!==i&&a.dirtyId!==e.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Bc{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){const n=e.width,s=e.height;if(i){const o=t.width/2/n,a=t.height/2/s,h=t.x/n+o,l=t.y/s+a;i=Ut.add(i,Ut.NW),this.x0=h+o*Ut.uX(i),this.y0=l+a*Ut.uY(i),i=Ut.add(i,2),this.x1=h+o*Ut.uX(i),this.y1=l+a*Ut.uY(i),i=Ut.add(i,2),this.x2=h+o*Ut.uX(i),this.y2=l+a*Ut.uY(i),i=Ut.add(i,2),this.x3=h+o*Ut.uX(i),this.y3=l+a*Ut.uY(i)}else this.x0=t.x/n,this.y0=t.y/s,this.x1=(t.x+t.width)/n,this.y1=t.y/s,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/s,this.x3=t.x/n,this.y3=(t.y+t.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}Bc.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Lp=new Bc;function ta(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}class ct extends To{constructor(t,e,i,n,s,o,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new yt(0,0,1,1)),t instanceof ct&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=n,this.valid=!1,this.destroyed=!1,this._uvs=Lp,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(s||0),s===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new mt(o.x,o.y):new mt(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e?.url&&Tr[e.url]&&ct.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,ct.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new ct(this.baseTexture,!this.noFrame&&t,e,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===Lp&&(this._uvs=new Bc),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=ot.STRICT_TEXTURE_CACHE){const n=typeof t=="string";let s=null;if(n)s=t;else if(t instanceof vt){if(!t.cacheId){const a=e?.pixiIdPrefix||"pixiid";t.cacheId=`${a}-${xn()}`,vt.addToCache(t,t.cacheId)}s=t.cacheId}else{if(!t._pixiId){const a=e?.pixiIdPrefix||"pixiid";t._pixiId=`${a}_${xn()}`}s=t._pixiId}let o=Tr[s];if(n&&i&&!o)throw new Error(`The cacheId "${s}" does not exist in TextureCache.`);return!o&&!(t instanceof vt)?(e.resolution||(e.resolution=ri(t)),o=new ct(new vt(t,e)),o.baseTexture.cacheId=s,vt.addToCache(o.baseTexture,s),ct.addToCache(o,s)):!o&&t instanceof vt&&(o=new ct(t),ct.addToCache(o,s)),o}static fromURL(t,e){const i=Object.assign({autoLoad:!1},e?.resourceOptions),n=ct.from(t,Object.assign({resourceOptions:i},e),!1),s=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):s.load().then(()=>Promise.resolve(n))}static fromBuffer(t,e,i,n){return new ct(vt.fromBuffer(t,e,i,n))}static fromLoader(t,e,i,n){const s=new vt(t,Object.assign({scaleMode:vt.defaultOptions.scaleMode,resolution:ri(e)},n)),{resource:o}=s;o instanceof s0&&(o.url=e);const a=new ct(s);return i||(i=e),vt.addToCache(a.baseTexture,i),ct.addToCache(a,i),i!==e&&(vt.addToCache(a.baseTexture,e),ct.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Tr[e]&&Tr[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Tr[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Tr[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Tr[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Tr[t.textureCacheIds[e]]===t&&delete Tr[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:i,width:n,height:s}=t,o=e+n>this.baseTexture.width,a=i+s>this.baseTexture.height;if(o||a){const h=o&&a?"and":"or",l=`X: ${e} + ${n} = ${e+n} > ${this.baseTexture.width}`,u=`Y: ${i} + ${s} = ${i+s} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${u}`)}this.valid=n&&s&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return ct._EMPTY||(ct._EMPTY=new ct(new vt),ta(ct._EMPTY),ta(ct._EMPTY.baseTexture)),ct._EMPTY}static get WHITE(){if(!ct._WHITE){const t=ot.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),ct._WHITE=new ct(vt.from(t)),ta(ct._WHITE),ta(ct._WHITE.baseTexture)}return ct._WHITE}}class Rn extends ct{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){const n=this.baseTexture.resolution,s=Math.round(t*n)/n,o=Math.round(e*n)/n;this.valid=s>0&&o>0,this._frame.width=this.orig.width=s,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(s,o),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Rn(new n0(t))}}class o0{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=Zt.NONE){const n=new n0(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new Rn(n)}getOptimalTexture(t,e,i=1,n=Zt.NONE){let s;t=Math.max(Math.ceil(t*i-1e-6),1),e=Math.max(Math.ceil(e*i-1e-6),1),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Ga(t),e=Ga(e),s=((t&65535)<<16|e&65535)>>>0,n>1&&(s+=n*4294967296)):s=n>1?-n:-1,this.texturePool[s]||(this.texturePool[s]=[]);let o=this.texturePool[s].pop();return o||(o=this.createTexture(t,e,n)),o.filterPoolKey=s,o.setResolution(i),o}getFilterTexture(t,e,i){const n=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||Zt.NONE);return n.filterFrame=t.filterFrame,n}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const i=this.texturePool[e];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const i=this.texturePool[e];if(i)for(let n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}o0.SCREEN_KEY=-1;class xb extends Di{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class a0 extends Di{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new $t(this.vertices),this.uvBuffer=new $t(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+e.width/t.width,this.uvs[3]=n,this.uvs[4]=i+e.width/t.width,this.uvs[5]=n+e.height/t.height,this.uvs[6]=i,this.uvs[7]=n+e.height/t.height,i=e.x,n=e.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+e.width,this.vertices[3]=n,this.vertices[4]=i+e.width,this.vertices[5]=n+e.height,this.vertices[6]=i,this.vertices[7]=n+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class wb{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Zt.NONE,this.sourceFrame=new yt,this.destinationFrame=new yt,this.bindingSourceFrame=new yt,this.bindingDestinationFrame=new yt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const ea=[new mt,new mt,new mt,new mt],Fl=new Nt;class h0{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new o0,this.statePool=[],this.quad=new xb,this.quadUv=new a0,this.tempRect=new yt,this.activeState={},this.globalUniforms=new mr({outputFrame:new yt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const i=this.renderer,n=this.defaultFilterStack,s=this.statePool.pop()||new wb,o=i.renderTexture;let a,h;if(o.current){const g=o.current;a=g.resolution,h=g.multisample}else a=i.resolution,h=i.multisample;let l=e[0].resolution||a,u=e[0].multisample??h,c=e[0].padding,d=e[0].autoFit,f=e[0].legacy??!0;for(let g=1;g<e.length;g++){const v=e[g];l=Math.min(l,v.resolution||a),u=Math.min(u,v.multisample??h),c=this.useMaxPadding?Math.max(c,v.padding):c+v.padding,d=d&&v.autoFit,f=f||(v.legacy??!0)}n.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(s),s.resolution=l,s.multisample=u,s.legacy=f,s.target=t,s.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),s.sourceFrame.pad(c);const p=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Fl.copyFrom(i.projection.transform).invert(),p),d?(s.sourceFrame.fit(p),(s.sourceFrame.width<=0||s.sourceFrame.height<=0)&&(s.sourceFrame.width=0,s.sourceFrame.height=0)):s.sourceFrame.intersects(p)||(s.sourceFrame.width=0,s.sourceFrame.height=0),this.roundFrame(s.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,l,u),s.filters=e,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;const m=this.tempRect;m.x=0,m.y=0,m.width=s.sourceFrame.width,m.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,m),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;const n=this.globalUniforms.uniforms;n.outputFrame=e.sourceFrame,n.resolution=e.resolution;const s=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(s[0]=e.destinationFrame.width,s[1]=e.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*e.resolution),o[1]=Math.round(s[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*s[2]-.5*o[2],a[3]=e.sourceFrame.height*s[3]-.5*o[3],e.legacy){const l=n.filterArea;l[0]=e.destinationFrame.width,l[1]=e.destinationFrame.height,l[2]=e.sourceFrame.x,l[3]=e.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,h.renderTexture,Cr.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let l=e.renderTexture,u=this.getOptimalFilterTexture(l.width,l.height,e.resolution);u.filterFrame=l.filterFrame;let c=0;for(c=0;c<i.length-1;++c){c===1&&e.multisample>1&&(u=this.getOptimalFilterTexture(l.width,l.height,e.resolution),u.filterFrame=l.filterFrame),i[c].apply(this,l,u,Cr.CLEAR,e);const d=l;l=u,u=d}i[c].apply(this,l,h.renderTexture,Cr.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(u)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Cr.CLEAR){const{renderTexture:i,state:n}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,i.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const s=n.stateId&1||this.forceClear;(e===Cr.CLEAR||e===Cr.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,n){const s=this.renderer;s.state.set(t.state),this.bindAndClear(i,n),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Rr.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Rr.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:i,destinationFrame:n}=this.activeState,{orig:s}=e._texture,o=t.set(n.width,0,0,n.height,i.x,i.y),a=e.worldTransform.copyTo(Nt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,n=Zt.NONE){return this.texturePool.getOptimalTexture(t,e,i,n)}getFilterTexture(t,e,i){if(typeof t=="number"){const s=t;t=e,e=s}t=t||this.activeState.renderTexture;const n=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||Zt.NONE);return n.filterFrame=t.filterFrame,n}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const i=ea[0],n=ea[1],s=ea[2],o=ea[3];i.set(e.left,e.top),n.set(e.left,e.bottom),s.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(i,i),t.apply(n,n),t.apply(s,s),t.apply(o,o);const a=Math.min(i.x,n.x,s.x,o.x),h=Math.min(i.y,n.y,s.y,o.y),l=Math.max(i.x,n.x,s.x,o.x),u=Math.max(i.y,n.y,s.y,o.y);e.x=a,e.y=h,e.width=l-a,e.height=u-h}roundFrame(t,e,i,n,s){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(s){const{a:o,b:a,c:h,d:l}=s;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}s=s?Fl.copyFrom(s):Fl.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(s,t),t.ceil(e),this.transformAABB(s.invert(),t)}}}h0.extension={type:it.RendererSystem,name:"filter"};dt.add(h0);class bb{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Zt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Tb=new yt;class l0{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Du(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new yt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;ot.PREFER_ENV===Mn.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=n=>e.drawBuffersWEBGL(n):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){const{gl:n}=this;if(t){const s=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,s.mipLevel=i),s.dirtyId!==t.dirtyId&&(s.dirtyId=t.dirtyId,s.dirtyFormat!==t.dirtyFormat?(s.dirtyFormat=t.dirtyFormat,s.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):s.dirtySize!==t.dirtySize&&(s.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const o=e.width>>i,a=e.height>>i,h=o/e.width;this.setViewport(e.x*h,e.y*h,o,a)}else{const o=t.width>>i,a=t.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,n){const s=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),n=Math.round(n),(s.width!==i||s.height!==n||s.x!==t||s.y!==e)&&(s.x=t,s.y=e,s.width=i,s.height=n,this.gl.viewport(t,e,i,n))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,n,s=yu.COLOR|yu.DEPTH){const{gl:o}=this;o.clearColor(t,e,i,n),o.clear(s)}initFramebuffer(t){const{gl:e}=this,i=new bb(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];if(i.stencil){e.bindRenderbuffer(e.RENDERBUFFER,i.stencil);let o;this.renderer.context.webGLVersion===1?o=e.DEPTH_STENCIL:t.depth&&t.stencil?o=e.DEPTH24_STENCIL8:t.depth?o=e.DEPTH_COMPONENT24:o=e.STENCIL_INDEX8,i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,o,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,o,t.width,t.height)}const n=t.colorTextures;let s=n.length;e.drawBuffers||(s=Math.min(s,1));for(let o=0;o<s;o++){const a=n[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:i}=this,n=t.glFramebuffers[this.CONTEXT_UID],s=t.colorTextures;let o=s.length;i.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(t)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null));const a=[];for(let h=0;h<o;h++){const l=s[h],u=l.parentTextureArray||l;this.renderer.texture.bind(u,0),h===0&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+h,l.target,u._glTextures[this.CONTEXT_UID].texture,e),a.push(i.COLOR_ATTACHMENT0+h))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const h=t.depthTexture;this.renderer.texture.bind(h,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,e)}if((t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)){n.stencil=n.stencil||i.createRenderbuffer();let h,l;this.renderer.context.webGLVersion===1?(h=i.DEPTH_STENCIL_ATTACHMENT,l=i.DEPTH_STENCIL):t.depth&&t.stencil?(h=i.DEPTH_STENCIL_ATTACHMENT,l=i.DEPTH24_STENCIL8):t.depth?(h=i.DEPTH_ATTACHMENT,l=i.DEPTH_COMPONENT24):(h=i.STENCIL_ATTACHMENT,l=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,l,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,l,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,h,i.RENDERBUFFER,n.stencil)}else n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let i=Zt.NONE;if(t<=1||e===null)return i;for(let n=0;n<e.length;n++)if(e[n]<=t){i=e[n];break}return i===1&&(i=Zt.NONE),i}blit(t,e,i){const{current:n,renderer:s,gl:o,CONTEXT_UID:a}=this;if(s.context.webGLVersion!==2||!n)return;const h=n.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;const u=n.colorTextures[0];if(!u)return;h.blitFramebuffer||(h.blitFramebuffer=new Du(n.width,n.height),h.blitFramebuffer.addColorTexture(0,u)),t=h.blitFramebuffer,t.colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),(t.width!==n.width||t.height!==n.height)&&(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}e||(e=Tb,e.width=n.width,e.height=n.height),i||(i=e);const l=e.width===i.width&&e.height===i.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const i=t.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const s=this.managedFramebuffers.indexOf(t);s>=0&&this.managedFramebuffers.splice(s,1),t.disposeRunner.remove(this),e||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const i=t.width,n=t.height,s=this.gl,o=e.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let a,h;this.renderer.context.webGLVersion===1?(a=s.DEPTH_STENCIL_ATTACHMENT,h=s.DEPTH_STENCIL):t.depth?(a=s.DEPTH_STENCIL_ATTACHMENT,h=s.DEPTH24_STENCIL8):(a=s.STENCIL_ATTACHMENT,h=s.STENCIL_INDEX8),e.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,e.multisample,h,i,n):s.renderbufferStorage(s.RENDERBUFFER,h,i,n),s.framebufferRenderbuffer(s.FRAMEBUFFER,a,s.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new yt}destroy(){this.renderer=null}}l0.extension={type:it.RendererSystem,name:"framebuffer"};dt.add(l0);const Ll={5126:4,5123:2,5121:1};class u0{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;ot.PREFER_ENV===Mn.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=n=>i.bindVertexArrayOES(n),t.deleteVertexArray=n=>i.deleteVertexArrayOES(n)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(n,s)=>i.vertexAttribDivisorANGLE(n,s),t.drawElementsInstanced=(n,s,o,a,h)=>i.drawElementsInstancedANGLE(n,s,o,a,h),t.drawArraysInstanced=(n,s,o,a)=>i.drawArraysInstancedANGLE(n,s,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:i}=this;let n=t.glVertexArrayObjects[this.CONTEXT_UID],s=!1;n||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=n={},s=!0);const o=n[e.program.id]||this.initGeometryVao(t,e,s);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const n=t.buffers[i];e.update(n)}}checkCompatibility(t,e){const i=t.attributes,n=e.attributeData;for(const s in n)if(!i[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(t,e){const i=t.attributes,n=e.attributeData,s=["g",t.id];for(const o in i)n[o]&&s.push(o,n[o].location);return s.join("-")}initGeometryVao(t,e,i=!0){const n=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[s]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const h=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID];let u=l[h];if(u)return l[a.id]=u,u;const c=t.buffers,d=t.attributes,f={},p={};for(const m in c)f[m]=0,p[m]=0;for(const m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[m].buffer]+=d[m].size*Ll[d[m].type];for(const m in d){const g=d[m],v=g.size;g.stride===void 0&&(f[g.buffer]===v*Ll[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=p[g.buffer],p[g.buffer]+=v*Ll[g.type])}u=n.createVertexArray(),n.bindVertexArray(u);for(let m=0;m<c.length;m++){const g=c[m];o.bind(g),i&&g._glBuffers[s].refCount++}return this.activateVao(t,a),l[a.id]=u,l[h]=u,n.bindVertexArray(null),o.unbind(Dr.ARRAY_BUFFER),u}disposeGeometry(t,e){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,s=t.buffers,o=this.renderer?.buffer;if(t.disposeRunner.remove(this),!!i){if(o)for(let a=0;a<s.length;a++){const h=s[a]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&o.dispose(s[a],e))}if(!e){for(const a in i)if(a[0]==="g"){const h=i[a];this._activeVao===h&&this.unbind(),n.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){const i=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&s.bind(t.indexBuffer);let h=null;for(const l in a){const u=a[l],c=o[u.buffer],d=c._glBuffers[n];if(e.attributeData[l]){h!==d&&(s.bind(c),h=d);const f=e.attributeData[l].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,u.size,u.type||i.FLOAT,u.normalized,u.stride,u.start),u.instance)if(this.hasInstance)i.vertexAttribDivisor(f,u.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,i,n){const{gl:s}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(t,e||o.indexBuffer.data.length,h,(i||0)*a,n||1):s.drawElements(t,e||o.indexBuffer.data.length,h,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(t,i,e||o.getSize(),n||1):s.drawArrays(t,i,e||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}u0.extension={type:it.RendererSystem,name:"geometry"};dt.add(u0);const Bp=new Nt;class c0{constructor(t,e){this._texture=t,this.mapCoord=new Nt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let n=0;n<t.length;n+=2){const s=t[n],o=t[n+1];e[n]=s*i.a+o*i.c+i.tx,e[n+1]=s*i.b+o*i.d+i.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const n=e.orig,s=e.trim;s&&(Bp.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Bp));const o=e.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,l=this.clampOffset;return a[0]=(e._frame.x+h+l)/o.width,a[1]=(e._frame.y+h+l)/o.height,a[2]=(e._frame.x+e._frame.width-h+l)/o.width,a[3]=(e._frame.y+e._frame.height-h+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0}}var Eb=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Ab=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Sb extends ve{constructor(t,e,i){let n=null;typeof t!="string"&&e===void 0&&i===void 0&&(n=t,t=void 0,e=void 0,i=void 0),super(t||Ab,e||Eb,i),this.maskSprite=n,this.maskMatrix=new Nt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,n){const s=this._maskSprite,o=s._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new c0(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,s).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,i,n))}}class Cb{constructor(t=null){this.type=re.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=ve.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=re.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class d0{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){const s=this.maskDataPool.pop()||new Cb;s.pooled=!0,s.maskObject=e,i=s}const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(n),i._colorMask=n?n._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==re.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case re.SCISSOR:this.renderer.scissor.push(i);break;case re.STENCIL:this.renderer.stencil.push(i);break;case re.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case re.COLOR:this.pushColorMask(i);break}i.type===re.SPRITE&&this.maskStack.push(i)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case re.SCISSOR:this.renderer.scissor.pop(e);break;case re.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case re.SPRITE:this.popSpriteMask(e);break;case re.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===re.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=re.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=re.SCISSOR:t.type=re.STENCIL:t.type=re.COLOR}pushSpriteMask(t){const{maskObject:e}=t,i=t._target;let n=t._filters;n||(n=this.alphaMaskPool[this.alphaMaskIndex],n||(n=this.alphaMaskPool[this.alphaMaskIndex]=[new Sb])),n[0].resolution=t.resolution,n[0].multisample=t.multisample,n[0].maskSprite=e;const s=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,n),i.filterArea=s,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){const e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}d0.extension={type:it.RendererSystem,name:"mask"};dt.add(d0);class f0{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;const n=this.getStackLength();n!==i&&(n===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Up=new Nt,Hp=[],p0=class wa extends f0{constructor(t){super(t),this.glConst=ot.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:i}=t,{renderer:n}=this,s=n.renderTexture,o=i.getBounds(!0,Hp.pop()??new yt);this.roundFrameToPixels(o,s.current?s.current.resolution:n.resolution,s.sourceFrame,s.destinationFrame,n.projection.transform),e&&o.fit(e),t._scissorRectLocal=o}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:i,c:n,d:s}=t;return(Math.abs(i)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(s)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||wa.isMatrixRotated(e.worldTransform)||wa.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const i=t._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(t,e,i,n,s){wa.isMatrixRotated(s)||(s=s?Up.copyFrom(s):Up.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.renderer.filter.transformAABB(s,t),t.fit(n),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&Hp.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};p0.extension={type:it.RendererSystem,name:"scissor"};let Mb=p0;dt.add(Mb);class m0 extends f0{constructor(t){super(t),this.glConst=ot.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:i}=this.renderer,n=t._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const s=t._colorMask;s!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,s!==0&&(t._colorMask=s,i.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,n!==0&&(i._colorMask=n,e.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}m0.extension={type:it.RendererSystem,name:"stencil"};dt.add(m0);class g0{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return wt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return wt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return wt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}g0.extension={type:[it.RendererSystem,it.CanvasRendererSystem],name:"_plugin"};dt.add(g0);class y0{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Nt,this.transform=null}update(t,e,i,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);const s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)}calculateProjection(t,e,i,n){const s=this.projectionMatrix,o=n?-1:1;s.identity(),s.a=1/e.width*2,s.d=o*(1/e.height*2),s.tx=-1-e.x*s.a,s.ty=-o-e.y*s.d}setTransform(t){}destroy(){this.renderer=null}}y0.extension={type:it.RendererSystem,name:"projection"};dt.add(y0);const Rb=new Lc,Gp=new yt;class v0{constructor(t){this.renderer=t,this._tempMatrix=new Nt}generateTexture(t,e){const{region:i,...n}=e||{},s=i?.copyTo(Gp)||t.getLocalBounds(Gp,!0),o=n.resolution||this.renderer.resolution;s.width=Math.max(s.width,1/o),s.height=Math.max(s.height,1/o),n.width=s.width,n.height=s.height,n.resolution=o,n.multisample??(n.multisample=this.renderer.multisample);const a=Rn.create(n);this._tempMatrix.tx=-s.x,this._tempMatrix.ty=-s.y;const h=t.transform;return t.transform=Rb,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=h,a}destroy(){}}v0.extension={type:[it.RendererSystem,it.CanvasRendererSystem],name:"textureGenerator"};dt.add(v0);const Yi=new yt,Is=new yt;class _0{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new yt,this.destinationFrame=new yt,this.viewportFrame=new yt}contextChange(){const t=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,i){const n=this.renderer;this.current=t;let s,o,a;t?(s=t.baseTexture,a=s.resolution,e||(Yi.width=t.frame.width,Yi.height=t.frame.height,e=Yi),i||(Is.x=t.frame.x,Is.y=t.frame.y,Is.width=e.width,Is.height=e.height,i=Is),o=s.framebuffer):(a=n.resolution,e||(Yi.width=n._view.screen.width,Yi.height=n._view.screen.height,e=Yi),i||(i=Yi,i.width=e.width,i.height=e.height));const h=this.viewportFrame;h.x=i.x*a,h.y=i.y*a,h.width=i.width*a,h.height=i.height*a,t||(h.y=n.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(i,e,a,!o),t?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,n=kt.shared.setValue(t||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&n.premultiply(n.alpha);const s=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=s.width!==o.width||s.height!==o.height;if(a){let{x:h,y:l,width:u,height:c}=this.viewportFrame;h=Math.round(h),l=Math.round(l),u=Math.round(u),c=Math.round(c),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,u,c)}this.renderer.framebuffer.clear(n.red,n.green,n.blue,n.alpha,e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}_0.extension={type:it.RendererSystem,name:"renderTexture"};dt.add(_0);class Pb{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function Ib(r,t){const e={},i=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){const s=t.getActiveAttrib(r,n);if(s.name.startsWith("gl_"))continue;const o=r0(t,s.type),a={type:o,name:s.name,size:e0(o),location:t.getAttribLocation(r,s.name)};e[s.name]=a}return e}function Db(r,t){const e={},i=t.getProgramParameter(r,t.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){const s=t.getActiveUniform(r,n),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),h=r0(t,s.type);e[o]={name:o,index:n,type:h,size:s.size,isArray:a,value:Jg(h,s.size)}}return e}function Ob(r,t){const e=Dp(r,r.VERTEX_SHADER,t.vertexSrc),i=Dp(r,r.FRAGMENT_SHADER,t.fragmentSrc),n=r.createProgram();r.attachShader(n,e),r.attachShader(n,i);const s=t.extra?.transformFeedbackVaryings;if(s&&(typeof r.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(n,s.names,s.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(n),r.getProgramParameter(n,r.LINK_STATUS)||hb(r,n,e,i),t.attributeData=Ib(n,r),t.uniformData=Db(n,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const a=Object.keys(t.attributeData);a.sort((h,l)=>h>l?1:-1);for(let h=0;h<a.length;h++)t.attributeData[a[h]].location=h,r.bindAttribLocation(n,h,a[h]);r.linkProgram(n)}r.deleteShader(e),r.deleteShader(i);const o={};for(const a in t.uniformData){const h=t.uniformData[a];o[a]={location:r.getUniformLocation(n,a),value:Jg(h.type,h.size)}}return new Pb(n,o)}function kb(r,t,e,i,n){e.buffer.update(n)}const Nb={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},x0={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function Fb(r){const t=r.map(s=>({data:s,offset:0,dataLen:0,dirty:0}));let e=0,i=0,n=0;for(let s=0;s<t.length;s++){const o=t[s];if(e=x0[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,i%e!==0&&i<16){const a=i%e%16;i+=a,n+=a}i+e>16?(n=Math.ceil(n/16)*16,o.offset=n,n+=e,i=e):(o.offset=n,i+=e,n+=e)}return n=Math.ceil(n/16)*16,{uboElements:t,size:n}}function Lb(r,t){const e=[];for(const i in r)t[i]&&e.push(t[i]);return e.sort((i,n)=>i.index-n.index),e}function Bb(r,t){if(!r.autoManage)return{size:0,syncFunc:kb};const e=Lb(r.uniforms,t),{uboElements:i,size:n}=Fb(e),s=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],h=r.uniforms[a.data.name],l=a.data.name;let u=!1;for(let c=0;c<ts.length;c++){const d=ts[c];if(d.codeUbo&&d.test(a.data,h)){s.push(`offset = ${a.offset/4};`,ts[c].codeUbo(a.data.name,h)),u=!0;break}}if(!u)if(a.data.size>1){const c=e0(a.data.type),d=Math.max(x0[a.data.type]/16,1),f=c/d,p=(4-f%4)%4;s.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const c=Nb[a.data.type];s.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};
                ${c};
                `)}}return s.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join(`
`))}}let Ub=0;const ra={textureCount:0,uboCount:0};class w0{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Ub++}systemCheck(){if(!ub())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),e||(ra.textureCount=0,ra.uboCount=0,this.syncUniformGroup(t.uniformGroup,ra)),n}setUniforms(t){const e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){const i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=sb(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;const n=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),n(i.uniformData,t.uniforms,this.renderer,ra,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){const{gl:n}=this.renderer;this.renderer.buffer.bind(t.buffer);const s=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(e.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=Bb(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(a.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){const n=t.uniforms,s=[`${i}-`];for(const o in n)s.push(o),e[o]&&s.push(e[o].type);return s.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,i=t.program,n=Ob(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}w0.extension={type:it.RendererSystem,name:"shader"};dt.add(w0);class Va{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.3.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Va.defaultOptions={hello:!1},Va.extension={type:[it.RendererSystem,it.CanvasRendererSystem],name:"startup"};dt.add(Va);function Hb(r,t=[]){return t[gt.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.ADD]=[r.ONE,r.ONE],t[gt.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.NONE]=[0,0],t[gt.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],t[gt.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[gt.SRC_IN]=[r.DST_ALPHA,r.ZERO],t[gt.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],t[gt.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[gt.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],t[gt.DST_IN]=[r.ZERO,r.SRC_ALPHA],t[gt.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],t[gt.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],t[gt.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[gt.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],t}const Gb=0,zb=1,jb=2,Wb=3,Xb=4,Vb=5,b0=class Ou{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=gt.NONE,this._blendEq=!1,this.map=[],this.map[Gb]=this.setBlend,this.map[zb]=this.setOffset,this.map[jb]=this.setCullFace,this.map[Wb]=this.setDepthTest,this.map[Xb]=this.setFrontFace,this.map[Vb]=this.setDepthMask,this.checks=[],this.defaultState=new Br,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=Hb(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,i=0;for(;e;)e&1&&this.map[i].call(this,!!(t.data&1<<i)),e=e>>1,i++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(Ou.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(Ou.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],i=this.gl;e.length===2?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const i=this.checks.indexOf(t);e&&i===-1?this.checks.push(t):!e&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};b0.extension={type:it.RendererSystem,name:"state"};let $b=b0;dt.add($b);class Yb extends To{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(n=>t.systems[n]),i=[...e,...Object.keys(t.systems).filter(n=>!e.includes(n))];for(const n of i)this.addSystem(t.systems[n],n)}addRunners(...t){t.forEach(e=>{this.runners[e]=new pr(e)})}addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const n in this.runners)this.runners[n].add(i);return this}emitWithCustomOptions(t,e){const i=Object.keys(this._systemsHash);t.items.forEach(n=>{const s=i.find(o=>this._systemsHash[o]===n);n[t.name](e[s])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const js=class ba{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=ba.defaultMaxIdle,this.checkCountMax=ba.defaultCheckCountMax,this.mode=ba.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==Oc.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let i=!1;for(let n=0;n<e.length;n++){const s=e[n];s.resource&&this.count-s.touched>this.maxIdle&&(t.destroyTexture(s,!0),e[n]=null,i=!0)}if(i){let n=0;for(let s=0;s<e.length;s++)e[s]!==null&&(e[n++]=e[s]);e.length=n}}unload(t){const e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(let n=t.children.length-1;n>=0;n--)this.unload(t.children[n])}destroy(){this.renderer=null}};js.defaultMode=Oc.AUTO,js.defaultMaxIdle=3600,js.defaultCheckCountMax=600,js.extension={type:it.RendererSystem,name:"textureGC"};let sn=js;dt.add(sn);class Bl{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=pt.UNSIGNED_BYTE,this.internalFormat=Q.RGBA,this.samplerType=0}}function qb(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[r.RGB]:st.FLOAT,[r.RGBA]:st.FLOAT,[r.ALPHA]:st.FLOAT,[r.LUMINANCE]:st.FLOAT,[r.LUMINANCE_ALPHA]:st.FLOAT,[r.R8]:st.FLOAT,[r.R8_SNORM]:st.FLOAT,[r.RG8]:st.FLOAT,[r.RG8_SNORM]:st.FLOAT,[r.RGB8]:st.FLOAT,[r.RGB8_SNORM]:st.FLOAT,[r.RGB565]:st.FLOAT,[r.RGBA4]:st.FLOAT,[r.RGB5_A1]:st.FLOAT,[r.RGBA8]:st.FLOAT,[r.RGBA8_SNORM]:st.FLOAT,[r.RGB10_A2]:st.FLOAT,[r.RGB10_A2UI]:st.FLOAT,[r.SRGB8]:st.FLOAT,[r.SRGB8_ALPHA8]:st.FLOAT,[r.R16F]:st.FLOAT,[r.RG16F]:st.FLOAT,[r.RGB16F]:st.FLOAT,[r.RGBA16F]:st.FLOAT,[r.R32F]:st.FLOAT,[r.RG32F]:st.FLOAT,[r.RGB32F]:st.FLOAT,[r.RGBA32F]:st.FLOAT,[r.R11F_G11F_B10F]:st.FLOAT,[r.RGB9_E5]:st.FLOAT,[r.R8I]:st.INT,[r.R8UI]:st.UINT,[r.R16I]:st.INT,[r.R16UI]:st.UINT,[r.R32I]:st.INT,[r.R32UI]:st.UINT,[r.RG8I]:st.INT,[r.RG8UI]:st.UINT,[r.RG16I]:st.INT,[r.RG16UI]:st.UINT,[r.RG32I]:st.INT,[r.RG32UI]:st.UINT,[r.RGB8I]:st.INT,[r.RGB8UI]:st.UINT,[r.RGB16I]:st.INT,[r.RGB16UI]:st.UINT,[r.RGB32I]:st.INT,[r.RGB32UI]:st.UINT,[r.RGBA8I]:st.INT,[r.RGBA8UI]:st.UINT,[r.RGBA16I]:st.INT,[r.RGBA16UI]:st.UINT,[r.RGBA32I]:st.INT,[r.RGBA32UI]:st.UINT,[r.DEPTH_COMPONENT16]:st.FLOAT,[r.DEPTH_COMPONENT24]:st.FLOAT,[r.DEPTH_COMPONENT32F]:st.FLOAT,[r.DEPTH_STENCIL]:st.FLOAT,[r.DEPTH24_STENCIL8]:st.FLOAT,[r.DEPTH32F_STENCIL8]:st.FLOAT}:t={[r.RGB]:st.FLOAT,[r.RGBA]:st.FLOAT,[r.ALPHA]:st.FLOAT,[r.LUMINANCE]:st.FLOAT,[r.LUMINANCE_ALPHA]:st.FLOAT,[r.DEPTH_STENCIL]:st.FLOAT},t}function Zb(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[pt.UNSIGNED_BYTE]:{[Q.RGBA]:r.RGBA8,[Q.RGB]:r.RGB8,[Q.RG]:r.RG8,[Q.RED]:r.R8,[Q.RGBA_INTEGER]:r.RGBA8UI,[Q.RGB_INTEGER]:r.RGB8UI,[Q.RG_INTEGER]:r.RG8UI,[Q.RED_INTEGER]:r.R8UI,[Q.ALPHA]:r.ALPHA,[Q.LUMINANCE]:r.LUMINANCE,[Q.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[pt.BYTE]:{[Q.RGBA]:r.RGBA8_SNORM,[Q.RGB]:r.RGB8_SNORM,[Q.RG]:r.RG8_SNORM,[Q.RED]:r.R8_SNORM,[Q.RGBA_INTEGER]:r.RGBA8I,[Q.RGB_INTEGER]:r.RGB8I,[Q.RG_INTEGER]:r.RG8I,[Q.RED_INTEGER]:r.R8I},[pt.UNSIGNED_SHORT]:{[Q.RGBA_INTEGER]:r.RGBA16UI,[Q.RGB_INTEGER]:r.RGB16UI,[Q.RG_INTEGER]:r.RG16UI,[Q.RED_INTEGER]:r.R16UI,[Q.DEPTH_COMPONENT]:r.DEPTH_COMPONENT16},[pt.SHORT]:{[Q.RGBA_INTEGER]:r.RGBA16I,[Q.RGB_INTEGER]:r.RGB16I,[Q.RG_INTEGER]:r.RG16I,[Q.RED_INTEGER]:r.R16I},[pt.UNSIGNED_INT]:{[Q.RGBA_INTEGER]:r.RGBA32UI,[Q.RGB_INTEGER]:r.RGB32UI,[Q.RG_INTEGER]:r.RG32UI,[Q.RED_INTEGER]:r.R32UI,[Q.DEPTH_COMPONENT]:r.DEPTH_COMPONENT24},[pt.INT]:{[Q.RGBA_INTEGER]:r.RGBA32I,[Q.RGB_INTEGER]:r.RGB32I,[Q.RG_INTEGER]:r.RG32I,[Q.RED_INTEGER]:r.R32I},[pt.FLOAT]:{[Q.RGBA]:r.RGBA32F,[Q.RGB]:r.RGB32F,[Q.RG]:r.RG32F,[Q.RED]:r.R32F,[Q.DEPTH_COMPONENT]:r.DEPTH_COMPONENT32F},[pt.HALF_FLOAT]:{[Q.RGBA]:r.RGBA16F,[Q.RGB]:r.RGB16F,[Q.RG]:r.RG16F,[Q.RED]:r.R16F},[pt.UNSIGNED_SHORT_5_6_5]:{[Q.RGB]:r.RGB565},[pt.UNSIGNED_SHORT_4_4_4_4]:{[Q.RGBA]:r.RGBA4},[pt.UNSIGNED_SHORT_5_5_5_1]:{[Q.RGBA]:r.RGB5_A1},[pt.UNSIGNED_INT_2_10_10_10_REV]:{[Q.RGBA]:r.RGB10_A2,[Q.RGBA_INTEGER]:r.RGB10_A2UI},[pt.UNSIGNED_INT_10F_11F_11F_REV]:{[Q.RGB]:r.R11F_G11F_B10F},[pt.UNSIGNED_INT_5_9_9_9_REV]:{[Q.RGB]:r.RGB9_E5},[pt.UNSIGNED_INT_24_8]:{[Q.DEPTH_STENCIL]:r.DEPTH24_STENCIL8},[pt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[Q.DEPTH_STENCIL]:r.DEPTH32F_STENCIL8}}:t={[pt.UNSIGNED_BYTE]:{[Q.RGBA]:r.RGBA,[Q.RGB]:r.RGB,[Q.ALPHA]:r.ALPHA,[Q.LUMINANCE]:r.LUMINANCE,[Q.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[pt.UNSIGNED_SHORT_5_6_5]:{[Q.RGB]:r.RGB},[pt.UNSIGNED_SHORT_4_4_4_4]:{[Q.RGBA]:r.RGBA},[pt.UNSIGNED_SHORT_5_5_5_1]:{[Q.RGBA]:r.RGBA}},t}class T0{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new vt,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=Zb(t),this.samplerTypes=qb(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};const i=new Bl(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Bl(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let n=0;n<this.boundTextures.length;n++)this.bind(null,n)}bind(t,e=0){const{gl:i}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):n.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(let n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[n]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:n}=this;if(i)for(let s=t-1;s>=0;--s){const o=e[s];o&&o._glTextures[n].samplerType!==st.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const e=new Bl(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){e.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??st.FLOAT,this.webGLVersion===2&&t.type===pt.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const i=this.renderer;if(this.initTextureType(t,e),t.resource?.upload(i,t,e))e.samplerType!==st.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,s=t.realHeight,o=i.gl;(e.width!==n||e.height!==s||e.dirtyId<0)&&(e.width=n,e.height=s,o.texImage2D(t.target,0,e.internalFormat,n,s,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const n=this.managedTextures.indexOf(t);n!==-1&&Jn(this.managedTextures,n,1)}}updateTextureStyle(t){const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Fr.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=Ir.CLAMP:e.wrapMode=t.wrapMode,t.resource?.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const i=this.gl;if(e.mipmap&&t.mipmap!==Fr.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===qr.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const n=this.renderer.context.extensions.anisotropicFiltering;if(n&&t.anisotropicLevel>0&&t.scaleMode===qr.LINEAR){const s=Math.min(t.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===qr.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===qr.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}T0.extension={type:it.RendererSystem,name:"texture"};dt.add(T0);class E0{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,n=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:i,renderer:n}=this;e&&n.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:i,CONTEXT_UID:n}=this,s=e.createTransformFeedback();t._glTransformFeedbacks[n]=s,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(i.buffer.update(a),a._glBuffers[n].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[n].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),s}disposeTransformFeedback(t,e){const i=t._glTransformFeedbacks[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this);const s=this.renderer.buffer;if(s)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&s.dispose(a,e))}i&&(e||n.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}E0.extension={type:it.RendererSystem,name:"transformFeedback"};dt.add(E0);class $a{constructor(t){this.renderer=t}init(t){this.screen=new yt(0,0,t.width,t.height),this.element=t.view||ot.ADAPTER.createCanvas(),this.resolution=t.resolution||ot.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const i=this.element.width/this.resolution,n=this.element.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${n}px`),this.renderer.emit("resize",i,n),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}$a.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},$a.extension={type:[it.RendererSystem,it.CanvasRendererSystem],name:"_view"};dt.add($a);ot.PREFER_ENV=Mn.WEBGL2;ot.STRICT_TEXTURE_CACHE=!1;ot.RENDER_OPTIONS={...Xa.defaultOptions,...Wa.defaultOptions,...$a.defaultOptions,...Va.defaultOptions};Object.defineProperties(ot,{WRAP_MODE:{get(){return vt.defaultOptions.wrapMode},set(r){wt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),vt.defaultOptions.wrapMode=r}},SCALE_MODE:{get(){return vt.defaultOptions.scaleMode},set(r){wt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),vt.defaultOptions.scaleMode=r}},MIPMAP_TEXTURES:{get(){return vt.defaultOptions.mipmap},set(r){wt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),vt.defaultOptions.mipmap=r}},ANISOTROPIC_LEVEL:{get(){return vt.defaultOptions.anisotropicLevel},set(r){wt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),vt.defaultOptions.anisotropicLevel=r}},FILTER_RESOLUTION:{get(){return wt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),ve.defaultResolution},set(r){ve.defaultResolution=r}},FILTER_MULTISAMPLE:{get(){return wt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),ve.defaultMultisample},set(r){ve.defaultMultisample=r}},SPRITE_MAX_TEXTURES:{get(){return nn.defaultMaxTextures},set(r){wt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),nn.defaultMaxTextures=r}},SPRITE_BATCH_SIZE:{get(){return nn.defaultBatchSize},set(r){wt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),nn.defaultBatchSize=r}},CAN_UPLOAD_SAME_BUFFER:{get(){return nn.canUploadSameBuffer},set(r){wt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),nn.canUploadSameBuffer=r}},GC_MODE:{get(){return sn.defaultMode},set(r){wt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),sn.defaultMode=r}},GC_MAX_IDLE:{get(){return sn.defaultMaxIdle},set(r){wt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),sn.defaultMaxIdle=r}},GC_MAX_CHECK_COUNT:{get(){return sn.defaultCheckCountMax},set(r){wt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),sn.defaultCheckCountMax=r}},PRECISION_VERTEX:{get(){return Qr.defaultVertexPrecision},set(r){wt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Qr.defaultVertexPrecision=r}},PRECISION_FRAGMENT:{get(){return Qr.defaultFragmentPrecision},set(r){wt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Qr.defaultFragmentPrecision=r}}});var wn=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(wn||{});class Ul{constructor(t,e=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=n}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const A0=class Ie{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Ul(null,null,1/0),this.deltaMS=1/Ie.targetFPMS,this.elapsedMS=1/Ie.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=wn.NORMAL){return this._addListener(new Ul(t,e,i))}addOnce(t,e,i=wn.NORMAL){return this._addListener(new Ul(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const s=t-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=t-s%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Ie.targetFPMS;const i=this._head;let n=i.next;for(;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Ie.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!Ie._shared){const t=Ie._shared=new Ie;t.autoStart=!0,t._protected=!0}return Ie._shared}static get system(){if(!Ie._system){const t=Ie._system=new Ie;t.autoStart=!0,t._protected=!0}return Ie._system}};A0.targetFPMS=.06;let _e=A0;Object.defineProperties(ot,{TARGET_FPMS:{get(){return _e.targetFPMS},set(r){wt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),_e.targetFPMS=r}}});class S0{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,wn.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?_e.shared:new _e,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}S0.extension=it.Application;dt.add(S0);const C0=[];dt.handleByList(it.Renderer,C0);function Kb(r){for(const t of C0)if(t.test(r))return new t(r);throw new Error("Unable to auto-detect a suitable renderer.")}var Qb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Jb=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const t2=Qb,M0=Jb;class R0{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=Zt.HIGH?this.multisample=Zt.HIGH:e>=Zt.MEDIUM?this.multisample=Zt.MEDIUM:e>=Zt.LOW?this.multisample=Zt.LOW:this.multisample=Zt.NONE}destroy(){}}R0.extension={type:it.RendererSystem,name:"_multisample"};dt.add(R0);class e2{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class P0{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,n.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:i,CONTEXT_UID:n}=this;if(this.boundBufferBases[e]!==t){const s=t._glBuffers[n]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,s.buffer)}}bindBufferRange(t,e,i){const{gl:n,CONTEXT_UID:s}=this;i=i||0;const o=t._glBuffers[s]||this.createGLBuffer(t);n.bindBufferRange(n.UNIFORM_BUFFER,e||0,o.buffer,i*256,256)}update(t){const{gl:e,CONTEXT_UID:i}=this,n=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==n.updateID)if(n.updateID=t._updateID,e.bindBuffer(t.type,n.buffer),n.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const s=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,s)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this),i&&(e||n.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new e2(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}P0.extension={type:it.RendererSystem,name:"buffer"};dt.add(P0);class I0{constructor(t){this.renderer=t}render(t,e){const i=this.renderer;let n,s,o,a;if(e&&(n=e.renderTexture,s=e.clear,o=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(n||(this.lastObjectRendered=t),!a){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}i.renderTexture.bind(n),i.batch.currentRenderer.start(),(s??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),n&&(e.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}I0.extension={type:it.RendererSystem,name:"objectRenderer"};dt.add(I0);const Ta=class ku extends Yb{constructor(t){super(),this.type=Og.WEBGL,t=Object.assign({},ot.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new mr({projectionMatrix:new Nt},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:ku.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(wt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=ku.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t?.forceCanvas?!1:Aw()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return wt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return wt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return wt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return wt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){wt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return wt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){wt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return wt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};Ta.extension={type:it.Renderer,priority:1},Ta.__plugins={},Ta.__systems={};let Uc=Ta;dt.handleByMap(it.RendererPlugin,Uc.__plugins);dt.handleByMap(it.RendererSystem,Uc.__systems);dt.add(Uc);class D0 extends ho{constructor(t,e){const{width:i,height:n}=e||{};super(i,n),this.items=[],this.itemDirtyIds=[];for(let s=0;s<t;s++){const o=new vt;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof ho?this.addResourceAt(t[i],i):this.addResourceAt(Zg(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(t).then(()=>{const{realWidth:e,realHeight:i}=this.items[0];return this.resize(e,i),this.update(),Promise.resolve(this)}),this._load}}class r2 extends D0{constructor(t,e){const{width:i,height:n}=e||{};let s,o;Array.isArray(t)?(s=t,o=t.length):o=t,super(o,{width:i,height:n}),s&&this.initFromArray(s,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Qn.TEXTURE_2D_ARRAY}upload(t,e,i){const{length:n,itemDirtyIds:s,items:o}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,n,0,e.format,i.type,null);for(let h=0;h<n;h++){const l=o[h];s[h]<l.dirtyId&&(s[h]=l.dirtyId,l.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,e.format,i.type,l.resource.source))}return!0}}class i2 extends Oi{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const O0=class Ws extends D0{constructor(t,e){const{width:i,height:n,autoLoad:s,linkBaseTexture:o}=e||{};if(t&&t.length!==Ws.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:i,height:n});for(let a=0;a<Ws.SIDES;a++)this.items[a].target=Qn.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,t&&this.initFromArray(t,e),s!==!1&&this.load()}bind(t){super.bind(t),t.target=Qn.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=Qn.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,i){const n=this.itemDirtyIds;for(let s=0;s<Ws.SIDES;s++){const o=this.items[s];(n[s]<o.dirtyId||i.dirtyId<e.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(t,o,i),n[s]=o.dirtyId):n[s]<-1&&(t.gl.texImage2D(o.target,0,i.internalFormat,e.realWidth,e.realHeight,0,e.format,i.type,null),n[s]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===Ws.SIDES}};O0.SIDES=6;let n2=O0;class Vn extends Oi{constructor(t,e){e=e||{};let i,n,s;typeof t=="string"?(i=Vn.EMPTY,n=t,s=!0):(i=t,n=null,s=!1),super(i),this.url=n,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??s,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const i=await ot.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const n=await i.blob();if(this.destroyed)return;const s=await createImageBitmap(n,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===be.UNPACK?"premultiply":"none"});if(this.destroyed){s.close();return}this.source=s,this.update(),t(this)}catch(i){if(this.destroyed)return;e(i),this.onError.emit(i)}}),this._load)}upload(t,e,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Vn._EMPTY=Vn._EMPTY??ot.ADAPTER.createCanvas(0,0),Vn._EMPTY}}const Nu=class Ea extends Oi{constructor(t,e){e=e||{},super(ot.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},Ea.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;Oi.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,i=t.height;if(!e||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=e*this.scale,s=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/i*e,s=this._overrideHeight||this._overrideWidth/e*i),n=Math.round(n),s=Math.round(s);const o=this.source;o.width=n,o.height=s,o._pixiId=`canvas_${xn()}`,o.getContext("2d").drawImage(t,0,0,e,i,0,0,n,s),this._resolve(),this._resolve=null}}static getSize(t){const e=Ea.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&Ea.SVG_XML.test(t)}};Nu.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Nu.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let Fu=Nu;const Lu=class Bu extends Oi{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const i=document.createElement("video");e.autoLoad!==!1&&i.setAttribute("preload","auto"),e.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),e.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),e.loop===!0&&i.setAttribute("loop",""),e.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof t=="string"&&(t=[t]);const n=t[0].src||t[0];Oi.crossOrigin(i,n,e.crossorigin);for(let s=0;s<t.length;++s){const o=document.createElement("source");let{src:a,mime:h}=t[s];if(a=a||t[s],a.startsWith("data:"))h=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const l=a.split("?").shift().toLowerCase(),u=l.slice(l.lastIndexOf(".")+1);h=h||Bu.MIME_TYPES[u]||`video/${u}`}o.src=a,h&&(o.type=h),i.appendChild(o)}t=i}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const e=_e.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,i)=>{this.valid?e(this):(this._resolve=e,this._reject=i,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(_e.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(_e.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(_e.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||Bu.TYPES.includes(e)}};Lu.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Lu.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let k0=Lu;Tu.push(Vn,s0,i2,k0,Fu,Sh,n2,r2);class Ya{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?yt.EMPTY:(t=t||new yt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:i,b:n,c:s,d:o,tx:a,ty:h}=t,l=i*e.x+s*e.y+a,u=n*e.x+o*e.y+h;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)}addQuad(t){let e=this.minX,i=this.minY,n=this.maxX,s=this.maxY,o=t[0],a=t[1];e=o<e?o:e,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=t[2],a=t[3],e=o<e?o:e,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=t[4],a=t[5],e=o<e?o:e,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=t[6],a=t[7],e=o<e?o:e,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,this.minX=e,this.minY=i,this.maxX=n,this.maxY=s}addFrame(t,e,i,n,s){this.addFrameMatrix(t.worldTransform,e,i,n,s)}addFrameMatrix(t,e,i,n,s){const o=t.a,a=t.b,h=t.c,l=t.d,u=t.tx,c=t.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,g=o*e+h*i+u,v=a*e+l*i+c;d=g<d?g:d,f=v<f?v:f,p=g>p?g:p,m=v>m?v:m,g=o*n+h*i+u,v=a*n+l*i+c,d=g<d?g:d,f=v<f?v:f,p=g>p?g:p,m=v>m?v:m,g=o*e+h*s+u,v=a*e+l*s+c,d=g<d?g:d,f=v<f?v:f,p=g>p?g:p,m=v>m?v:m,g=o*n+h*s+u,v=a*n+l*s+c,d=g<d?g:d,f=v<f?v:f,p=g>p?g:p,m=v>m?v:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addVertexData(t,e,i){let n=this.minX,s=this.minY,o=this.maxX,a=this.maxY;for(let h=e;h<i;h+=2){const l=t[h],u=t[h+1];n=l<n?l:n,s=u<s?u:s,o=l>o?l:o,a=u>a?u:a}this.minX=n,this.minY=s,this.maxX=o,this.maxY=a}addVertices(t,e,i,n){this.addVerticesMatrix(t.worldTransform,e,i,n)}addVerticesMatrix(t,e,i,n,s=0,o=s){const a=t.a,h=t.b,l=t.c,u=t.d,c=t.tx,d=t.ty;let f=this.minX,p=this.minY,m=this.maxX,g=this.maxY;for(let v=i;v<n;v+=2){const w=e[v],_=e[v+1],T=a*w+l*_+c,b=u*_+h*w+d;f=Math.min(f,T-s),m=Math.max(m,T+s),p=Math.min(p,b-o),g=Math.max(g,b+o)}this.minX=f,this.minY=p,this.maxX=m,this.maxY=g}addBounds(t){const e=this.minX,i=this.minY,n=this.maxX,s=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>s?t.maxY:s}addBoundsMask(t,e){const i=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,s=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=s&&n<=o){const a=this.minX,h=this.minY,l=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=n<h?n:h,this.maxX=s>l?s:l,this.maxY=o>u?o:u}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const i=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,s=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=s&&n<=o){const a=this.minX,h=this.minY,l=this.maxX,u=this.maxY;this.minX=i<a?i:a,this.minY=n<h?n:h,this.maxX=s>l?s:l,this.maxY=o>u?o:u}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,i,n,s,o){t-=s,e-=o,i+=s,n+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>n?this.maxY:n}}class zt extends To{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Lc,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Ya,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let i=0;i<e.length;++i){const n=e[i];Object.defineProperty(zt.prototype,n,Object.getOwnPropertyDescriptor(t,n))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new yt),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new yt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Ya);const e=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=i?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;const n=this._bounds,s=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=n,this._bounds.updateID+=this._boundsID-s,o}toGlobal(t,e,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,i,n){return e&&(t=e.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,e=0,i=1,n=1,s=0,o=0,a=0,h=0,l=0){return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=n||1,this.rotation=s,this.skew.x=o,this.skew.y=a,this.pivot.x=h,this.pivot.y=l,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new s2),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Jw}set angle(t){this.transform.rotation=t*Su}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class s2 extends zt{constructor(){super(...arguments),this.sortDirty=null}}zt.prototype.displayObjectUpdateTransform=zt.prototype.updateTransform;const o2=new Nt;function a2(r,t){return r.zIndex===t.zIndex?r._lastSortedIndex-t._lastSortedIndex:r.zIndex-t.zIndex}const N0=class Uu extends zt{constructor(){super(),this.children=[],this.sortableChildren=Uu.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const i=this.getChildIndex(t),n=this.getChildIndex(e);this.children[i]=e,this.children[n]=t,this.onChildrenChange(i<n?i:n)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(t);Jn(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],i=this.children.indexOf(e);if(i===-1)return null;e.parent=null,e.transform._parentID=-1,Jn(this.children,i,1),this._boundsID++,this.onChildrenChange(i),e.emit("removed",this),this.emit("childRemoved",e,this,i)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Jn(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const i=t,n=e,s=n-i;let o;if(s>0&&s<=n){o=this.children.splice(i,s);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,i=this.children.length;e<i;++e){const n=this.children[e];n._lastSortedIndex=e,!t&&n.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(a2),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const i=this.children[t];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const i=super.getLocalBounds(t);if(!e)for(let n=0,s=this.children.length;n<s;++n){const o=this.children[n];o.visible&&o.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let i,n;this.cullArea?(i=this.cullArea,n=this.worldTransform):this._render!==Uu.prototype._render&&(i=this.getBounds(!0));const s=t.projection.transform;if(s&&(n?(n=o2.copyFrom(n),n.prepend(s)):n=s),i&&e.intersects(i,n))this._render(t);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const h=this.children[o],l=h.cullable;h.cullable=l||!this.cullArea,h.render(t),h.cullable=l}}render(t){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}}renderAdvanced(t){const e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let s=0;s<e.length;s++)e[s].enabled&&this._enabledFilters.push(e[s])}const n=e&&this._enabledFilters?.length||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==re.NONE));if(n&&t.batch.flush(),e&&this._enabledFilters?.length&&t.filter.push(this,this._enabledFilters),i&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let s=0,o=this.children.length;s<o;++s)this.children[s].render(t)}n&&t.batch.flush(),i&&t.mask.pop(this),e&&this._enabledFilters?.length&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t?.children,i=this.removeChildren(0,this.children.length);if(e)for(let n=0;n<i.length;++n)i[n].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};N0.defaultSortableChildren=!1;let bt=N0;bt.prototype.containerUpdateTransform=bt.prototype.updateTransform;Object.defineProperties(ot,{SORTABLE_CHILDREN:{get(){return bt.defaultSortableChildren},set(r){wt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),bt.defaultSortableChildren=r}}});const Ds=new mt,h2=new Uint16Array([0,1,2,0,2,3]);class Yt extends bt{constructor(t){super(),this._anchor=new Kr(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new kt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=gt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||ct.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=h2,this.pluginName="batch",this.isSprite=!0,this._roundPixels=ot.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Ei(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Ei(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,i=e.a,n=e.b,s=e.c,o=e.d,a=e.tx,h=e.ty,l=this.vertexData,u=t.trim,c=t.orig,d=this._anchor;let f=0,p=0,m=0,g=0;if(u?(p=u.x-d._x*c.width,f=p+u.width,g=u.y-d._y*c.height,m=g+u.height):(p=-d._x*c.width,f=p+c.width,g=-d._y*c.height,m=g+c.height),l[0]=i*p+s*g+a,l[1]=o*g+n*p+h,l[2]=i*f+s*g+a,l[3]=o*g+n*f+h,l[4]=i*f+s*m+a,l[5]=o*m+n*f+h,l[6]=i*p+s*m+a,l[7]=o*m+n*p+h,this._roundPixels){const v=ot.RESOLUTION;for(let w=0;w<l.length;++w)l[w]=Math.round(l[w]*v)/v}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,i=t.orig,n=this._anchor,s=this.transform.worldTransform,o=s.a,a=s.b,h=s.c,l=s.d,u=s.tx,c=s.ty,d=-n._x*i.width,f=d+i.width,p=-n._y*i.height,m=p+i.height;if(e[0]=o*d+h*p+u,e[1]=l*p+a*d+c,e[2]=o*f+h*p+u,e[3]=l*p+a*f+c,e[4]=o*f+h*m+u,e[5]=l*m+a*f+c,e[6]=o*d+h*m+u,e[7]=l*m+a*d+c,this._roundPixels){const g=ot.RESOLUTION;for(let v=0;v<e.length;++v)e[v]=Math.round(e[v]*g)/g}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Ya),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new yt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Ds);const e=this._texture.orig.width,i=this._texture.orig.height,n=-e*this.anchor.x;let s=0;return Ds.x>=n&&Ds.x<n+e&&(s=-i*this.anchor.y,Ds.y>=s&&Ds.y<s+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t?.texture){const e=typeof t=="boolean"?t:t?.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const i=t instanceof ct?t:ct.from(t,e);return new Yt(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=Ei(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=Ei(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||ct.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const F0=new Nt;zt.prototype._cacheAsBitmap=!1;zt.prototype._cacheData=null;zt.prototype._cacheAsBitmapResolution=null;zt.prototype._cacheAsBitmapMultisample=null;class l2{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(zt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(r){r!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(r){if(this._cacheAsBitmap===r)return;this._cacheAsBitmap=r;let t;r?(this._cacheData||(this._cacheData=new l2),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});zt.prototype._renderCached=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(r),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(r))};zt.prototype._initCachedDisplayObject=function(r){if(this._cacheData?.sprite)return;const t=this.alpha;this.alpha=1,r.batch.flush();const e=this.getLocalBounds(new yt,!0);if(this.filters?.length){const d=this.filters[0].padding;e.pad(d)}const i=this.cacheAsBitmapResolution||r.resolution;e.ceil(i),e.width=Math.max(e.width,1/i),e.height=Math.max(e.height,1/i);const n=r.renderTexture.current,s=r.renderTexture.sourceFrame.clone(),o=r.renderTexture.destinationFrame.clone(),a=r.projection.transform,h=Rn.create({width:e.width,height:e.height,resolution:i,multisample:this.cacheAsBitmapMultisample??r.multisample}),l=`cacheAsBitmap_${xn()}`;this._cacheData.textureCacheId=l,vt.addToCache(h.baseTexture,l),ct.addToCache(h,l);const u=this.transform.localTransform.copyTo(F0).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,r.render(this,{renderTexture:h,clear:!0,transform:u,skipUpdateTransform:!1}),r.framebuffer.blit(),r.projection.transform=a,r.renderTexture.bind(n,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const c=new Yt(h);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(e.x/e.width),c.anchor.y=-(e.y/e.height),c.alpha=t,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)};zt.prototype._renderCachedCanvas=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(r),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(r))};zt.prototype._initCachedDisplayObjectCanvas=function(r){if(this._cacheData?.sprite)return;const t=this.getLocalBounds(new yt,!0),e=this.alpha;this.alpha=1;const i=r.canvasContext.activeContext,n=r._projTransform,s=this.cacheAsBitmapResolution||r.resolution;t.ceil(s),t.width=Math.max(t.width,1/s),t.height=Math.max(t.height,1/s);const o=Rn.create({width:t.width,height:t.height,resolution:s}),a=`cacheAsBitmap_${xn()}`;this._cacheData.textureCacheId=a,vt.addToCache(o.baseTexture,a),ct.addToCache(o,a);const h=F0;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=t.x,h.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,r.render(this,{renderTexture:o,clear:!0,transform:h,skipUpdateTransform:!1}),r.canvasContext.activeContext=i,r._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const l=new Yt(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(t.x/t.width),l.anchor.y=-(t.y/t.height),l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=r._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)};zt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};zt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};zt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,vt.removeFromCache(this._cacheData.textureCacheId),ct.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};zt.prototype._cacheAsBitmapDestroy=function(r){this.cacheAsBitmap=!1,this.destroy(r)};zt.prototype.name=null;bt.prototype.getChildByName=function(r,t){for(let e=0,i=this.children.length;e<i;e++)if(this.children[e].name===r)return this.children[e];if(t)for(let e=0,i=this.children.length;e<i;e++){const n=this.children[e];if(!n.getChildByName)continue;const s=n.getChildByName(r,!0);if(s)return s}return null};zt.prototype.getGlobalPosition=function(r=new mt,t=!1){return this.parent?this.parent.toGlobal(this.position,r,t):(r.x=this.position.x,r.y=this.position.y),r};var u2=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class c2 extends ve{constructor(t=1){super(t2,u2,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const d2={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},f2=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function p2(r){const t=d2[r],e=t.length;let i=f2,n="";const s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<r;a++){let h=s.replace("%index%",a.toString());o=a,a>=e&&(o=r-a-1),h=h.replace("%value%",t[o].toString()),n+=h,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",r.toString()),i}const m2=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function g2(r,t){const e=Math.ceil(r/2);let i=m2,n="",s;t?s="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":s="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<r;o++){let a=s.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(e-1)}.0`),n+=a,n+=`
`}return i=i.replace("%blur%",n),i=i.replace("%size%",r.toString()),i}class Hu extends ve{constructor(t,e=8,i=4,n=ve.defaultResolution,s=5){const o=g2(s,t),a=p2(s);super(o,a),this.horizontal=t,this.resolution=n,this._quality=0,this.quality=i,this.blur=e}apply(t,e,i,n){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,i,n);else{const s=t.getFilterTexture(),o=t.renderer;let a=e,h=s;this.state.blend=!1,t.applyFilter(this,a,h,Cr.CLEAR);for(let l=1;l<this.passes-1;l++){t.bindAndClear(a,Cr.BLIT),this.uniforms.uSampler=h;const u=h;h=a,a=u,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,h,i,n),t.returnFilterTexture(s)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class y2 extends ve{constructor(t=8,e=4,i=ve.defaultResolution,n=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new Hu(!0,t,e,i,n),this.blurYFilter=new Hu(!1,t,e,i,n),this.resolution=i,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,i,n){const s=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(s&&o){const a=t.getFilterTexture();this.blurXFilter.apply(t,e,a,Cr.CLEAR),this.blurYFilter.apply(t,a,i,n),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,e,i,n):this.blurXFilter.apply(t,e,i,n)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var v2=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Gu extends ve{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(M0,v2,t),this.alpha=1}_loadMatrix(t,e=!1){let i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}tint(t,e){const[i,n,s]=kt.shared.setValue(t).toArray(),o=[i,0,0,0,0,0,n,0,0,0,0,0,s,0,0,0,0,0,1,0];this._loadMatrix(o,e)}greyscale(t,e){const i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const i=Math.cos(t),n=Math.sin(t),s=Math.sqrt,o=1/3,a=s(o),h=i+(1-i)*o,l=o*(1-i)-a*n,u=o*(1-i)+a*n,c=o*(1-i)+a*n,d=i+o*(1-i),f=o*(1-i)-a*n,p=o*(1-i)-a*n,m=o*(1-i)+a*n,g=i+o*(1-i),v=[h,l,u,0,0,c,d,f,0,0,p,m,g,0,0,0,0,0,1,0];this._loadMatrix(v,e)}contrast(t,e){const i=(t||0)+1,n=-.5*(i-1),s=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(s,e)}saturate(t=0,e){const i=t*2/3+1,n=(i-1)*-.5,s=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(s,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,i,n,s){t=t||.2,e=e||.15,i=i||16770432,n=n||3375104;const o=kt.shared,[a,h,l]=o.setValue(i).toArray(),[u,c,d]=o.setValue(n).toArray(),f=[.3,.59,.11,0,0,a,h,l,t,0,u,c,d,e,0,a-u,h-c,l-d,0,0];this._loadMatrix(f,s)}night(t,e){t=t||.1;const i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,e)}predator(t,e){const i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Gu.prototype.grayscale=Gu.prototype.greyscale;var _2=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,x2=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class w2 extends ve{constructor(t,e){const i=new Nt;t.renderable=!1,super(x2,_2,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,e==null&&(e=20),this.scale=new mt(e,e)}apply(t,e,i,n){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const s=this.maskSprite.worldTransform,o=Math.sqrt(s.a*s.a+s.b*s.b),a=Math.sqrt(s.c*s.c+s.d*s.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=s.a/o,this.uniforms.rotation[1]=s.b/o,this.uniforms.rotation[2]=s.c/a,this.uniforms.rotation[3]=s.d/a),t.applyFilter(this,e,i,n)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var b2=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,T2=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class E2 extends ve{constructor(){super(T2,b2)}}var A2=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class S2 extends ve{constructor(t=.5,e=Math.random()){super(M0,A2,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const zp={AlphaFilter:c2,BlurFilter:y2,BlurFilterPass:Hu,ColorMatrixFilter:Gu,DisplacementFilter:w2,FXAAFilter:E2,NoiseFilter:S2};Object.entries(zp).forEach(([r,t])=>{Object.defineProperty(zp,r,{get(){return wt("7.1.0",`filters.${r} has moved to ${r}`),t}})});class C2{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(_e.system.add(this.tickerUpdate,this,wn.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(_e.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const Ti=new C2;class Eo{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Eo.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new mt,this.page=new mt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,i,n,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class qa extends Eo{constructor(){super(...arguments),this.client=new mt,this.movement=new mt,this.offset=new mt,this.global=new mt,this.screen=new mt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,n,s,o,a,h,l,u,c,d,f,p,m){throw new Error("Method not implemented.")}}class ur extends qa{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class es extends qa{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}es.DOM_DELTA_PIXEL=0,es.DOM_DELTA_LINE=1,es.DOM_DELTA_PAGE=2;const M2=2048,R2=new mt,Hl=new mt;class P2{constructor(t){this.dispatch=new To,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((i,n)=>i.priority-n.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let i=0,n=e.length;i<n;i++)e[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){Ti.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",n=this[i](this.rootTarget,this.rootTarget.eventMode,R2.set(t,e),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,e){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let n=0,s=i.length-1;n<s;n++)if(t.currentTarget=i[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(t.currentTarget=i[n],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const n=Array.isArray(e)?e:[e];for(let s=i.length-1;s>=0;s--)n.forEach(o=>{t.currentTarget=i[s],this.notifyTarget(t,o)})}propagationPath(t){const e=[t];for(let i=0;i<M2&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,i,n,s,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Ti.pauseUpdate=!1),t.interactiveChildren&&t.children){const u=t.children;for(let c=u.length-1;c>=0;c--){const d=u[c],f=this.hitTestMoveRecursive(d,this._isInteractive(e)?e:d.eventMode,i,n,s,o||s(t,i));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=t.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const h=this._isInteractive(e),l=t.isInteractive();return h&&l&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:h&&!s(t,i)&&n(t,i)?l?[t]:[]:null}hitTestRecursive(t,e,i,n,s){if(this._interactivePrune(t)||s(t,i))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Ti.pauseUpdate=!1),t.interactiveChildren&&t.children){const h=t.children;for(let l=h.length-1;l>=0;l--){const u=h[l],c=this.hitTestRecursive(u,this._isInteractive(e)?e:u.eventMode,i,n,s);if(c){if(c.length>0&&!c[c.length-1].parent)continue;const d=t.isInteractive();return(c.length>0||d)&&c.push(t),c}}}const o=this._isInteractive(e),a=t.isInteractive();return o&&n(t,i)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){if(t.hitArea&&(t.worldTransform.applyInverse(e,Hl),!t.hitArea.contains(Hl.x,Hl.y)))return!0;if(t._mask){const i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!i.containsPoint?.(e))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){e=e??t.type;const i=`on${e}`;t.currentTarget[i]?.(t);const n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const n=e.button===2;this.dispatchEvent(e,n?"rightdown":"mousedown")}const i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const i=e.pointerType==="mouse"||e.pointerType==="pen",n=this.trackingData(t.pointerId),s=this.findMountedTarget(n.overTargets);if(n.overTargets?.length>0&&s!==e.target){const h=t.type==="mousemove"?"mouseout":"pointerout",l=this.createPointerEvent(t,h,s);if(this.dispatchEvent(l,"pointerout"),i&&this.dispatchEvent(l,"mouseout"),!e.composedPath().includes(s)){const u=this.createPointerEvent(t,"pointerleave",s);for(u.eventPhase=u.AT_TARGET;u.target&&!e.composedPath().includes(u.target);)u.currentTarget=u.target,this.notifyTarget(u),i&&this.notifyTarget(u,"mouseleave"),u.target=u.target.parent;this.freeEvent(u)}this.freeEvent(l)}if(s!==e.target){const h=t.type==="mousemove"?"mouseover":"pointerover",l=this.clonePointerEvent(e,h);this.dispatchEvent(l,"pointerover"),i&&this.dispatchEvent(l,"mouseover");let u=s?.parent;for(;u&&u!==this.rootTarget.parent&&u!==e.target;)u=u.parent;if(!u||u===this.rootTarget.parent){const c=this.clonePointerEvent(e,"pointerenter");for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==s&&c.target!==this.rootTarget.parent;)c.currentTarget=c.target,this.notifyTarget(c),i&&this.notifyTarget(c,"mouseenter"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(l)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&o.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&o.push("globalmousemove"),this.cursor=e.target?.cursor),o.length>0&&this.all(e,o),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.createPointerEvent(t),n=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=i.target?.cursor);const s=this.clonePointerEvent(i,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;e.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(s)}mapPointerOut(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const i=t.pointerType==="mouse"||t.pointerType==="pen",n=this.findMountedTarget(e.overTargets),s=this.createPointerEvent(t,"pointerout",n);this.dispatchEvent(s),i&&this.dispatchEvent(s,"mouseout");const o=this.createPointerEvent(t,"pointerleave",n);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;e.overTargets=null,this.freeEvent(s),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}const n=this.trackingData(t.pointerId),s=this.findMountedTarget(n.pressTargetsByButton[t.button]);let o=s;if(s&&!i.composedPath().includes(s)){let a=s;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const h=i.button===2;this.notifyTarget(i,h?"rightupoutside":"mouseupoutside")}a=a.parent}delete n.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,n.clicksByButton[t.button]||(n.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:e});const h=n.clicksByButton[t.button];if(h.target===a.target&&e-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=a.target,h.timeStamp=e,a.detail=h.clickCount,a.pointerType==="mouse"){const l=a.button===2;this.dispatchEvent(a,l?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof ur)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.findMountedTarget(e.pressTargetsByButton[t.button]),n=this.createPointerEvent(t);if(i){let s=i;for(;s;)n.currentTarget=s,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch"?this.notifyTarget(n,"touchendoutside"):(n.pointerType==="mouse"||n.pointerType==="pen")&&this.notifyTarget(n,n.button===2?"rightupoutside":"mouseupoutside"),s=s.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(n)}mapWheel(t){if(!(t instanceof es)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){const n=this.allocateEvent(ur);return this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t,n.target=i??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],typeof e=="string"&&(n.type=e),n}createWheelEvent(t){const e=this.allocateEvent(es);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const i=this.allocateEvent(ur);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=e??i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof ur&&e instanceof ur&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof qa&&e instanceof qa&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const i=t.currentTarget._events[e];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(e,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let n=0,s=i.length;n<s&&!t.propagationImmediatelyStopped;n++)i[n].once&&t.currentTarget.removeListener(e,i[n].fn,void 0,!0),i[n].fn.call(i[n].context,t)}}const I2=1,D2={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},zu=class ju{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new P2(null),Ti.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new ur(null),this.rootWheelEvent=new es(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...ju.defaultEventFeatures},{set:(e,i,n)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=n),e[i]=n,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:i}=this.renderer;this.setTargetElement(e),this.resolution=i,ju._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const i=this.cursorStyles[t];if(i)switch(typeof i){case"string":e&&(this.domElement.style.cursor=i);break;case"function":i(t);break;case"object":e&&Object.assign(this.domElement.style,i);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let i=0,n=e.length;i<n;i++){const s=e[i],o=this.bootstrapEvent(this.rootPointerEvent,s);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Ti.pointerMoved();const e=this.normalizeToPointerData(t);for(let i=0,n=e.length;i<n;i++){const s=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const i=e!==this.domElement?"outside":"",n=this.normalizeToPointerData(t);for(let s=0,o=n.length;s<o;s++){const a=this.bootstrapEvent(this.rootPointerEvent,n[s]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);for(let i=0,n=e.length;i<n;i++){const s=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(s)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,Ti.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Ti.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Ti.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,i){const n=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;t.x=(e-n.left)*(this.domElement.width/n.width)*s,t.y=(i-n.top)*(this.domElement.height/n.height)*s}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let i=0,n=t.changedTouches.length;i<n;i++){const s=t.changedTouches[i];typeof s.button>"u"&&(s.button=0),typeof s.buttons>"u"&&(s.buttons=1),typeof s.isPrimary>"u"&&(s.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof s.width>"u"&&(s.width=s.radiusX||1),typeof s.height>"u"&&(s.height=s.radiusY||1),typeof s.tiltX>"u"&&(s.tiltX=0),typeof s.tiltY>"u"&&(s.tiltY=0),typeof s.pointerType>"u"&&(s.pointerType="touch"),typeof s.pointerId>"u"&&(s.pointerId=s.identifier||0),typeof s.pressure>"u"&&(s.pressure=s.force||.5),typeof s.twist>"u"&&(s.twist=0),typeof s.tangentialPressure>"u"&&(s.tangentialPressure=0),typeof s.layerX>"u"&&(s.layerX=s.offsetX=s.clientX),typeof s.layerY>"u"&&(s.layerY=s.offsetY=s.clientY),s.isNormalized=!0,s.type=t.type,e.push(s)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const i=t;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=I2),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=D2[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};zu.extension={name:"events",type:[it.RendererSystem,it.CanvasRendererSystem]},zu.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let Wu=zu;dt.add(Wu);function jp(r){return r==="dynamic"||r==="static"}const O2={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??jp(Wu.defaultEventMode)},set interactive(r){wt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=r,this.eventMode=r?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Wu.defaultEventMode},set eventMode(r){this._internalInteractive=jp(r),this._internalEventMode=r},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(r,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,n=typeof t=="function"?void 0:t;r=i?`${r}capture`:r,t=typeof t=="function"?t:t.handleEvent,this.on(r,t,n)},removeEventListener(r,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,n=typeof t=="function"?void 0:t;r=i?`${r}capture`:r,t=typeof t=="function"?t:t.handleEvent,this.off(r,t,n)},dispatchEvent(r){if(!(r instanceof Eo))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=null,r.target=this,r.manager.dispatchEvent(r),!r.defaultPrevented}};zt.mixin(O2);const k2={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};zt.mixin(k2);const N2=9,ia=100,F2=0,L2=0,Wp=2,Xp=1,B2=-1e3,U2=-1e3,H2=2;class L0{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Zr.tablet||Zr.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${ia}px`,e.style.height=`${ia}px`,e.style.position="absolute",e.style.top=`${F2}px`,e.style.left=`${L2}px`,e.style.zIndex=Wp.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${Xp}px`,t.style.height=`${Xp}px`,t.style.position="absolute",t.style.top=`${B2}px`,t.style.left=`${U2}px`,t.style.zIndex=H2.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}update(){const t=performance.now();if(Zr.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:i,width:n,height:s}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:h}=this.renderer,l=n/o*h,u=s/a*h;let c=this.div;c.style.left=`${e}px`,c.style.top=`${i}px`,c.style.width=`${o}px`,c.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,Jn(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{c=f._accessibleDiv;let p=f.hitArea;const m=f.worldTransform;f.hitArea?(c.style.left=`${(m.tx+p.x*m.a)*l}px`,c.style.top=`${(m.ty+p.y*m.d)*u}px`,c.style.width=`${p.width*m.a*l}px`,c.style.height=`${p.height*m.d*u}px`):(p=f.getBounds(),this.capHitArea(p),c.style.left=`${p.x*l}px`,c.style.top=`${p.y*u}px`,c.style.width=`${p.width*l}px`,c.style.height=`${p.height*u}px`,c.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(c.title=f.accessibleTitle),c.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&c.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==c.title||f.tabIndex!==c.tabIndex)&&(c.title=f.accessibleTitle,c.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(c))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:i}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${ia}px`,e.style.height=`${ia}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=Wp.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:i}=t.target,n=this.renderer.events.rootBoundary,s=Object.assign(new Eo(n),{target:i});n.rootTarget=this.renderer.lastObjectRendered,e.forEach(o=>n.dispatchEvent(s,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===N2&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}L0.extension={name:"accessibility",type:[it.RendererPlugin,it.CanvasRendererPlugin]};dt.add(L0);const B0=class Xu{constructor(t){this.stage=new bt,t=Object.assign({forceCanvas:!1},t),this.renderer=Kb(t),Xu._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(t,e){const i=Xu._plugins.slice(0);i.reverse(),i.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};B0._plugins=[];let U0=B0;dt.handleByList(it.Application,U0._plugins);class H0{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,i;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:n,clientHeight:s}=this._resizeTo;e=n,i=s}this.renderer.resize(e,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}H0.extension=it.Application;dt.add(H0);const Vp={loader:it.LoadParser,resolver:it.ResolveParser,cache:it.CacheParser,detection:it.DetectionParser};dt.handle(it.Asset,r=>{const t=r.ref;Object.entries(Vp).filter(([e])=>!!t[e]).forEach(([e,i])=>dt.add(Object.assign(t[e],{extension:t[e].extension??i})))},r=>{const t=r.ref;Object.keys(Vp).filter(e=>!!t[e]).forEach(e=>dt.remove(t[e]))});class G2{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function _s(r,t){if(Array.isArray(t)){for(const e of t)if(r.startsWith(`data:${e}`))return!0;return!1}return r.startsWith(`data:${t}`)}function Bi(r,t){const e=r.split("?")[0],i=ie.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const dr=(r,t,e=!1)=>(Array.isArray(r)||(r=[r]),t?r.map(i=>typeof i=="string"||e?t(i):i):r),Vu=(r,t)=>{const e=t.split("?")[1];return e&&(r+=`?${e}`),r};function G0(r,t,e,i,n){const s=t[e];for(let o=0;o<s.length;o++){const a=s[o];e<t.length-1?G0(r.replace(i[e],a),t,e+1,i,n):n.push(r.replace(i[e],a))}}function z2(r){const t=/\{(.*?)\}/g,e=r.match(t),i=[];if(e){const n=[];e.forEach(s=>{const o=s.substring(1,s.length-1).split(",");n.push(o)}),G0(r,n,0,e,i)}else i.push(r);return i}const Za=r=>!Array.isArray(r);class j2{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=dr(t);let n;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){n=h.getCacheableAssets(i,e);break}}n||(n={},i.forEach(a=>{n[a]=e}));const s=Object.keys(n),o={cacheKeys:s,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),s.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,n[a])}),e instanceof ct){const a=e;i.forEach(h=>{a.baseTexture!==ct.EMPTY.baseTexture&&vt.addToCache(a.baseTexture,h),ct.addToCache(a,h)})}}remove(t){if(!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const an=new j2;class W2{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{let n=null,s=null;if(e.loadParser&&(s=this._parserHash[e.loadParser],s||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!s){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(t,e,this)){s=a;break}}if(!s)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await s.load(t,e,this),i.parser=s;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(n,e,this)&&(n=await a.parse(n,e,this)||n,i.parser=a)}return n})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const n={},s=Za(t),o=dr(t,l=>({alias:[l],src:l})),a=o.length,h=o.map(async l=>{const u=ie.toAbsolute(l.src);if(!n[l.src])try{this.promiseCache[u]||(this.promiseCache[u]=this._getLoadPromiseAndParser(u,l)),n[l.src]=await this.promiseCache[u].promise,e&&e(++i/a)}catch(c){throw delete this.promiseCache[u],delete n[l.src],new Error(`[Loader.load] Failed to load ${u}.
${c}`)}});return await Promise.all(h),s?n[o[0].src]:n}async unload(t){const e=dr(t,i=>({alias:[i],src:i})).map(async i=>{const n=ie.toAbsolute(i.src),s=this.promiseCache[n];if(s){const o=await s.promise;delete this.promiseCache[n],s.parser?.unload?.(o,i,this)}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var yr=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(yr||{});const X2=".json",V2="application/json",$2={extension:{type:it.LoadParser,priority:yr.Low},name:"loadJson",test(r){return _s(r,V2)||Bi(r,X2)},async load(r){return await(await ot.ADAPTER.fetch(r)).json()}};dt.add($2);const Y2=".txt",q2="text/plain",Z2={name:"loadTxt",extension:{type:it.LoadParser,priority:yr.Low},test(r){return _s(r,q2)||Bi(r,Y2)},async load(r){return await(await ot.ADAPTER.fetch(r)).text()}};dt.add(Z2);const K2=["normal","bold","100","200","300","400","500","600","700","800","900"],Q2=[".ttf",".otf",".woff",".woff2"],J2=["font/ttf","font/otf","font/woff","font/woff2"],t1=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function e1(r){const t=ie.extname(r),e=ie.basename(r,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(s=>s.charAt(0).toUpperCase()+s.slice(1));let i=e.length>0;for(const s of e)if(!s.match(t1)){i=!1;break}let n=e.join(" ");return i||(n=`"${n.replace(/[\\"]/g,"\\$&")}"`),n}const r1=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function i1(r){return r1.test(r)?r:encodeURI(r)}const n1={extension:{type:it.LoadParser,priority:yr.Low},name:"loadWebFont",test(r){return _s(r,J2)||Bi(r,Q2)},async load(r,t){const e=ot.ADAPTER.getFontFaceSet();if(e){const i=[],n=t.data?.family??e1(r),s=t.data?.weights?.filter(a=>K2.includes(a))??["normal"],o=t.data??{};for(let a=0;a<s.length;a++){const h=s[a],l=new FontFace(n,`url(${i1(r)})`,{...o,weight:h});await l.load(),e.add(l),i.push(l)}return i.length===1?i[0]:i}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(t=>ot.ADAPTER.getFontFaceSet().delete(t))}};dt.add(n1);let $p=0,Gl;const s1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",o1={code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${s1}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},a1={code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let zl;class h1{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([o1.code],{type:"application/javascript"})),i=new Worker(e);i.addEventListener("message",n=>{i.terminate(),URL.revokeObjectURL(e),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Gl===void 0&&(Gl=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Gl&&(zl||(zl=URL.createObjectURL(new Blob([a1.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(zl),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((n,s)=>{this.queue.push({id:t,arguments:e,resolve:n,reject:s})});return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),i=e.id;this.resolveHash[$p]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:$p++,id:i})}}const Yp=new h1;function Ao(r,t,e){r.resource.internal=!0;const i=new ct(r),n=()=>{delete t.promiseCache[e],an.has(e)&&an.remove(e)};return i.baseTexture.once("destroyed",()=>{e in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),n())}),i.once("destroyed",()=>{r.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),i}const l1=[".jpeg",".jpg",".png",".webp",".avif"],u1=["image/jpeg","image/png","image/webp","image/avif"];async function c1(r){const t=await ot.ADAPTER.fetch(r);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const Ih={name:"loadTextures",extension:{type:it.LoadParser,priority:yr.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return _s(r,u1)||Bi(r,l1)},async load(r,t,e){const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let n;i?this.config.preferWorkers&&await Yp.isImageBitmapSupported()?n=await Yp.loadImageBitmap(r):n=await c1(r):n=await new Promise((a,h)=>{const l=new Image;l.crossOrigin=this.config.crossOrigin,l.src=r,l.complete?a(l):(l.onload=()=>a(l),l.onerror=u=>h(u))});const s={...t.data};s.resolution??(s.resolution=ri(r)),i&&s.resourceOptions?.ownsImageBitmap===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);const o=new vt(n,s);return o.resource.src=r,Ao(o,e,r)},unload(r){r.destroy(!0)}};dt.add(Ih);const d1=".svg",f1="image/svg+xml",p1={extension:{type:it.LoadParser,priority:yr.High},name:"loadSVG",test(r){return _s(r,f1)||Bi(r,d1)},async testParse(r){return Fu.test(r)},async parse(r,t,e){const i=new Fu(r,t?.data?.resourceOptions);await i.load();const n=new vt(i,{resolution:ri(r),...t?.data});return n.resource.src=t.src,Ao(n,e,t.src)},async load(r,t){return(await ot.ADAPTER.fetch(r)).text()},unload:Ih.unload};dt.add(p1);const m1=[".mp4",".m4v",".webm",".ogv"],g1=["video/mp4","video/webm","video/ogg"],y1={name:"loadVideo",extension:{type:it.LoadParser,priority:yr.High},config:{defaultAutoPlay:!0},test(r){return _s(r,g1)||Bi(r,m1)},async load(r,t,e){let i;const n=await(await ot.ADAPTER.fetch(r)).blob(),s=URL.createObjectURL(n);try{const o={autoPlay:this.config.defaultAutoPlay,...t?.data?.resourceOptions},a=new k0(s,o);await a.load();const h=new vt(a,{alphaMode:await Ew(),resolution:ri(r),...t?.data});h.resource.src=r,i=Ao(h,e,r),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(o){throw URL.revokeObjectURL(s),o}return i},unload(r){r.destroy(!0)}};dt.add(y1);class v1{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,name:i,src:n,srcs:s}=t;return dr(e||i||n||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>a?.src??a?.srcs??a):o?.src||o?.srcs?o.src??o.srcs:o,!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];Array.isArray(e)?e.forEach(n=>{const s=n.src??n.srcs,o=n.alias??n.name;let a;if(typeof o=="string"){const h=this._createBundleAssetId(t,o);i.push(h),a=[o,h]}else{const h=o.map(l=>this._createBundleAssetId(t,l));i.push(...h),a=[...o,...h]}this.add({...n,alias:a,src:s})}):Object.keys(e).forEach(n=>{const s=[n,this._createBundleAssetId(t,n)];if(typeof e[n]=="string")this.add({alias:s,src:e[n]});else if(Array.isArray(e[n]))this.add({alias:s,src:e[n]});else{const o=e[n],a=o.src??o.srcs;this.add({...o,alias:s,src:Array.isArray(a)?a:[a]})}i.push(...s)}),this._bundles[t]=i}add(t,e,i,n,s){const o=[];typeof t=="string"||Array.isArray(t)&&typeof t[0]=="string"?(wt("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:t,src:e,data:i,format:n,loadParser:s})):Array.isArray(t)?o.push(...t):o.push(t);let a;a=h=>{this.hasKey(h)&&console.warn(`[Resolver] already has key: ${h} overwriting`)},dr(o).forEach(h=>{const{src:l,srcs:u}=h;let{data:c,format:d,loadParser:f}=h;const p=dr(l||u).map(v=>typeof v=="string"?z2(v):Array.isArray(v)?v:[v]),m=this.getAlias(h);Array.isArray(m)?m.forEach(a):a(m);const g=[];p.forEach(v=>{v.forEach(w=>{let _={};if(typeof w!="object"){_.src=w;for(let T=0;T<this._parsers.length;T++){const b=this._parsers[T];if(b.test(w)){_=b.parse(w);break}}}else c=w.data??c,d=w.format??d,f=w.loadParser??f,_={..._,...w};if(!m)throw new Error(`[Resolver] alias is undefined for this asset: ${_.src}`);_=this.buildResolvedAsset(_,{aliases:m,data:c,format:d,loadParser:f}),g.push(_)})}),m.forEach(v=>{this._assetMap[v]=g})})}resolveBundle(t){const e=Za(t);t=dr(t);const i={};return t.forEach(n=>{const s=this._bundles[n];if(s){const o=this.resolve(s),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(n,h)]=l}i[n]=a}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const n in e)i[n]=e[n].src;return i}return e.src}resolve(t){const e=Za(t);t=dr(t);const i={};return t.forEach(n=>{if(!this._resolverHash[n])if(this._assetMap[n]){let s=this._assetMap[n];const o=s[0],a=this._getPreferredOrder(s);a?.priority.forEach(h=>{a.params[h].forEach(l=>{const u=s.filter(c=>c[h]?c[h]===l:!1);u.length&&(s=u)})}),this._resolverHash[n]=s[0]??o}else this._resolverHash[n]=this.buildResolvedAsset({alias:[n],src:n},{});i[n]=this._resolverHash[n]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[0],n=this._preferredOrder.find(s=>s.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){const{aliases:i,data:n,loadParser:s,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=ie.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...n||{},...t.data},t.loadParser=s??t.loadParser,t.format=o??ie.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}class _1{constructor(){this._detections=[],this._initialized=!1,this.resolver=new v1,this.loader=new W2,this.cache=an,this._backgroundLoader=new G2(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let s=t.manifest;typeof s=="string"&&(s=await this.load(s)),this.resolver.addManifest(s)}const e=t.texturePreference?.resolution??1,i=typeof e=="number"?[e]:e,n=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,i,n,s){this.resolver.add(t,e,i,n,s)}async load(t,e){this._initialized||await this.init();const i=Za(t),n=dr(t).map(a=>{if(typeof a!="string"){const h=this.resolver.getAlias(a);return h.some(l=>!this.resolver.hasKey(l))&&this.add(a),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(n),o=await this._mapLoadToResolve(s,e);return i?o[n[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const n=this.resolver.resolveBundle(t),s={},o=Object.keys(n);let a=0,h=0;const l=()=>{e?.(++a/h)},u=o.map(c=>{const d=n[c];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{s[c]=f})});return await Promise.all(u),i?s[t[0]]:s}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return an.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=an.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=Object.values(t),n=Object.keys(t);this._backgroundLoader.active=!1;const s=await this.loader.load(i,e);this._backgroundLoader.active=!0;const o={};return i.forEach((a,h)=>{const l=s[a.src],u=[a.src];a.alias&&u.push(...a.alias),o[n[h]]=l,an.set(u,l)}),o}async unload(t){this._initialized||await this.init();const e=dr(t).map(n=>typeof n!="string"?n.src:n),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=dr(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(n=>this._unloadFromResolved(e[n]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{an.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,n)=>e.indexOf(i)===n),e}get detections(){return this._detections}get preferWorkers(){return Ih.config.preferWorkers}set preferWorkers(t){wt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const na=new _1;dt.handleByList(it.LoadParser,na.loader.parsers).handleByList(it.ResolveParser,na.resolver.parsers).handleByList(it.CacheParser,na.cache.parsers).handleByList(it.DetectionParser,na.detections);const x1={extension:it.CacheParser,test:r=>Array.isArray(r)&&r.every(t=>t instanceof ct),getCacheableAssets:(r,t)=>{const e={};return r.forEach(i=>{t.forEach((n,s)=>{e[i+(s===0?"":s+1)]=n})}),e}};dt.add(x1);async function z0(r){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(r)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const w1={extension:{type:it.DetectionParser,priority:1},test:async()=>z0("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(t=>t!=="avif")};dt.add(w1);const b1={extension:{type:it.DetectionParser,priority:0},test:async()=>z0("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(t=>t!=="webp")};dt.add(b1);const qp=["png","jpg","jpeg"],T1={extension:{type:it.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...qp],remove:async r=>r.filter(t=>!qp.includes(t))};dt.add(T1);const E1="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Hc(r){return E1?!1:document.createElement("video").canPlayType(r)!==""}const A1={extension:{type:it.DetectionParser,priority:0},test:async()=>Hc("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(t=>t!=="webm")};dt.add(A1);const S1={extension:{type:it.DetectionParser,priority:0},test:async()=>Hc("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(t=>t!=="mp4"&&t!=="m4v")};dt.add(S1);const C1={extension:{type:it.DetectionParser,priority:0},test:async()=>Hc("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(t=>t!=="ogv")};dt.add(C1);const M1={extension:it.ResolveParser,test:Ih.test,parse:r=>({resolution:parseFloat(ot.RETINA_PREFIX.exec(r)?.[1]??"1"),format:ie.extname(r).slice(1),src:r})};dt.add(M1);var De=(r=>(r[r.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",r[r.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",r[r.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",r[r.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",r[r.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",r[r.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",r[r.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",r[r.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",r[r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",r[r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",r[r.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",r[r.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",r))(De||{});const Ka={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let Vr,jn;function Zp(){jn={s3tc:Vr.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Vr.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Vr.getExtension("WEBGL_compressed_texture_etc"),etc1:Vr.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Vr.getExtension("WEBGL_compressed_texture_pvrtc")||Vr.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Vr.getExtension("WEBGL_compressed_texture_atc"),astc:Vr.getExtension("WEBGL_compressed_texture_astc")}}const R1={extension:{type:it.DetectionParser,priority:2},test:async()=>{const r=ot.ADAPTER.createCanvas().getContext("webgl");return r?(Vr=r,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async r=>{jn||Zp();const t=[];for(const e in jn)jn[e]&&t.push(e);return[...t,...r]},remove:async r=>(jn||Zp(),r.filter(t=>!(t in jn)))};dt.add(R1);class P1 extends Sh{constructor(t,e={width:1,height:1,autoLoad:!0}){let i,n;typeof t=="string"?(i=t,n=new Uint8Array):(i=null,n=t),super(n,e),this.origin=i,this.buffer=n?new bu(n):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new bu(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class fn extends P1{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=fn._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||fn._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,i){const n=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;n.pixelStorei(n.UNPACK_ALIGNMENT,4);for(let s=0,o=this.levels;s<o;s++){const{levelID:a,levelWidth:h,levelHeight:l,levelBuffer:u}=this._levelBuffers[s];n.compressedTexImage2D(n.TEXTURE_2D,a,this.format,h,l,0,u)}return!0}onBlobLoaded(){this._levelBuffers=fn._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,i,n,s,o,a){const h=new Array(i);let l=t.byteOffset,u=o,c=a,d=u+n-1&~(n-1),f=c+s-1&~(s-1),p=d*f*Ka[e];for(let m=0;m<i;m++)h[m]={levelID:m,levelWidth:i>1?u:d,levelHeight:i>1?c:f,levelBuffer:new Uint8Array(t.buffer,l,p)},l+=p,u=u>>1||1,c=c>>1||1,d=u+n-1&~(n-1),f=c+s-1&~(s-1),p=d*f*Ka[e];return h}}const jl=4,sa=124,I1=32,Kp=20,D1=542327876,oa={HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},O1={FOURCC:2},aa={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},k1=1,N1=2,F1=4,L1=64,B1=512,U1=131072,H1=827611204,G1=861165636,z1=894720068,j1=808540228,W1=4,X1={[H1]:De.COMPRESSED_RGBA_S3TC_DXT1_EXT,[G1]:De.COMPRESSED_RGBA_S3TC_DXT3_EXT,[z1]:De.COMPRESSED_RGBA_S3TC_DXT5_EXT},V1={70:De.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:De.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:De.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:De.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:De.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:De.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:De.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:De.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:De.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function $1(r){const t=new Uint32Array(r);if(t[0]!==D1)throw new Error("Invalid DDS file magic word");const e=new Uint32Array(r,0,sa/Uint32Array.BYTES_PER_ELEMENT),i=e[oa.HEIGHT],n=e[oa.WIDTH],s=e[oa.MIPMAP_COUNT],o=new Uint32Array(r,oa.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,I1/Uint32Array.BYTES_PER_ELEMENT),a=o[k1];if(a&F1){const h=o[O1.FOURCC];if(h!==j1){const w=X1[h],_=jl+sa,T=new Uint8Array(r,_);return[new fn(T,{format:w,width:n,height:i,levels:s})]}const l=jl+sa,u=new Uint32Array(t.buffer,l,Kp/Uint32Array.BYTES_PER_ELEMENT),c=u[aa.DXGI_FORMAT],d=u[aa.RESOURCE_DIMENSION],f=u[aa.MISC_FLAG],p=u[aa.ARRAY_SIZE],m=V1[c];if(m===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${c}`);if(f===W1)throw new Error("DDSParser does not support cubemap textures");if(d===6)throw new Error("DDSParser does not supported 3D texture data");const g=new Array,v=jl+sa+Kp;if(p===1)g.push(new Uint8Array(r,v));else{const w=Ka[m];let _=0,T=n,b=i;for(let y=0;y<s;y++){const S=Math.max(1,T+3&-4),D=Math.max(1,b+3&-4),G=S*D*w;_+=G,T=T>>>1,b=b>>>1}let x=v;for(let y=0;y<p;y++)g.push(new Uint8Array(r,x,_)),x+=_}return g.map(w=>new fn(w,{format:m,width:n,height:i,levels:s}))}throw a&L1?new Error("DDSParser does not support uncompressed texture data."):a&B1?new Error("DDSParser does not supported YUV uncompressed texture data."):a&U1?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&N1?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Qp=[171,75,84,88,32,49,49,187,13,10,26,10],Y1=67305985,hr={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},$u=64,Jp={[pt.UNSIGNED_BYTE]:1,[pt.UNSIGNED_SHORT]:2,[pt.INT]:4,[pt.UNSIGNED_INT]:4,[pt.FLOAT]:4,[pt.HALF_FLOAT]:8},q1={[Q.RGBA]:4,[Q.RGB]:3,[Q.RG]:2,[Q.RED]:1,[Q.LUMINANCE]:1,[Q.LUMINANCE_ALPHA]:2,[Q.ALPHA]:1},Z1={[pt.UNSIGNED_SHORT_4_4_4_4]:2,[pt.UNSIGNED_SHORT_5_5_5_1]:2,[pt.UNSIGNED_SHORT_5_6_5]:2};function K1(r,t,e=!1){const i=new DataView(t);if(!Q1(r,i))return null;const n=i.getUint32(hr.ENDIANNESS,!0)===Y1,s=i.getUint32(hr.GL_TYPE,n),o=i.getUint32(hr.GL_FORMAT,n),a=i.getUint32(hr.GL_INTERNAL_FORMAT,n),h=i.getUint32(hr.PIXEL_WIDTH,n),l=i.getUint32(hr.PIXEL_HEIGHT,n)||1,u=i.getUint32(hr.PIXEL_DEPTH,n)||1,c=i.getUint32(hr.NUMBER_OF_ARRAY_ELEMENTS,n)||1,d=i.getUint32(hr.NUMBER_OF_FACES,n),f=i.getUint32(hr.NUMBER_OF_MIPMAP_LEVELS,n),p=i.getUint32(hr.BYTES_OF_KEY_VALUE_DATA,n);if(l===0||u!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(c!==1)throw new Error("WebGL does not support array textures");const m=4,g=4,v=h+3&-4,w=l+3&-4,_=new Array(c);let T=h*l;s===0&&(T=v*w);let b;if(s!==0?Jp[s]?b=Jp[s]*q1[o]:b=Z1[s]:b=Ka[a],b===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const x=e?tT(i,p,n):null;let y=T*b,S=h,D=l,G=v,O=w,N=$u+p;for(let P=0;P<f;P++){const F=i.getUint32(N,n);let j=N+4;for(let E=0;E<c;E++){let A=_[E];A||(A=_[E]=new Array(f)),A[P]={levelID:P,levelWidth:f>1||s!==0?S:G,levelHeight:f>1||s!==0?D:O,levelBuffer:new Uint8Array(t,j,y)},j+=y}N+=F+4,N=N%4!==0?N+4-N%4:N,S=S>>1||1,D=D>>1||1,G=S+m-1&-4,O=D+g-1&-4,y=G*O*b}return s!==0?{uncompressed:_.map(P=>{let F=P[0].levelBuffer,j=!1;return s===pt.FLOAT?F=new Float32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4):s===pt.UNSIGNED_INT?(j=!0,F=new Uint32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)):s===pt.INT&&(j=!0,F=new Int32Array(P[0].levelBuffer.buffer,P[0].levelBuffer.byteOffset,P[0].levelBuffer.byteLength/4)),{resource:new Sh(F,{width:P[0].levelWidth,height:P[0].levelHeight}),type:s,format:j?J1(o):o}}),kvData:x}:{compressed:_.map(P=>new fn(null,{format:a,width:h,height:l,levels:f,levelBuffers:P})),kvData:x}}function Q1(r,t){for(let e=0;e<Qp.length;e++)if(t.getUint8(e)!==Qp[e])return console.error(`${r} is not a valid *.ktx file!`),!1;return!0}function J1(r){switch(r){case Q.RGBA:return Q.RGBA_INTEGER;case Q.RGB:return Q.RGB_INTEGER;case Q.RG:return Q.RG_INTEGER;case Q.RED:return Q.RED_INTEGER;default:return r}}function tT(r,t,e){const i=new Map;let n=0;for(;n<t;){const s=r.getUint32($u+n,e),o=$u+n+4,a=3-(s+3)%4;if(s===0||s>t-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let h=0;for(;h<s&&r.getUint8(o+h)!==0;h++);if(h===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const l=new TextDecoder().decode(new Uint8Array(r.buffer,o,h)),u=new DataView(r.buffer,o+h+1,s-h-1);i.set(l,u),n+=4+s+a}return i}const eT={extension:{type:it.LoadParser,priority:yr.High},name:"loadDDS",test(r){return Bi(r,".dds")},async load(r,t,e){const i=await(await ot.ADAPTER.fetch(r)).arrayBuffer(),n=$1(i).map(s=>{const o=new vt(s,{mipmap:Fr.OFF,alphaMode:be.NO_PREMULTIPLIED_ALPHA,resolution:ri(r),...t.data});return Ao(o,e,r)});return n.length===1?n[0]:n},unload(r){Array.isArray(r)?r.forEach(t=>t.destroy(!0)):r.destroy(!0)}};dt.add(eT);const rT={extension:{type:it.LoadParser,priority:yr.High},name:"loadKTX",test(r){return Bi(r,".ktx")},async load(r,t,e){const i=await(await ot.ADAPTER.fetch(r)).arrayBuffer(),{compressed:n,uncompressed:s,kvData:o}=K1(r,i),a=n??s,h={mipmap:Fr.OFF,alphaMode:be.NO_PREMULTIPLIED_ALPHA,resolution:ri(r),...t.data},l=a.map(u=>{a===s&&Object.assign(h,{type:u.type,format:u.format});const c=u.resource??u,d=new vt(c,h);return d.ktxKeyValueData=o,Ao(d,e,r)});return l.length===1?l[0]:l},unload(r){Array.isArray(r)?r.forEach(t=>t.destroy(!0)):r.destroy(!0)}};dt.add(rT);const iT={extension:it.ResolveParser,test:r=>{const t=ie.extname(r).slice(1);return["basis","ktx","dds"].includes(t)},parse:r=>{const t=ie.extname(r).slice(1);if(t==="ktx"){const e=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(e.some(i=>r.endsWith(i)))return{resolution:parseFloat(ot.RETINA_PREFIX.exec(r)?.[1]??"1"),format:e.find(i=>r.endsWith(i)),src:r}}return{resolution:parseFloat(ot.RETINA_PREFIX.exec(r)?.[1]??"1"),format:t,src:r}}};dt.add(iT);const ha=new yt,nT=4,j0=class Xs{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){const t=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}async image(t,e,i,n){const s=new Image;return s.src=await this.base64(t,e,i,n),s}async base64(t,e,i,n){const s=this.canvas(t,n);if(s.toBlob!==void 0)return new Promise((o,a)=>{s.toBlob(h=>{if(!h){a(new Error("ICanvas.toBlob failed!"));return}const l=new FileReader;l.onload=()=>o(l.result),l.onerror=a,l.readAsDataURL(h)},e,i)});if(s.toDataURL!==void 0)return s.toDataURL(e,i);if(s.convertToBlob!==void 0){const o=await s.convertToBlob({type:e,quality:i});return new Promise((a,h)=>{const l=new FileReader;l.onload=()=>a(l.result),l.onerror=h,l.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){const{pixels:i,width:n,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,e);o&&Xs._flipY(i,n,s),a&&Xs._unpremultiplyAlpha(i);const h=new Hw(n,s,1),l=new ImageData(new Uint8ClampedArray(i.buffer),n,s);return h.context.putImageData(l,0,0),h.canvas}pixels(t,e){const{pixels:i,width:n,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,e);return o&&Xs._flipY(i,n,s),a&&Xs._unpremultiplyAlpha(i),i}_rawPixels(t,e){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let n,s=!1,o=!1,a,h=!1;t&&(t instanceof Rn?a=t:(a=i.generateTexture(t,{region:e,resolution:i.resolution,multisample:i.multisample}),h=!0,e&&(ha.width=e.width,ha.height=e.height,e=ha)));const l=i.gl;if(a){if(n=a.baseTexture.resolution,e=e??a.frame,s=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===Q.RGBA,!h){i.renderTexture.bind(a);const f=a.framebuffer.glFramebuffers[i.CONTEXT_UID];f.blitFramebuffer&&i.framebuffer.bind(f.blitFramebuffer)}}else n=i.resolution,e||(e=ha,e.width=i.width/n,e.height=i.height/n),s=!0,o=this._rendererPremultipliedAlpha,i.renderTexture.bind();const u=Math.max(Math.round(e.width*n),1),c=Math.max(Math.round(e.height*n),1),d=new Uint8Array(nT*u*c);return l.readPixels(Math.round(e.x*n),Math.round(e.y*n),u,c,l.RGBA,l.UNSIGNED_BYTE,d),h&&a?.destroy(!0),{pixels:d,width:u,height:c,flipY:s,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(t,e,i){const n=e<<2,s=i>>1,o=new Uint8Array(n);for(let a=0;a<s;a++){const h=a*n,l=(i-a-1)*n;o.set(t.subarray(h,h+n)),t.copyWithin(h,l,l+n),t.set(o,l)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let i=0;i<e;i+=4){const n=t[i+3];if(n!==0){const s=255.001/n;t[i]=t[i]*s+.5,t[i+1]=t[i+1]*s+.5,t[i+2]=t[i+2]*s+.5}}}};j0.extension={name:"extract",type:it.RendererSystem};let sT=j0;dt.add(sT);const Qa={build(r){const t=r.points;let e,i,n,s,o,a;if(r.type===de.CIRC){const p=r.shape;e=p.x,i=p.y,o=a=p.radius,n=s=0}else if(r.type===de.ELIP){const p=r.shape;e=p.x,i=p.y,o=p.width,a=p.height,n=s=0}else{const p=r.shape,m=p.width/2,g=p.height/2;e=p.x+m,i=p.y+g,o=a=Math.max(0,Math.min(p.radius,Math.min(m,g))),n=m-o,s=g-a}if(!(o>=0&&a>=0&&n>=0&&s>=0)){t.length=0;return}const h=Math.ceil(2.3*Math.sqrt(o+a)),l=h*8+(n?4:0)+(s?4:0);if(t.length=l,l===0)return;if(h===0){t.length=8,t[0]=t[6]=e+n,t[1]=t[3]=i+s,t[2]=t[4]=e-n,t[5]=t[7]=i-s;return}let u=0,c=h*4+(n?2:0)+2,d=c,f=l;{const p=n+o,m=s,g=e+p,v=e-p,w=i+m;if(t[u++]=g,t[u++]=w,t[--c]=w,t[--c]=v,s){const _=i-m;t[d++]=v,t[d++]=_,t[--f]=_,t[--f]=g}}for(let p=1;p<h;p++){const m=Math.PI/2*(p/h),g=n+Math.cos(m)*o,v=s+Math.sin(m)*a,w=e+g,_=e-g,T=i+v,b=i-v;t[u++]=w,t[u++]=T,t[--c]=T,t[--c]=_,t[d++]=_,t[d++]=b,t[--f]=b,t[--f]=w}{const p=n,m=s+a,g=e+p,v=e-p,w=i+m,_=i-m;t[u++]=g,t[u++]=w,t[--f]=_,t[--f]=g,n&&(t[u++]=v,t[u++]=w,t[--f]=_,t[--f]=v)}},triangulate(r,t){const e=r.points,i=t.points,n=t.indices;if(e.length===0)return;let s=i.length/2;const o=s;let a,h;if(r.type!==de.RREC){const u=r.shape;a=u.x,h=u.y}else{const u=r.shape;a=u.x+u.width/2,h=u.y+u.height/2}const l=r.matrix;i.push(r.matrix?l.a*a+l.c*h+l.tx:a,r.matrix?l.b*a+l.d*h+l.ty:h),s++,i.push(e[0],e[1]);for(let u=2;u<e.length;u+=2)i.push(e[u],e[u+1]),n.push(s++,o,s);n.push(o+1,o,s)}};function tm(r,t=!1){const e=r.length;if(e<6)return;let i=0;for(let n=0,s=r[e-2],o=r[e-1];n<e;n+=2){const a=r[n],h=r[n+1];i+=(a-s)*(h+o),s=a,o=h}if(!t&&i>0||t&&i<=0){const n=e/2;for(let s=n+n%2;s<e;s+=2){const o=e-s-2,a=e-s-1,h=s,l=s+1;[r[o],r[h]]=[r[h],r[o]],[r[a],r[l]]=[r[l],r[a]]}}}const W0={build(r){r.points=r.shape.points.slice()},triangulate(r,t){let e=r.points;const i=r.holes,n=t.points,s=t.indices;if(e.length>=6){tm(e,!1);const o=[];for(let l=0;l<i.length;l++){const u=i[l];tm(u.points,!0),o.push(e.length/2),e=e.concat(u.points)}const a=Ux(e,o,2);if(!a)return;const h=n.length/2;for(let l=0;l<a.length;l+=3)s.push(a[l]+h),s.push(a[l+1]+h),s.push(a[l+2]+h);for(let l=0;l<e.length;l++)n.push(e[l])}}},oT={build(r){const t=r.shape,e=t.x,i=t.y,n=t.width,s=t.height,o=r.points;o.length=0,n>=0&&s>=0&&o.push(e,i,e+n,i,e+n,i+s,e,i+s)},triangulate(r,t){const e=r.points,i=t.points;if(e.length===0)return;const n=i.length/2;i.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},aT={build(r){Qa.build(r)},triangulate(r,t){Qa.triangulate(r,t)}};var Xe=(r=>(r.MITER="miter",r.BEVEL="bevel",r.ROUND="round",r))(Xe||{}),Ai=(r=>(r.BUTT="butt",r.ROUND="round",r.SQUARE="square",r))(Ai||{});const as={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(r,t=20){if(!this.adaptive||!r||isNaN(r))return t;let e=Math.ceil(r/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class em{static curveTo(t,e,i,n,s,o){const a=o[o.length-2],h=o[o.length-1]-e,l=a-t,u=n-e,c=i-t,d=Math.abs(h*c-l*u);if(d<1e-8||s===0)return(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e),null;const f=h*h+l*l,p=u*u+c*c,m=h*u+l*c,g=s*Math.sqrt(f)/d,v=s*Math.sqrt(p)/d,w=g*m/f,_=v*m/p,T=g*c+v*l,b=g*u+v*h,x=l*(v+w),y=h*(v+w),S=c*(g+_),D=u*(g+_),G=Math.atan2(y-b,x-T),O=Math.atan2(D-b,S-T);return{cx:T+t,cy:b+e,radius:s,startAngle:G,endAngle:O,anticlockwise:l*u>c*h}}static arc(t,e,i,n,s,o,a,h,l){const u=a-o,c=as._segmentsCount(Math.abs(u)*s,Math.ceil(Math.abs(u)/ja)*40),d=u/(c*2),f=d*2,p=Math.cos(d),m=Math.sin(d),g=c-1,v=g%1/g;for(let w=0;w<=g;++w){const _=w+v*w,T=d+o+f*_,b=Math.cos(T),x=-Math.sin(T);l.push((p*b+m*x)*s+i,(p*-x+m*b)*s+n)}}}class hT{constructor(){this.reset()}begin(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Gc{static curveLength(t,e,i,n,s,o,a,h){let l=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0,v=0,w=0,_=0,T=t,b=e;for(let x=1;x<=10;++x)u=x/10,c=u*u,d=c*u,f=1-u,p=f*f,m=p*f,g=m*t+3*p*u*i+3*f*c*s+d*a,v=m*e+3*p*u*n+3*f*c*o+d*h,w=T-g,_=b-v,T=g,b=v,l+=Math.sqrt(w*w+_*_);return l}static curveTo(t,e,i,n,s,o,a){const h=a[a.length-2],l=a[a.length-1];a.length-=2;const u=as._segmentsCount(Gc.curveLength(h,l,t,e,i,n,s,o));let c=0,d=0,f=0,p=0,m=0;a.push(h,l);for(let g=1,v=0;g<=u;++g)v=g/u,c=1-v,d=c*c,f=d*c,p=v*v,m=p*v,a.push(f*h+3*d*v*t+3*c*p*i+m*s,f*l+3*d*v*e+3*c*p*n+m*o)}}function rm(r,t,e,i,n,s,o,a){const h=r-e*n,l=t-i*n,u=r+e*s,c=t+i*s;let d,f;o?(d=i,f=-e):(d=-i,f=e);const p=h+d,m=l+f,g=u+d,v=c+f;return a.push(p,m,g,v),2}function qi(r,t,e,i,n,s,o,a){const h=e-r,l=i-t;let u=Math.atan2(h,l),c=Math.atan2(n-r,s-t);a&&u<c?u+=Math.PI*2:!a&&u>c&&(c+=Math.PI*2);let d=u;const f=c-u,p=Math.abs(f),m=Math.sqrt(h*h+l*l),g=(15*p*Math.sqrt(m)/Math.PI>>0)+1,v=f/g;if(d+=v,a){o.push(r,t,e,i);for(let w=1,_=d;w<g;w++,_+=v)o.push(r,t,r+Math.sin(_)*m,t+Math.cos(_)*m);o.push(r,t,n,s)}else{o.push(e,i,r,t);for(let w=1,_=d;w<g;w++,_+=v)o.push(r+Math.sin(_)*m,t+Math.cos(_)*m,r,t);o.push(n,s,r,t)}return g*2}function lT(r,t){const e=r.shape;let i=r.points||e.points.slice();const n=t.closePointEps;if(i.length===0)return;const s=r.lineStyle,o=new mt(i[0],i[1]),a=new mt(i[i.length-2],i[i.length-1]),h=e.type!==de.POLY||e.closeStroke,l=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(h){i=i.slice(),l&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));const A=(o.x+a.x)*.5,C=(a.y+o.y)*.5;i.unshift(A,C),i.push(A,C)}const u=t.points,c=i.length/2;let d=i.length;const f=u.length/2,p=s.width/2,m=p*p,g=s.miterLimit*s.miterLimit;let v=i[0],w=i[1],_=i[2],T=i[3],b=0,x=0,y=-(w-T),S=v-_,D=0,G=0,O=Math.sqrt(y*y+S*S);y/=O,S/=O,y*=p,S*=p;const N=s.alignment,P=(1-N)*2,F=N*2;h||(s.cap===Ai.ROUND?d+=qi(v-y*(P-F)*.5,w-S*(P-F)*.5,v-y*P,w-S*P,v+y*F,w+S*F,u,!0)+2:s.cap===Ai.SQUARE&&(d+=rm(v,w,y,S,P,F,!0,u))),u.push(v-y*P,w-S*P,v+y*F,w+S*F);for(let A=1;A<c-1;++A){v=i[(A-1)*2],w=i[(A-1)*2+1],_=i[A*2],T=i[A*2+1],b=i[(A+1)*2],x=i[(A+1)*2+1],y=-(w-T),S=v-_,O=Math.sqrt(y*y+S*S),y/=O,S/=O,y*=p,S*=p,D=-(T-x),G=_-b,O=Math.sqrt(D*D+G*G),D/=O,G/=O,D*=p,G*=p;const C=_-v,B=w-T,I=_-b,M=x-T,k=C*I+B*M,L=B*I-M*C,V=L<0;if(Math.abs(L)<.001*Math.abs(k)){u.push(_-y*P,T-S*P,_+y*F,T+S*F),k>=0&&(s.join===Xe.ROUND?d+=qi(_,T,_-y*P,T-S*P,_-D*P,T-G*P,u,!1)+4:d+=2,u.push(_-D*F,T-G*F,_+D*P,T+G*P));continue}const $=(-y+v)*(-S+T)-(-y+_)*(-S+w),tt=(-D+b)*(-G+T)-(-D+_)*(-G+x),et=(C*tt-I*$)/L,K=(M*$-B*tt)/L,U=(et-_)*(et-_)+(K-T)*(K-T),X=_+(et-_)*P,q=T+(K-T)*P,z=_-(et-_)*F,at=T-(K-T)*F,nt=Math.min(C*C+B*B,I*I+M*M),J=V?P:F,ht=nt+J*J*m,Ct=U<=ht;let Pt=s.join;if(Pt===Xe.MITER&&U/m>g&&(Pt=Xe.BEVEL),Ct)switch(Pt){case Xe.MITER:{u.push(X,q,z,at);break}case Xe.BEVEL:{V?u.push(X,q,_+y*F,T+S*F,X,q,_+D*F,T+G*F):u.push(_-y*P,T-S*P,z,at,_-D*P,T-G*P,z,at),d+=2;break}case Xe.ROUND:{V?(u.push(X,q,_+y*F,T+S*F),d+=qi(_,T,_+y*F,T+S*F,_+D*F,T+G*F,u,!0)+4,u.push(X,q,_+D*F,T+G*F)):(u.push(_-y*P,T-S*P,z,at),d+=qi(_,T,_-y*P,T-S*P,_-D*P,T-G*P,u,!1)+4,u.push(_-D*P,T-G*P,z,at));break}}else{switch(u.push(_-y*P,T-S*P,_+y*F,T+S*F),Pt){case Xe.MITER:{V?u.push(z,at,z,at):u.push(X,q,X,q),d+=2;break}case Xe.ROUND:{V?d+=qi(_,T,_+y*F,T+S*F,_+D*F,T+G*F,u,!0)+2:d+=qi(_,T,_-y*P,T-S*P,_-D*P,T-G*P,u,!1)+2;break}}u.push(_-D*P,T-G*P,_+D*F,T+G*F),d+=2}}v=i[(c-2)*2],w=i[(c-2)*2+1],_=i[(c-1)*2],T=i[(c-1)*2+1],y=-(w-T),S=v-_,O=Math.sqrt(y*y+S*S),y/=O,S/=O,y*=p,S*=p,u.push(_-y*P,T-S*P,_+y*F,T+S*F),h||(s.cap===Ai.ROUND?d+=qi(_-y*(P-F)*.5,T-S*(P-F)*.5,_-y*P,T-S*P,_+y*F,T+S*F,u,!1)+2:s.cap===Ai.SQUARE&&(d+=rm(_,T,y,S,P,F,!1,u)));const j=t.indices,E=as.epsilon*as.epsilon;for(let A=f;A<d+f-2;++A)v=u[A*2],w=u[A*2+1],_=u[(A+1)*2],T=u[(A+1)*2+1],b=u[(A+2)*2],x=u[(A+2)*2+1],!(Math.abs(v*(T-x)+_*(x-w)+b*(w-T))<E)&&j.push(A,A+1,A+2)}function uT(r,t){let e=0;const i=r.shape,n=r.points||i.points,s=i.type!==de.POLY||i.closeStroke;if(n.length===0)return;const o=t.points,a=t.indices,h=n.length/2,l=o.length/2;let u=l;for(o.push(n[0],n[1]),e=1;e<h;e++)o.push(n[e*2],n[e*2+1]),a.push(u,u+1),u++;s&&a.push(u,l)}function im(r,t){r.lineStyle.native?uT(r,t):lT(r,t)}class zc{static curveLength(t,e,i,n,s,o){const a=t-2*i+s,h=e-2*n+o,l=2*i-2*t,u=2*n-2*e,c=4*(a*a+h*h),d=4*(a*l+h*u),f=l*l+u*u,p=2*Math.sqrt(c+d+f),m=Math.sqrt(c),g=2*c*m,v=2*Math.sqrt(f),w=d/m;return(g*p+m*d*(p-v)+(4*f*c-d*d)*Math.log((2*m+w+p)/(w+v)))/(4*g)}static curveTo(t,e,i,n,s){const o=s[s.length-2],a=s[s.length-1],h=as._segmentsCount(zc.curveLength(o,a,t,e,i,n));let l=0,u=0;for(let c=1;c<=h;++c){const d=c/h;l=o+(t-o)*d,u=a+(e-a)*d,s.push(l+(t+(i-t)*d-l)*d,u+(e+(n-e)*d-u)*d)}}}const Wl={[de.POLY]:W0,[de.CIRC]:Qa,[de.ELIP]:Qa,[de.RECT]:oT,[de.RREC]:aT},nm=[],la=[];class Ja{constructor(t,e=null,i=null,n=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=n,this.type=t.type}clone(){return new Ja(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Ln=new mt,X0=class V0 extends Kg{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Ya,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),la.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),nm.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,i=null,n=null){const s=new Ja(t,e,i,n);return this.graphicsData.push(s),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const i=new Ja(t,null,null,e),n=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=n.lineStyle,n.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let i=0;i<e.length;++i){const n=e[i];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(t,Ln):Ln.copyFrom(t),n.shape.contains(Ln.x,Ln.y))){let s=!1;if(n.holes){for(let o=0;o<n.holes.length;o++)if(n.holes[o].shape.contains(Ln.x,Ln.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let i=null,n=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],n=i.style);for(let h=this.shapeIndex;h<e.length;h++){this.shapeIndex++;const l=e[h],u=l.fillStyle,c=l.lineStyle;Wl[l.type].build(l),l.matrix&&this.transformPoints(l.points,l.matrix),(u.visible||c.visible)&&this.processHoles(l.holes);for(let d=0;d<2;d++){const f=d===0?u:c;if(!f.visible)continue;const p=f.texture.baseTexture,m=this.indices.length,g=this.points.length/2;p.wrapMode=Ir.REPEAT,d===0?this.processFill(l):this.processLine(l);const v=this.points.length/2-g;v!==0&&(i&&!this._compareStyles(n,f)&&(i.end(m,g),i=null),i||(i=nm.pop()||new hT,i.begin(f,m,g),this.batches.push(i),n=f),this.addUvs(this.points,t,f.texture,g,v,f.matrix))}}const s=this.indices.length,o=this.points.length/2;if(i&&i.end(s,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const i=this.graphicsData[t],n=i.fillStyle,s=i.lineStyle;if(n&&!n.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,i=t.length;e<i;e++){const n=t[e];for(let s=0;s<n.size;s++){const o=n.start+s;this.indicesUint16[o]=this.indicesUint16[o]-n.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<V0.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++vt._globalBatch;for(let c=0;c<this.drawCalls.length;c++)this.drawCalls[c].texArray.clear(),la.push(this.drawCalls[c]);this.drawCalls.length=0;const e=this.colors,i=this.textureIds;let n=la.pop();n||(n=new Au,n.texArray=new Pu),n.texArray.count=0,n.start=0,n.size=0,n.type=Rr.TRIANGLES;let s=0,o=null,a=0,h=!1,l=Rr.TRIANGLES,u=0;this.drawCalls.push(n);for(let c=0;c<this.batches.length;c++){const d=this.batches[c],f=8,p=d.style,m=p.texture.baseTexture;h!==!!p.native&&(h=!!p.native,l=h?Rr.LINES:Rr.TRIANGLES,o=null,s=f,t++),o!==m&&(o=m,m._batchEnabled!==t&&(s===f&&(t++,s=0,n.size>0&&(n=la.pop(),n||(n=new Au,n.texArray=new Pu),this.drawCalls.push(n)),n.start=u,n.size=0,n.texArray.count=0,n.type=l),m.touched=1,m._batchEnabled=t,m._batchLocation=s,m.wrapMode=Ir.REPEAT,n.texArray.elements[n.texArray.count++]=m,s++)),n.size+=d.size,u+=d.size,a=m._batchLocation,this.addColors(e,p.color,p.alpha,d.attribSize,d.attribStart),this.addTextureIds(i,a,d.attribSize,d.attribStart)}vt._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,i=this.colors,n=this.textureIds,s=new ArrayBuffer(t.length*3*4),o=new Float32Array(s),a=new Uint32Array(s);let h=0;for(let l=0;l<t.length/2;l++)o[h++]=t[l*2],o[h++]=t[l*2+1],o[h++]=e[l*2],o[h++]=e[l*2+1],a[h++]=i[l],o[h++]=n[l];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?W0.triangulate(t,this):Wl[t.type].triangulate(t,this)}processLine(t){im(t,this);for(let e=0;e<t.holes.length;e++)im(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const i=t[e];Wl[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let i=0;i<t.length/2;i++){const n=t[i*2],s=t[i*2+1];t[i*2]=e.a*n+e.c*s+e.tx,t[i*2+1]=e.b*n+e.d*s+e.ty}}addColors(t,e,i,n,s=0){const o=kt.shared.setValue(e).toLittleEndianNumber(),a=kt.shared.setValue(o).toPremultiplied(i);t.length=Math.max(t.length,s+n);for(let h=0;h<n;h++)t[s+h]=a}addTextureIds(t,e,i,n=0){t.length=Math.max(t.length,n+i);for(let s=0;s<i;s++)t[n+s]=e}addUvs(t,e,i,n,s,o=null){let a=0;const h=e.length,l=i.frame;for(;a<s;){let c=t[(n+a)*2],d=t[(n+a)*2+1];if(o){const f=o.a*c+o.c*d+o.tx;d=o.b*c+o.d*d+o.ty,c=f}a++,e.push(c/l.width,d/l.height)}const u=i.baseTexture;(l.width<u.width||l.height<u.height)&&this.adjustUvs(e,i,h,s)}adjustUvs(t,e,i,n){const s=e.baseTexture,o=1e-6,a=i+n*2,h=e.frame,l=h.width/s.width,u=h.height/s.height;let c=h.x/h.width,d=h.y/h.height,f=Math.floor(t[i]+o),p=Math.floor(t[i+1]+o);for(let m=i+2;m<a;m+=2)f=Math.min(f,Math.floor(t[m]+o)),p=Math.min(p,Math.floor(t[m+1]+o));c-=f,d-=p;for(let m=i;m<a;m+=2)t[m]=(t[m]+c)*l,t[m+1]=(t[m+1]+d)*u}};X0.BATCHABLE_SIZE=100;let cT=X0;class Dh{constructor(){this.color=16777215,this.alpha=1,this.texture=ct.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Dh;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=ct.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class jc extends Dh{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Ai.BUTT,this.join=Xe.MITER,this.miterLimit=10}clone(){const t=new jc;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Ai.BUTT,this.join=Xe.MITER,this.miterLimit=10}}const Xl={},Yu=class Aa extends bt{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Dh,this._lineStyle=new jc,this._matrix=null,this._holeMode=!1,this.state=Br.for2d(),this._geometry=t||new cT,this._geometry.refCount++,this._transformID=-1,this._tintColor=new kt(16777215),this.blendMode=gt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Aa(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,i,n=.5,s=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:i,alignment:n,native:s}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:ct.WHITE,color:t?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Ai.BUTT,join:Xe.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.width>0&&t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:i},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new dn,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new dn,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,n=i[i.length-2],s=i[i.length-1];return(n!==t||s!==e)&&i.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,i,n){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),zc.curveTo(t,e,i,n,s),this}bezierCurveTo(t,e,i,n,s,o){return this._initCurve(),Gc.curveTo(t,e,i,n,s,o,this.currentPath.points),this}arcTo(t,e,i,n,s){this._initCurve(t,e);const o=this.currentPath.points,a=em.curveTo(t,e,i,n,s,o);if(a){const{cx:h,cy:l,radius:u,startAngle:c,endAngle:d,anticlockwise:f}=a;this.arc(h,l,u,c,d,f)}return this}arc(t,e,i,n,s,o=!1){if(n===s)return this;if(!o&&s<=n?s+=ja:o&&n<=s&&(n+=ja),s-n===0)return this;const a=t+Math.cos(n)*i,h=e+Math.sin(n)*i,l=this._geometry.closePointEps;let u=this.currentPath?this.currentPath.points:null;if(u){const c=Math.abs(u[u.length-2]-a),d=Math.abs(u[u.length-1]-h);c<l&&d<l||u.push(a,h)}else this.moveTo(a,h),u=this.currentPath.points;return em.arc(a,h,t,e,i,n,s,o,u),this}beginFill(t=0,e){return this.beginTextureFill({texture:ct.WHITE,color:t,alpha:e})}normalizeColor(t){const e=kt.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:ct.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:i},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,i,n){return this.drawShape(new yt(t,e,i,n))}drawRoundedRect(t,e,i,n,s){return this.drawShape(new Rh(t,e,i,n,s))}drawCircle(t,e,i){return this.drawShape(new Ch(t,e,i))}drawEllipse(t,e,i,n){return this.drawShape(new Mh(t,e,i,n))}drawPolygon(...t){let e,i=!0;const n=t[0];n.points?(i=n.closeStroke,e=n.points):Array.isArray(t[0])?e=t[0]:e=t;const s=new dn(e);return s.closeStroke=i,this.drawShape(s),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===de.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(let n=0;n<i;n++){const s=t.batches[n],o=s.style.color,a=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),h=new Float32Array(t.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),l=new Uint16Array(t.indicesUint16.buffer,s.start*2,s.size),u={vertexData:a,blendMode:e,indices:l,uvs:h,_batchRGB:kt.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[n]=u}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,i=this.batches.length;e<i;e++){const n=this.batches[e];n.worldAlpha=this.worldAlpha*n.alpha,t.plugins[this.pluginName].render(n)}}}_renderDirect(t){const e=this._resolveDirectShader(t),i=this._geometry,n=this.worldAlpha,s=e.uniforms,o=i.drawCalls;s.translationMatrix=this.transform.worldTransform,kt.shared.setValue(this._tintColor).premultiply(n).toArray(s.tint),t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(let a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,i.drawCalls[a])}_renderDrawCallDirect(t,e){const{texArray:i,type:n,size:s,start:o}=e,a=i.count;for(let h=0;h<a;h++)t.texture.bind(i.elements[h],h);t.geometry.draw(n,s,o)}_resolveDirectShader(t){let e=this.shader;const i=this.pluginName;if(!e){if(!Xl[i]){const{maxTextures:n}=t.plugins[i],s=new Int32Array(n);for(let h=0;h<n;h++)s[h]=h;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Nt,default:mr.from({uSamplers:s},!0)},a=t.plugins[i]._shader.program;Xl[i]=new Or(a,o)}e=Xl[i]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:i,maxX:n,maxY:s}=t.bounds;this._bounds.addFrame(this.transform,e,i,n,s)}containsPoint(t){return this.worldTransform.applyInverse(t,Aa._TEMP_POINT),this._geometry.containsPoint(Aa._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=kt.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,i=e.a,n=e.b,s=e.c,o=e.d,a=e.tx,h=e.ty,l=this._geometry.points,u=this.vertexData;let c=0;for(let d=0;d<l.length;d+=2){const f=l[d],p=l[d+1];u[c++]=i*f+s*p+a,u[c++]=o*p+n*f+h}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};Yu.curves=as,Yu._TEMP_POINT=new mt;let ki=Yu;class dT{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const Vl=new mt,sm=new dn,$0=class Y0 extends bt{constructor(t,e,i,n=Rr.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=i||Br.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=ot.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Rr.TRIANGLES&&e.length<Y0.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const n=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[n]),t.plugins[n].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,l=n.tx,u=n.ty,c=this.vertexData;for(let d=0;d<c.length/2;d++){const f=e[d*2],p=e[d*2+1];c[d*2]=s*f+a*p+l,c[d*2+1]=o*f+h*p+u}if(this._roundPixels){const d=ot.RESOLUTION;for(let f=0;f<c.length;++f)c[f]=Math.round(c[f]*d)/d}this.vertexDirty=i}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new dT(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Vl);const e=this.geometry.getBuffer("aVertexPosition").data,i=sm.points,n=this.geometry.getIndex().data,s=n.length,o=this.drawMode===4?3:1;for(let a=0;a+2<s;a+=o){const h=n[a]*2,l=n[a+1]*2,u=n[a+2]*2;if(i[0]=e[h],i[1]=e[h+1],i[2]=e[l],i[3]=e[l+1],i[4]=e[u],i[5]=e[u+1],sm.contains(Vl.x,Vl.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};$0.BATCHABLE_SIZE=100;let qu=$0;class q0 extends Di{constructor(t,e,i){super();const n=new $t(t),s=new $t(e,!0),o=new $t(i,!0,!0);this.addAttribute("aVertexPosition",n,2,!1,pt.FLOAT).addAttribute("aTextureCoord",s,2,!1,pt.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var fT=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,pT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Zu extends Or{constructor(t,e){const i={uSampler:t,alpha:1,uTextureMatrix:Nt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(i,e.uniforms),super(e.program||Qr.from(pT,fT),i),this._colorDirty=!1,this.uvMatrix=new c0(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new kt(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;kt.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class mT extends q0{constructor(t=200,e,i=0){super(new Float32Array(e.length*4),new Float32Array(e.length*4),new Uint16Array((e.length-1)*6)),this.points=e,this._width=t,this.textureScale=i,this.build()}get width(){return this._width}build(){const t=this.points;if(!t)return;const e=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),n=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(t.length*4),i.data=new Float32Array(t.length*4),n.data=new Uint16Array((t.length-1)*6));const s=i.data,o=n.data;s[0]=0,s[1]=0,s[2]=0,s[3]=1;let a=0,h=t[0];const l=this._width*this.textureScale,u=t.length;for(let d=0;d<u;d++){const f=d*4;if(this.textureScale>0){const p=h.x-t[d].x,m=h.y-t[d].y,g=Math.sqrt(p*p+m*m);h=t[d],a+=g/l}else a=d/(u-1);s[f]=a,s[f+1]=0,s[f+2]=a,s[f+3]=1}let c=0;for(let d=0;d<u-1;d++){const f=d*2;o[c++]=f,o[c++]=f+1,o[c++]=f+2,o[c++]=f+2,o[c++]=f+1,o[c++]=f+3}i.update(),n.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let e=t[0],i,n=0,s=0;const o=this.buffers[0].data,a=t.length,h=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let l=0;l<a;l++){const u=t[l],c=l*4;l<t.length-1?i=t[l+1]:i=u,s=-(i.x-e.x),n=i.y-e.y;const d=Math.sqrt(n*n+s*s);d<1e-6?(n=0,s=0):(n/=d,s/=d,n*=h,s*=h),o[c]=u.x+n,o[c+1]=u.y+s,o[c+2]=u.x-n,o[c+3]=u.y-s,e=u}this.buffers[0].update()}update(){this.textureScale>0?this.build():this.updateVertices()}}class gT extends qu{constructor(t,e,i=0){const n=new mT(t.height,e,i),s=new Zu(t);i>0&&(t.baseTexture.wrapMode=Ir.REPEAT),super(n,s),this.autoUpdate=!0}_render(t){const e=this.geometry;(this.autoUpdate||e._width!==this.shader.texture.height)&&(e._width=this.shader.texture.height,e.update()),super._render(t)}}class om{constructor(t,e,i){this.geometry=new Di,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let n=0;n<t.length;++n){let s=t[n];s={attributeName:s.attributeName,size:s.size,uploadFunction:s.uploadFunction,type:s.type||pt.FLOAT,offset:s.offset},e[n]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new $t(Bw(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=e,e+=a.size,this.dynamicStride+=a.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new $t(this.dynamicData,!1,!1);let n=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=n,n+=a.size,this.staticStride+=a.size}const s=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new $t(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===pt.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===pt.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,e,i){for(let n=0;n<this.dynamicProperties.length;n++){const s=this.dynamicProperties[n];s.uploadFunction(t,e,i,s.type===pt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,s.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,i){for(let n=0;n<this.staticProperties.length;n++){const s=this.staticProperties[n];s.uploadFunction(t,e,i,s.type===pt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,s.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var yT=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,vT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class Z0 extends Ph{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Nt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:pt.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Or.from(vT,yT,{}),this.state=Br.for2d()}render(t){const e=t.children,i=t._maxSize,n=t._batchSize,s=this.renderer;let o=e.length;if(o===0)return;o>i&&!t.autoResize&&(o=i);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const h=e[0]._texture.baseTexture,l=h.alphaMode>0;this.state.blendMode=Yg(t.blendMode,l),s.state.set(this.state);const u=s.gl,c=t.worldTransform.copyTo(this.tempMatrix);c.prepend(s.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=c.toArray(!0),this.shader.uniforms.uColor=kt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=h,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,p=0;f<o;f+=n,p+=1){let m=o-f;m>n&&(m=n),p>=a.length&&a.push(this._generateOneMoreBuffer(t));const g=a[p];g.uploadDynamic(e,f,m);const v=t._bufferUpdateIDs[p]||0;d=d||g._updateID<v,d&&(g._updateID=t._updateID,g.uploadStatic(e,f,m)),s.geometry.bind(g.geometry),u.drawElements(u.TRIANGLES,m*6,u.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],i=t._maxSize,n=t._batchSize,s=t._properties;for(let o=0;o<i;o+=n)e.push(new om(this.properties,s,n));return e}_generateOneMoreBuffer(t){const e=t._batchSize,i=t._properties;return new om(this.properties,i,e)}uploadVertices(t,e,i,n,s,o){let a=0,h=0,l=0,u=0;for(let c=0;c<i;++c){const d=t[e+c],f=d._texture,p=d.scale.x,m=d.scale.y,g=f.trim,v=f.orig;g?(h=g.x-d.anchor.x*v.width,a=h+g.width,u=g.y-d.anchor.y*v.height,l=u+g.height):(a=v.width*(1-d.anchor.x),h=v.width*-d.anchor.x,l=v.height*(1-d.anchor.y),u=v.height*-d.anchor.y),n[o]=h*p,n[o+1]=u*m,n[o+s]=a*p,n[o+s+1]=u*m,n[o+s*2]=a*p,n[o+s*2+1]=l*m,n[o+s*3]=h*p,n[o+s*3+1]=l*m,o+=s*4}}uploadPosition(t,e,i,n,s,o){for(let a=0;a<i;a++){const h=t[e+a].position;n[o]=h.x,n[o+1]=h.y,n[o+s]=h.x,n[o+s+1]=h.y,n[o+s*2]=h.x,n[o+s*2+1]=h.y,n[o+s*3]=h.x,n[o+s*3+1]=h.y,o+=s*4}}uploadRotation(t,e,i,n,s,o){for(let a=0;a<i;a++){const h=t[e+a].rotation;n[o]=h,n[o+s]=h,n[o+s*2]=h,n[o+s*3]=h,o+=s*4}}uploadUvs(t,e,i,n,s,o){for(let a=0;a<i;++a){const h=t[e+a]._texture._uvs;h?(n[o]=h.x0,n[o+1]=h.y0,n[o+s]=h.x1,n[o+s+1]=h.y1,n[o+s*2]=h.x2,n[o+s*2+1]=h.y2,n[o+s*3]=h.x3,n[o+s*3+1]=h.y3,o+=s*4):(n[o]=0,n[o+1]=0,n[o+s]=0,n[o+s+1]=0,n[o+s*2]=0,n[o+s*2+1]=0,n[o+s*3]=0,n[o+s*3+1]=0,o+=s*4)}}uploadTint(t,e,i,n,s,o){for(let a=0;a<i;++a){const h=t[e+a],l=kt.shared.setValue(h._tintRGB).toPremultiplied(h.alpha,h.texture.baseTexture.alphaMode>0);n[o]=l,n[o+s]=l,n[o+s*2]=l,n[o+s*3]=l,o+=s*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}Z0.extension={name:"particle",type:it.RendererPlugin};dt.add(Z0);var Oh=(r=>(r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",r))(Oh||{});const ua={willReadFrequently:!0},Er=class ft{static get experimentalLetterSpacingSupported(){let t=ft._experimentalLetterSpacingSupported;if(t!==void 0){const e=ot.ADAPTER.getCanvasRenderingContext2D().prototype;t=ft._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,n,s,o,a,h,l){this.text=t,this.style=e,this.width=i,this.height=n,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=h,this.fontProperties=l}static measureText(t,e,i,n=ft._canvas){i=i??e.wordWrap;const s=e.toFontString(),o=ft.measureFont(s);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const a=n.getContext("2d",ua);a.font=s;const h=(i?ft.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),l=new Array(h.length);let u=0;for(let p=0;p<h.length;p++){const m=ft._measureText(h[p],e.letterSpacing,a);l[p]=m,u=Math.max(u,m)}let c=u+e.strokeThickness;e.dropShadow&&(c+=e.dropShadowDistance);const d=e.lineHeight||o.fontSize+e.strokeThickness;let f=Math.max(d,o.fontSize+e.strokeThickness*2)+e.leading+(h.length-1)*(d+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new ft(t,e,c,f,h,l,d+e.leading,u,o)}static _measureText(t,e,i){let n=!1;ft.experimentalLetterSpacingSupported&&(ft.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,n=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let s=i.measureText(t).width;return s>0&&(n?s-=e:s+=(ft.graphemeSegmenter(t).length-1)*e),s}static wordWrap(t,e,i=ft._canvas){const n=i.getContext("2d",ua);let s=0,o="",a="";const h=Object.create(null),{letterSpacing:l,whiteSpace:u}=e,c=ft.collapseSpaces(u),d=ft.collapseNewlines(u);let f=!c;const p=e.wordWrapWidth+l,m=ft.tokenize(t);for(let g=0;g<m.length;g++){let v=m[g];if(ft.isNewline(v)){if(!d){a+=ft.addLine(o),f=!c,o="",s=0;continue}v=" "}if(c){const _=ft.isBreakingSpace(v),T=ft.isBreakingSpace(o[o.length-1]);if(_&&T)continue}const w=ft.getFromCache(v,l,h,n);if(w>p)if(o!==""&&(a+=ft.addLine(o),o="",s=0),ft.canBreakWords(v,e.breakWords)){const _=ft.wordWrapSplit(v);for(let T=0;T<_.length;T++){let b=_[T],x=b,y=1;for(;_[T+y];){const D=_[T+y];if(!ft.canBreakChars(x,D,v,T,e.breakWords))b+=D;else break;x=D,y++}T+=y-1;const S=ft.getFromCache(b,l,h,n);S+s>p&&(a+=ft.addLine(o),f=!1,o="",s=0),o+=b,s+=S}}else{o.length>0&&(a+=ft.addLine(o),o="",s=0);const _=g===m.length-1;a+=ft.addLine(v,!_),f=!1,o="",s=0}else w+s>p&&(f=!1,a+=ft.addLine(o),o="",s=0),(o.length>0||!ft.isBreakingSpace(v)||f)&&(o+=v,s+=w)}return a+=ft.addLine(o,!1),a}static addLine(t,e=!0){return t=ft.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,i,n){let s=i[t];return typeof s!="number"&&(s=ft._measureText(t,e,n)+e,i[t]=s),s}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!ft.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:ft._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:ft._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let n=0;n<t.length;n++){const s=t[n],o=t[n+1];if(ft.isBreakingSpace(s,o)||ft.isNewline(s)){i!==""&&(e.push(i),i=""),e.push(s);continue}i+=s}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,n,s){return!0}static wordWrapSplit(t){return ft.graphemeSegmenter(t)}static measureFont(t){if(ft._fonts[t])return ft._fonts[t];const e={ascent:0,descent:0,fontSize:0},i=ft._canvas,n=ft._context;n.font=t;const s=ft.METRICS_STRING+ft.BASELINE_SYMBOL,o=Math.ceil(n.measureText(s).width);let a=Math.ceil(n.measureText(ft.BASELINE_SYMBOL).width);const h=Math.ceil(ft.HEIGHT_MULTIPLIER*a);if(a=a*ft.BASELINE_MULTIPLIER|0,o===0||h===0)return ft._fonts[t]=e,e;i.width=o,i.height=h,n.fillStyle="#f00",n.fillRect(0,0,o,h),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(s,0,a);const l=n.getImageData(0,0,o,h).data,u=l.length,c=o*4;let d=0,f=0,p=!1;for(d=0;d<a;++d){for(let m=0;m<c;m+=4)if(l[f+m]!==255){p=!0;break}if(!p)f+=c;else break}for(e.ascent=a-d,f=u-c,p=!1,d=h;d>a;--d){for(let m=0;m<c;m+=4)if(l[f+m]!==255){p=!0;break}if(!p)f-=c;else break}return e.descent=d-a,e.fontSize=e.ascent+e.descent,ft._fonts[t]=e,e}static clearMetrics(t=""){t?delete ft._fonts[t]:ft._fonts={}}static get _canvas(){if(!ft.__canvas){let t;try{const e=new OffscreenCanvas(0,0);if(e.getContext("2d",ua)?.measureText)return ft.__canvas=e,e;t=ot.ADAPTER.createCanvas()}catch{t=ot.ADAPTER.createCanvas()}t.width=t.height=10,ft.__canvas=t}return ft.__canvas}static get _context(){return ft.__context||(ft.__context=ft._canvas.getContext("2d",ua)),ft.__context}};Er.METRICS_STRING="|q",Er.BASELINE_SYMBOL="M",Er.BASELINE_MULTIPLIER=1.4,Er.HEIGHT_MULTIPLIER=2,Er.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const r=new Intl.Segmenter;return t=>[...r.segment(t)].map(e=>e.segment)}return r=>[...r]})(),Er.experimentalLetterSpacing=!1,Er._fonts={},Er._newlines=[10,13],Er._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let bi=Er;const _T=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],K0=class Vs{constructor(t){this.styleID=0,this.reset(),Yl(this,t,t)}clone(){const t={};return Yl(t,this,Vs.defaultStyle),new Vs(t)}reset(){Yl(this,Vs.defaultStyle,Vs.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=$l(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=$l(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){xT(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=$l(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let n=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!_T.includes(n)&&(n=`"${n}"`),e[i]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};K0.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Oh.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ni=K0;function $l(r){const t=kt.shared,e=i=>{const n=t.setValue(i);return n.alpha===1?n.toHex():n.toRgbaString()};return Array.isArray(r)?r.map(e):e(r)}function xT(r,t){if(!Array.isArray(r)||!Array.isArray(t)||r.length!==t.length)return!1;for(let e=0;e<r.length;++e)if(r[e]!==t[e])return!1;return!0}function Yl(r,t,e){for(const i in e)Array.isArray(t[i])?r[i]=t[i].slice():r[i]=t[i]}const wT={texture:!0,children:!1,baseTexture:!0},Q0=class Ku extends Yt{constructor(t,e,i){let n=!1;i||(i=ot.ADAPTER.createCanvas(),n=!0),i.width=3,i.height=3;const s=ct.from(i);s.orig=new yt,s.trim=new yt,super(s),this._ownCanvas=n,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=Ku.defaultResolution??ot.RESOLUTION,this._autoResolution=Ku.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return bi.experimentalLetterSpacing}static set experimentalLetterSpacing(t){wt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),bi.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const i=this.context,n=bi.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=n.width,o=n.height,a=n.lines,h=n.lineHeight,l=n.lineWidths,u=n.maxLineWidth,c=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+e.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;let d,f;const p=e.dropShadow?2:1;for(let m=0;m<p;++m){const g=e.dropShadow&&m===0,v=g?Math.ceil(Math.max(1,o)+e.padding*2):0,w=v*this._resolution;if(g){i.fillStyle="black",i.strokeStyle="black";const T=e.dropShadowColor,b=e.dropShadowBlur*this._resolution,x=e.dropShadowDistance*this._resolution;i.shadowColor=kt.shared.setValue(T).setAlpha(e.dropShadowAlpha).toRgbaString(),i.shadowBlur=b,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*x,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*x+w}else i.fillStyle=this._generateFillStyle(e,a,n),i.strokeStyle=e.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let _=(h-c.fontSize)/2;h-c.fontSize<0&&(_=0);for(let T=0;T<a.length;T++)d=e.strokeThickness/2,f=e.strokeThickness/2+T*h+c.ascent+_,e.align==="right"?d+=u-l[T]:e.align==="center"&&(d+=(u-l[T])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(a[T],d+e.padding,f+e.padding-v,!0),e.fill&&this.drawLetterSpacing(a[T],d+e.padding,f+e.padding-v)}this.updateTexture()}drawLetterSpacing(t,e,i,n=!1){const s=this._style.letterSpacing;let o=!1;if(bi.experimentalLetterSpacingSupported&&(bi.experimentalLetterSpacing?(this.context.letterSpacing=`${s}px`,this.context.textLetterSpacing=`${s}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),s===0||o){n?this.context.strokeText(t,e,i):this.context.fillText(t,e,i);return}let a=e;const h=bi.graphemeSegmenter(t);let l=this.context.measureText(t).width,u=0;for(let c=0;c<h.length;++c){const d=h[c];n?this.context.strokeText(d,a,i):this.context.fillText(d,a,i);let f="";for(let p=c+1;p<h.length;++p)f+=h[p];u=this.context.measureText(f).width,a+=l-u+s,l=u}}updateTexture(){const t=this.canvas;if(this._style.trim){const o=zw(t);o.data&&(t.width=o.width,t.height=o.height,this.context.putImageData(o.data,0,0))}const e=this._texture,i=this._style,n=i.trim?0:i.padding,s=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-n,e.trim.y=-n,e.orig.width=e._frame.width-n*2,e.orig.height=e._frame.height-n*2,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,i){const n=t.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;let s;const o=t.dropShadow?t.dropShadowDistance:0,a=t.padding||0,h=this.canvas.width/this._resolution-o-a*2,l=this.canvas.height/this._resolution-o-a*2,u=n.slice(),c=t.fillGradientStops.slice();if(!c.length){const d=u.length+1;for(let f=1;f<d;++f)c.push(f/d)}if(u.unshift(n[0]),c.unshift(0),u.push(n[n.length-1]),c.push(1),t.fillGradientType===Oh.LINEAR_VERTICAL){s=this.context.createLinearGradient(h/2,a,h/2,l+a);const d=i.fontProperties.fontSize+t.strokeThickness;for(let f=0;f<e.length;f++){const p=i.lineHeight*(f-1)+d,m=i.lineHeight*f;let g=m;f>0&&p>m&&(g=(m+p)/2);const v=m+d,w=i.lineHeight*(f+1);let _=v;f+1<e.length&&w<v&&(_=(v+w)/2);const T=(_-g)/l;for(let b=0;b<u.length;b++){let x=0;typeof c[b]=="number"?x=c[b]:x=b/u.length;let y=Math.min(1,Math.max(0,g/l+x*T));y=Number(y.toFixed(5)),s.addColorStop(y,u[b])}}}else{s=this.context.createLinearGradient(a,l/2,h+a,l/2);const d=u.length+1;let f=1;for(let p=0;p<u.length;p++){let m;typeof c[p]=="number"?m=c[p]:m=f/d,s.addColorStop(m,u[p]),f++}}return s}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},wT,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=Ei(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=Ei(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof Ni?this._style=t:this._style=new Ni(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};Q0.defaultAutoResolution=!0;let J0=Q0;class bT{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function TT(r,t){let e=!1;if(r?._textures?.length){for(let i=0;i<r._textures.length;i++)if(r._textures[i]instanceof ct){const n=r._textures[i].baseTexture;t.includes(n)||(t.push(n),e=!0)}}return e}function ET(r,t){if(r.baseTexture instanceof vt){const e=r.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function AT(r,t){if(r._texture&&r._texture instanceof ct){const e=r._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function ST(r,t){return t instanceof J0?(t.updateText(!0),!0):!1}function CT(r,t){if(t instanceof Ni){const e=t.toFontString();return bi.measureFont(e),!0}return!1}function MT(r,t){if(r instanceof J0){t.includes(r.style)||t.push(r.style),t.includes(r)||t.push(r);const e=r._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function RT(r,t){return r instanceof Ni?(t.includes(r)||t.push(r),!0):!1}const ty=class ey{constructor(t){this.limiter=new bT(ey.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(MT),this.registerFindHook(RT),this.registerFindHook(TT),this.registerFindHook(ET),this.registerFindHook(AT),this.registerUploadHook(ST),this.registerUploadHook(CT)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,_e.system.addOnce(this.tick,this,wn.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed){for(let i=0,n=this.uploadHooks.length;i<n;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)_e.system.addOnce(this.tick,this,wn.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,i=t.length;e<i;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof bt)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&_e.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};ty.uploadsPerFrame=4;let Qu=ty;Object.defineProperties(ot,{UPLOADS_PER_FRAME:{get(){return Qu.uploadsPerFrame},set(r){wt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Qu.uploadsPerFrame=r}}});function ry(r,t){return t instanceof vt?(t._glTextures[r.CONTEXT_UID]||r.texture.bind(t),!0):!1}function PT(r,t){if(!(t instanceof ki))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:i}=e;for(let n=0;n<i.length;n++){const{texture:s}=i[n].style;s&&ry(r,s.baseTexture)}return e.batchable||r.geometry.bind(e,t._resolveDirectShader(r)),!0}function IT(r,t){return r instanceof ki?(t.push(r),!0):!1}class iy extends Qu{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(IT),this.registerUploadHook(ry),this.registerUploadHook(PT)}}iy.extension={name:"prepare",type:it.RendererSystem};dt.add(iy);var DT=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,OT=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,kT=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,am=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,NT=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const ca=new Nt;class ny extends Ph{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new a0,this.state=Br.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Or.from(am,NT,e),this.shader=t.context.webGLVersion>1?Or.from(OT,DT,e):Or.from(am,kT,e)}render(t){const e=this.renderer,i=this.quad;let n=i.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y);const s=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;n=i.uvs,n[0]=n[6]=-s,n[1]=n[3]=-o,n[2]=n[4]=1-s,n[5]=n[7]=1-o,i.invalidate();const a=t._texture,h=a.baseTexture,l=h.alphaMode>0,u=t.tileTransform.localTransform,c=t.uvMatrix;let d=h.isPowerOfTwo&&a.frame.width===h.width&&a.frame.height===h.height;d&&(h._glTextures[e.CONTEXT_UID]?d=h.wrapMode!==Ir.CLAMP:h.wrapMode===Ir.CLAMP&&(h.wrapMode=Ir.REPEAT));const f=d?this.simpleShader:this.shader,p=a.width,m=a.height,g=t._width,v=t._height;ca.set(u.a*p/g,u.b*p/v,u.c*m/g,u.d*m/v,u.tx/g,u.ty/v),ca.invert(),d?ca.prepend(c.mapCoord):(f.uniforms.uMapCoord=c.mapCoord.toArray(!0),f.uniforms.uClampFrame=c.uClampFrame,f.uniforms.uClampOffset=c.uClampOffset),f.uniforms.uTransform=ca.toArray(!0),f.uniforms.uColor=kt.shared.setValue(t.tint).premultiply(t.worldAlpha,l).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,e.shader.bind(f),e.geometry.bind(i),this.state.blendMode=Yg(t.blendMode,l),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}ny.extension={name:"tilingSprite",type:it.RendererPlugin};dt.add(ny);const sy=class $s{constructor(t,e,i=null){this.linkedSheets=[],this._texture=t instanceof ct?t:null,this.baseTexture=t instanceof vt?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;const n=this.baseTexture.resource;this.resolution=this._updateResolution(i||(n?n.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let i=ri(t,null);return i===null&&(i=parseFloat(e??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=$s.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=$s.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const n=this._frameKeys[e],s=this._frames[n],o=s.frame;if(o){let a=null,h=null;const l=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,u=new yt(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);s.rotated?a=new yt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new yt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(h=new yt(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new ct(this.baseTexture,a,u,h,s.rotated?2:0,s.anchor,s.borders),ct.addToCache(this.textures[n],n.toString())}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const n=t[e][i];this.animations[e].push(this.textures[n])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*$s.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*$s.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};sy.BATCH_SIZE=1e3;let hm=sy;const FT=["jpg","png","jpeg","avif","webp"];function oy(r,t,e){const i={};if(r.forEach(n=>{i[n]=t}),Object.keys(t.textures).forEach(n=>{i[n]=t.textures[n]}),!e){const n=ie.dirname(r[0]);t.linkedSheets.forEach((s,o)=>{const a=oy([`${n}/${t.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(i,a)})}return i}const LT={extension:it.Asset,cache:{test:r=>r instanceof hm,getCacheableAssets:(r,t)=>oy(r,t,!1)},resolver:{test:r=>{const t=r.split("?")[0].split("."),e=t.pop(),i=t.pop();return e==="json"&&FT.includes(i)},parse:r=>{const t=r.split(".");return{resolution:parseFloat(ot.RETINA_PREFIX.exec(r)?.[1]??"1"),format:t[t.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:it.LoadParser,priority:yr.Normal},async testParse(r,t){return ie.extname(t.src).toLowerCase()===".json"&&!!r.frames},async parse(r,t,e){let i=ie.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let n=i+r.meta.image;n=Vu(n,t.src);const s=(await e.load([n]))[n],o=new hm(s.baseTexture,r,t.src);await o.parse();const a=r?.meta?.related_multi_packs;if(Array.isArray(a)){const h=[];for(const u of a){if(typeof u!="string")continue;let c=i+u;t.data?.ignoreMultiPack||(c=Vu(c,t.src),h.push(e.load({src:c,data:{ignoreMultiPack:!0}})))}const l=await Promise.all(h);o.linkedSheets=l,l.forEach(u=>{u.linkedSheets=[o].concat(o.linkedSheets.filter(c=>c!==u))})}return o},unload(r){r.destroy(!0)}}};dt.add(LT);class th{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class Sa{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const s in e){const o=e[s].match(/^[a-z]+/gm)[0],a=e[s].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),h={};for(const l in a){const u=a[l].split("="),c=u[0],d=u[1].replace(/"/gm,""),f=parseFloat(d),p=isNaN(f)?d:f;h[c]=p}i[o].push(h)}const n=new th;return i.info.forEach(s=>n.info.push({face:s.face,size:parseInt(s.size,10)})),i.common.forEach(s=>n.common.push({lineHeight:parseInt(s.lineHeight,10)})),i.page.forEach(s=>n.page.push({id:parseInt(s.id,10),file:s.file})),i.char.forEach(s=>n.char.push({id:parseInt(s.id,10),page:parseInt(s.page,10),x:parseInt(s.x,10),y:parseInt(s.y,10),width:parseInt(s.width,10),height:parseInt(s.height,10),xoffset:parseInt(s.xoffset,10),yoffset:parseInt(s.yoffset,10),xadvance:parseInt(s.xadvance,10)})),i.kerning.forEach(s=>n.kerning.push({first:parseInt(s.first,10),second:parseInt(s.second,10),amount:parseInt(s.amount,10)})),i.distanceField.forEach(s=>n.distanceField.push({distanceRange:parseInt(s.distanceRange,10),fieldType:s.fieldType})),n}}class Ju{static test(t){const e=t;return typeof t!="string"&&"getElementsByTagName"in t&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new th,i=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),s=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),h=t.getElementsByTagName("distanceField");for(let l=0;l<i.length;l++)e.info.push({face:i[l].getAttribute("face"),size:parseInt(i[l].getAttribute("size"),10)});for(let l=0;l<n.length;l++)e.common.push({lineHeight:parseInt(n[l].getAttribute("lineHeight"),10)});for(let l=0;l<s.length;l++)e.page.push({id:parseInt(s[l].getAttribute("id"),10)||0,file:s[l].getAttribute("file")});for(let l=0;l<o.length;l++){const u=o[l];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(let l=0;l<a.length;l++)e.kerning.push({first:parseInt(a[l].getAttribute("first"),10),second:parseInt(a[l].getAttribute("second"),10),amount:parseInt(a[l].getAttribute("amount"),10)});for(let l=0;l<h.length;l++)e.distanceField.push({fieldType:h[l].getAttribute("fieldType"),distanceRange:parseInt(h[l].getAttribute("distanceRange"),10)});return e}}class tc{static test(t){return typeof t=="string"&&t.includes("<font>")?Ju.test(ot.ADAPTER.parseXML(t)):!1}static parse(t){return Ju.parse(ot.ADAPTER.parseXML(t))}}const ql=[Sa,Ju,tc];function BT(r){for(let t=0;t<ql.length;t++)if(ql[t].test(r))return ql[t];return null}function UT(r,t,e,i,n,s){const o=e.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const h=e.dropShadow?e.dropShadowDistance:0,l=e.padding||0,u=r.width/i-h-l*2,c=r.height/i-h-l*2,d=o.slice(),f=e.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let m=1;m<p;++m)f.push(m/p)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),e.fillGradientType===Oh.LINEAR_VERTICAL){a=t.createLinearGradient(u/2,l,u/2,c+l);let p=0;const m=(s.fontProperties.fontSize+e.strokeThickness)/c;for(let g=0;g<n.length;g++){const v=s.lineHeight*g;for(let w=0;w<d.length;w++){let _=0;typeof f[w]=="number"?_=f[w]:_=w/d.length;const T=v/c+_*m;let b=Math.max(p,T);b=Math.min(b,1),a.addColorStop(b,d[w]),p=b}}}else{a=t.createLinearGradient(l,c/2,u+l,c/2);const p=d.length+1;let m=1;for(let g=0;g<d.length;g++){let v;typeof f[g]=="number"?v=f[g]:v=m/p,a.addColorStop(v,d[g]),m++}}return a}function HT(r,t,e,i,n,s,o){const a=e.text,h=e.fontProperties;t.translate(i,n),t.scale(s,s);const l=o.strokeThickness/2,u=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=UT(r,t,o,s,[a],e),t.strokeStyle=o.stroke,o.dropShadow){const c=o.dropShadowColor,d=o.dropShadowBlur*s,f=o.dropShadowDistance*s;t.shadowColor=kt.shared.setValue(c).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,l,u+e.lineHeight-h.descent),o.fill&&t.fillText(a,l,u+e.lineHeight-h.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Ca(r){return r.codePointAt?r.codePointAt(0):r.charCodeAt(0)}function ay(r){return Array.from?Array.from(r):r.split("")}function GT(r){typeof r=="string"&&(r=[r]);const t=[];for(let e=0,i=r.length;e<i;e++){const n=r[e];if(Array.isArray(n)){if(n.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);const s=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(let a=s,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...ay(n))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const wi=class Ar{constructor(t,e,i){const[n]=t.info,[s]=t.common,[o]=t.page,[a]=t.distanceField,h=ri(o.file),l={};this._ownsTextures=i,this.font=n.face,this.size=n.size,this.lineHeight=s.lineHeight/h,this.chars={},this.pageTextures=l;for(let u=0;u<t.page.length;u++){const{id:c,file:d}=t.page[u];l[c]=e instanceof Array?e[u]:e[d],a?.fieldType&&a.fieldType!=="none"&&(l[c].baseTexture.alphaMode=be.NO_PREMULTIPLIED_ALPHA,l[c].baseTexture.mipmap=Fr.OFF)}for(let u=0;u<t.char.length;u++){const{id:c,page:d}=t.char[u];let{x:f,y:p,width:m,height:g,xoffset:v,yoffset:w,xadvance:_}=t.char[u];f/=h,p/=h,m/=h,g/=h,v/=h,w/=h,_/=h;const T=new yt(f+l[d].frame.x/h,p+l[d].frame.y/h,m,g);this.chars[c]={xOffset:v,yOffset:w,xAdvance:_,kerning:{},texture:new ct(l[d].baseTexture,T),page:d}}for(let u=0;u<t.kerning.length;u++){let{first:c,second:d,amount:f}=t.kerning[u];c/=h,d/=h,f/=h,this.chars[d]&&(this.chars[d].kerning[c]=f)}this.distanceFieldRange=a?.distanceRange,this.distanceFieldType=a?.fieldType?.toLowerCase()??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,i){let n;if(t instanceof th)n=t;else{const o=BT(t);if(!o)throw new Error("Unrecognized data format for font.");n=o.parse(t)}e instanceof ct&&(e=[e]);const s=new Ar(n,e,i);return Ar.available[s.font]=s,s}static uninstall(t){const e=Ar.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete Ar.available[t]}static from(t,e,i){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:n,padding:s,resolution:o,textureWidth:a,textureHeight:h,...l}=Object.assign({},Ar.defaultOptions,i),u=GT(n),c=e instanceof Ni?e:new Ni(e),d=a,f=new th;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};let p=0,m=0,g,v,w,_=0;const T=[];for(let x=0;x<u.length;x++){g||(g=ot.ADAPTER.createCanvas(),g.width=a,g.height=h,v=g.getContext("2d"),w=new vt(g,{resolution:o,...l}),T.push(new ct(w)),f.page.push({id:T.length-1,file:""}));const y=u[x],S=bi.measureText(y,c,!1,g),D=S.width,G=Math.ceil(S.height),O=Math.ceil((c.fontStyle==="italic"?2:1)*D);if(m>=h-G*o){if(m===0)throw new Error(`[BitmapFont] textureHeight ${h}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${y}')`);--x,g=null,v=null,w=null,m=0,p=0,_=0;continue}if(_=Math.max(G+S.fontProperties.descent,_),O*o+p>=d){if(p===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${y}')`);--x,m+=_*o,m=Math.ceil(m),p=0,_=0;continue}HT(g,v,S,p,m,o,c);const N=Ca(S.text);f.char.push({id:N,page:T.length-1,x:p/o,y:m/o,width:O,height:G,xoffset:0,yoffset:0,xadvance:D-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),p+=(O+2*s)*o,p=Math.ceil(p)}if(!i?.skipKerning)for(let x=0,y=u.length;x<y;x++){const S=u[x];for(let D=0;D<y;D++){const G=u[D],O=v.measureText(S).width,N=v.measureText(G).width,P=v.measureText(S+G).width-(O+N);P&&f.kerning.push({first:Ca(S),second:Ca(G),amount:P})}}const b=new Ar(f,T,!0);return Ar.available[t]!==void 0&&Ar.uninstall(t),Ar.available[t]=b,b}};wi.ALPHA=[["a","z"],["A","Z"]," "],wi.NUMERIC=[["0","9"]],wi.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],wi.ASCII=[[" ","~"]],wi.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:wi.ALPHANUMERIC},wi.available={};let Ve=wi;var zT=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,jT=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const lm=[],um=[],cm=[],hy=class ly extends bt{constructor(t,e={}){super();const{align:i,tint:n,maxWidth:s,letterSpacing:o,fontName:a,fontSize:h}=Object.assign({},ly.styleDefaults,e);if(!Ve.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new kt(n),this._font=void 0,this._fontName=a,this._fontSize=h,this.text=t,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new Kr(()=>{this.dirty=!0},this,0,0),this._roundPixels=ot.ROUND_PIXELS,this.dirty=!0,this._resolution=ot.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){const t=Ve.available[this._fontName],e=this.fontSize,i=e/t.size,n=new mt,s=[],o=[],a=[],h=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",l=ay(h),u=this._maxWidth*t.size/e,c=t.distanceFieldType==="none"?lm:um;let d=null,f=0,p=0,m=0,g=-1,v=0,w=0,_=0,T=0;for(let O=0;O<l.length;O++){const N=l[O],P=Ca(N);if(/(?:\s)/.test(N)&&(g=O,v=f,T++),N==="\r"||N===`
`){o.push(f),a.push(-1),p=Math.max(p,f),++m,++w,n.x=0,n.y+=t.lineHeight,d=null,T=0;continue}const F=t.chars[P];if(!F)continue;d&&F.kerning[d]&&(n.x+=F.kerning[d]);const j=cm.pop()||{texture:ct.EMPTY,line:0,charCode:0,prevSpaces:0,position:new mt};j.texture=F.texture,j.line=m,j.charCode=P,j.position.x=Math.round(n.x+F.xOffset+this._letterSpacing/2),j.position.y=Math.round(n.y+F.yOffset),j.prevSpaces=T,s.push(j),f=j.position.x+Math.max(F.xAdvance-F.xOffset,F.texture.orig.width),n.x+=F.xAdvance+this._letterSpacing,_=Math.max(_,F.yOffset+F.texture.height),d=P,g!==-1&&u>0&&n.x>u&&(++w,Jn(s,1+g-w,1+O-g),O=g,g=-1,o.push(v),a.push(s.length>0?s[s.length-1].prevSpaces:0),p=Math.max(p,v),m++,n.x=0,n.y+=t.lineHeight,d=null,T=0)}const b=l[l.length-1];b!=="\r"&&b!==`
`&&(/(?:\s)/.test(b)&&(f=v),o.push(f),p=Math.max(p,f),a.push(-1));const x=[];for(let O=0;O<=m;O++){let N=0;this._align==="right"?N=p-o[O]:this._align==="center"?N=(p-o[O])/2:this._align==="justify"&&(N=a[O]<0?0:(p-o[O])/a[O]),x.push(N)}const y=s.length,S={},D=[],G=this._activePagesMeshData;c.push(...G);for(let O=0;O<y;O++){const N=s[O].texture,P=N.baseTexture.uid;if(!S[P]){let F=c.pop();if(!F){const E=new q0;let A,C;t.distanceFieldType==="none"?(A=new Zu(ct.EMPTY),C=gt.NORMAL):(A=new Zu(ct.EMPTY,{program:Qr.from(jT,zT),uniforms:{uFWidth:0}}),C=gt.NORMAL_NPM);const B=new qu(E,A);B.blendMode=C,F={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:B,vertices:null,uvs:null,indices:null}}F.index=0,F.indexCount=0,F.vertexCount=0,F.uvsCount=0,F.total=0;const{_textureCache:j}=this;j[P]=j[P]||new ct(N.baseTexture),F.mesh.texture=j[P],F.mesh.tint=this._tintColor.value,D.push(F),S[P]=F}S[P].total++}for(let O=0;O<G.length;O++)D.includes(G[O])||this.removeChild(G[O].mesh);for(let O=0;O<D.length;O++)D[O].mesh.parent!==this&&this.addChild(D[O].mesh);this._activePagesMeshData=D;for(const O in S){const N=S[O],P=N.total;if(!(N.indices?.length>6*P)||N.vertices.length<qu.BATCHABLE_SIZE*2)N.vertices=new Float32Array(8*P),N.uvs=new Float32Array(8*P),N.indices=new Uint16Array(6*P);else{const F=N.total,j=N.vertices;for(let E=F*4*2;E<j.length;E++)j[E]=0}N.mesh.size=6*P}for(let O=0;O<y;O++){const N=s[O];let P=N.position.x+x[N.line]*(this._align==="justify"?N.prevSpaces:1);this._roundPixels&&(P=Math.round(P));const F=P*i,j=N.position.y*i,E=N.texture,A=S[E.baseTexture.uid],C=E.frame,B=E._uvs,I=A.index++;A.indices[I*6+0]=0+I*4,A.indices[I*6+1]=1+I*4,A.indices[I*6+2]=2+I*4,A.indices[I*6+3]=0+I*4,A.indices[I*6+4]=2+I*4,A.indices[I*6+5]=3+I*4,A.vertices[I*8+0]=F,A.vertices[I*8+1]=j,A.vertices[I*8+2]=F+C.width*i,A.vertices[I*8+3]=j,A.vertices[I*8+4]=F+C.width*i,A.vertices[I*8+5]=j+C.height*i,A.vertices[I*8+6]=F,A.vertices[I*8+7]=j+C.height*i,A.uvs[I*8+0]=B.x0,A.uvs[I*8+1]=B.y0,A.uvs[I*8+2]=B.x1,A.uvs[I*8+3]=B.y1,A.uvs[I*8+4]=B.x2,A.uvs[I*8+5]=B.y2,A.uvs[I*8+6]=B.x3,A.uvs[I*8+7]=B.y3}this._textWidth=p*i,this._textHeight=(n.y+t.lineHeight)*i;for(const O in S){const N=S[O];if(this.anchor.x!==0||this.anchor.y!==0){let E=0;const A=this._textWidth*this.anchor.x,C=this._textHeight*this.anchor.y;for(let B=0;B<N.total;B++)N.vertices[E++]-=A,N.vertices[E++]-=C,N.vertices[E++]-=A,N.vertices[E++]-=C,N.vertices[E++]-=A,N.vertices[E++]-=C,N.vertices[E++]-=A,N.vertices[E++]-=C}this._maxLineHeight=_*i;const P=N.mesh.geometry.getBuffer("aVertexPosition"),F=N.mesh.geometry.getBuffer("aTextureCoord"),j=N.mesh.geometry.getIndex();P.data=N.vertices,F.data=N.uvs,j.data=N.indices,P.update(),F.update(),j.update()}for(let O=0;O<s.length;O++)cm.push(s[O]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:i,size:n}=Ve.available[this._fontName];if(i!=="none"){const{a:s,b:o,c:a,d:h}=this.worldTransform,l=Math.sqrt(s*s+o*o),u=Math.sqrt(a*a+h*h),c=(Math.abs(l)+Math.abs(u))/2,d=this.fontSize/n,f=t._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=c*e*d*f}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=Ve.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!Ve.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??Ve.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,i=Ve.available[this._fontName].distanceFieldType==="none"?lm:um;i.push(...this._activePagesMeshData);for(const n of this._activePagesMeshData)this.removeChild(n.mesh);this._activePagesMeshData=[],i.filter(n=>e[n.mesh.texture.baseTexture.uid]).forEach(n=>{n.mesh.texture=ct.EMPTY});for(const n in e)e[n].destroy(),delete e[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};hy.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};let WT=hy;const XT=[".xml",".fnt"],VT={extension:{type:it.LoadParser,priority:yr.Normal},name:"loadBitmapFont",test(r){return XT.includes(ie.extname(r).toLowerCase())},async testParse(r){return Sa.test(r)||tc.test(r)},async parse(r,t,e){const i=Sa.test(r)?Sa.parse(r):tc.parse(r),{src:n}=t,{page:s}=i,o=[];for(let l=0;l<s.length;++l){const u=s[l].file;let c=ie.join(ie.dirname(n),u);c=Vu(c,n),o.push(c)}const a=await e.load(o),h=o.map(l=>a[l]);return Ve.install(i,h,!0)},async load(r,t){return(await ot.ADAPTER.fetch(r)).text()},unload(r){r.destroy()}};dt.add(VT);const ec=class Wn extends Ni{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new Wn(Object.keys(Wn.defaultOptions).reduce((e,i)=>({...e,[i]:t[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete Wn.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:i}=Wn;if(i[t]){const n=i[t];return this._fonts.push(n),n.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return ot.ADAPTER.fetch(t).then(n=>n.blob()).then(async n=>new Promise((s,o)=>{const a=URL.createObjectURL(n),h=new FileReader;h.onload=()=>s([a,h.result]),h.onerror=o,h.readAsDataURL(n)})).then(async([n,s])=>{const o=Object.assign({family:ie.basename(t,ie.extname(t)),weight:"normal",style:"normal",display:"auto",src:n,dataSrc:s,refs:1,originalUrl:t,fontFace:null},e);i[t]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){const e=t.filter(i=>!this._overrides.includes(i));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(i=>this._overrides.includes(i));e.length>0&&(this._overrides=this._overrides.filter(i=>!e.includes(i)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}
            @font-face {
                font-family: "${e.family}";
                src: url('${e.dataSrc}');
                font-weight: ${e.weight};
                font-style: ${e.style};
                font-display: ${e.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=Fw(t)),typeof t=="number"?Nw(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),n=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(e*255|0).toString(16).padStart(2,"0"));const s=`${i}px ${n}px`;return this.dropShadowBlur>0?`text-shadow: ${s} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${s} ${t}`}reset(){Object.assign(this,Wn.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=ot.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};ec.availableFonts={},ec.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let Zl=ec;const da=class Xn extends Yt{constructor(t="",e={}){super(ct.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,n=ct.from(i,{scaleMode:ot.SCALE_MODE,resourceOptions:{autoLoad:!1}});n.orig=new yt,n.trim=new yt,this.texture=n;const s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),h=document.createElementNS(s,"foreignObject"),l=document.createElementNS(o,"div"),u=document.createElementNS(o,"style");h.setAttribute("width","10000"),h.setAttribute("height","10000"),h.style.overflow="hidden",a.appendChild(h),this.maxWidth=Xn.defaultMaxWidth,this.maxHeight=Xn.defaultMaxHeight,this._domElement=l,this._styleElement=u,this._svgRoot=a,this._foreignObject=h,this._foreignObject.appendChild(u),this._foreignObject.appendChild(l),this._image=i,this._loadImage=new Image,this._autoResolution=Xn.defaultAutoResolution,this._resolution=Xn.defaultResolution??ot.RESOLUTION,this.text=t,this.style=e}measureText(t){const{text:e,style:i,resolution:n}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:i.toCSS(n)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const s=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=s;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const h=Math.min(this.maxWidth,Math.ceil(o)),l=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",h.toString()),this._svgRoot.setAttribute("height",l.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(n)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:h+i.padding*2,height:l+i.padding*2}}async updateText(t=!0){const{style:e,_image:i,_loadImage:n}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:s,height:o}=this.measureText();i.width=n.width=Math.ceil(Math.max(1,s)),i.height=n.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(h=>{n.onload=async()=>{if(a<this._updateID){h();return}await e.onBeforeDraw(),i.src=n.src,n.onload=null,n.src="",this.updateTexture(),h()};const l=new XMLSerializer().serializeToString(this._svgRoot);n.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(l)}`})}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:i,resolution:n}=this,{padding:s}=t,{baseTexture:o}=e;e.trim.width=e._frame.width=i.width/n,e.trim.height=e._frame.height=i.height/n,e.trim.x=-s,e.trim.y=-s,e.orig.width=e._frame.width-s*2,e.orig.height=e._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(i.width,i.height,n),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Xn.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&this._style?.cleanFonts(),this._style=e,this._svgRoot?.remove(),this._svgRoot=e,this._domElement?.remove(),this._domElement=e,this._foreignObject?.remove(),this._foreignObject=e,this._styleElement?.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=Ei(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=Ei(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof Zl?(this.ownsStyle=!1,this._style=t):t instanceof Ni?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=Zl.from(t)):(this.ownsStyle=!0,this._style=new Zl(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};da.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},da.defaultMaxWidth=2024,da.defaultMaxHeight=2024,da.defaultAutoResolution=!0;function $T(){const r=new Map;function t(o,a){const h=r.get(o);return h?h.add(a):r.set(o,new Set([a])),()=>i(o,a)}function e(o,a){const h=l=>{i(o,h),a(l)};t(o,h)}function i(o,a){r.get(o)?.delete(a)}function n(o,a){r.get(o)?.forEach(h=>h(a))}function s(){r.clear()}return{on:t,off:i,once:e,emit:n,clear:s}}const rt=$T();function Re(r){let t;return new Promise(e=>{t=e,rt.on(r,t)}).then(e=>(rt.off(r,t),e))}let ei=null;const uy=new ResizeObserver(()=>{ei&&rt.emit("stageUpdated",ei)});function YT(r){ei=r,uy.observe(ei),rt.emit("stageCreated",ei)}function qT(){ei&&uy.unobserve(ei),ei=null}async function Wc(){return ei||await Re("stageCreated")}let $e=null;async function ZT(){const r=await Wc();QT(r),rt.on("stageUpdated",JT)}function KT(){$e&&($e.destroy(!0,{children:!0}),$e=null)}function QT(r){$e||($e=new U0({backgroundAlpha:0,resizeTo:r,antialias:!0,resolution:Math.ceil(window.devicePixelRatio)}),$e.stage.sortableChildren=!0,r.appendChild($e.view),rt.emit("applicationCreated",$e))}async function Qt(){return $e||await Re("applicationCreated")}function JT(r){$e&&($e.resizeTo=r,rt.emit("applicationResized",$e))}let Ma=new Map;function tE(){Ma=new Map}async function So(r,t){const e=`${r.toString()}-${JSON.stringify(t)}`;if(Ma.has(e))return Ma.get(e);const i=await r(...t);return Ma.set(e,i),i}let eo=null;const eE={animationDuration:500,disableAnimationsThreshold:500,disableEdgesThreshold:500,fetchEvents:()=>[],fetchEventsInterval:3e4,theme:"dark"};function rE(r){return{...eE,...r}}function iE(r){nE(r)}function nE(r){const t=rE(r);if(!eo){eo=t,rt.emit("configCreated",t);return}Object.assign(eo,t),rt.emit("configUpdated",t)}function sE(){eo=null}async function Ue(){return eo||await Re("configCreated")}const Zi=new yt;class oE{constructor(t={}){this._recursive=typeof t.recursive=="boolean"?t.recursive:!0,this._toggle=t.toggle||"visible",this._targetList=new Set}add(t){return this._targetList.add(t),this}addAll(t){for(let e=0,i=t.length;e<i;e++)this._targetList.add(t[e]);return this}remove(t){return this._targetList.delete(t),this}removeAll(t){for(let e=0,i=t.length;e<i;e++)this._targetList.delete(t[e]);return this}clear(){return this._targetList.clear(),this}cull(t,e=!1){return e||this.uncull(),this._targetList.forEach(i=>{e||i.getBounds(!1,Zi),this._recursive?this.cullRecursive(t,i,e):(e&&i._bounds.getRectangle(t),i[this._toggle]=Zi.right>t.left&&Zi.left<t.right&&Zi.bottom>t.top&&Zi.top<t.bottom)}),this}uncull(){return this._targetList.forEach(t=>{this._recursive?this.uncullRecursive(t):t[this._toggle]=!1}),this}cullRecursive(t,e,i){const n=i?e._bounds.getRectangle(Zi):e.getBounds(!0,Zi);if(e[this._toggle]=n.right>t.left&&n.left<t.right&&n.bottom>t.top&&n.top<t.bottom,!(n.left>=t.left&&n.top>=t.top&&n.right<=t.right&&n.bottom<=t.bottom)&&e[this._toggle]&&e.children&&e.children.length){const s=e.children;for(let o=0,a=s.length;o<a;o++)this.cullRecursive(t,s[o])}}uncullRecursive(t){if(t[this._toggle]=!0,t.children&&t.children.length){const e=t.children;for(let i=0,n=e.length;i<n;i++)this.uncullRecursive(e[i])}}}var Ra={exports:{}};Ra.exports;var dm;function aE(){return dm||(dm=1,(function(r,t){var e=200,i="__lodash_hash_undefined__",n=1,s=2,o=9007199254740991,a="[object Arguments]",h="[object Array]",l="[object AsyncFunction]",u="[object Boolean]",c="[object Date]",d="[object Error]",f="[object Function]",p="[object GeneratorFunction]",m="[object Map]",g="[object Number]",v="[object Null]",w="[object Object]",_="[object Promise]",T="[object Proxy]",b="[object RegExp]",x="[object Set]",y="[object String]",S="[object Symbol]",D="[object Undefined]",G="[object WeakMap]",O="[object ArrayBuffer]",N="[object DataView]",P="[object Float32Array]",F="[object Float64Array]",j="[object Int8Array]",E="[object Int16Array]",A="[object Int32Array]",C="[object Uint8Array]",B="[object Uint8ClampedArray]",I="[object Uint16Array]",M="[object Uint32Array]",k=/[\\^$.*+?()[\]{}|]/g,L=/^\[object .+?Constructor\]$/,V=/^(?:0|[1-9]\d*)$/,$={};$[P]=$[F]=$[j]=$[E]=$[A]=$[C]=$[B]=$[I]=$[M]=!0,$[a]=$[h]=$[O]=$[u]=$[N]=$[c]=$[d]=$[f]=$[m]=$[g]=$[w]=$[b]=$[x]=$[y]=$[G]=!1;var tt=typeof qe=="object"&&qe&&qe.Object===Object&&qe,et=typeof self=="object"&&self&&self.Object===Object&&self,K=tt||et||Function("return this")(),U=t&&!t.nodeType&&t,X=U&&!0&&r&&!r.nodeType&&r,q=X&&X.exports===U,z=q&&tt.process,at=(function(){try{return z&&z.binding&&z.binding("util")}catch{}})(),nt=at&&at.isTypedArray;function J(R,H){for(var Z=-1,lt=R==null?0:R.length,Ot=0,xt=[];++Z<lt;){var Wt=R[Z];H(Wt,Z,R)&&(xt[Ot++]=Wt)}return xt}function ht(R,H){for(var Z=-1,lt=H.length,Ot=R.length;++Z<lt;)R[Ot+Z]=H[Z];return R}function Ct(R,H){for(var Z=-1,lt=R==null?0:R.length;++Z<lt;)if(H(R[Z],Z,R))return!0;return!1}function Pt(R,H){for(var Z=-1,lt=Array(R);++Z<R;)lt[Z]=H(Z);return lt}function ir(R){return function(H){return R(H)}}function xe(R,H){return R.has(H)}function ci(R,H){return R?.[H]}function di(R){var H=-1,Z=Array(R.size);return R.forEach(function(lt,Ot){Z[++H]=[Ot,lt]}),Z}function fi(R,H){return function(Z){return R(H(Z))}}function Xh(R){var H=-1,Z=Array(R.size);return R.forEach(function(lt){Z[++H]=lt}),Z}var Vh=Array.prototype,$h=Function.prototype,Hi=Object.prototype,ws=K["__core-js_shared__"],pi=$h.toString,we=Hi.hasOwnProperty,bs=(function(){var R=/[^.]+$/.exec(ws&&ws.keys&&ws.keys.IE_PROTO||"");return R?"Symbol(src)_1."+R:""})(),Do=Hi.toString,Yh=RegExp("^"+pi.call(we).replace(k,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),On=q?K.Buffer:void 0,Gr=K.Symbol,W=K.Uint8Array,Y=Hi.propertyIsEnumerable,At=Vh.splice,Et=Gr?Gr.toStringTag:void 0,Rt=Object.getOwnPropertySymbols,_t=On?On.isBuffer:void 0,_r=fi(Object.keys,Object),nr=Nn(K,"DataView"),te=Nn(K,"Map"),He=Nn(K,"Promise"),Gi=Nn(K,"Set"),xr=Nn(K,"WeakMap"),ue=Nn(Object,"create"),Oo=Xi(nr),ko=Xi(te),No=Xi(He),zi=Xi(Gi),Ts=Xi(xr),ji=Gr?Gr.prototype:void 0,Wi=ji?ji.valueOf:void 0;function sr(R){var H=-1,Z=R==null?0:R.length;for(this.clear();++H<Z;){var lt=R[H];this.set(lt[0],lt[1])}}function Fo(){this.__data__=ue?ue(null):{},this.size=0}function Lo(R){var H=this.has(R)&&delete this.__data__[R];return this.size-=H?1:0,H}function Es(R){var H=this.__data__;if(ue){var Z=H[R];return Z===i?void 0:Z}return we.call(H,R)?H[R]:void 0}function Bo(R){var H=this.__data__;return ue?H[R]!==void 0:we.call(H,R)}function As(R,H){var Z=this.__data__;return this.size+=this.has(R)?0:1,Z[R]=ue&&H===void 0?i:H,this}sr.prototype.clear=Fo,sr.prototype.delete=Lo,sr.prototype.get=Es,sr.prototype.has=Bo,sr.prototype.set=As;function Ge(R){var H=-1,Z=R==null?0:R.length;for(this.clear();++H<Z;){var lt=R[H];this.set(lt[0],lt[1])}}function qh(){this.__data__=[],this.size=0}function Ss(R){var H=this.__data__,Z=Ho(H,R);if(Z<0)return!1;var lt=H.length-1;return Z==lt?H.pop():At.call(H,Z,1),--this.size,!0}function mi(R){var H=this.__data__,Z=Ho(H,R);return Z<0?void 0:H[Z][1]}function kn(R){return Ho(this.__data__,R)>-1}function Zh(R,H){var Z=this.__data__,lt=Ho(Z,R);return lt<0?(++this.size,Z.push([R,H])):Z[lt][1]=H,this}Ge.prototype.clear=qh,Ge.prototype.delete=Ss,Ge.prototype.get=mi,Ge.prototype.has=kn,Ge.prototype.set=Zh;function wr(R){var H=-1,Z=R==null?0:R.length;for(this.clear();++H<Z;){var lt=R[H];this.set(lt[0],lt[1])}}function R_(){this.size=0,this.__data__={hash:new sr,map:new(te||Ge),string:new sr}}function P_(R){var H=Go(this,R).delete(R);return this.size-=H?1:0,H}function I_(R){return Go(this,R).get(R)}function D_(R){return Go(this,R).has(R)}function O_(R,H){var Z=Go(this,R),lt=Z.size;return Z.set(R,H),this.size+=Z.size==lt?0:1,this}wr.prototype.clear=R_,wr.prototype.delete=P_,wr.prototype.get=I_,wr.prototype.has=D_,wr.prototype.set=O_;function Uo(R){var H=-1,Z=R==null?0:R.length;for(this.__data__=new wr;++H<Z;)this.add(R[H])}function k_(R){return this.__data__.set(R,i),this}function N_(R){return this.__data__.has(R)}Uo.prototype.add=Uo.prototype.push=k_,Uo.prototype.has=N_;function gi(R){var H=this.__data__=new Ge(R);this.size=H.size}function F_(){this.__data__=new Ge,this.size=0}function L_(R){var H=this.__data__,Z=H.delete(R);return this.size=H.size,Z}function B_(R){return this.__data__.get(R)}function U_(R){return this.__data__.has(R)}function H_(R,H){var Z=this.__data__;if(Z instanceof Ge){var lt=Z.__data__;if(!te||lt.length<e-1)return lt.push([R,H]),this.size=++Z.size,this;Z=this.__data__=new wr(lt)}return Z.set(R,H),this.size=Z.size,this}gi.prototype.clear=F_,gi.prototype.delete=L_,gi.prototype.get=B_,gi.prototype.has=U_,gi.prototype.set=H_;function G_(R,H){var Z=zo(R),lt=!Z&&rx(R),Ot=!Z&&!lt&&Kh(R),xt=!Z&&!lt&&!Ot&&Fd(R),Wt=Z||lt||Ot||xt,se=Wt?Pt(R.length,String):[],ce=se.length;for(var Lt in R)we.call(R,Lt)&&!(Wt&&(Lt=="length"||Ot&&(Lt=="offset"||Lt=="parent")||xt&&(Lt=="buffer"||Lt=="byteLength"||Lt=="byteOffset")||K_(Lt,ce)))&&se.push(Lt);return se}function Ho(R,H){for(var Z=R.length;Z--;)if(Dd(R[Z][0],H))return Z;return-1}function z_(R,H,Z){var lt=H(R);return zo(R)?lt:ht(lt,Z(R))}function Cs(R){return R==null?R===void 0?D:v:Et&&Et in Object(R)?q_(R):ex(R)}function Md(R){return Ms(R)&&Cs(R)==a}function Rd(R,H,Z,lt,Ot){return R===H?!0:R==null||H==null||!Ms(R)&&!Ms(H)?R!==R&&H!==H:j_(R,H,Z,lt,Rd,Ot)}function j_(R,H,Z,lt,Ot,xt){var Wt=zo(R),se=zo(H),ce=Wt?h:yi(R),Lt=se?h:yi(H);ce=ce==a?w:ce,Lt=Lt==a?w:Lt;var Pe=ce==w,or=Lt==w,fe=ce==Lt;if(fe&&Kh(R)){if(!Kh(H))return!1;Wt=!0,Pe=!1}if(fe&&!Pe)return xt||(xt=new gi),Wt||Fd(R)?Pd(R,H,Z,lt,Ot,xt):$_(R,H,ce,Z,lt,Ot,xt);if(!(Z&n)){var ze=Pe&&we.call(R,"__wrapped__"),je=or&&we.call(H,"__wrapped__");if(ze||je){var vi=ze?R.value():R,zr=je?H.value():H;return xt||(xt=new gi),Ot(vi,zr,Z,lt,xt)}}return fe?(xt||(xt=new gi),Y_(R,H,Z,lt,Ot,xt)):!1}function W_(R){if(!Nd(R)||J_(R))return!1;var H=Od(R)?Yh:L;return H.test(Xi(R))}function X_(R){return Ms(R)&&kd(R.length)&&!!$[Cs(R)]}function V_(R){if(!tx(R))return _r(R);var H=[];for(var Z in Object(R))we.call(R,Z)&&Z!="constructor"&&H.push(Z);return H}function Pd(R,H,Z,lt,Ot,xt){var Wt=Z&n,se=R.length,ce=H.length;if(se!=ce&&!(Wt&&ce>se))return!1;var Lt=xt.get(R);if(Lt&&xt.get(H))return Lt==H;var Pe=-1,or=!0,fe=Z&s?new Uo:void 0;for(xt.set(R,H),xt.set(H,R);++Pe<se;){var ze=R[Pe],je=H[Pe];if(lt)var vi=Wt?lt(je,ze,Pe,H,R,xt):lt(ze,je,Pe,R,H,xt);if(vi!==void 0){if(vi)continue;or=!1;break}if(fe){if(!Ct(H,function(zr,Vi){if(!xe(fe,Vi)&&(ze===zr||Ot(ze,zr,Z,lt,xt)))return fe.push(Vi)})){or=!1;break}}else if(!(ze===je||Ot(ze,je,Z,lt,xt))){or=!1;break}}return xt.delete(R),xt.delete(H),or}function $_(R,H,Z,lt,Ot,xt,Wt){switch(Z){case N:if(R.byteLength!=H.byteLength||R.byteOffset!=H.byteOffset)return!1;R=R.buffer,H=H.buffer;case O:return!(R.byteLength!=H.byteLength||!xt(new W(R),new W(H)));case u:case c:case g:return Dd(+R,+H);case d:return R.name==H.name&&R.message==H.message;case b:case y:return R==H+"";case m:var se=di;case x:var ce=lt&n;if(se||(se=Xh),R.size!=H.size&&!ce)return!1;var Lt=Wt.get(R);if(Lt)return Lt==H;lt|=s,Wt.set(R,H);var Pe=Pd(se(R),se(H),lt,Ot,xt,Wt);return Wt.delete(R),Pe;case S:if(Wi)return Wi.call(R)==Wi.call(H)}return!1}function Y_(R,H,Z,lt,Ot,xt){var Wt=Z&n,se=Id(R),ce=se.length,Lt=Id(H),Pe=Lt.length;if(ce!=Pe&&!Wt)return!1;for(var or=ce;or--;){var fe=se[or];if(!(Wt?fe in H:we.call(H,fe)))return!1}var ze=xt.get(R);if(ze&&xt.get(H))return ze==H;var je=!0;xt.set(R,H),xt.set(H,R);for(var vi=Wt;++or<ce;){fe=se[or];var zr=R[fe],Vi=H[fe];if(lt)var Ld=Wt?lt(Vi,zr,fe,H,R,xt):lt(zr,Vi,fe,R,H,xt);if(!(Ld===void 0?zr===Vi||Ot(zr,Vi,Z,lt,xt):Ld)){je=!1;break}vi||(vi=fe=="constructor")}if(je&&!vi){var jo=R.constructor,Wo=H.constructor;jo!=Wo&&"constructor"in R&&"constructor"in H&&!(typeof jo=="function"&&jo instanceof jo&&typeof Wo=="function"&&Wo instanceof Wo)&&(je=!1)}return xt.delete(R),xt.delete(H),je}function Id(R){return z_(R,sx,Z_)}function Go(R,H){var Z=R.__data__;return Q_(H)?Z[typeof H=="string"?"string":"hash"]:Z.map}function Nn(R,H){var Z=ci(R,H);return W_(Z)?Z:void 0}function q_(R){var H=we.call(R,Et),Z=R[Et];try{R[Et]=void 0;var lt=!0}catch{}var Ot=Do.call(R);return lt&&(H?R[Et]=Z:delete R[Et]),Ot}var Z_=Rt?function(R){return R==null?[]:(R=Object(R),J(Rt(R),function(H){return Y.call(R,H)}))}:ox,yi=Cs;(nr&&yi(new nr(new ArrayBuffer(1)))!=N||te&&yi(new te)!=m||He&&yi(He.resolve())!=_||Gi&&yi(new Gi)!=x||xr&&yi(new xr)!=G)&&(yi=function(R){var H=Cs(R),Z=H==w?R.constructor:void 0,lt=Z?Xi(Z):"";if(lt)switch(lt){case Oo:return N;case ko:return m;case No:return _;case zi:return x;case Ts:return G}return H});function K_(R,H){return H=H??o,!!H&&(typeof R=="number"||V.test(R))&&R>-1&&R%1==0&&R<H}function Q_(R){var H=typeof R;return H=="string"||H=="number"||H=="symbol"||H=="boolean"?R!=="__proto__":R===null}function J_(R){return!!bs&&bs in R}function tx(R){var H=R&&R.constructor,Z=typeof H=="function"&&H.prototype||Hi;return R===Z}function ex(R){return Do.call(R)}function Xi(R){if(R!=null){try{return pi.call(R)}catch{}try{return R+""}catch{}}return""}function Dd(R,H){return R===H||R!==R&&H!==H}var rx=Md((function(){return arguments})())?Md:function(R){return Ms(R)&&we.call(R,"callee")&&!Y.call(R,"callee")},zo=Array.isArray;function ix(R){return R!=null&&kd(R.length)&&!Od(R)}var Kh=_t||ax;function nx(R,H){return Rd(R,H)}function Od(R){if(!Nd(R))return!1;var H=Cs(R);return H==f||H==p||H==l||H==T}function kd(R){return typeof R=="number"&&R>-1&&R%1==0&&R<=o}function Nd(R){var H=typeof R;return R!=null&&(H=="object"||H=="function")}function Ms(R){return R!=null&&typeof R=="object"}var Fd=nt?ir(nt):X_;function sx(R){return ix(R)?G_(R):V_(R)}function ox(){return[]}function ax(){return!1}r.exports=nx})(Ra,Ra.exports)),Ra.exports}var hE=aE();const cy=bo(hE);class er{constructor(t){this.parent=t,this.paused=!1}destroy(){}down(t){return!1}move(t){return!1}up(t){return!1}wheel(t){return!1}update(t){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}var lE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uE(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var dy={exports:{}};(function(r,t){(function(){var e,i;i=function(n){return r.exports=n},e={linear:function(n,s,o,a){return o*n/a+s},easeInQuad:function(n,s,o,a){return o*(n/=a)*n+s},easeOutQuad:function(n,s,o,a){return-o*(n/=a)*(n-2)+s},easeInOutQuad:function(n,s,o,a){return(n/=a/2)<1?o/2*n*n+s:-o/2*(--n*(n-2)-1)+s},easeInCubic:function(n,s,o,a){return o*(n/=a)*n*n+s},easeOutCubic:function(n,s,o,a){return o*((n=n/a-1)*n*n+1)+s},easeInOutCubic:function(n,s,o,a){return(n/=a/2)<1?o/2*n*n*n+s:o/2*((n-=2)*n*n+2)+s},easeInQuart:function(n,s,o,a){return o*(n/=a)*n*n*n+s},easeOutQuart:function(n,s,o,a){return-o*((n=n/a-1)*n*n*n-1)+s},easeInOutQuart:function(n,s,o,a){return(n/=a/2)<1?o/2*n*n*n*n+s:-o/2*((n-=2)*n*n*n-2)+s},easeInQuint:function(n,s,o,a){return o*(n/=a)*n*n*n*n+s},easeOutQuint:function(n,s,o,a){return o*((n=n/a-1)*n*n*n*n+1)+s},easeInOutQuint:function(n,s,o,a){return(n/=a/2)<1?o/2*n*n*n*n*n+s:o/2*((n-=2)*n*n*n*n+2)+s},easeInSine:function(n,s,o,a){return-o*Math.cos(n/a*(Math.PI/2))+o+s},easeOutSine:function(n,s,o,a){return o*Math.sin(n/a*(Math.PI/2))+s},easeInOutSine:function(n,s,o,a){return-o/2*(Math.cos(Math.PI*n/a)-1)+s},easeInExpo:function(n,s,o,a){return n===0?s:o*Math.pow(2,10*(n/a-1))+s},easeOutExpo:function(n,s,o,a){return n===a?s+o:o*(-Math.pow(2,-10*n/a)+1)+s},easeInOutExpo:function(n,s,o,a){return(n/=a/2)<1?o/2*Math.pow(2,10*(n-1))+s:o/2*(-Math.pow(2,-10*--n)+2)+s},easeInCirc:function(n,s,o,a){return-o*(Math.sqrt(1-(n/=a)*n)-1)+s},easeOutCirc:function(n,s,o,a){return o*Math.sqrt(1-(n=n/a-1)*n)+s},easeInOutCirc:function(n,s,o,a){return(n/=a/2)<1?-o/2*(Math.sqrt(1-n*n)-1)+s:o/2*(Math.sqrt(1-(n-=2)*n)+1)+s},easeInElastic:function(n,s,o,a){var h,l,u;return u=1.70158,l=0,h=o,n===0||(n/=a),l||(l=a*.3),h<Math.abs(o)?(h=o,u=l/4):u=l/(2*Math.PI)*Math.asin(o/h),-(h*Math.pow(2,10*(n-=1))*Math.sin((n*a-u)*(2*Math.PI)/l))+s},easeOutElastic:function(n,s,o,a){var h,l,u;return u=1.70158,l=0,h=o,n===0||(n/=a),l||(l=a*.3),h<Math.abs(o)?(h=o,u=l/4):u=l/(2*Math.PI)*Math.asin(o/h),h*Math.pow(2,-10*n)*Math.sin((n*a-u)*(2*Math.PI)/l)+o+s},easeInOutElastic:function(n,s,o,a){var h,l,u;return u=1.70158,l=0,h=o,n===0||(n/=a/2),l||(l=a*(.3*1.5)),h<Math.abs(o)?(h=o,u=l/4):u=l/(2*Math.PI)*Math.asin(o/h),n<1?-.5*(h*Math.pow(2,10*(n-=1))*Math.sin((n*a-u)*(2*Math.PI)/l))+s:h*Math.pow(2,-10*(n-=1))*Math.sin((n*a-u)*(2*Math.PI)/l)*.5+o+s},easeInBack:function(n,s,o,a,h){return h===void 0&&(h=1.70158),o*(n/=a)*n*((h+1)*n-h)+s},easeOutBack:function(n,s,o,a,h){return h===void 0&&(h=1.70158),o*((n=n/a-1)*n*((h+1)*n+h)+1)+s},easeInOutBack:function(n,s,o,a,h){return h===void 0&&(h=1.70158),(n/=a/2)<1?o/2*(n*n*(((h*=1.525)+1)*n-h))+s:o/2*((n-=2)*n*(((h*=1.525)+1)*n+h)+2)+s},easeInBounce:function(n,s,o,a){var h;return h=e.easeOutBounce(a-n,0,o,a),o-h+s},easeOutBounce:function(n,s,o,a){return(n/=a)<1/2.75?o*(7.5625*n*n)+s:n<2/2.75?o*(7.5625*(n-=1.5/2.75)*n+.75)+s:n<2.5/2.75?o*(7.5625*(n-=2.25/2.75)*n+.9375)+s:o*(7.5625*(n-=2.625/2.75)*n+.984375)+s},easeInOutBounce:function(n,s,o,a){var h;return n<a/2?(h=e.easeInBounce(n*2,0,o,a),h*.5+s):(h=e.easeOutBounce(n*2-a,0,o,a),h*.5+o*.5+s)}},i(e)}).call(lE)})(dy);var cE=dy.exports;const fm=uE(cE);function kh(r,t){if(r){if(typeof r=="function")return r;if(typeof r=="string")return fm[r]}else return fm[t]}const dE={removeOnInterrupt:!1,ease:"linear",time:1e3};class fE extends er{constructor(t,e={}){super(t),this.startWidth=null,this.startHeight=null,this.deltaWidth=null,this.deltaHeight=null,this.width=null,this.height=null,this.time=0,this.options=Object.assign({},dE,e),this.options.ease=kh(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),this.width!==null&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),this.height!==null&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),this.width!==null&&this.parent.fitWidth(this.width,this.keepCenter,this.height===null),this.height!==null&&this.parent.fitHeight(this.height,this.keepCenter,this.width===null),!this.keepCenter&&this.options.position&&this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(this.paused)return;this.time+=t;const e=new mt(this.parent.scale.x,this.parent.scale.y);if(this.time>=this.options.time){const i=this.parent.width,n=this.parent.height;this.complete(),(i!==this.parent.width||n!==this.parent.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}else{const i=this.options.ease(this.time,0,1,this.options.time);if(this.width!==null){const n=this.startWidth,s=this.deltaWidth;this.parent.fitWidth(n+s*i,this.keepCenter,this.height===null)}if(this.height!==null){const n=this.startHeight,s=this.deltaHeight;this.parent.fitHeight(n+s*i,this.keepCenter,this.width===null)}if(this.width===null?this.parent.scale.x=this.parent.scale.y:this.height===null&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const n=this.startX,s=this.startY,o=this.deltaX,a=this.deltaY,h=new mt(this.parent.x,this.parent.y);this.parent.moveCenter(n+o*i,s+a*i),this.parent.emit("moved",{viewport:this.parent,original:h,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}}}const pE={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class mE extends er{constructor(t,e={}){super(t),this.options=Object.assign({},pE,e),this.ease=kh(this.options.ease,"easeInOutSine"),this.options.sides?this.options.sides==="all"?this.top=this.bottom=this.left=this.right=!0:this.options.sides==="horizontal"?(this.right=this.left=!0,this.top=this.bottom=!1):this.options.sides==="vertical"?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=this.options.sides.indexOf("top")!==-1,this.bottom=this.options.sides.indexOf("bottom")!==-1,this.left=this.options.sides.indexOf("left")!==-1,this.right=this.options.sides.indexOf("right")!==-1):this.left=this.top=this.right=this.bottom=!1;const i=this.options.underflow.toLowerCase();i==="center"?(this.underflowX=0,this.underflowY=0):(this.underflowX=i.indexOf("left")!==-1?-1:i.indexOf("right")!==-1?1:0,this.underflowY=i.indexOf("top")!==-1?-1:i.indexOf("bottom")!==-1?1:0),this.reset()}isActive(){return this.toX!==null||this.toY!==null}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(t){if(!this.paused){if(this.bounce(),this.toX){const e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){const e=this.toY;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),e.time>=this.options.time?(this.parent.y=e.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(e.time,e.start,e.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}oob(){const t=this.options.bounceBox;if(t){const e=typeof t.x>"u"?0:t.x,i=typeof t.y>"u"?0:t.y,n=typeof t.width>"u"?this.parent.worldWidth:t.width,s=typeof t.height>"u"?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>n,top:this.parent.top<i,bottom:this.parent.bottom>s,topLeft:new mt(e*this.parent.scale.x,i*this.parent.scale.y),bottomRight:new mt(n*this.parent.scale.x-this.parent.screenWidth,s*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new mt(0,0),bottomRight:new mt(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){var t,e;if(this.paused)return;let i,n=this.parent.plugins.get("decelerate",!0);n&&(n.x||n.y)&&(n.x&&n.percentChangeX===((t=n.options)==null?void 0:t.friction)||n.y&&n.percentChangeY===((e=n.options)==null?void 0:e.friction))&&(i=this.oob(),(i.left&&this.left||i.right&&this.right)&&(n.percentChangeX=this.options.friction),(i.top&&this.top||i.bottom&&this.bottom)&&(n.percentChangeY=this.options.friction));const s=this.parent.plugins.get("drag",!0)||{},o=this.parent.plugins.get("pinch",!0)||{};if(n=n||{},!(s!=null&&s.active)&&!(o!=null&&o.active)&&(!this.toX||!this.toY)&&(!n.x||!n.y)){i=i||this.oob();const a=i.topLeft,h=i.bottomRight;if(!this.toX&&!n.x){let l=null;i.left&&this.left?l=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-a.x:i.right&&this.right&&(l=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-h.x),l!==null&&this.parent.x!==l&&(this.toX={time:0,start:this.parent.x,delta:l-this.parent.x,end:l},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!n.y){let l=null;i.top&&this.top?l=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-a.y:i.bottom&&this.bottom&&(l=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-h.y),l!==null&&this.parent.y!==l&&(this.toY={time:0,start:this.parent.y,delta:l-this.parent.y,end:l},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const gE={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class yE extends er{constructor(t,e={}){super(t),this.options=Object.assign({},gE,e),this.options.direction&&(this.options.left=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.right=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.top=this.options.direction==="y"||this.options.direction==="all"?!0:null,this.options.bottom=this.options.direction==="y"||this.options.direction==="all"?!0:null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();t==="none"?this.noUnderflow=!0:t==="center"?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=t.indexOf("left")!==-1?-1:t.indexOf("right")!==-1?1:0,this.underflowY=t.indexOf("top")!==-1?-1:t.indexOf("bottom")!==-1?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t=new mt(this.parent.x,this.parent.y),e=this.parent.plugins.decelerate||{};if(this.options.left!==null||this.options.right!==null){let i=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x!==0&&(this.parent.x=0,i=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,i=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,i=!0)}else this.options.left!==null&&this.parent.left<(this.options.left===!0?0:this.options.left)&&(this.parent.x=-(this.options.left===!0?0:this.options.left)*this.parent.scale.x,e.x=0,i=!0),this.options.right!==null&&this.parent.right>(this.options.right===!0?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(this.options.right===!0?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(this.options.top!==null||this.options.bottom!==null){let i=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y!==0&&(this.parent.y=0,i=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,i=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,i=!0)}else this.options.top!==null&&this.parent.top<(this.options.top===!0?0:this.options.top)&&(this.parent.y=-(this.options.top===!0?0:this.options.top)*this.parent.scale.y,e.y=0,i=!0),this.options.bottom!==null&&this.parent.bottom>(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const vE={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class _E extends er{constructor(t,e={}){super(t),this.options=Object.assign({},vE,e),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused){if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(this.options.minWidth!==null&&t<this.options.minWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxWidth!==null&&t>this.options.maxWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.minHeight!==null&&e<this.options.minHeight){const i=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxHeight!==null&&e>this.options.maxHeight){const i=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/i,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const t={x:null,y:null},e={x:null,y:null};if(typeof this.options.minScale=="number")t.x=this.options.minScale,t.y=this.options.minScale;else if(this.options.minScale!==null){const s=this.options.minScale;t.x=typeof s.x>"u"?null:s.x,t.y=typeof s.y>"u"?null:s.y}if(typeof this.options.maxScale=="number")e.x=this.options.maxScale,e.y=this.options.maxScale;else if(this.options.maxScale!==null){const s=this.options.maxScale;e.x=typeof s.x>"u"?null:s.x,e.y=typeof s.y>"u"?null:s.y}let i=this.parent.scale.x,n=this.parent.scale.y;t.x!==null&&i<t.x&&(i=t.x),e.x!==null&&i>e.x&&(i=e.x),t.y!==null&&n<t.y&&(n=t.y),e.y!==null&&n>e.y&&(n=e.y),(i!==this.parent.scale.x||n!==this.parent.scale.y)&&(this.parent.scale.set(i,n),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}}reset(){this.clamp()}}const xE={friction:.98,bounce:.8,minSpeed:.01},xi=16;class wE extends er{constructor(t,e={}){super(t),this.options=Object.assign({},xE,e),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",i=>this.handleMoved(i))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!!(this.x||this.y)}move(){if(this.paused)return!1;const t=this.parent.input.count();return(t===1||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}handleMoved(t){if(this.saved.length){const e=this.saved[this.saved.length-1];t.type==="clamp-x"&&t.original?e.x===t.original.x&&(e.x=this.parent.x):t.type==="clamp-y"&&t.original&&e.y===t.original.y&&(e.y=this.parent.y)}}up(){if(this.parent.input.count()===0&&this.saved.length){const t=performance.now();for(const e of this.saved)if(e.time>=t-100){const i=t-e.time;this.x=(this.parent.x-e.x)/i,this.y=(this.parent.y-e.y)/i,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(t){t=t||{},typeof t.x<"u"&&(this.x=t.x,this.percentChangeX=this.options.friction),typeof t.y<"u"&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const e=this.x||this.y,i=this.timeSinceRelease,n=this.timeSinceRelease+t;if(this.x){const s=this.percentChangeX,o=Math.log(s);this.parent.x+=this.x*xi/o*(Math.pow(s,n/xi)-Math.pow(s,i/xi)),this.x*=Math.pow(this.percentChangeX,t/xi)}if(this.y){const s=this.percentChangeY,o=Math.log(s);this.parent.y+=this.y*xi/o*(Math.pow(s,n/xi)-Math.pow(s,i/xi)),this.y*=Math.pow(this.percentChangeY,t/xi)}this.timeSinceRelease+=t,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const bE={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20,wheelSwapAxes:!1};class TE extends er{constructor(t,e={}){super(t),this.windowEventHandlers=[],this.options=Object.assign({},bE,e),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="x",this.yDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="y",this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){const e=n=>{t.includes(n.code)&&(this.keyIsPressed=!0)},i=n=>{t.includes(n.code)&&(this.keyIsPressed=!1)};this.addWindowEventHandler("keyup",i),this.addWindowEventHandler("keydown",e)}addWindowEventHandler(t,e){typeof window>"u"||(window.addEventListener(t,e),this.windowEventHandlers.push({event:t,handler:e}))}destroy(){typeof window>"u"||this.windowEventHandlers.forEach(({event:t,handler:e})=>{window.removeEventListener(t,e)})}mouseButtons(t){!t||t==="all"?this.mouse=[!0,!0,!0]:this.mouse=[t.indexOf("left")!==-1,t.indexOf("middle")!==-1,t.indexOf("right")!==-1]}parseUnderflow(){const t=this.options.underflow.toLowerCase();t==="center"?(this.underflowX=0,this.underflowY=0):(t.includes("left")?this.underflowX=-1:t.includes("right")?this.underflowX=1:this.underflowX=0,t.includes("top")?this.underflowY=-1:t.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(t){const e=t.pointerType==="mouse",i=this.parent.input.count();return!!((i===1||i>1&&!this.parent.plugins.get("pinch",!0))&&(!e||this.mouse[t.button]))}checkKeyPress(t){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&t.data.pointerType==="touch"}down(t){return this.paused||!this.options.pressDrag?!1:this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.global.x,y:t.global.y},this.current=t.pointerId,!0):(this.last=null,!1)}get active(){return this.moved}move(t){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===t.data.pointerId){const e=t.global.x,i=t.global.y,n=this.parent.input.count();if(n===1||n>1&&!this.parent.plugins.get("pinch",!0)){const s=e-this.last.x,o=i-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(s)||this.yDirection&&this.parent.input.checkThreshold(o)){const a={x:e,y:i};return this.xDirection&&(this.parent.x+=(a.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(a.y-this.last.y)*this.options.factor),this.last=a,this.moved||this.parent.emit("drag-start",{event:t,screen:new mt(this.last.x,this.last.y),world:this.parent.toWorld(new mt(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up(t){if(this.paused)return!1;const e=this.parent.input.touches;if(e.length===1){const i=e[0];return i.last&&(this.last={x:i.last.x,y:i.last.y},this.current=i.id),this.moved=!1,!0}else if(this.last&&this.moved){const i=new mt(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:i,world:this.parent.toWorld(i),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(t){if(this.paused)return!1;if(this.options.wheel){const e=this.parent.plugins.get("wheel",!0);if(!e||!e.options.wheelZoom&&!t.ctrlKey){const i=t.deltaMode?this.options.lineHeight:1,n=[t.deltaX,t.deltaY],[s,o]=this.options.wheelSwapAxes?n.reverse():n;return this.xDirection&&(this.parent.x+=s*i*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=o*i*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),this.parent.options.stopPropagation&&t.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if(this.options.clampWheel!=="y")if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if(this.options.clampWheel!=="x")if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const EE={speed:0,acceleration:null,radius:null};class AE extends er{constructor(t,e,i={}){super(t),this.target=e,this.options=Object.assign({},EE,i),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const e=this.parent.center;let i=this.target.x,n=this.target.y;if(this.options.radius)if(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius){const a=Math.atan2(this.target.y-e.y,this.target.x-e.x);i=this.target.x-Math.cos(a)*this.options.radius,n=this.target.y-Math.sin(a)*this.options.radius}else return;const s=i-e.x,o=n-e.y;if(s||o)if(this.options.speed)if(this.options.acceleration){const a=Math.atan2(n-e.y,i-e.x),h=Math.sqrt(Math.pow(s,2)+Math.pow(o,2));if(h){const l=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);h>l?this.velocity={x:Math.min(this.velocity.x+(this.options.acceleration*t,this.options.speed)),y:Math.min(this.velocity.y+(this.options.acceleration*t,this.options.speed))}:this.velocity={x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const u=Math.cos(a)*this.velocity.x,c=Math.sin(a)*this.velocity.y,d=Math.abs(u)>Math.abs(s)?i:e.x+u,f=Math.abs(c)>Math.abs(o)?n:e.y+c;this.parent.moveCenter(d,f),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const a=Math.atan2(n-e.y,i-e.x),h=Math.cos(a)*this.options.speed,l=Math.sin(a)*this.options.speed,u=Math.abs(h)>Math.abs(s)?i:e.x+h,c=Math.abs(l)>Math.abs(o)?n:e.y+l;this.parent.moveCenter(u,c),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(i,n),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const SE={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class CE extends er{constructor(t,e={}){super(t),this.options=Object.assign({},SE,e),this.reverse=this.options.reverse?1:-1,this.radiusSquared=typeof this.options.radius=="number"?Math.pow(this.options.radius,2):null,this.resize()}resize(){const t=this.options.distance;t!==null?(this.left=t,this.top=t,this.right=this.parent.screenWidth-t,this.bottom=this.parent.screenHeight-t):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=this.options.right===null?null:this.parent.screenWidth-this.options.right,this.bottom=this.options.bottom===null?null:this.parent.screenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(t){if(this.paused||t.pointerType!=="mouse"&&t.pointerId!==1||!this.options.allowButtons&&t.buttons!==0)return!1;const e=t.global.x,i=t.global.y;if(this.radiusSquared){const n=this.parent.toScreen(this.parent.center);if(Math.pow(n.x-e,2)+Math.pow(n.y-i,2)>=this.radiusSquared){const s=Math.atan2(n.y-i,n.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(s))*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.round(Math.sin(s))*this.options.speed*this.reverse*(60/1e3)):(this.horizontal=Math.cos(s)*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.sin(s)*this.options.speed*this.reverse*(60/1e3))}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else this.left!==null&&e<this.left?this.horizontal=Number(this.reverse)*this.options.speed*(60/1e3):this.right!==null&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateHorizontal(),this.horizontal=0),this.top!==null&&i<this.top?this.vertical=Number(this.reverse)*this.options.speed*(60/1e3):this.bottom!==null&&i>this.bottom?this.vertical=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const ME={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class RE extends er{constructor(t,e={}){super(t),this.active=!1,this.pinching=!1,this.moved=!1,this.options=Object.assign({},ME,e)}down(){return this.parent.input.count()>=2?(this.active=!0,!0):!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(t){if(this.paused||!this.active)return!1;const e=t.global.x,i=t.global.y,n=this.parent.input.touches;if(n.length>=2){const s=n[0],o=n[1],a=s.last&&o.last?Math.sqrt(Math.pow(o.last.x-s.last.x,2)+Math.pow(o.last.y-s.last.y,2)):null;if(s.id===t.pointerId?s.last={x:e,y:i,data:t}:o.id===t.pointerId&&(o.last={x:e,y:i,data:t}),a){let h;const l=new mt(s.last.x+(o.last.x-s.last.x)/2,s.last.y+(o.last.y-s.last.y)/2);this.options.center||(h=this.parent.toLocal(l));let u=Math.sqrt(Math.pow(o.last.x-s.last.x,2)+Math.pow(o.last.y-s.last.y,2));u=u===0?u=1e-10:u;const c=(1-a/u)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=c),this.isAxisY()&&(this.parent.scale.y+=c),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:l});const d=this.parent.plugins.get("clamp-zoom",!0);if(d&&d.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const f=this.parent.toGlobal(h);this.parent.x+=(l.x-f.x)*this.options.factor,this.parent.y+=(l.y-f.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(l.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(l.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=l,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return this.pinching&&this.parent.input.touches.length<=1?(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0):!1}}const PE={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class IE extends er{constructor(t,e,i,n={}){super(t),this.options=Object.assign({},PE,n),this.ease=kh(n.ease,"easeInOutSine"),this.x=e,this.y=i,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(this.parent.input.count()===0){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}return!1}update(t){if(!this.paused&&!(this.options.interrupt&&this.parent.input.count()!==0))if(this.snapping){const e=this.snapping;e.time+=t;let i,n,s;const o=this.startX,a=this.startY,h=this.deltaX,l=this.deltaY;if(e.time>this.options.time)i=!0,n=o+h,s=a+l;else{const u=this.ease(e.time,0,1,this.options.time);n=o+h*u,s=a+l*u}this.options.topLeft?this.parent.moveCorner(n,s):this.parent.moveCenter(n,s),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),i&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const e=this.options.topLeft?this.parent.corner:this.parent.center;(e.x!==this.x||e.y!==this.y)&&this.snapStart()}}}const DE={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class OE extends er{constructor(t,e={}){super(t),this.options=Object.assign({},DE,e),this.ease=kh(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=t.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,this.options.time===0?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):e.forceStart&&this.createSnapping()}createSnapping(){const t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,i=this.parent.screenWidth/this.xScale,n=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:i-t,deltaY:n-e},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(t){if(this.paused||this.options.interrupt&&this.parent.input.count()!==0)return;let e;if(!this.options.center&&!this.options.noMove&&(e=this.parent.center),!this.snapping)(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping();else if(this.snapping){const i=this.snapping;if(i.time+=t,i.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const s=this.snapping,o=this.ease(s.time,s.startX,s.deltaX,this.options.time),a=this.ease(s.time,s.startY,s.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/o,this.parent.scale.y=this.parent.screenHeight/a}const n=this.parent.plugins.get("clamp-zoom",!0);n&&n.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}resume(){this.snapping=null,super.resume()}}const kE={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class NE extends er{constructor(t,e={}){super(t),this.options=Object.assign({},kE,e),this.keyIsPressed=!1,this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){typeof window>"u"||(window.addEventListener("keydown",e=>{t.includes(e.code)&&(this.keyIsPressed=!0)}),window.addEventListener("keyup",e=>{t.includes(e.code)&&(this.keyIsPressed=!1)}))}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const t=this.smoothingCenter,e=this.smoothing;let i;this.options.center||(i=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x+=e.x),this.isAxisY()&&(this.parent.scale.y+=e.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const n=this.parent.plugins.get("clamp-zoom",!0);if(n&&n.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const s=this.parent.toGlobal(i);this.parent.x+=t.x-s.x,this.parent.y+=t.y-s.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch(t){if(this.paused)return;const e=this.parent.input.getPointerPosition(t),i=-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/200,n=Math.pow(2,(1+this.options.percent)*i);let s;this.options.center||(s=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=n),this.isAxisY()&&(this.parent.scale.y*=n),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const o=this.parent.plugins.get("clamp-zoom",!0);if(o&&o.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const a=this.parent.toGlobal(s);this.parent.x+=e.x-a.x,this.parent.y+=e.y-a.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}wheel(t){if(this.paused||!this.checkKeyPress())return!1;if(t.ctrlKey&&this.options.trackpadPinch)this.pinch(t);else if(this.options.wheelZoom){const e=this.parent.input.getPointerPosition(t),i=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,n=Math.pow(2,(1+this.options.percent)*i);if(this.options.smooth){const s={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+s.x)*n-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+s.y)*n-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{let s;this.options.center||(s=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=n),this.isAxisY()&&(this.parent.scale.y*=n),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const o=this.parent.plugins.get("clamp-zoom",!0);if(o&&o.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const a=this.parent.toGlobal(s);this.parent.x+=e.x-a.x,this.parent.y+=e.y-a.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel-start",{event:t,viewport:this.parent})}return!this.parent.options.passiveWheel}}class FE{constructor(t){this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.eventMode="static",this.viewport.forceHitArea||(this.viewport.hitArea=new yt(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.options.allowPreserveDragOutside?this.viewport.on("globalpointermove",this.move,this):this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.options.allowPreserveDragOutside||this.viewport.on("pointerleave",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.events.domElement.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){var t;(t=this.viewport.options.events.domElement)==null||t.removeEventListener("wheel",this.wheelFunction)}down(t){if(!(this.viewport.pause||!this.viewport.visible)){if(t.pointerType==="mouse"?this.isMouseDown=!0:this.get(t.pointerId)||this.touches.push({id:t.pointerId,last:null}),this.count()===1){this.last=t.global.clone();const e=this.viewport.plugins.get("decelerate",!0),i=this.viewport.plugins.get("bounce",!0);(!e||!e.isActive())&&(!i||!i.isActive())?this.clickedAvailable=!0:this.clickedAvailable=!1}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.visible)return;const e=this.viewport.plugins.move(t);if(this.clickedAvailable&&this.last){const i=t.global.x-this.last.x,n=t.global.y-this.last.y;(this.checkThreshold(i)||this.checkThreshold(n))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.visible)return;t.pointerType==="mouse"&&(this.isMouseDown=!1),t.pointerType!=="mouse"&&this.remove(t.pointerId);const e=this.viewport.plugins.up(t);this.clickedAvailable&&this.count()===0&&this.last&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this.viewport}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){const e=new mt;return this.viewport.options.events.mapPositionToPoint(e,t.clientX,t.clientY),e}handleWheel(t){if(this.viewport.pause||!this.viewport.visible)return;const e=this.viewport.toLocal(this.getPointerPosition(t));this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom&&this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(const e of this.touches)if(e.id===t)return e;return null}remove(t){for(let e=0;e<this.touches.length;e++)if(this.touches[e].id===t){this.touches.splice(e,1);return}}count(){return(this.isMouseDown?1:0)+this.touches.length}}const Os=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class LE{constructor(t){this.viewport=t,this.list=[],this.plugins={}}add(t,e,i=Os.length){const n=this.plugins[t];n&&n.destroy(),this.plugins[t]=e;const s=Os.indexOf(t);s!==-1&&Os.splice(s,1),Os.splice(i,0,t),this.sort()}get(t,e){var i;return e&&(i=this.plugins[t])!=null&&i.paused?null:this.plugins[t]}update(t){for(const e of this.list)e.update(t)}resize(){for(const t of this.list)t.resize()}reset(){for(const t of this.list)t.reset()}removeAll(){this.list.forEach(t=>{t.destroy()}),this.plugins={},this.sort()}remove(t){var e;this.plugins[t]&&((e=this.plugins[t])==null||e.destroy(),delete this.plugins[t],this.viewport.emit("plugin-remove",t),this.sort())}pause(t){var e;(e=this.plugins[t])==null||e.pause()}resume(t){var e;(e=this.plugins[t])==null||e.resume()}sort(){this.list=[];for(const t of Os)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let e=!1;for(const i of this.list)i.down(t)&&(e=!0);return e}move(t){let e=!1;for(const i of this.viewport.plugins.list)i.move(t)&&(e=!0);return e}up(t){let e=!1;for(const i of this.list)i.up(t)&&(e=!0);return e}wheel(t){let e=!1;for(const i of this.list)i.wheel(t)&&(e=!0);return e}}const BE={screenWidth:typeof window>"u"?0:window.innerWidth,screenHeight:typeof window>"u"?0:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,disableOnContextMenu:!1,ticker:_e.shared,allowPreserveDragOutside:!1};class UE extends bt{constructor(t){super(),this._disableOnContextMenu=e=>e.preventDefault(),this.options={...BE,...t},this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.disableOnContextMenu&&this.options.events.domElement.addEventListener("contextmenu",this._disableOnContextMenu),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new FE(this),this.plugins=new LE(this)}destroy(t){var e;!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&((e=this.options.events.domElement)==null||e.removeEventListener("contextmenu",this._disableOnContextMenu)),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new yt(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=typeof window>"u"?0:window.innerWidth,e=typeof window>"u"?0:window.innerHeight,i,n){this.screenWidth=t,this.screenHeight=e,typeof i<"u"&&(this._worldWidth=i),typeof n<"u"&&(this._worldHeight=n),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new yt(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,e){return arguments.length===2?this.toLocal(new mt(t,e)):this.toLocal(t)}toScreen(t,e){return arguments.length===2?this.toGlobal(new mt(t,e)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new mt(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(...t){let e,i;typeof t[0]=="number"?(e=t[0],i=t[1]):(e=t[0].x,i=t[0].y);const n=(this.worldScreenWidth/2-e)*this.scale.x,s=(this.worldScreenHeight/2-i)*this.scale.y;return(this.x!==n||this.y!==s)&&(this.position.set(n,s),this.plugins.reset(),this.dirty=!0),this}get corner(){return new mt(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(...t){let e,i;return t.length===1?(e=-t[0].x*this.scale.x,i=-t[0].y*this.scale.y):(e=-t[0]*this.scale.x,i=-t[1]*this.scale.y),(e!==this.x||i!==this.y)&&(this.position.set(e,i),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,e){const i=this.screenWidth/t,n=this.screenHeight/e;return Math.min(i,n)}findCover(t,e){const i=this.screenWidth/t,n=this.screenHeight/e;return Math.max(i,n)}fitWidth(t=this.worldWidth,e,i=!0,n){let s;e&&(s=this.center),this.scale.x=this.screenWidth/t,i&&(this.scale.y=this.scale.x);const o=this.plugins.get("clamp-zoom",!0);return!n&&o&&o.clamp(),e&&s&&this.moveCenter(s),this}fitHeight(t=this.worldHeight,e,i=!0,n){let s;e&&(s=this.center),this.scale.y=this.screenHeight/t,i&&(this.scale.x=this.scale.y);const o=this.plugins.get("clamp-zoom",!0);return!n&&o&&o.clamp(),e&&s&&this.moveCenter(s),this}fitWorld(t){let e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),t&&e&&this.moveCenter(e),this}fit(t,e=this.worldWidth,i=this.worldHeight){let n;t&&(n=this.center),this.scale.x=this.screenWidth/e,this.scale.y=this.screenHeight/i,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const s=this.plugins.get("clamp-zoom",!0);return s&&s.clamp(),t&&n&&this.moveCenter(n),this}setZoom(t,e){let i;e&&(i=this.center),this.scale.set(t);const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),e&&i&&this.moveCenter(i),this}zoomPercent(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}zoom(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}get scaled(){return this.scale.x}set scaled(t){this.setZoom(t,!0)}snapZoom(t){return this.plugins.add("snap-zoom",new OE(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new mt(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new yt(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new TE(this,t)),this}clamp(t){return this.plugins.add("clamp",new yE(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new wE(this,t)),this}bounce(t){return this.plugins.add("bounce",new mE(this,t)),this}pinch(t){return this.plugins.add("pinch",new RE(this,t)),this}snap(t,e,i){return this.plugins.add("snap",new IE(this,t,e,i)),this}follow(t,e){return this.plugins.add("follow",new AE(this,t,e)),this}wheel(t){return this.plugins.add("wheel",new NE(this,t)),this}animate(t){return this.plugins.add("animate",new fE(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new _E(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new CE(this,t)),this}get pause(){return!!this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,e,i,n,s){s&&(i>this.worldScreenWidth||n>this.worldScreenHeight)&&(this.fit(!0,i,n),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let o=!1;t<this.left?(this.left=t,o=!0):t+i>this.right&&(this.right=t+i,o=!0),e<this.top?(this.top=e,o=!0):e+n>this.bottom&&(this.bottom=e+n,o=!0),o&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}const Pa=1e3,pm=Symbol.for("constructDateFrom");async function fy(r,t){const e=await Ue();let i,n=null;async function s(){try{n=await e.fetch(r),t(n)}catch(a){console.error(a)}n&&!n.end_time&&(i=setTimeout(()=>s(),HE(n)))}function o(){clearTimeout(i)}return{start:s,stop:o}}function HE(r){const t=Math.floor(r.nodes.size/Pa)*Pa;return Math.max(Pa,t)}function $r(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function py(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t}var Le={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},hs={duration:.5,overwrite:!1,delay:0},Xc,me,Ft,Ke=1e8,Dt=1/Ke,rc=Math.PI*2,GE=rc/4,zE=0,my=Math.sqrt,jE=Math.cos,WE=Math.sin,he=function(r){return typeof r=="string"},Xt=function(r){return typeof r=="function"},ii=function(r){return typeof r=="number"},Vc=function(r){return typeof r>"u"},Lr=function(r){return typeof r=="object"},Ee=function(r){return r!==!1},$c=function(){return typeof window<"u"},fa=function(r){return Xt(r)||he(r)},gy=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},ge=Array.isArray,ic=/(?:-?\.?\d|\.)+/gi,yy=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,$n=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Kl=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,vy=/[+-]=-?[.\d]+/,_y=/[^,'"\[\]\s]+/gi,XE=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Ht,Sr,nc,Yc,Be={},eh={},xy,wy=function(r){return(eh=bn(r,Be))&&Me},qc=function(r,t){return console.warn("Invalid property",r,"set to",t,"Missing plugin? gsap.registerPlugin()")},lo=function(r,t){return!t&&console.warn(r)},by=function(r,t){return r&&(Be[r]=t)&&eh&&(eh[r]=t)||Be},uo=function(){return 0},VE={suppressEvents:!0,isStart:!0,kill:!1},Ia={suppressEvents:!0,kill:!1},$E={suppressEvents:!0},Zc={},Pi=[],sc={},Ty,Oe={},Ql={},mm=30,Da=[],Kc="",Qc=function(r){var t=r[0],e,i;if(Lr(t)||Xt(t)||(r=[r]),!(e=(t._gsap||{}).harness)){for(i=Da.length;i--&&!Da[i].targetTest(t););e=Da[i]}for(i=r.length;i--;)r[i]&&(r[i]._gsap||(r[i]._gsap=new $y(r[i],e)))||r.splice(i,1);return r},pn=function(r){return r._gsap||Qc(Qe(r))[0]._gsap},Ey=function(r,t,e){return(e=r[t])&&Xt(e)?r[t]():Vc(e)&&r.getAttribute&&r.getAttribute(t)||e},Ae=function(r,t){return(r=r.split(",")).forEach(t)||r},Vt=function(r){return Math.round(r*1e5)/1e5||0},ae=function(r){return Math.round(r*1e7)/1e7||0},rs=function(r,t){var e=t.charAt(0),i=parseFloat(t.substr(2));return r=parseFloat(r),e==="+"?r+i:e==="-"?r-i:e==="*"?r*i:r/i},YE=function(r,t){for(var e=t.length,i=0;r.indexOf(t[i])<0&&++i<e;);return i<e},rh=function(){var r=Pi.length,t=Pi.slice(0),e,i;for(sc={},Pi.length=0,e=0;e<r;e++)i=t[e],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},Ay=function(r,t,e,i){Pi.length&&!me&&rh(),r.render(t,e,me&&t<0&&(r._initted||r._startAt)),Pi.length&&!me&&rh()},Sy=function(r){var t=parseFloat(r);return(t||t===0)&&(r+"").match(_y).length<2?t:he(r)?r.trim():r},Cy=function(r){return r},tr=function(r,t){for(var e in t)e in r||(r[e]=t[e]);return r},qE=function(r){return function(t,e){for(var i in e)i in t||i==="duration"&&r||i==="ease"||(t[i]=e[i])}},bn=function(r,t){for(var e in t)r[e]=t[e];return r},gm=function r(t,e){for(var i in e)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(t[i]=Lr(e[i])?r(t[i]||(t[i]={}),e[i]):e[i]);return t},ih=function(r,t){var e={},i;for(i in r)i in t||(e[i]=r[i]);return e},ro=function(r){var t=r.parent||Ht,e=r.keyframes?qE(ge(r.keyframes)):tr;if(Ee(r.inherit))for(;t;)e(r,t.vars.defaults),t=t.parent||t._dp;return r},ZE=function(r,t){for(var e=r.length,i=e===t.length;i&&e--&&r[e]===t[e];);return e<0},My=function(r,t,e,i,n){var s=r[i],o;if(n)for(o=t[n];s&&s[n]>o;)s=s._prev;return s?(t._next=s._next,s._next=t):(t._next=r[e],r[e]=t),t._next?t._next._prev=t:r[i]=t,t._prev=s,t.parent=t._dp=r,t},Nh=function(r,t,e,i){e===void 0&&(e="_first"),i===void 0&&(i="_last");var n=t._prev,s=t._next;n?n._next=s:r[e]===t&&(r[e]=s),s?s._prev=n:r[i]===t&&(r[i]=n),t._next=t._prev=t.parent=null},Fi=function(r,t){r.parent&&(!t||r.parent.autoRemoveChildren)&&r.parent.remove&&r.parent.remove(r),r._act=0},mn=function(r,t){if(r&&(!t||t._end>r._dur||t._start<0))for(var e=r;e;)e._dirty=1,e=e.parent;return r},KE=function(r){for(var t=r.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return r},oc=function(r,t,e,i){return r._startAt&&(me?r._startAt.revert(Ia):r.vars.immediateRender&&!r.vars.autoRevert||r._startAt.render(t,!0,i))},QE=function r(t){return!t||t._ts&&r(t.parent)},ym=function(r){return r._repeat?ls(r._tTime,r=r.duration()+r._rDelay)*r:0},ls=function(r,t){var e=Math.floor(r/=t);return r&&e===r?e-1:e},nh=function(r,t){return(r-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Fh=function(r){return r._end=ae(r._start+(r._tDur/Math.abs(r._ts||r._rts||Dt)||0))},Lh=function(r,t){var e=r._dp;return e&&e.smoothChildTiming&&r._ts&&(r._start=ae(e._time-(r._ts>0?t/r._ts:((r._dirty?r.totalDuration():r._tDur)-t)/-r._ts)),Fh(r),e._dirty||mn(e,r)),r},Ry=function(r,t){var e;if((t._time||!t._dur&&t._initted||t._start<r._time&&(t._dur||!t.add))&&(e=nh(r.rawTime(),t),(!t._dur||Co(0,t.totalDuration(),e)-t._tTime>Dt)&&t.render(e,!0)),mn(r,t)._dp&&r._initted&&r._time>=r._dur&&r._ts){if(r._dur<r.duration())for(e=r;e._dp;)e.rawTime()>=0&&e.totalTime(e._tTime),e=e._dp;r._zTime=-Dt}},Mr=function(r,t,e,i){return t.parent&&Fi(t),t._start=ae((ii(e)?e:e||r!==Ht?We(r,e,t):r._time)+t._delay),t._end=ae(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),My(r,t,"_first","_last",r._sort?"_start":0),ac(t)||(r._recent=t),i||Ry(r,t),r._ts<0&&Lh(r,r._tTime),r},Py=function(r,t){return(Be.ScrollTrigger||qc("scrollTrigger",t))&&Be.ScrollTrigger.create(t,r)},Iy=function(r,t,e,i,n){if(td(r,t,n),!r._initted)return 1;if(!e&&r._pt&&!me&&(r._dur&&r.vars.lazy!==!1||!r._dur&&r.vars.lazy)&&Ty!==Ne.frame)return Pi.push(r),r._lazy=[n,i],1},JE=function r(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||r(e))},ac=function(r){var t=r.data;return t==="isFromStart"||t==="isStart"},tA=function(r,t,e,i){var n=r.ratio,s=t<0||!t&&(!r._start&&JE(r)&&!(!r._initted&&ac(r))||(r._ts<0||r._dp._ts<0)&&!ac(r))?0:1,o=r._rDelay,a=0,h,l,u;if(o&&r._repeat&&(a=Co(0,r._tDur,t),l=ls(a,o),r._yoyo&&l&1&&(s=1-s),l!==ls(r._tTime,o)&&(n=1-s,r.vars.repeatRefresh&&r._initted&&r.invalidate())),s!==n||me||i||r._zTime===Dt||!t&&r._zTime){if(!r._initted&&Iy(r,t,i,e,a))return;for(u=r._zTime,r._zTime=t||(e?Dt:0),e||(e=t&&!u),r.ratio=s,r._from&&(s=1-s),r._time=0,r._tTime=a,h=r._pt;h;)h.r(s,h.d),h=h._next;t<0&&oc(r,t,e,!0),r._onUpdate&&!e&&Fe(r,"onUpdate"),a&&r._repeat&&!e&&r.parent&&Fe(r,"onRepeat"),(t>=r._tDur||t<0)&&r.ratio===s&&(s&&Fi(r,1),!e&&!me&&(Fe(r,s?"onComplete":"onReverseComplete",!0),r._prom&&r._prom()))}else r._zTime||(r._zTime=t)},eA=function(r,t,e){var i;if(e>t)for(i=r._first;i&&i._start<=e;){if(i.data==="isPause"&&i._start>t)return i;i=i._next}else for(i=r._last;i&&i._start>=e;){if(i.data==="isPause"&&i._start<t)return i;i=i._prev}},us=function(r,t,e,i){var n=r._repeat,s=ae(t)||0,o=r._tTime/r._tDur;return o&&!i&&(r._time*=s/r._dur),r._dur=s,r._tDur=n?n<0?1e10:ae(s*(n+1)+r._rDelay*n):s,o>0&&!i&&Lh(r,r._tTime=r._tDur*o),r.parent&&Fh(r),e||mn(r.parent,r),r},vm=function(r){return r instanceof ye?mn(r):us(r,r._dur)},rA={_start:0,endTime:uo,totalDuration:uo},We=function r(t,e,i){var n=t.labels,s=t._recent||rA,o=t.duration()>=Ke?s.endTime(!1):t._dur,a,h,l;return he(e)&&(isNaN(e)||e in n)?(h=e.charAt(0),l=e.substr(-1)==="%",a=e.indexOf("="),h==="<"||h===">"?(a>=0&&(e=e.replace(/=/,"")),(h==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(e.substr(1))||0)*(l?(a<0?s:i).totalDuration()/100:1)):a<0?(e in n||(n[e]=o),n[e]):(h=parseFloat(e.charAt(a-1)+e.substr(a+1)),l&&i&&(h=h/100*(ge(i)?i[0]:i).totalDuration()),a>1?r(t,e.substr(0,a-1),i)+h:o+h)):e==null?o:+e},io=function(r,t,e){var i=ii(t[1]),n=(i?2:1)+(r<2?0:1),s=t[n],o,a;if(i&&(s.duration=t[1]),s.parent=e,r){for(o=s,a=e;a&&!("immediateRender"in o);)o=a.vars.defaults||{},a=Ee(a.vars.inherit)&&a.parent;s.immediateRender=Ee(o.immediateRender),r<2?s.runBackwards=1:s.startAt=t[n-1]}return new qt(t[0],s,t[n+1])},Ui=function(r,t){return r||r===0?t(r):t},Co=function(r,t,e){return e<r?r:e>t?t:e},pe=function(r,t){return!he(r)||!(t=XE.exec(r))?"":t[1]},iA=function(r,t,e){return Ui(e,function(i){return Co(r,t,i)})},hc=[].slice,Dy=function(r,t){return r&&Lr(r)&&"length"in r&&(!t&&!r.length||r.length-1 in r&&Lr(r[0]))&&!r.nodeType&&r!==Sr},nA=function(r,t,e){return e===void 0&&(e=[]),r.forEach(function(i){var n;return he(i)&&!t||Dy(i,1)?(n=e).push.apply(n,Qe(i)):e.push(i)})||e},Qe=function(r,t,e){return Ft&&!t&&Ft.selector?Ft.selector(r):he(r)&&!e&&(nc||!cs())?hc.call((t||Yc).querySelectorAll(r),0):ge(r)?nA(r,e):Dy(r)?hc.call(r,0):r?[r]:[]},lc=function(r){return r=Qe(r)[0]||lo("Invalid scope")||{},function(t){var e=r.current||r.nativeElement||r;return Qe(t,e.querySelectorAll?e:e===r?lo("Invalid scope")||Yc.createElement("div"):r)}},Oy=function(r){return r.sort(function(){return .5-Math.random()})},ky=function(r){if(Xt(r))return r;var t=Lr(r)?r:{each:r},e=gn(t.ease),i=t.from||0,n=parseFloat(t.base)||0,s={},o=i>0&&i<1,a=isNaN(i)||o,h=t.axis,l=i,u=i;return he(i)?l=u={center:.5,edges:.5,end:1}[i]||0:!o&&a&&(l=i[0],u=i[1]),function(c,d,f){var p=(f||t).length,m=s[p],g,v,w,_,T,b,x,y,S;if(!m){if(S=t.grid==="auto"?0:(t.grid||[1,Ke])[1],!S){for(x=-Ke;x<(x=f[S++].getBoundingClientRect().left)&&S<p;);S<p&&S--}for(m=s[p]=[],g=a?Math.min(S,p)*l-.5:i%S,v=S===Ke?0:a?p*u/S-.5:i/S|0,x=0,y=Ke,b=0;b<p;b++)w=b%S-g,_=v-(b/S|0),m[b]=T=h?Math.abs(h==="y"?_:w):my(w*w+_*_),T>x&&(x=T),T<y&&(y=T);i==="random"&&Oy(m),m.max=x-y,m.min=y,m.v=p=(parseFloat(t.amount)||parseFloat(t.each)*(S>p?p-1:h?h==="y"?p/S:S:Math.max(S,p/S))||0)*(i==="edges"?-1:1),m.b=p<0?n-p:n,m.u=pe(t.amount||t.each)||0,e=e&&p<0?Wy(e):e}return p=(m[c]-m.min)/m.max||0,ae(m.b+(e?e(p):p)*m.v)+m.u}},uc=function(r){var t=Math.pow(10,((r+"").split(".")[1]||"").length);return function(e){var i=ae(Math.round(parseFloat(e)/r)*r*t);return(i-i%1)/t+(ii(e)?0:pe(e))}},Ny=function(r,t){var e=ge(r),i,n;return!e&&Lr(r)&&(i=e=r.radius||Ke,r.values?(r=Qe(r.values),(n=!ii(r[0]))&&(i*=i)):r=uc(r.increment)),Ui(t,e?Xt(r)?function(s){return n=r(s),Math.abs(n-s)<=i?n:s}:function(s){for(var o=parseFloat(n?s.x:s),a=parseFloat(n?s.y:0),h=Ke,l=0,u=r.length,c,d;u--;)n?(c=r[u].x-o,d=r[u].y-a,c=c*c+d*d):c=Math.abs(r[u]-o),c<h&&(h=c,l=u);return l=!i||h<=i?r[l]:s,n||l===s||ii(s)?l:l+pe(s)}:uc(r))},Fy=function(r,t,e,i){return Ui(ge(r)?!t:e===!0?!!(e=0):!i,function(){return ge(r)?r[~~(Math.random()*r.length)]:(e=e||1e-5)&&(i=e<1?Math.pow(10,(e+"").length-2):1)&&Math.floor(Math.round((r-e/2+Math.random()*(t-r+e*.99))/e)*e*i)/i})},sA=function(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];return function(i){return t.reduce(function(n,s){return s(n)},i)}},oA=function(r,t){return function(e){return r(parseFloat(e))+(t||pe(e))}},aA=function(r,t,e){return By(r,t,0,1,e)},Ly=function(r,t,e){return Ui(e,function(i){return r[~~t(i)]})},hA=function r(t,e,i){var n=e-t;return ge(t)?Ly(t,r(0,t.length),e):Ui(i,function(s){return(n+(s-t)%n)%n+t})},lA=function r(t,e,i){var n=e-t,s=n*2;return ge(t)?Ly(t,r(0,t.length-1),e):Ui(i,function(o){return o=(s+(o-t)%s)%s||0,t+(o>n?s-o:o)})},co=function(r){for(var t=0,e="",i,n,s,o;~(i=r.indexOf("random(",t));)s=r.indexOf(")",i),o=r.charAt(i+7)==="[",n=r.substr(i+7,s-i-7).match(o?_y:ic),e+=r.substr(t,i-t)+Fy(o?n:+n[0],o?0:+n[1],+n[2]||1e-5),t=s+1;return e+r.substr(t,r.length-t)},By=function(r,t,e,i,n){var s=t-r,o=i-e;return Ui(n,function(a){return e+((a-r)/s*o||0)})},uA=function r(t,e,i,n){var s=isNaN(t+e)?0:function(f){return(1-f)*t+f*e};if(!s){var o=he(t),a={},h,l,u,c,d;if(i===!0&&(n=1)&&(i=null),o)t={p:t},e={p:e};else if(ge(t)&&!ge(e)){for(u=[],c=t.length,d=c-2,l=1;l<c;l++)u.push(r(t[l-1],t[l]));c--,s=function(f){f*=c;var p=Math.min(d,~~f);return u[p](f-p)},i=e}else n||(t=bn(ge(t)?[]:{},t));if(!u){for(h in e)Jc.call(a,t,h,"get",e[h]);s=function(f){return id(f,a)||(o?t.p:t)}}}return Ui(i,s)},_m=function(r,t,e){var i=r.labels,n=Ke,s,o,a;for(s in i)o=i[s]-t,o<0==!!e&&o&&n>(o=Math.abs(o))&&(a=s,n=o);return a},Fe=function(r,t,e){var i=r.vars,n=i[t],s=Ft,o=r._ctx,a,h,l;if(n)return a=i[t+"Params"],h=i.callbackScope||r,e&&Pi.length&&rh(),o&&(Ft=o),l=a?n.apply(h,a):n.call(h),Ft=s,l},Ys=function(r){return Fi(r),r.scrollTrigger&&r.scrollTrigger.kill(!!me),r.progress()<1&&Fe(r,"onInterrupt"),r},Yn,Uy=[],Hy=function(r){if(r)if(r=!r.name&&r.default||r,$c()||r.headless){var t=r.name,e=Xt(r),i=t&&!e&&r.init?function(){this._props=[]}:r,n={init:uo,render:id,add:Jc,kill:SA,modifier:AA,rawVars:0},s={targetTest:0,get:0,getSetter:rd,aliases:{},register:0};if(cs(),r!==i){if(Oe[t])return;tr(i,tr(ih(r,n),s)),bn(i.prototype,bn(n,ih(r,s))),Oe[i.prop=t]=i,r.targetTest&&(Da.push(i),Zc[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}by(t,i),r.register&&r.register(Me,i,Se)}else Uy.push(r)},It=255,qs={aqua:[0,It,It],lime:[0,It,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,It],navy:[0,0,128],white:[It,It,It],olive:[128,128,0],yellow:[It,It,0],orange:[It,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[It,0,0],pink:[It,192,203],cyan:[0,It,It],transparent:[It,It,It,0]},Jl=function(r,t,e){return r+=r<0?1:r>1?-1:0,(r*6<1?t+(e-t)*r*6:r<.5?e:r*3<2?t+(e-t)*(2/3-r)*6:t)*It+.5|0},Gy=function(r,t,e){var i=r?ii(r)?[r>>16,r>>8&It,r&It]:0:qs.black,n,s,o,a,h,l,u,c,d,f;if(!i){if(r.substr(-1)===","&&(r=r.substr(0,r.length-1)),qs[r])i=qs[r];else if(r.charAt(0)==="#"){if(r.length<6&&(n=r.charAt(1),s=r.charAt(2),o=r.charAt(3),r="#"+n+n+s+s+o+o+(r.length===5?r.charAt(4)+r.charAt(4):"")),r.length===9)return i=parseInt(r.substr(1,6),16),[i>>16,i>>8&It,i&It,parseInt(r.substr(7),16)/255];r=parseInt(r.substr(1),16),i=[r>>16,r>>8&It,r&It]}else if(r.substr(0,3)==="hsl"){if(i=f=r.match(ic),!t)a=+i[0]%360/360,h=+i[1]/100,l=+i[2]/100,s=l<=.5?l*(h+1):l+h-l*h,n=l*2-s,i.length>3&&(i[3]*=1),i[0]=Jl(a+1/3,n,s),i[1]=Jl(a,n,s),i[2]=Jl(a-1/3,n,s);else if(~r.indexOf("="))return i=r.match(yy),e&&i.length<4&&(i[3]=1),i}else i=r.match(ic)||qs.transparent;i=i.map(Number)}return t&&!f&&(n=i[0]/It,s=i[1]/It,o=i[2]/It,u=Math.max(n,s,o),c=Math.min(n,s,o),l=(u+c)/2,u===c?a=h=0:(d=u-c,h=l>.5?d/(2-u-c):d/(u+c),a=u===n?(s-o)/d+(s<o?6:0):u===s?(o-n)/d+2:(n-s)/d+4,a*=60),i[0]=~~(a+.5),i[1]=~~(h*100+.5),i[2]=~~(l*100+.5)),e&&i.length<4&&(i[3]=1),i},zy=function(r){var t=[],e=[],i=-1;return r.split(Ii).forEach(function(n){var s=n.match($n)||[];t.push.apply(t,s),e.push(i+=s.length+1)}),t.c=e,t},xm=function(r,t,e){var i="",n=(r+i).match(Ii),s=t?"hsla(":"rgba(",o=0,a,h,l,u;if(!n)return r;if(n=n.map(function(c){return(c=Gy(c,t,1))&&s+(t?c[0]+","+c[1]+"%,"+c[2]+"%,"+c[3]:c.join(","))+")"}),e&&(l=zy(r),a=e.c,a.join(i)!==l.c.join(i)))for(h=r.replace(Ii,"1").split($n),u=h.length-1;o<u;o++)i+=h[o]+(~a.indexOf(o)?n.shift()||s+"0,0,0,0)":(l.length?l:n.length?n:e).shift());if(!h)for(h=r.split(Ii),u=h.length-1;o<u;o++)i+=h[o]+n[o];return i+h[u]},Ii=(function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in qs)r+="|"+t+"\\b";return new RegExp(r+")","gi")})(),cA=/hsl[a]?\(/,jy=function(r){var t=r.join(" "),e;if(Ii.lastIndex=0,Ii.test(t))return e=cA.test(t),r[1]=xm(r[1],e),r[0]=xm(r[0],e,zy(r[1])),!0},fo,Ne=(function(){var r=Date.now,t=500,e=33,i=r(),n=i,s=1e3/240,o=s,a=[],h,l,u,c,d,f,p=function m(g){var v=r()-n,w=g===!0,_,T,b,x;if((v>t||v<0)&&(i+=v-e),n+=v,b=n-i,_=b-o,(_>0||w)&&(x=++c.frame,d=b-c.time*1e3,c.time=b=b/1e3,o+=_+(_>=s?4:s-_),T=1),w||(h=l(m)),T)for(f=0;f<a.length;f++)a[f](b,d,x,g)};return c={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(m){return d/(1e3/(m||60))},wake:function(){xy&&(!nc&&$c()&&(Sr=nc=window,Yc=Sr.document||{},Be.gsap=Me,(Sr.gsapVersions||(Sr.gsapVersions=[])).push(Me.version),wy(eh||Sr.GreenSockGlobals||!Sr.gsap&&Sr||{}),Uy.forEach(Hy)),u=typeof requestAnimationFrame<"u"&&requestAnimationFrame,h&&c.sleep(),l=u||function(m){return setTimeout(m,o-c.time*1e3+1|0)},fo=1,p(2))},sleep:function(){(u?cancelAnimationFrame:clearTimeout)(h),fo=0,l=uo},lagSmoothing:function(m,g){t=m||1/0,e=Math.min(g||33,t)},fps:function(m){s=1e3/(m||240),o=c.time*1e3+s},add:function(m,g,v){var w=g?function(_,T,b,x){m(_,T,b,x),c.remove(w)}:m;return c.remove(m),a[v?"unshift":"push"](w),cs(),w},remove:function(m,g){~(g=a.indexOf(m))&&a.splice(g,1)&&f>=g&&f--},_listeners:a},c})(),cs=function(){return!fo&&Ne.wake()},Tt={},dA=/^[\d.\-M][\d.\-,\s]/,fA=/["']/g,pA=function(r){for(var t={},e=r.substr(1,r.length-3).split(":"),i=e[0],n=1,s=e.length,o,a,h;n<s;n++)a=e[n],o=n!==s-1?a.lastIndexOf(","):a.length,h=a.substr(0,o),t[i]=isNaN(h)?h.replace(fA,"").trim():+h,i=a.substr(o+1).trim();return t},mA=function(r){var t=r.indexOf("(")+1,e=r.indexOf(")"),i=r.indexOf("(",t);return r.substring(t,~i&&i<e?r.indexOf(")",e+1):e)},gA=function(r){var t=(r+"").split("("),e=Tt[t[0]];return e&&t.length>1&&e.config?e.config.apply(null,~r.indexOf("{")?[pA(t[1])]:mA(r).split(",").map(Sy)):Tt._CE&&dA.test(r)?Tt._CE("",r):e},Wy=function(r){return function(t){return 1-r(1-t)}},Xy=function r(t,e){for(var i=t._first,n;i;)i instanceof ye?r(i,e):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==e&&(i.timeline?r(i.timeline,e):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=e)),i=i._next},gn=function(r,t){return r&&(Xt(r)?r:Tt[r]||gA(r))||t},Pn=function(r,t,e,i){e===void 0&&(e=function(o){return 1-t(1-o)}),i===void 0&&(i=function(o){return o<.5?t(o*2)/2:1-t((1-o)*2)/2});var n={easeIn:t,easeOut:e,easeInOut:i},s;return Ae(r,function(o){Tt[o]=Be[o]=n,Tt[s=o.toLowerCase()]=e;for(var a in n)Tt[s+(a==="easeIn"?".in":a==="easeOut"?".out":".inOut")]=Tt[o+"."+a]=n[a]}),n},Vy=function(r){return function(t){return t<.5?(1-r(1-t*2))/2:.5+r((t-.5)*2)/2}},tu=function r(t,e,i){var n=e>=1?e:1,s=(i||(t?.3:.45))/(e<1?e:1),o=s/rc*(Math.asin(1/n)||0),a=function(l){return l===1?1:n*Math.pow(2,-10*l)*WE((l-o)*s)+1},h=t==="out"?a:t==="in"?function(l){return 1-a(1-l)}:Vy(a);return s=rc/s,h.config=function(l,u){return r(t,l,u)},h},eu=function r(t,e){e===void 0&&(e=1.70158);var i=function(s){return s?--s*s*((e+1)*s+e)+1:0},n=t==="out"?i:t==="in"?function(s){return 1-i(1-s)}:Vy(i);return n.config=function(s){return r(t,s)},n};Ae("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,t){var e=t<5?t+1:t;Pn(r+",Power"+(e-1),t?function(i){return Math.pow(i,e)}:function(i){return i},function(i){return 1-Math.pow(1-i,e)},function(i){return i<.5?Math.pow(i*2,e)/2:1-Math.pow((1-i)*2,e)/2})});Tt.Linear.easeNone=Tt.none=Tt.Linear.easeIn;Pn("Elastic",tu("in"),tu("out"),tu());(function(r,t){var e=1/t,i=2*e,n=2.5*e,s=function(o){return o<e?r*o*o:o<i?r*Math.pow(o-1.5/t,2)+.75:o<n?r*(o-=2.25/t)*o+.9375:r*Math.pow(o-2.625/t,2)+.984375};Pn("Bounce",function(o){return 1-s(1-o)},s)})(7.5625,2.75);Pn("Expo",function(r){return r?Math.pow(2,10*(r-1)):0});Pn("Circ",function(r){return-(my(1-r*r)-1)});Pn("Sine",function(r){return r===1?1:-jE(r*GE)+1});Pn("Back",eu("in"),eu("out"),eu());Tt.SteppedEase=Tt.steps=Be.SteppedEase={config:function(r,t){r===void 0&&(r=1);var e=1/r,i=r+(t?0:1),n=t?1:0,s=1-Dt;return function(o){return((i*Co(0,s,o)|0)+n)*e}}};hs.ease=Tt["quad.out"];Ae("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return Kc+=r+","+r+"Params,"});var $y=function(r,t){this.id=zE++,r._gsap=this,this.target=r,this.harness=t,this.get=t?t.get:Ey,this.set=t?t.getSetter:rd},po=(function(){function r(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,us(this,+e.duration,1,1),this.data=e.data,Ft&&(this._ctx=Ft,Ft.data.push(this)),fo||Ne.wake()}var t=r.prototype;return t.delay=function(e){return e||e===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,us(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,i){if(cs(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Lh(this,e),!n._dp||n.parent||Ry(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&Mr(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===Dt||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),Ay(this,e,i)),this},t.time=function(e,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+ym(this))%(this._dur+this._rDelay)||(e?this._dur:0),i):this._time},t.totalProgress=function(e,i){return arguments.length?this.totalTime(this.totalDuration()*e,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},t.progress=function(e,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-e:e)+ym(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(e,i){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,i):this._repeat?ls(this._tTime,n)+1:1},t.timeScale=function(e,i){if(!arguments.length)return this._rts===-Dt?0:this._rts;if(this._rts===e)return this;var n=this.parent&&this._ts?nh(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||e===-Dt?0:this._rts,this.totalTime(Co(-Math.abs(this._delay),this._tDur,n),i!==!1),Fh(this),KE(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(cs(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Dt&&(this._tTime-=Dt)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&Mr(i,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(Ee(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var i=this.parent||this._dp;return i?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?nh(i.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){e===void 0&&(e=$E);var i=me;return me=e,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),this.data!=="nested"&&e.kill!==!1&&this.kill(),me=i,this},t.globalTime=function(e){for(var i=this,n=arguments.length?e:i.rawTime();i;)n=i._start+n/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(e):n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,vm(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var i=this._time;return this._rDelay=e,vm(this),i?this.time(i):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,i){return this.totalTime(We(this,e),Ee(i))},t.restart=function(e,i){return this.play().totalTime(e?-this._delay:0,Ee(i))},t.play=function(e,i){return e!=null&&this.seek(e,i),this.reversed(!1).paused(!1)},t.reverse=function(e,i){return e!=null&&this.seek(e||this.totalDuration(),i),this.reversed(!0).paused(!1)},t.pause=function(e,i){return e!=null&&this.seek(e,i),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-Dt:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-Dt,this},t.isActive=function(){var e=this.parent||this._dp,i=this._start,n;return!!(!e||this._ts&&this._initted&&e.isActive()&&(n=e.rawTime(!0))>=i&&n<this.endTime(!0)-Dt)},t.eventCallback=function(e,i,n){var s=this.vars;return arguments.length>1?(i?(s[e]=i,n&&(s[e+"Params"]=n),e==="onUpdate"&&(this._onUpdate=i)):delete s[e],this):s[e]},t.then=function(e){var i=this;return new Promise(function(n){var s=Xt(e)?e:Cy,o=function(){var a=i.then;i.then=null,Xt(s)&&(s=s(i))&&(s.then||s===i)&&(i.then=a),n(s),i.then=a};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?o():i._prom=o})},t.kill=function(){Ys(this)},r})();tr(po.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Dt,_prom:0,_ps:!1,_rts:1});var ye=(function(r){py(t,r);function t(i,n){var s;return i===void 0&&(i={}),s=r.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=Ee(i.sortChildren),Ht&&Mr(i.parent||Ht,$r(s),n),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&Py($r(s),i.scrollTrigger),s}var e=t.prototype;return e.to=function(i,n,s){return io(0,arguments,this),this},e.from=function(i,n,s){return io(1,arguments,this),this},e.fromTo=function(i,n,s,o){return io(2,arguments,this),this},e.set=function(i,n,s){return n.duration=0,n.parent=this,ro(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new qt(i,n,We(this,s),1),this},e.call=function(i,n,s){return Mr(this,qt.delayedCall(0,i,n),s)},e.staggerTo=function(i,n,s,o,a,h,l){return s.duration=n,s.stagger=s.stagger||o,s.onComplete=h,s.onCompleteParams=l,s.parent=this,new qt(i,s,We(this,a)),this},e.staggerFrom=function(i,n,s,o,a,h,l){return s.runBackwards=1,ro(s).immediateRender=Ee(s.immediateRender),this.staggerTo(i,n,s,o,a,h,l)},e.staggerFromTo=function(i,n,s,o,a,h,l,u){return o.startAt=s,ro(o).immediateRender=Ee(o.immediateRender),this.staggerTo(i,n,o,a,h,l,u)},e.render=function(i,n,s){var o=this._time,a=this._dirty?this.totalDuration():this._tDur,h=this._dur,l=i<=0?0:ae(i),u=this._zTime<0!=i<0&&(this._initted||!h),c,d,f,p,m,g,v,w,_,T,b,x;if(this!==Ht&&l>a&&i>=0&&(l=a),l!==this._tTime||s||u){if(o!==this._time&&h&&(l+=this._time-o,i+=this._time-o),c=l,_=this._start,w=this._ts,g=!w,u&&(h||(o=this._zTime),(i||!n)&&(this._zTime=i)),this._repeat){if(b=this._yoyo,m=h+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(m*100+i,n,s);if(c=ae(l%m),l===a?(p=this._repeat,c=h):(p=~~(l/m),p&&p===l/m&&(c=h,p--),c>h&&(c=h)),T=ls(this._tTime,m),!o&&this._tTime&&T!==p&&this._tTime-T*m-this._dur<=0&&(T=p),b&&p&1&&(c=h-c,x=1),p!==T&&!this._lock){var y=b&&T&1,S=y===(b&&p&1);if(p<T&&(y=!y),o=y?0:l%h?h:l,this._lock=1,this.render(o||(x?0:ae(p*m)),n,!h)._lock=0,this._tTime=l,!n&&this.parent&&Fe(this,"onRepeat"),this.vars.repeatRefresh&&!x&&(this.invalidate()._lock=1),o&&o!==this._time||g!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,a=this._tDur,S&&(this._lock=2,o=y?h:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!x&&this.invalidate()),this._lock=0,!this._ts&&!g)return this;Xy(this,x)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=eA(this,ae(o),ae(c)),v&&(l-=c-(c=v._start))),this._tTime=l,this._time=c,this._act=!w,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,o=0),!o&&c&&!n&&!p&&(Fe(this,"onStart"),this._tTime!==l))return this;if(c>=o&&i>=0)for(d=this._first;d;){if(f=d._next,(d._act||c>=d._start)&&d._ts&&v!==d){if(d.parent!==this)return this.render(i,n,s);if(d.render(d._ts>0?(c-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(c-d._start)*d._ts,n,s),c!==this._time||!this._ts&&!g){v=0,f&&(l+=this._zTime=-Dt);break}}d=f}else{d=this._last;for(var D=i<0?i:c;d;){if(f=d._prev,(d._act||D<=d._end)&&d._ts&&v!==d){if(d.parent!==this)return this.render(i,n,s);if(d.render(d._ts>0?(D-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(D-d._start)*d._ts,n,s||me&&(d._initted||d._startAt)),c!==this._time||!this._ts&&!g){v=0,f&&(l+=this._zTime=D?-Dt:Dt);break}}d=f}}if(v&&!n&&(this.pause(),v.render(c>=o?0:-Dt)._zTime=c>=o?1:-1,this._ts))return this._start=_,Fh(this),this.render(i,n,s);this._onUpdate&&!n&&Fe(this,"onUpdate",!0),(l===a&&this._tTime>=this.totalDuration()||!l&&o)&&(_===this._start||Math.abs(w)!==Math.abs(this._ts))&&(this._lock||((i||!h)&&(l===a&&this._ts>0||!l&&this._ts<0)&&Fi(this,1),!n&&!(i<0&&!o)&&(l||o||!a)&&(Fe(this,l===a&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(l<a&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(i,n){var s=this;if(ii(n)||(n=We(this,n,i)),!(i instanceof po)){if(ge(i))return i.forEach(function(o){return s.add(o,n)}),this;if(he(i))return this.addLabel(i,n);if(Xt(i))i=qt.delayedCall(0,i);else return this}return this!==i?Mr(this,i,n):this},e.getChildren=function(i,n,s,o){i===void 0&&(i=!0),n===void 0&&(n=!0),s===void 0&&(s=!0),o===void 0&&(o=-Ke);for(var a=[],h=this._first;h;)h._start>=o&&(h instanceof qt?n&&a.push(h):(s&&a.push(h),i&&a.push.apply(a,h.getChildren(!0,n,s)))),h=h._next;return a},e.getById=function(i){for(var n=this.getChildren(1,1,1),s=n.length;s--;)if(n[s].vars.id===i)return n[s]},e.remove=function(i){return he(i)?this.removeLabel(i):Xt(i)?this.killTweensOf(i):(Nh(this,i),i===this._recent&&(this._recent=this._last),mn(this))},e.totalTime=function(i,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=ae(Ne.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),r.prototype.totalTime.call(this,i,n),this._forcing=0,this):this._tTime},e.addLabel=function(i,n){return this.labels[i]=We(this,n),this},e.removeLabel=function(i){return delete this.labels[i],this},e.addPause=function(i,n,s){var o=qt.delayedCall(0,n||uo,s);return o.data="isPause",this._hasPause=1,Mr(this,o,We(this,i))},e.removePause=function(i){var n=this._first;for(i=We(this,i);n;)n._start===i&&n.data==="isPause"&&Fi(n),n=n._next},e.killTweensOf=function(i,n,s){for(var o=this.getTweensOf(i,s),a=o.length;a--;)Si!==o[a]&&o[a].kill(i,n);return this},e.getTweensOf=function(i,n){for(var s=[],o=Qe(i),a=this._first,h=ii(n),l;a;)a instanceof qt?YE(a._targets,o)&&(h?(!Si||a._initted&&a._ts)&&a.globalTime(0)<=n&&a.globalTime(a.totalDuration())>n:!n||a.isActive())&&s.push(a):(l=a.getTweensOf(o,n)).length&&s.push.apply(s,l),a=a._next;return s},e.tweenTo=function(i,n){n=n||{};var s=this,o=We(s,i),a=n,h=a.startAt,l=a.onStart,u=a.onStartParams,c=a.immediateRender,d,f=qt.to(s,tr({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:n.duration||Math.abs((o-(h&&"time"in h?h.time:s._time))/s.timeScale())||Dt,onStart:function(){if(s.pause(),!d){var p=n.duration||Math.abs((o-(h&&"time"in h?h.time:s._time))/s.timeScale());f._dur!==p&&us(f,p,0,1).render(f._time,!0,!0),d=1}l&&l.apply(f,u||[])}},n));return c?f.render(0):f},e.tweenFromTo=function(i,n,s){return this.tweenTo(n,tr({startAt:{time:We(this,i)}},s))},e.recent=function(){return this._recent},e.nextLabel=function(i){return i===void 0&&(i=this._time),_m(this,We(this,i))},e.previousLabel=function(i){return i===void 0&&(i=this._time),_m(this,We(this,i),1)},e.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+Dt)},e.shiftChildren=function(i,n,s){s===void 0&&(s=0);for(var o=this._first,a=this.labels,h;o;)o._start>=s&&(o._start+=i,o._end+=i),o=o._next;if(n)for(h in a)a[h]>=s&&(a[h]+=i);return mn(this)},e.invalidate=function(i){var n=this._first;for(this._lock=0;n;)n.invalidate(i),n=n._next;return r.prototype.invalidate.call(this,i)},e.clear=function(i){i===void 0&&(i=!0);for(var n=this._first,s;n;)s=n._next,this.remove(n),n=s;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),mn(this)},e.totalDuration=function(i){var n=0,s=this,o=s._last,a=Ke,h,l,u;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-i:i));if(s._dirty){for(u=s.parent;o;)h=o._prev,o._dirty&&o.totalDuration(),l=o._start,l>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,Mr(s,o,l-o._delay,1)._lock=0):a=l,l<0&&o._ts&&(n-=l,(!u&&!s._dp||u&&u.smoothChildTiming)&&(s._start+=l/s._ts,s._time-=l,s._tTime-=l),s.shiftChildren(-l,!1,-1/0),a=0),o._end>n&&o._ts&&(n=o._end),o=h;us(s,s===Ht&&s._time>n?s._time:n,1,1),s._dirty=0}return s._tDur},t.updateRoot=function(i){if(Ht._ts&&(Ay(Ht,nh(i,Ht)),Ty=Ne.frame),Ne.frame>=mm){mm+=Le.autoSleep||120;var n=Ht._first;if((!n||!n._ts)&&Le.autoSleep&&Ne._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||Ne.sleep()}}},t})(po);tr(ye.prototype,{_lock:0,_hasPause:0,_forcing:0});var yA=function(r,t,e,i,n,s,o){var a=new Se(this._pt,r,t,0,1,Jy,null,n),h=0,l=0,u,c,d,f,p,m,g,v;for(a.b=e,a.e=i,e+="",i+="",(g=~i.indexOf("random("))&&(i=co(i)),s&&(v=[e,i],s(v,r,t),e=v[0],i=v[1]),c=e.match(Kl)||[];u=Kl.exec(i);)f=u[0],p=i.substring(h,u.index),d?d=(d+1)%5:p.substr(-5)==="rgba("&&(d=1),f!==c[l++]&&(m=parseFloat(c[l-1])||0,a._pt={_next:a._pt,p:p||l===1?p:",",s:m,c:f.charAt(1)==="="?rs(m,f)-m:parseFloat(f)-m,m:d&&d<4?Math.round:0},h=Kl.lastIndex);return a.c=h<i.length?i.substring(h,i.length):"",a.fp=o,(vy.test(i)||g)&&(a.e=0),this._pt=a,a},Jc=function(r,t,e,i,n,s,o,a,h,l){Xt(i)&&(i=i(n||0,r,s));var u=r[t],c=e!=="get"?e:Xt(u)?h?r[t.indexOf("set")||!Xt(r["get"+t.substr(3)])?t:"get"+t.substr(3)](h):r[t]():u,d=Xt(u)?h?bA:Ky:ed,f;if(he(i)&&(~i.indexOf("random(")&&(i=co(i)),i.charAt(1)==="="&&(f=rs(c,i)+(pe(c)||0),(f||f===0)&&(i=f))),!l||c!==i||cc)return!isNaN(c*i)&&i!==""?(f=new Se(this._pt,r,t,+c||0,i-(c||0),typeof u=="boolean"?EA:Qy,0,d),h&&(f.fp=h),o&&f.modifier(o,this,r),this._pt=f):(!u&&!(t in r)&&qc(t,i),yA.call(this,r,t,c,i,d,a||Le.stringFilter,h))},vA=function(r,t,e,i,n){if(Xt(r)&&(r=no(r,n,t,e,i)),!Lr(r)||r.style&&r.nodeType||ge(r)||gy(r))return he(r)?no(r,n,t,e,i):r;var s={},o;for(o in r)s[o]=no(r[o],n,t,e,i);return s},Yy=function(r,t,e,i,n,s){var o,a,h,l;if(Oe[r]&&(o=new Oe[r]).init(n,o.rawVars?t[r]:vA(t[r],i,n,s,e),e,i,s)!==!1&&(e._pt=a=new Se(e._pt,n,r,0,1,o.render,o,0,o.priority),e!==Yn))for(h=e._ptLookup[e._targets.indexOf(n)],l=o._props.length;l--;)h[o._props[l]]=a;return o},Si,cc,td=function r(t,e,i){var n=t.vars,s=n.ease,o=n.startAt,a=n.immediateRender,h=n.lazy,l=n.onUpdate,u=n.runBackwards,c=n.yoyoEase,d=n.keyframes,f=n.autoRevert,p=t._dur,m=t._startAt,g=t._targets,v=t.parent,w=v&&v.data==="nested"?v.vars.targets:g,_=t._overwrite==="auto"&&!Xc,T=t.timeline,b,x,y,S,D,G,O,N,P,F,j,E,A;if(T&&(!d||!s)&&(s="none"),t._ease=gn(s,hs.ease),t._yEase=c?Wy(gn(c===!0?s:c,hs.ease)):0,c&&t._yoyo&&!t._repeat&&(c=t._yEase,t._yEase=t._ease,t._ease=c),t._from=!T&&!!n.runBackwards,!T||d&&!n.stagger){if(N=g[0]?pn(g[0]).harness:0,E=N&&n[N.prop],b=ih(n,Zc),m&&(m._zTime<0&&m.progress(1),e<0&&u&&a&&!f?m.render(-1,!0):m.revert(u&&p?Ia:VE),m._lazy=0),o){if(Fi(t._startAt=qt.set(g,tr({data:"isStart",overwrite:!1,parent:v,immediateRender:!0,lazy:!m&&Ee(h),startAt:null,delay:0,onUpdate:l&&function(){return Fe(t,"onUpdate")},stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(me||!a&&!f)&&t._startAt.revert(Ia),a&&p&&e<=0&&i<=0){e&&(t._zTime=e);return}}else if(u&&p&&!m){if(e&&(a=!1),y=tr({overwrite:!1,data:"isFromStart",lazy:a&&!m&&Ee(h),immediateRender:a,stagger:0,parent:v},b),E&&(y[N.prop]=E),Fi(t._startAt=qt.set(g,y)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(me?t._startAt.revert(Ia):t._startAt.render(-1,!0)),t._zTime=e,!a)r(t._startAt,Dt,Dt);else if(!e)return}for(t._pt=t._ptCache=0,h=p&&Ee(h)||h&&!p,x=0;x<g.length;x++){if(D=g[x],O=D._gsap||Qc(g)[x]._gsap,t._ptLookup[x]=F={},sc[O.id]&&Pi.length&&rh(),j=w===g?x:w.indexOf(D),N&&(P=new N).init(D,E||b,t,j,w)!==!1&&(t._pt=S=new Se(t._pt,D,P.name,0,1,P.render,P,0,P.priority),P._props.forEach(function(C){F[C]=S}),P.priority&&(G=1)),!N||E)for(y in b)Oe[y]&&(P=Yy(y,b,t,j,D,w))?P.priority&&(G=1):F[y]=S=Jc.call(t,D,y,"get",b[y],j,w,0,n.stringFilter);t._op&&t._op[x]&&t.kill(D,t._op[x]),_&&t._pt&&(Si=t,Ht.killTweensOf(D,F,t.globalTime(e)),A=!t.parent,Si=0),t._pt&&h&&(sc[O.id]=1)}G&&tv(t),t._onInit&&t._onInit(t)}t._onUpdate=l,t._initted=(!t._op||t._pt)&&!A,d&&e<=0&&T.render(Ke,!0,!0)},_A=function(r,t,e,i,n,s,o,a){var h=(r._pt&&r._ptCache||(r._ptCache={}))[t],l,u,c,d;if(!h)for(h=r._ptCache[t]=[],c=r._ptLookup,d=r._targets.length;d--;){if(l=c[d][t],l&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return cc=1,r.vars[t]="+=0",td(r,o),cc=0,a?lo(t+" not eligible for reset"):1;h.push(l)}for(d=h.length;d--;)u=h[d],l=u._pt||u,l.s=(i||i===0)&&!n?i:l.s+(i||0)+s*l.c,l.c=e-l.s,u.e&&(u.e=Vt(e)+pe(u.e)),u.b&&(u.b=l.s+pe(u.b))},xA=function(r,t){var e=r[0]?pn(r[0]).harness:0,i=e&&e.aliases,n,s,o,a;if(!i)return t;n=bn({},t);for(s in i)if(s in n)for(a=i[s].split(","),o=a.length;o--;)n[a[o]]=n[s];return n},wA=function(r,t,e,i){var n=t.ease||i||"power1.inOut",s,o;if(ge(t))o=e[r]||(e[r]=[]),t.forEach(function(a,h){return o.push({t:h/(t.length-1)*100,v:a,e:n})});else for(s in t)o=e[s]||(e[s]=[]),s==="ease"||o.push({t:parseFloat(r),v:t[s],e:n})},no=function(r,t,e,i,n){return Xt(r)?r.call(t,e,i,n):he(r)&&~r.indexOf("random(")?co(r):r},qy=Kc+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Zy={};Ae(qy+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return Zy[r]=1});var qt=(function(r){py(t,r);function t(i,n,s,o){var a;typeof n=="number"&&(s.duration=n,n=s,s=null),a=r.call(this,o?n:ro(n))||this;var h=a.vars,l=h.duration,u=h.delay,c=h.immediateRender,d=h.stagger,f=h.overwrite,p=h.keyframes,m=h.defaults,g=h.scrollTrigger,v=h.yoyoEase,w=n.parent||Ht,_=(ge(i)||gy(i)?ii(i[0]):"length"in n)?[i]:Qe(i),T,b,x,y,S,D,G,O;if(a._targets=_.length?Qc(_):lo("GSAP target "+i+" not found. https://gsap.com",!Le.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,p||d||fa(l)||fa(u)){if(n=a.vars,T=a.timeline=new ye({data:"nested",defaults:m||{},targets:w&&w.data==="nested"?w.vars.targets:_}),T.kill(),T.parent=T._dp=$r(a),T._start=0,d||fa(l)||fa(u)){if(y=_.length,G=d&&ky(d),Lr(d))for(S in d)~qy.indexOf(S)&&(O||(O={}),O[S]=d[S]);for(b=0;b<y;b++)x=ih(n,Zy),x.stagger=0,v&&(x.yoyoEase=v),O&&bn(x,O),D=_[b],x.duration=+no(l,$r(a),b,D,_),x.delay=(+no(u,$r(a),b,D,_)||0)-a._delay,!d&&y===1&&x.delay&&(a._delay=u=x.delay,a._start+=u,x.delay=0),T.to(D,x,G?G(b,D,_):0),T._ease=Tt.none;T.duration()?l=u=0:a.timeline=0}else if(p){ro(tr(T.vars.defaults,{ease:"none"})),T._ease=gn(p.ease||n.ease||"none");var N=0,P,F,j;if(ge(p))p.forEach(function(E){return T.to(_,E,">")}),T.duration();else{x={};for(S in p)S==="ease"||S==="easeEach"||wA(S,p[S],x,p.easeEach);for(S in x)for(P=x[S].sort(function(E,A){return E.t-A.t}),N=0,b=0;b<P.length;b++)F=P[b],j={ease:F.e,duration:(F.t-(b?P[b-1].t:0))/100*l},j[S]=F.v,T.to(_,j,N),N+=j.duration;T.duration()<l&&T.to({},{duration:l-T.duration()})}}l||a.duration(l=T.duration())}else a.timeline=0;return f===!0&&!Xc&&(Si=$r(a),Ht.killTweensOf(_),Si=0),Mr(w,$r(a),s),n.reversed&&a.reverse(),n.paused&&a.paused(!0),(c||!l&&!p&&a._start===ae(w._time)&&Ee(c)&&QE($r(a))&&w.data!=="nested")&&(a._tTime=-Dt,a.render(Math.max(0,-u)||0)),g&&Py($r(a),g),a}var e=t.prototype;return e.render=function(i,n,s){var o=this._time,a=this._tDur,h=this._dur,l=i<0,u=i>a-Dt&&!l?a:i<Dt?0:i,c,d,f,p,m,g,v,w,_;if(!h)tA(this,i,n,s);else if(u!==this._tTime||!i||s||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==l){if(c=u,w=this.timeline,this._repeat){if(p=h+this._rDelay,this._repeat<-1&&l)return this.totalTime(p*100+i,n,s);if(c=ae(u%p),u===a?(f=this._repeat,c=h):(f=~~(u/p),f&&f===ae(u/p)&&(c=h,f--),c>h&&(c=h)),g=this._yoyo&&f&1,g&&(_=this._yEase,c=h-c),m=ls(this._tTime,p),c===o&&!s&&this._initted&&f===m)return this._tTime=u,this;f!==m&&(w&&this._yEase&&Xy(w,g),this.vars.repeatRefresh&&!g&&!this._lock&&this._time!==p&&this._initted&&(this._lock=s=1,this.render(ae(p*f),!0).invalidate()._lock=0))}if(!this._initted){if(Iy(this,l?i:c,s,n,u))return this._tTime=0,this;if(o!==this._time&&!(s&&this.vars.repeatRefresh&&f!==m))return this;if(h!==this._dur)return this.render(i,n,s)}if(this._tTime=u,this._time=c,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(_||this._ease)(c/h),this._from&&(this.ratio=v=1-v),c&&!o&&!n&&!f&&(Fe(this,"onStart"),this._tTime!==u))return this;for(d=this._pt;d;)d.r(v,d.d),d=d._next;w&&w.render(i<0?i:w._dur*w._ease(c/this._dur),n,s)||this._startAt&&(this._zTime=i),this._onUpdate&&!n&&(l&&oc(this,i,n,s),Fe(this,"onUpdate")),this._repeat&&f!==m&&this.vars.onRepeat&&!n&&this.parent&&Fe(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(l&&!this._onUpdate&&oc(this,i,!0,!0),(i||!h)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&Fi(this,1),!n&&!(l&&!o)&&(u||o||g)&&(Fe(this,u===a?"onComplete":"onReverseComplete",!0),this._prom&&!(u<a&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),r.prototype.invalidate.call(this,i)},e.resetTo=function(i,n,s,o,a){fo||Ne.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),l;return this._initted||td(this,h),l=this._ease(h/this._dur),_A(this,i,n,s,o,l,h,a)?this.resetTo(i,n,s,o,1):(Lh(this,0),this.parent||My(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(i,n){if(n===void 0&&(n="all"),!i&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?Ys(this):this;if(this.timeline){var s=this.timeline.totalDuration();return this.timeline.killTweensOf(i,n,Si&&Si.vars.overwrite!==!0)._first||Ys(this),this.parent&&s!==this.timeline.totalDuration()&&us(this,this._dur*this.timeline._tDur/s,0,1),this}var o=this._targets,a=i?Qe(i):o,h=this._ptLookup,l=this._pt,u,c,d,f,p,m,g;if((!n||n==="all")&&ZE(o,a))return n==="all"&&(this._pt=0),Ys(this);for(u=this._op=this._op||[],n!=="all"&&(he(n)&&(p={},Ae(n,function(v){return p[v]=1}),n=p),n=xA(o,n)),g=o.length;g--;)if(~a.indexOf(o[g])){c=h[g],n==="all"?(u[g]=n,f=c,d={}):(d=u[g]=u[g]||{},f=n);for(p in f)m=c&&c[p],m&&((!("kill"in m.d)||m.d.kill(p)===!0)&&Nh(this,m,"_pt"),delete c[p]),d!=="all"&&(d[p]=1)}return this._initted&&!this._pt&&l&&Ys(this),this},t.to=function(i,n){return new t(i,n,arguments[2])},t.from=function(i,n){return io(1,arguments)},t.delayedCall=function(i,n,s,o){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:n,onReverseComplete:n,onCompleteParams:s,onReverseCompleteParams:s,callbackScope:o})},t.fromTo=function(i,n,s){return io(2,arguments)},t.set=function(i,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(i,n)},t.killTweensOf=function(i,n,s){return Ht.killTweensOf(i,n,s)},t})(po);tr(qt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Ae("staggerTo,staggerFrom,staggerFromTo",function(r){qt[r]=function(){var t=new ye,e=hc.call(arguments,0);return e.splice(r==="staggerFromTo"?5:4,0,0),t[r].apply(t,e)}});var ed=function(r,t,e){return r[t]=e},Ky=function(r,t,e){return r[t](e)},bA=function(r,t,e,i){return r[t](i.fp,e)},TA=function(r,t,e){return r.setAttribute(t,e)},rd=function(r,t){return Xt(r[t])?Ky:Vc(r[t])&&r.setAttribute?TA:ed},Qy=function(r,t){return t.set(t.t,t.p,Math.round((t.s+t.c*r)*1e6)/1e6,t)},EA=function(r,t){return t.set(t.t,t.p,!!(t.s+t.c*r),t)},Jy=function(r,t){var e=t._pt,i="";if(!r&&t.b)i=t.b;else if(r===1&&t.e)i=t.e;else{for(;e;)i=e.p+(e.m?e.m(e.s+e.c*r):Math.round((e.s+e.c*r)*1e4)/1e4)+i,e=e._next;i+=t.c}t.set(t.t,t.p,i,t)},id=function(r,t){for(var e=t._pt;e;)e.r(r,e.d),e=e._next},AA=function(r,t,e,i){for(var n=this._pt,s;n;)s=n._next,n.p===i&&n.modifier(r,t,e),n=s},SA=function(r){for(var t=this._pt,e,i;t;)i=t._next,t.p===r&&!t.op||t.op===r?Nh(this,t,"_pt"):t.dep||(e=1),t=i;return!e},CA=function(r,t,e,i){i.mSet(r,t,i.m.call(i.tween,e,i.mt),i)},tv=function(r){for(var t=r._pt,e,i,n,s;t;){for(e=t._next,i=n;i&&i.pr>t.pr;)i=i._next;(t._prev=i?i._prev:s)?t._prev._next=t:n=t,(t._next=i)?i._prev=t:s=t,t=e}r._pt=n},Se=(function(){function r(e,i,n,s,o,a,h,l,u){this.t=i,this.s=s,this.c=o,this.p=n,this.r=a||Qy,this.d=h||this,this.set=l||ed,this.pr=u||0,this._next=e,e&&(e._prev=this)}var t=r.prototype;return t.modifier=function(e,i,n){this.mSet=this.mSet||this.set,this.set=CA,this.m=e,this.mt=n,this.tween=i},r})();Ae(Kc+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return Zc[r]=1});Be.TweenMax=Be.TweenLite=qt;Be.TimelineLite=Be.TimelineMax=ye;Ht=new ye({sortChildren:!1,defaults:hs,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Le.stringFilter=jy;var yn=[],Oa={},MA=[],wm=0,RA=0,ru=function(r){return(Oa[r]||MA).map(function(t){return t()})},dc=function(){var r=Date.now(),t=[];r-wm>2&&(ru("matchMediaInit"),yn.forEach(function(e){var i=e.queries,n=e.conditions,s,o,a,h;for(o in i)s=Sr.matchMedia(i[o]).matches,s&&(a=1),s!==n[o]&&(n[o]=s,h=1);h&&(e.revert(),a&&t.push(e))}),ru("matchMediaRevert"),t.forEach(function(e){return e.onMatch(e,function(i){return e.add(null,i)})}),wm=r,ru("matchMedia"))},ev=(function(){function r(e,i){this.selector=i&&lc(i),this.data=[],this._r=[],this.isReverted=!1,this.id=RA++,e&&this.add(e)}var t=r.prototype;return t.add=function(e,i,n){Xt(e)&&(n=i,i=e,e=Xt);var s=this,o=function(){var a=Ft,h=s.selector,l;return a&&a!==s&&a.data.push(s),n&&(s.selector=lc(n)),Ft=s,l=i.apply(s,arguments),Xt(l)&&s._r.push(l),Ft=a,s.selector=h,s.isReverted=!1,l};return s.last=o,e===Xt?o(s,function(a){return s.add(null,a)}):e?s[e]=o:o},t.ignore=function(e){var i=Ft;Ft=null,e(this),Ft=i},t.getTweens=function(){var e=[];return this.data.forEach(function(i){return i instanceof r?e.push.apply(e,i.getTweens()):i instanceof qt&&!(i.parent&&i.parent.data==="nested")&&e.push(i)}),e},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(e,i){var n=this;if(e?(function(){for(var o=n.getTweens(),a=n.data.length,h;a--;)h=n.data[a],h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(l){return o.splice(o.indexOf(l),1)}));for(o.map(function(l){return{g:l._dur||l._delay||l._sat&&!l._sat.vars.immediateRender?l.globalTime(0):-1/0,t:l}}).sort(function(l,u){return u.g-l.g||-1/0}).forEach(function(l){return l.t.revert(e)}),a=n.data.length;a--;)h=n.data[a],h instanceof ye?h.data!=="nested"&&(h.scrollTrigger&&h.scrollTrigger.revert(),h.kill()):!(h instanceof qt)&&h.revert&&h.revert(e);n._r.forEach(function(l){return l(e,n)}),n.isReverted=!0})():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),i)for(var s=yn.length;s--;)yn[s].id===this.id&&yn.splice(s,1)},t.revert=function(e){this.kill(e||{})},r})(),PA=(function(){function r(e){this.contexts=[],this.scope=e,Ft&&Ft.data.push(this)}var t=r.prototype;return t.add=function(e,i,n){Lr(e)||(e={matches:e});var s=new ev(0,n||this.scope),o=s.conditions={},a,h,l;Ft&&!s.selector&&(s.selector=Ft.selector),this.contexts.push(s),i=s.add("onMatch",i),s.queries=e;for(h in e)h==="all"?l=1:(a=Sr.matchMedia(e[h]),a&&(yn.indexOf(s)<0&&yn.push(s),(o[h]=a.matches)&&(l=1),a.addListener?a.addListener(dc):a.addEventListener("change",dc)));return l&&i(s,function(u){return s.add(null,u)}),this},t.revert=function(e){this.kill(e||{})},t.kill=function(e){this.contexts.forEach(function(i){return i.kill(e,!0)})},r})(),sh={registerPlugin:function(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];t.forEach(function(i){return Hy(i)})},timeline:function(r){return new ye(r)},getTweensOf:function(r,t){return Ht.getTweensOf(r,t)},getProperty:function(r,t,e,i){he(r)&&(r=Qe(r)[0]);var n=pn(r||{}).get,s=e?Cy:Sy;return e==="native"&&(e=""),r&&(t?s((Oe[t]&&Oe[t].get||n)(r,t,e,i)):function(o,a,h){return s((Oe[o]&&Oe[o].get||n)(r,o,a,h))})},quickSetter:function(r,t,e){if(r=Qe(r),r.length>1){var i=r.map(function(l){return Me.quickSetter(l,t,e)}),n=i.length;return function(l){for(var u=n;u--;)i[u](l)}}r=r[0]||{};var s=Oe[t],o=pn(r),a=o.harness&&(o.harness.aliases||{})[t]||t,h=s?function(l){var u=new s;Yn._pt=0,u.init(r,e?l+e:l,Yn,0,[r]),u.render(1,u),Yn._pt&&id(1,Yn)}:o.set(r,a);return s?h:function(l){return h(r,a,e?l+e:l,o,1)}},quickTo:function(r,t,e){var i,n=Me.to(r,bn((i={},i[t]="+=0.1",i.paused=!0,i),e||{})),s=function(o,a,h){return n.resetTo(t,o,a,h)};return s.tween=n,s},isTweening:function(r){return Ht.getTweensOf(r,!0).length>0},defaults:function(r){return r&&r.ease&&(r.ease=gn(r.ease,hs.ease)),gm(hs,r||{})},config:function(r){return gm(Le,r||{})},registerEffect:function(r){var t=r.name,e=r.effect,i=r.plugins,n=r.defaults,s=r.extendTimeline;(i||"").split(",").forEach(function(o){return o&&!Oe[o]&&!Be[o]&&lo(t+" effect requires "+o+" plugin.")}),Ql[t]=function(o,a,h){return e(Qe(o),tr(a||{},n),h)},s&&(ye.prototype[t]=function(o,a,h){return this.add(Ql[t](o,Lr(a)?a:(h=a)&&{},this),h)})},registerEase:function(r,t){Tt[r]=gn(t)},parseEase:function(r,t){return arguments.length?gn(r,t):Tt},getById:function(r){return Ht.getById(r)},exportRoot:function(r,t){r===void 0&&(r={});var e=new ye(r),i,n;for(e.smoothChildTiming=Ee(r.smoothChildTiming),Ht.remove(e),e._dp=0,e._time=e._tTime=Ht._time,i=Ht._first;i;)n=i._next,(t||!(!i._dur&&i instanceof qt&&i.vars.onComplete===i._targets[0]))&&Mr(e,i,i._start-i._delay),i=n;return Mr(Ht,e,0),e},context:function(r,t){return r?new ev(r,t):Ft},matchMedia:function(r){return new PA(r)},matchMediaRefresh:function(){return yn.forEach(function(r){var t=r.conditions,e,i;for(i in t)t[i]&&(t[i]=!1,e=1);e&&r.revert()})||dc()},addEventListener:function(r,t){var e=Oa[r]||(Oa[r]=[]);~e.indexOf(t)||e.push(t)},removeEventListener:function(r,t){var e=Oa[r],i=e&&e.indexOf(t);i>=0&&e.splice(i,1)},utils:{wrap:hA,wrapYoyo:lA,distribute:ky,random:Fy,snap:Ny,normalize:aA,getUnit:pe,clamp:iA,splitColor:Gy,toArray:Qe,selector:lc,mapRange:By,pipe:sA,unitize:oA,interpolate:uA,shuffle:Oy},install:wy,effects:Ql,ticker:Ne,updateRoot:ye.updateRoot,plugins:Oe,globalTimeline:Ht,core:{PropTween:Se,globals:by,Tween:qt,Timeline:ye,Animation:po,getCache:pn,_removeLinkedListItem:Nh,reverting:function(){return me},context:function(r){return r&&Ft&&(Ft.data.push(r),r._ctx=Ft),Ft},suppressOverwrites:function(r){return Xc=r}}};Ae("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return sh[r]=qt[r]});Ne.add(ye.updateRoot);Yn=sh.to({},{duration:0});var IA=function(r,t){for(var e=r._pt;e&&e.p!==t&&e.op!==t&&e.fp!==t;)e=e._next;return e},DA=function(r,t){var e=r._targets,i,n,s;for(i in t)for(n=e.length;n--;)s=r._ptLookup[n][i],s&&(s=s.d)&&(s._pt&&(s=IA(s,i)),s&&s.modifier&&s.modifier(t[i],r,e[n],i))},iu=function(r,t){return{name:r,rawVars:1,init:function(e,i,n){n._onInit=function(s){var o,a;if(he(i)&&(o={},Ae(i,function(h){return o[h]=1}),i=o),t){o={};for(a in i)o[a]=t(i[a]);i=o}DA(s,i)}}}},Me=sh.registerPlugin({name:"attr",init:function(r,t,e,i,n){var s,o,a;this.tween=e;for(s in t)a=r.getAttribute(s)||"",o=this.add(r,"setAttribute",(a||0)+"",t[s],i,n,0,0,s),o.op=s,o.b=a,this._props.push(s)},render:function(r,t){for(var e=t._pt;e;)me?e.set(e.t,e.p,e.b,e):e.r(r,e.d),e=e._next}},{name:"endArray",init:function(r,t){for(var e=t.length;e--;)this.add(r,e,r[e]||0,t[e],0,0,0,0,0,1)}},iu("roundProps",uc),iu("modifiers"),iu("snap",Ny))||sh;qt.version=ye.version=Me.version="3.12.5";xy=1;$c()&&cs();Tt.Power0;Tt.Power1;Tt.Power2;Tt.Power3;Tt.Power4;Tt.Linear;Tt.Quad;Tt.Cubic;Tt.Quart;Tt.Quint;Tt.Strong;Tt.Elastic;Tt.Back;Tt.SteppedEase;Tt.Bounce;Tt.Sine;Tt.Expo;Tt.Circ;var bm,Ci,is,nd,ln,Tm,sd,OA=function(){return typeof window<"u"},ni={},on=180/Math.PI,ns=Math.PI/180,Bn=Math.atan2,Em=1e8,od=/([A-Z])/g,kA=/(left|right|width|margin|padding|x)/i,NA=/[\s,\(]\S/,Pr={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},fc=function(r,t){return t.set(t.t,t.p,Math.round((t.s+t.c*r)*1e4)/1e4+t.u,t)},FA=function(r,t){return t.set(t.t,t.p,r===1?t.e:Math.round((t.s+t.c*r)*1e4)/1e4+t.u,t)},LA=function(r,t){return t.set(t.t,t.p,r?Math.round((t.s+t.c*r)*1e4)/1e4+t.u:t.b,t)},BA=function(r,t){var e=t.s+t.c*r;t.set(t.t,t.p,~~(e+(e<0?-.5:.5))+t.u,t)},rv=function(r,t){return t.set(t.t,t.p,r?t.e:t.b,t)},iv=function(r,t){return t.set(t.t,t.p,r!==1?t.b:t.e,t)},UA=function(r,t,e){return r.style[t]=e},HA=function(r,t,e){return r.style.setProperty(t,e)},GA=function(r,t,e){return r._gsap[t]=e},zA=function(r,t,e){return r._gsap.scaleX=r._gsap.scaleY=e},jA=function(r,t,e,i,n){var s=r._gsap;s.scaleX=s.scaleY=e,s.renderTransform(n,s)},WA=function(r,t,e,i,n){var s=r._gsap;s[t]=e,s.renderTransform(n,s)},Gt="transform",Ce=Gt+"Origin",XA=function r(t,e){var i=this,n=this.target,s=n.style,o=n._gsap;if(t in ni&&s){if(this.tfm=this.tfm||{},t!=="transform")t=Pr[t]||t,~t.indexOf(",")?t.split(",").forEach(function(a){return i.tfm[a]=Yr(n,a)}):this.tfm[t]=o.x?o[t]:Yr(n,t),t===Ce&&(this.tfm.zOrigin=o.zOrigin);else return Pr.transform.split(",").forEach(function(a){return r.call(i,a,e)});if(this.props.indexOf(Gt)>=0)return;o.svg&&(this.svgo=n.getAttribute("data-svg-origin"),this.props.push(Ce,e,"")),t=Gt}(s||e)&&this.props.push(t,e,s[t])},nv=function(r){r.translate&&(r.removeProperty("translate"),r.removeProperty("scale"),r.removeProperty("rotate"))},VA=function(){var r=this.props,t=this.target,e=t.style,i=t._gsap,n,s;for(n=0;n<r.length;n+=3)r[n+1]?t[r[n]]=r[n+2]:r[n+2]?e[r[n]]=r[n+2]:e.removeProperty(r[n].substr(0,2)==="--"?r[n]:r[n].replace(od,"-$1").toLowerCase());if(this.tfm){for(s in this.tfm)i[s]=this.tfm[s];i.svg&&(i.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),n=sd(),(!n||!n.isStart)&&!e[Gt]&&(nv(e),i.zOrigin&&e[Ce]&&(e[Ce]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},sv=function(r,t){var e={target:r,props:[],revert:VA,save:XA};return r._gsap||Me.core.getCache(r),t&&t.split(",").forEach(function(i){return e.save(i)}),e},ov,pc=function(r,t){var e=Ci.createElementNS?Ci.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),r):Ci.createElement(r);return e&&e.style?e:Ci.createElement(r)},kr=function r(t,e,i){var n=getComputedStyle(t);return n[e]||n.getPropertyValue(e.replace(od,"-$1").toLowerCase())||n.getPropertyValue(e)||!i&&r(t,ds(e)||e,1)||""},Am="O,Moz,ms,Ms,Webkit".split(","),ds=function(r,t,e){var i=t||ln,n=i.style,s=5;if(r in n&&!e)return r;for(r=r.charAt(0).toUpperCase()+r.substr(1);s--&&!(Am[s]+r in n););return s<0?null:(s===3?"ms":s>=0?Am[s]:"")+r},mc=function(){OA()&&window.document&&(bm=window,Ci=bm.document,is=Ci.documentElement,ln=pc("div")||{style:{}},pc("div"),Gt=ds(Gt),Ce=Gt+"Origin",ln.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",ov=!!ds("perspective"),sd=Me.core.reverting,nd=1)},nu=function r(t){var e=pc("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,n=this.nextSibling,s=this.style.cssText,o;if(is.appendChild(e),e.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=r}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(n?i.insertBefore(this,n):i.appendChild(this)),is.removeChild(e),this.style.cssText=s,o},Sm=function(r,t){for(var e=t.length;e--;)if(r.hasAttribute(t[e]))return r.getAttribute(t[e])},av=function(r){var t;try{t=r.getBBox()}catch{t=nu.call(r,!0)}return t&&(t.width||t.height)||r.getBBox===nu||(t=nu.call(r,!0)),t&&!t.width&&!t.x&&!t.y?{x:+Sm(r,["x","cx","x1"])||0,y:+Sm(r,["y","cy","y1"])||0,width:0,height:0}:t},hv=function(r){return!!(r.getCTM&&(!r.parentNode||r.ownerSVGElement)&&av(r))},Tn=function(r,t){if(t){var e=r.style,i;t in ni&&t!==Ce&&(t=Gt),e.removeProperty?(i=t.substr(0,2),(i==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),e.removeProperty(i==="--"?t:t.replace(od,"-$1").toLowerCase())):e.removeAttribute(t)}},Mi=function(r,t,e,i,n,s){var o=new Se(r._pt,t,e,0,1,s?iv:rv);return r._pt=o,o.b=i,o.e=n,r._props.push(e),o},Cm={deg:1,rad:1,turn:1},$A={grid:1,flex:1},Li=function r(t,e,i,n){var s=parseFloat(i)||0,o=(i+"").trim().substr((s+"").length)||"px",a=ln.style,h=kA.test(e),l=t.tagName.toLowerCase()==="svg",u=(l?"client":"offset")+(h?"Width":"Height"),c=100,d=n==="px",f=n==="%",p,m,g,v;if(n===o||!s||Cm[n]||Cm[o])return s;if(o!=="px"&&!d&&(s=r(t,e,i,"px")),v=t.getCTM&&hv(t),(f||o==="%")&&(ni[e]||~e.indexOf("adius")))return p=v?t.getBBox()[h?"width":"height"]:t[u],Vt(f?s/p*c:s/100*p);if(a[h?"width":"height"]=c+(d?o:n),m=~e.indexOf("adius")||n==="em"&&t.appendChild&&!l?t:t.parentNode,v&&(m=(t.ownerSVGElement||{}).parentNode),(!m||m===Ci||!m.appendChild)&&(m=Ci.body),g=m._gsap,g&&f&&g.width&&h&&g.time===Ne.time&&!g.uncache)return Vt(s/g.width*c);if(f&&(e==="height"||e==="width")){var w=t.style[e];t.style[e]=c+n,p=t[u],w?t.style[e]=w:Tn(t,e)}else(f||o==="%")&&!$A[kr(m,"display")]&&(a.position=kr(t,"position")),m===t&&(a.position="static"),m.appendChild(ln),p=ln[u],m.removeChild(ln),a.position="absolute";return h&&f&&(g=pn(m),g.time=Ne.time,g.width=m[u]),Vt(d?p*s/c:p&&s?c/p*s:0)},Yr=function(r,t,e,i){var n;return nd||mc(),t in Pr&&t!=="transform"&&(t=Pr[t],~t.indexOf(",")&&(t=t.split(",")[0])),ni[t]&&t!=="transform"?(n=go(r,i),n=t!=="transformOrigin"?n[t]:n.svg?n.origin:ah(kr(r,Ce))+" "+n.zOrigin+"px"):(n=r.style[t],(!n||n==="auto"||i||~(n+"").indexOf("calc("))&&(n=oh[t]&&oh[t](r,t,e)||kr(r,t)||Ey(r,t)||(t==="opacity"?1:0))),e&&!~(n+"").trim().indexOf(" ")?Li(r,t,n,e)+e:n},YA=function(r,t,e,i){if(!e||e==="none"){var n=ds(t,r,1),s=n&&kr(r,n,1);s&&s!==e?(t=n,e=s):t==="borderColor"&&(e=kr(r,"borderTopColor"))}var o=new Se(this._pt,r.style,t,0,1,Jy),a=0,h=0,l,u,c,d,f,p,m,g,v,w,_,T;if(o.b=e,o.e=i,e+="",i+="",i==="auto"&&(p=r.style[t],r.style[t]=i,i=kr(r,t)||i,p?r.style[t]=p:Tn(r,t)),l=[e,i],jy(l),e=l[0],i=l[1],c=e.match($n)||[],T=i.match($n)||[],T.length){for(;u=$n.exec(i);)m=u[0],v=i.substring(a,u.index),f?f=(f+1)%5:(v.substr(-5)==="rgba("||v.substr(-5)==="hsla(")&&(f=1),m!==(p=c[h++]||"")&&(d=parseFloat(p)||0,_=p.substr((d+"").length),m.charAt(1)==="="&&(m=rs(d,m)+_),g=parseFloat(m),w=m.substr((g+"").length),a=$n.lastIndex-w.length,w||(w=w||Le.units[t]||_,a===i.length&&(i+=w,o.e+=w)),_!==w&&(d=Li(r,t,p,w)||0),o._pt={_next:o._pt,p:v||h===1?v:",",s:d,c:g-d,m:f&&f<4||t==="zIndex"?Math.round:0});o.c=a<i.length?i.substring(a,i.length):""}else o.r=t==="display"&&i==="none"?iv:rv;return vy.test(i)&&(o.e=0),this._pt=o,o},Mm={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},qA=function(r){var t=r.split(" "),e=t[0],i=t[1]||"50%";return(e==="top"||e==="bottom"||i==="left"||i==="right")&&(r=e,e=i,i=r),t[0]=Mm[e]||e,t[1]=Mm[i]||i,t.join(" ")},ZA=function(r,t){if(t.tween&&t.tween._time===t.tween._dur){var e=t.t,i=e.style,n=t.u,s=e._gsap,o,a,h;if(n==="all"||n===!0)i.cssText="",a=1;else for(n=n.split(","),h=n.length;--h>-1;)o=n[h],ni[o]&&(a=1,o=o==="transformOrigin"?Ce:Gt),Tn(e,o);a&&(Tn(e,Gt),s&&(s.svg&&e.removeAttribute("transform"),go(e,1),s.uncache=1,nv(i)))}},oh={clearProps:function(r,t,e,i,n){if(n.data!=="isFromStart"){var s=r._pt=new Se(r._pt,t,e,0,0,ZA);return s.u=i,s.pr=-10,s.tween=n,r._props.push(e),1}}},mo=[1,0,0,1,0,0],lv={},uv=function(r){return r==="matrix(1, 0, 0, 1, 0, 0)"||r==="none"||!r},Rm=function(r){var t=kr(r,Gt);return uv(t)?mo:t.substr(7).match(yy).map(Vt)},ad=function(r,t){var e=r._gsap||pn(r),i=r.style,n=Rm(r),s,o,a,h;return e.svg&&r.getAttribute("transform")?(a=r.transform.baseVal.consolidate().matrix,n=[a.a,a.b,a.c,a.d,a.e,a.f],n.join(",")==="1,0,0,1,0,0"?mo:n):(n===mo&&!r.offsetParent&&r!==is&&!e.svg&&(a=i.display,i.display="block",s=r.parentNode,(!s||!r.offsetParent)&&(h=1,o=r.nextElementSibling,is.appendChild(r)),n=Rm(r),a?i.display=a:Tn(r,"display"),h&&(o?s.insertBefore(r,o):s?s.appendChild(r):is.removeChild(r))),t&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},gc=function(r,t,e,i,n,s){var o=r._gsap,a=n||ad(r,!0),h=o.xOrigin||0,l=o.yOrigin||0,u=o.xOffset||0,c=o.yOffset||0,d=a[0],f=a[1],p=a[2],m=a[3],g=a[4],v=a[5],w=t.split(" "),_=parseFloat(w[0])||0,T=parseFloat(w[1])||0,b,x,y,S;e?a!==mo&&(x=d*m-f*p)&&(y=_*(m/x)+T*(-p/x)+(p*v-m*g)/x,S=_*(-f/x)+T*(d/x)-(d*v-f*g)/x,_=y,T=S):(b=av(r),_=b.x+(~w[0].indexOf("%")?_/100*b.width:_),T=b.y+(~(w[1]||w[0]).indexOf("%")?T/100*b.height:T)),i||i!==!1&&o.smooth?(g=_-h,v=T-l,o.xOffset=u+(g*d+v*p)-g,o.yOffset=c+(g*f+v*m)-v):o.xOffset=o.yOffset=0,o.xOrigin=_,o.yOrigin=T,o.smooth=!!i,o.origin=t,o.originIsAbsolute=!!e,r.style[Ce]="0px 0px",s&&(Mi(s,o,"xOrigin",h,_),Mi(s,o,"yOrigin",l,T),Mi(s,o,"xOffset",u,o.xOffset),Mi(s,o,"yOffset",c,o.yOffset)),r.setAttribute("data-svg-origin",_+" "+T)},go=function(r,t){var e=r._gsap||new $y(r);if("x"in e&&!t&&!e.uncache)return e;var i=r.style,n=e.scaleX<0,s="px",o="deg",a=getComputedStyle(r),h=kr(r,Ce)||"0",l,u,c,d,f,p,m,g,v,w,_,T,b,x,y,S,D,G,O,N,P,F,j,E,A,C,B,I,M,k,L,V;return l=u=c=p=m=g=v=w=_=0,d=f=1,e.svg=!!(r.getCTM&&hv(r)),a.translate&&((a.translate!=="none"||a.scale!=="none"||a.rotate!=="none")&&(i[Gt]=(a.translate!=="none"?"translate3d("+(a.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(a.rotate!=="none"?"rotate("+a.rotate+") ":"")+(a.scale!=="none"?"scale("+a.scale.split(" ").join(",")+") ":"")+(a[Gt]!=="none"?a[Gt]:"")),i.scale=i.rotate=i.translate="none"),x=ad(r,e.svg),e.svg&&(e.uncache?(A=r.getBBox(),h=e.xOrigin-A.x+"px "+(e.yOrigin-A.y)+"px",E=""):E=!t&&r.getAttribute("data-svg-origin"),gc(r,E||h,!!E||e.originIsAbsolute,e.smooth!==!1,x)),T=e.xOrigin||0,b=e.yOrigin||0,x!==mo&&(G=x[0],O=x[1],N=x[2],P=x[3],l=F=x[4],u=j=x[5],x.length===6?(d=Math.sqrt(G*G+O*O),f=Math.sqrt(P*P+N*N),p=G||O?Bn(O,G)*on:0,v=N||P?Bn(N,P)*on+p:0,v&&(f*=Math.abs(Math.cos(v*ns))),e.svg&&(l-=T-(T*G+b*N),u-=b-(T*O+b*P))):(V=x[6],k=x[7],B=x[8],I=x[9],M=x[10],L=x[11],l=x[12],u=x[13],c=x[14],y=Bn(V,M),m=y*on,y&&(S=Math.cos(-y),D=Math.sin(-y),E=F*S+B*D,A=j*S+I*D,C=V*S+M*D,B=F*-D+B*S,I=j*-D+I*S,M=V*-D+M*S,L=k*-D+L*S,F=E,j=A,V=C),y=Bn(-N,M),g=y*on,y&&(S=Math.cos(-y),D=Math.sin(-y),E=G*S-B*D,A=O*S-I*D,C=N*S-M*D,L=P*D+L*S,G=E,O=A,N=C),y=Bn(O,G),p=y*on,y&&(S=Math.cos(y),D=Math.sin(y),E=G*S+O*D,A=F*S+j*D,O=O*S-G*D,j=j*S-F*D,G=E,F=A),m&&Math.abs(m)+Math.abs(p)>359.9&&(m=p=0,g=180-g),d=Vt(Math.sqrt(G*G+O*O+N*N)),f=Vt(Math.sqrt(j*j+V*V)),y=Bn(F,j),v=Math.abs(y)>2e-4?y*on:0,_=L?1/(L<0?-L:L):0),e.svg&&(E=r.getAttribute("transform"),e.forceCSS=r.setAttribute("transform","")||!uv(kr(r,Gt)),E&&r.setAttribute("transform",E))),Math.abs(v)>90&&Math.abs(v)<270&&(n?(d*=-1,v+=p<=0?180:-180,p+=p<=0?180:-180):(f*=-1,v+=v<=0?180:-180)),t=t||e.uncache,e.x=l-((e.xPercent=l&&(!t&&e.xPercent||(Math.round(r.offsetWidth/2)===Math.round(-l)?-50:0)))?r.offsetWidth*e.xPercent/100:0)+s,e.y=u-((e.yPercent=u&&(!t&&e.yPercent||(Math.round(r.offsetHeight/2)===Math.round(-u)?-50:0)))?r.offsetHeight*e.yPercent/100:0)+s,e.z=c+s,e.scaleX=Vt(d),e.scaleY=Vt(f),e.rotation=Vt(p)+o,e.rotationX=Vt(m)+o,e.rotationY=Vt(g)+o,e.skewX=v+o,e.skewY=w+o,e.transformPerspective=_+s,(e.zOrigin=parseFloat(h.split(" ")[2])||!t&&e.zOrigin||0)&&(i[Ce]=ah(h)),e.xOffset=e.yOffset=0,e.force3D=Le.force3D,e.renderTransform=e.svg?QA:ov?cv:KA,e.uncache=0,e},ah=function(r){return(r=r.split(" "))[0]+" "+r[1]},su=function(r,t,e){var i=pe(t);return Vt(parseFloat(t)+parseFloat(Li(r,"x",e+"px",i)))+i},KA=function(r,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,cv(r,t)},Ki="0deg",ks="0px",Qi=") ",cv=function(r,t){var e=t||this,i=e.xPercent,n=e.yPercent,s=e.x,o=e.y,a=e.z,h=e.rotation,l=e.rotationY,u=e.rotationX,c=e.skewX,d=e.skewY,f=e.scaleX,p=e.scaleY,m=e.transformPerspective,g=e.force3D,v=e.target,w=e.zOrigin,_="",T=g==="auto"&&r&&r!==1||g===!0;if(w&&(u!==Ki||l!==Ki)){var b=parseFloat(l)*ns,x=Math.sin(b),y=Math.cos(b),S;b=parseFloat(u)*ns,S=Math.cos(b),s=su(v,s,x*S*-w),o=su(v,o,-Math.sin(b)*-w),a=su(v,a,y*S*-w+w)}m!==ks&&(_+="perspective("+m+Qi),(i||n)&&(_+="translate("+i+"%, "+n+"%) "),(T||s!==ks||o!==ks||a!==ks)&&(_+=a!==ks||T?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+Qi),h!==Ki&&(_+="rotate("+h+Qi),l!==Ki&&(_+="rotateY("+l+Qi),u!==Ki&&(_+="rotateX("+u+Qi),(c!==Ki||d!==Ki)&&(_+="skew("+c+", "+d+Qi),(f!==1||p!==1)&&(_+="scale("+f+", "+p+Qi),v.style[Gt]=_||"translate(0, 0)"},QA=function(r,t){var e=t||this,i=e.xPercent,n=e.yPercent,s=e.x,o=e.y,a=e.rotation,h=e.skewX,l=e.skewY,u=e.scaleX,c=e.scaleY,d=e.target,f=e.xOrigin,p=e.yOrigin,m=e.xOffset,g=e.yOffset,v=e.forceCSS,w=parseFloat(s),_=parseFloat(o),T,b,x,y,S;a=parseFloat(a),h=parseFloat(h),l=parseFloat(l),l&&(l=parseFloat(l),h+=l,a+=l),a||h?(a*=ns,h*=ns,T=Math.cos(a)*u,b=Math.sin(a)*u,x=Math.sin(a-h)*-c,y=Math.cos(a-h)*c,h&&(l*=ns,S=Math.tan(h-l),S=Math.sqrt(1+S*S),x*=S,y*=S,l&&(S=Math.tan(l),S=Math.sqrt(1+S*S),T*=S,b*=S)),T=Vt(T),b=Vt(b),x=Vt(x),y=Vt(y)):(T=u,y=c,b=x=0),(w&&!~(s+"").indexOf("px")||_&&!~(o+"").indexOf("px"))&&(w=Li(d,"x",s,"px"),_=Li(d,"y",o,"px")),(f||p||m||g)&&(w=Vt(w+f-(f*T+p*x)+m),_=Vt(_+p-(f*b+p*y)+g)),(i||n)&&(S=d.getBBox(),w=Vt(w+i/100*S.width),_=Vt(_+n/100*S.height)),S="matrix("+T+","+b+","+x+","+y+","+w+","+_+")",d.setAttribute("transform",S),v&&(d.style[Gt]=S)},JA=function(r,t,e,i,n){var s=360,o=he(n),a=parseFloat(n)*(o&&~n.indexOf("rad")?on:1),h=a-i,l=i+h+"deg",u,c;return o&&(u=n.split("_")[1],u==="short"&&(h%=s,h!==h%(s/2)&&(h+=h<0?s:-s)),u==="cw"&&h<0?h=(h+s*Em)%s-~~(h/s)*s:u==="ccw"&&h>0&&(h=(h-s*Em)%s-~~(h/s)*s)),r._pt=c=new Se(r._pt,t,e,i,h,FA),c.e=l,c.u="deg",r._props.push(e),c},Pm=function(r,t){for(var e in t)r[e]=t[e];return r},tS=function(r,t,e){var i=Pm({},e._gsap),n="perspective,force3D,transformOrigin,svgOrigin",s=e.style,o,a,h,l,u,c,d,f;i.svg?(h=e.getAttribute("transform"),e.setAttribute("transform",""),s[Gt]=t,o=go(e,1),Tn(e,Gt),e.setAttribute("transform",h)):(h=getComputedStyle(e)[Gt],s[Gt]=t,o=go(e,1),s[Gt]=h);for(a in ni)h=i[a],l=o[a],h!==l&&n.indexOf(a)<0&&(d=pe(h),f=pe(l),u=d!==f?Li(e,a,h,f):parseFloat(h),c=parseFloat(l),r._pt=new Se(r._pt,o,a,u,c-u,fc),r._pt.u=f||0,r._props.push(a));Pm(o,i)};Ae("padding,margin,Width,Radius",function(r,t){var e="Top",i="Right",n="Bottom",s="Left",o=(t<3?[e,i,n,s]:[e+s,e+i,n+i,n+s]).map(function(a){return t<2?r+a:"border"+a+r});oh[t>1?"border"+r:r]=function(a,h,l,u,c){var d,f;if(arguments.length<4)return d=o.map(function(p){return Yr(a,p,l)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(u+"").split(" "),f={},o.forEach(function(p,m){return f[p]=d[m]=d[m]||d[(m-1)/2|0]}),a.init(h,f,c)}});var dv={name:"css",register:mc,targetTest:function(r){return r.style&&r.nodeType},init:function(r,t,e,i,n){var s=this._props,o=r.style,a=e.vars.startAt,h,l,u,c,d,f,p,m,g,v,w,_,T,b,x,y;nd||mc(),this.styles=this.styles||sv(r),y=this.styles.props,this.tween=e;for(p in t)if(p!=="autoRound"&&(l=t[p],!(Oe[p]&&Yy(p,t,e,i,r,n)))){if(d=typeof l,f=oh[p],d==="function"&&(l=l.call(e,i,r,n),d=typeof l),d==="string"&&~l.indexOf("random(")&&(l=co(l)),f)f(this,r,p,l,e)&&(x=1);else if(p.substr(0,2)==="--")h=(getComputedStyle(r).getPropertyValue(p)+"").trim(),l+="",Ii.lastIndex=0,Ii.test(h)||(m=pe(h),g=pe(l)),g?m!==g&&(h=Li(r,p,h,g)+g):m&&(l+=m),this.add(o,"setProperty",h,l,i,n,0,0,p),s.push(p),y.push(p,0,o[p]);else if(d!=="undefined"){if(a&&p in a?(h=typeof a[p]=="function"?a[p].call(e,i,r,n):a[p],he(h)&&~h.indexOf("random(")&&(h=co(h)),pe(h+"")||h==="auto"||(h+=Le.units[p]||pe(Yr(r,p))||""),(h+"").charAt(1)==="="&&(h=Yr(r,p))):h=Yr(r,p),c=parseFloat(h),v=d==="string"&&l.charAt(1)==="="&&l.substr(0,2),v&&(l=l.substr(2)),u=parseFloat(l),p in Pr&&(p==="autoAlpha"&&(c===1&&Yr(r,"visibility")==="hidden"&&u&&(c=0),y.push("visibility",0,o.visibility),Mi(this,o,"visibility",c?"inherit":"hidden",u?"inherit":"hidden",!u)),p!=="scale"&&p!=="transform"&&(p=Pr[p],~p.indexOf(",")&&(p=p.split(",")[0]))),w=p in ni,w){if(this.styles.save(p),_||(T=r._gsap,T.renderTransform&&!t.parseTransform||go(r,t.parseTransform),b=t.smoothOrigin!==!1&&T.smooth,_=this._pt=new Se(this._pt,o,Gt,0,1,T.renderTransform,T,0,-1),_.dep=1),p==="scale")this._pt=new Se(this._pt,T,"scaleY",T.scaleY,(v?rs(T.scaleY,v+u):u)-T.scaleY||0,fc),this._pt.u=0,s.push("scaleY",p),p+="X";else if(p==="transformOrigin"){y.push(Ce,0,o[Ce]),l=qA(l),T.svg?gc(r,l,0,b,0,this):(g=parseFloat(l.split(" ")[2])||0,g!==T.zOrigin&&Mi(this,T,"zOrigin",T.zOrigin,g),Mi(this,o,p,ah(h),ah(l)));continue}else if(p==="svgOrigin"){gc(r,l,1,b,0,this);continue}else if(p in lv){JA(this,T,p,c,v?rs(c,v+l):l);continue}else if(p==="smoothOrigin"){Mi(this,T,"smooth",T.smooth,l);continue}else if(p==="force3D"){T[p]=l;continue}else if(p==="transform"){tS(this,l,r);continue}}else p in o||(p=ds(p)||p);if(w||(u||u===0)&&(c||c===0)&&!NA.test(l)&&p in o)m=(h+"").substr((c+"").length),u||(u=0),g=pe(l)||(p in Le.units?Le.units[p]:m),m!==g&&(c=Li(r,p,h,g)),this._pt=new Se(this._pt,w?T:o,p,c,(v?rs(c,v+u):u)-c,!w&&(g==="px"||p==="zIndex")&&t.autoRound!==!1?BA:fc),this._pt.u=g||0,m!==g&&g!=="%"&&(this._pt.b=h,this._pt.r=LA);else if(p in o)YA.call(this,r,p,h,v?v+l:l);else if(p in r)this.add(r,p,h||r[p],v?v+l:l,i,n);else if(p!=="parseTransform"){qc(p,l);continue}w||(p in o?y.push(p,0,o[p]):y.push(p,1,h||r[p])),s.push(p)}}x&&tv(this)},render:function(r,t){if(t.tween._time||!sd())for(var e=t._pt;e;)e.r(r,e.d),e=e._next;else t.styles.revert()},get:Yr,aliases:Pr,getSetter:function(r,t,e){var i=Pr[t];return i&&i.indexOf(",")<0&&(t=i),t in ni&&t!==Ce&&(r._gsap.x||Yr(r,"x"))?e&&Tm===e?t==="scale"?zA:GA:(Tm=e||{})&&(t==="scale"?jA:WA):r.style&&!Vc(r.style[t])?UA:~t.indexOf("-")?HA:rd(r,t)},core:{_removeProperty:Tn,_getMatrix:ad}};Me.utils.checkPrefix=ds;Me.core.getStyleSaver=sv;(function(r,t,e,i){var n=Ae(r+","+t+","+e,function(s){ni[s]=1});Ae(t,function(s){Le.units[s]="deg",lv[s]=1}),Pr[n[13]]=r+","+t,Ae(i,function(s){var o=s.split(":");Pr[o[1]]=n[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Ae("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){Le.units[r]="px"});Me.registerPlugin(dv);var fv=Me.registerPlugin(dv)||Me;fv.core.Tween;function pv(r,t){return typeof r=="function"?r(t):r&&typeof r=="object"&&pm in r?r[pm](t):r instanceof Date?new r.constructor(t):new Date(t)}function yc(r,t){return pv(r,r)}function eS(r,t,e){return pv(r,+yc(r)+t)}function rS(r,t,e){return eS(r,t*1e3)}function iS(r){return t=>{const e=Math.trunc,i=e(t);return i===0?0:i}}function mv(r,t){return+yc(r)-+yc(t)}function nS(r,t,e){const i=mv(r,t)/1e3;return iS()(i)}const sS=r=>({font:{fontFamily:"ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",type:"BitmapFont"},rowGap:24,columnGap:32,textDefault:r==="dark"?"#ffffff":"#161618",textInverse:r==="dark"?"#161618":"#ffffff",selectedBorderColor:r==="dark"?"#3fa2c3":"#297f9c",selectedBorderWidth:2,selectedBorderOffset:4,selectedBorderRadius:9,nodesPadding:16,nodeHeight:32,nodePadding:4,nodeRadius:6,nodeBorderRadius:9,nodeToggleSize:28,nodeToggleBgColor:"#35363C",nodeToggleBorderRadius:6,nodeToggleBorderColor:r==="dark"?"#4d4f56":"#bbbec9",nodeUnselectedAlpha:.2,artifactsGap:4,artifactsNodeOverlap:4,artifactPaddingLeft:2,artifactPaddingRight:4,artifactPaddingY:2,artifactTextColor:"#ffffff",artifactBgColor:"#35363b",artifactBorderRadius:4,artifactContentGap:4,artifactIconSize:16,artifactIconColor:"#ffffff",flowStateBarHeight:8,flowStateSelectedBarHeight:10,flowStateAreaAlpha:.1,eventTargetSize:30,eventBottomMargin:4,eventSelectedBorderInset:8,eventRadiusDefault:4,eventColor:"#A564F9",eventClusterRadiusDefault:6,eventClusterColor:"#A564F9",edgeColor:r==="dark"?"#adadad":"#737682",guideLineWidth:1,guideLineColor:r==="dark"?"#4d4f56":"#bbbec9",guideTextTopPadding:8,guideTextLeftPadding:8,guideTextSize:12,guideTextColor:r==="dark"?"#adadad":"#737682",playheadWidth:2,playheadColor:"#6272FF",node:()=>({background:"#ffffff"}),state:()=>({background:"#ffffff"})});let qn=null;async function oS(){const r=await Ue();qn=Im(r),rt.emit("stylesCreated",qn),rt.on("configUpdated",t=>{qn=Im(t),rt.emit("stylesUpdated",qn)})}function aS(){qn=null}async function jt(){return qn||await Re("stylesCreated")}function Im(r){return{...sS(r.theme),...r.styles?.(r.theme)}}function hS(r){let t=0;for(const[,{children:e}]of r)t+=e.length;return t}function lS({start_time:r,end_time:t,nodes:e},i,n){const s=Math.max(nS(t??new Date,r),1),o=i.nodeHeight+i.rowGap;return(e.size>0?e.size*o*.5:o*4)*n/(s*Ag)}async function uS(){const r=await Hr(),t=await Ue(),e=await jt(),i=await Qt(),n=i.view.width/i.view.height,s=lS(r,e,n);gv(s,!0),r.nodes.size>t.disableAnimationsThreshold&&(ut.disableAnimations=!0),hS(r.nodes)>t.disableEdgesThreshold&&(ut.disableEdges=!0)}function cS(){ut.horizontal="temporal",ut.vertical="nearest-parent",ut.horizontalScaleMultiplierDefault=0,ut.horizontalScaleMultiplier=0,ut.disableAnimations=!1,ut.disableGuides=!1,ut.disableEdges=!1,ut.disableArtifacts=!1,ut.disableEvents=!1}const ut={horizontal:"temporal",vertical:"nearest-parent",horizontalScaleMultiplierDefault:0,horizontalScaleMultiplier:0,disableAnimations:!1,disableGuides:!1,disableEdges:!1,disableArtifacts:!1,disableEvents:!1,isTemporal(){return this.horizontal==="temporal"},isDependency(){return this.horizontal==="dependency"},isWaterfall(){return this.vertical==="waterfall"},isNearestParent(){return this.vertical==="nearest-parent"},isLeftAligned(){return this.horizontal==="left-aligned"}};async function Kt(){return vc()?ut:await Re("layoutSettingsCreated")}function hd(){return ut.isDependency()?vx:Ag*ut.horizontalScaleMultiplier}function dS(){return[0,hd()]}function fS(r){if(ut.isDependency())return[0,1];const t=r,e=rS(t,yx);return[t,e]}function gv(r,t=!1){if(ut.horizontalScaleMultiplier===r)return;const e=xs();ut.horizontalScaleMultiplier=r,t&&(ut.horizontalScaleMultiplierDefault=r),e()}function hD(){gv(ut.horizontalScaleMultiplierDefault)}function lD(r){if(ut.horizontal===r)return;const t=xs();ut.horizontal=r,ut.disableGuides=ut.isDependency()||ut.isLeftAligned(),t()}function uD(r){if(ut.vertical===r)return;const t=xs();ut.vertical=r,t()}function cD(r){if(ut.disableEdges===r)return;const t=xs();ut.disableEdges=r,t()}function dD(r){if(ut.disableArtifacts===r)return;const t=xs();ut.disableArtifacts=r,t()}function fD(r){if(ut.disableEvents===r)return;const t=xs();ut.disableEvents=r,t()}function xs(){const r=vc()?"layoutSettingsUpdated":"layoutSettingsCreated",{horizontal:t,vertical:e}=ut;return()=>{vc()&&rt.emit(r,ut),(t!==ut.horizontal||e!==ut.vertical)&&rt.emit("layoutUpdated")}}function vc(){return ut.horizontalScaleMultiplier!==0}async function yv(){const r=await Kt(),t=await Ue();function e(i,n,s){const o=r.disableAnimations||s?0:t.animationDuration/1e3;return fv.to(i,{...n,duration:o,ease:"power1.out",onUpdate:()=>{Io()}})}return{animate:e}}async function pS({size:r,stroke:t=1,radius:e=0}){const i=await Qt(),n=new ki;return n.lineStyle(t,"#fff",1,0),n.drawRoundedRect(0,0,r*2,r*2,e),i.renderer.generateTexture(n,{region:new yt(0,0,r,r),resolution:10})}async function Zs(r){return await So(pS,[r])}var hh=(r=>(r[r.Up=0]="Up",r[r.Down=180]="Down",r[r.Left=270]="Left",r[r.Right=90]="Right",r))(hh||{});function vv(){const r=new Yt;async function t(e){const{rotate:i=0}=e,n={size:e.size,radius:e.radius,stroke:e.stroke},s=await Zs(n);return r.texture=s,r.anchor.set(.5,.5),r.angle=45+i,r}return{element:r,render:t}}async function mS(){const r=await Qt(),t=new ki;return t.beginFill("#fff"),t.drawRect(0,0,1,1),t.endFill(),r.renderer.generateTexture(t,{wrapMode:Ir.REPEAT})}async function ld(){return await So(mS,[])}function _c(r,t){return Array.from({length:r},(e,i)=>t(i))}const gS=8,yS=2;async function vS(){const r=await jt(),t=await S_(),e=await VI(),{animate:i}=await yv(),n=new bt,{element:s,render:o}=await vv(),a=await ld(),h=_c(Mg,()=>new mt),l=new gT(a,h);let u=!1;n.name=gx,n.addChild(s),n.addChild(l),t.addAll([s,l]),e.add(n);async function c(){return await o({size:10,rotate:hh.Right}),s.tint=r.edgeColor,l.tint=r.edgeColor,n}async function d(p,m){const g=f(m);u||await c();for(const[v,w]of h.entries()){const{x:_,y:T}=g[v];i(w,{x:_,y:T},!u)}i(n,{x:p.x,y:p.y},!u),i(s,{x:m.x-gS,y:m.y},!u),u=!0}function f({x:p,y:m}){const g=[],v={x:0,y:0},w={x:p-yS,y:m},_={x:Dm(v.x,{source:v,target:w}),y:v.y},T={x:Dm(w.x,{source:v,target:w},!0),y:w.y};for(const[b]of h.entries()){if(b===h.length-1){g[b]=w;continue}const x=_S(b,{source:v,target:w,sourceBezier:_,targetBezier:T});g[b]=x}return g}return{element:n,render:c,setPosition:d}}function Dm(r,{source:t,target:e},i){const n=(e.x-t.x)/2;return r+(n>Bd?n:Bd)*(i?-1:1)}function _S(r,t){const e=r/Mg,{source:i,target:n,sourceBezier:s,targetBezier:o}=t,a=i.x+(s.x-i.x)*e,h=i.y+(s.y-i.y)*e,l=s.x+(o.x-s.x)*e,u=s.y+(o.y-s.y)*e,c=o.x+(n.x-o.x)*e,d=o.y+(n.y-o.y)*e,f=a+(l-a)*e,p=h+(u-h)*e,m=l+(c-l)*e,g=u+(d-u)*e,v=f+(m-f)*e,w=p+(g-p)*e;return{x:v,y:w}}async function xS({height:r,radius:t}){const e=await Qt(),i=new ki;return i.beginFill("#fff"),i.drawRoundedRect(0,0,t*2,r,t),i.endFill(),e.renderer.generateTexture(i,{region:new yt(0,0,t,r),resolution:Sg})}async function wS(r){return await So(xS,[r])}function bS(){const r=new Yt,t=new Yt;async function e(i){const n=await wS(i);return r.texture=n,t.texture=n,t.anchor.x=1,t.scale.x=-1,{left:r,right:t}}return{left:r,right:t,render:e}}async function si(){const r=await ld();return new Yt(r)}async function ud(){const r=new bt,t=await si(),{left:e,right:i,render:n}=await bS();r.addChild(t),r.addChild(e),r.addChild(i);async function s(h){const{width:l,x:u,visible:c}=a(h);return await n({height:h.height,radius:h.radius}),t.visible=c,t.width=l,t.height=h.height,t.x=u,e.visible=o(h.capLeft,h.radius),i.visible=o(h.capRight,h.radius),i.x=h.radius+l,t.tint=h.background,e.tint=h.background,i.tint=h.background,r}function o(h,l){return l===0?!1:h??!0}function a(h){const l=o(h.capLeft,h.radius),u=o(h.capRight,h.radius);let c=0;l&&(c+=h.radius),u&&(c+=h.radius);const d=Math.max(h.width-c,0),f=d>0,p=l?h.radius:0;return{width:d,visible:f,x:p}}return{element:r,render:s}}function Bh(){const r=new bt,t=new Yt,e=new Yt,i=new Yt,n=new Yt,s=new Yt,o=new Yt,a=new Yt,h=new Yt;t.name="border-corner-top-left",e.name="border-corner-top-right",i.name="border-corner-bottom-left",n.name="border-corner-bottom-right",s.name="border-corner-left",o.name="border-corner-right",a.name="border-corner-top",h.name="border-corner-bottom",e.anchor.x=1,e.scale.x=-1,i.anchor.y=1,i.scale.y=-1,n.anchor.x=1,n.scale.x=-1,n.anchor.y=1,n.scale.y=-1,r.addChild(t),r.addChild(e),r.addChild(i),r.addChild(n),r.addChild(s),r.addChild(o),r.addChild(a),r.addChild(h);async function l(p){const{radius:m=0,color:g="#fff",stroke:v,width:w,height:_}=p,T=typeof m=="number",b={topLeft:u(T?m:m[0],w,_),topRight:u(T?m:m[1],w,_),bottomLeft:u(T?m:m[2],w,_),bottomRight:u(T?m:m[3],w,_)};return await c({width:w,height:_,stroke:v,cornerSizes:b}),await d({width:w,height:_,stroke:v,cornerSizes:b}),f(g),r}function u(p,m,g){const v=Math.min(m,g);return{size:p*2>v?v/2:p,radius:p}}async function c({width:p,height:m,stroke:g,cornerSizes:v}){const{topLeft:w,topRight:_,bottomLeft:T,bottomRight:b}=v,[x,y,S,D]=await Promise.all([Zs({...w,stroke:g}),Zs({..._,stroke:g}),Zs({...T,stroke:g}),Zs({...b,stroke:g})]);t.texture=x,e.texture=y,i.texture=D,n.texture=S,t.position.set(0,0),e.position.set(p-_.size,0),i.position.set(0,m-T.size),n.position.set(p-b.size,m-b.size)}async function d({width:p,height:m,stroke:g,cornerSizes:v}){const w=await ld(),{topLeft:_,topRight:T,bottomLeft:b,bottomRight:x}=v;a.texture=w,s.texture=w,o.texture=w,h.texture=w,s.position.set(0,_.size),s.height=Math.max(m-_.size-b.size,0),s.width=g,o.position.set(p-g,T.size),o.height=Math.max(m-T.size-x.size,0),o.width=g,a.position.set(_.size,0),a.width=Math.max(p-_.size-T.size,0),a.height=g,h.position.set(b.size,m-g),h.width=Math.max(p-b.size-x.size,0),h.height=g}function f(p){t.tint=p,e.tint=p,i.tint=p,n.tint=p,a.tint=p,s.tint=p,o.tint=p,h.tint=p}return{element:r,render:l}}async function Uh(){const r=await jt(),t=new bt,{element:e,render:i}=await Bh();async function n({selected:s,width:o,height:a}){if(!s)return t.removeChild(e),t;const{selectedBorderColor:h,selectedBorderWidth:l,selectedBorderOffset:u,selectedBorderRadius:c}=r;return e.position.set(-u,-u),t.addChild(e),await i({stroke:l,radius:c,width:o+u*2,height:a+u*2,color:h}),t}return{element:t,render:n}}async function TS(){const r=await jt(),t=new bt,{element:e,render:i}=await ud(),{element:n,render:s}=await Uh();t.addChild(e),t.addChild(n);async function o({selected:a,width:h,height:l}){const{artifactBgColor:u,artifactBorderRadius:c}=r,d={width:h,height:l,background:u,radius:c,capLeft:!0,capRight:!0};return await Promise.all([i(d),s({selected:a,width:h,height:l})]),t}return{element:t,render:o}}var ES=Object.defineProperty,AS=(r,t,e)=>t in r?ES(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Ns=(r,t,e)=>(AS(r,typeof t!="symbol"?t+"":t,e),e);class SS extends bt{constructor(t){super(),Ns(this,"_progress",0),Ns(this,"options"),Ns(this,"bgCircle",new ki),Ns(this,"fillCircle",new ki),Ns(this,"innerView",new bt),this.options=t,this.addChild(this.innerView),this.innerView.addChild(this.bgCircle,this.fillCircle),this.addBackground(),t.value&&(this.progress=t.value)}addBackground(){const{backgroundColor:t,lineWidth:e,radius:i,backgroundAlpha:n}=this.options;let s=1;n>0&&(s=n),t===void 0&&(s=1e-6),this.bgCircle.lineStyle({width:e,color:t,alpha:s}).drawCircle(0,0,i)}set progress(t){t>100&&(t=100),t<0&&(t=0),this._progress=t;const{lineWidth:e,radius:i,fillColor:n,fillAlpha:s,cap:o}=this.options;if(t===0&&s===0){this.fillCircle.clear();return}const a=0,h=360/100*t;this.fillCircle.clear().lineStyle({width:e,color:n,cap:o,alpha:s}).arc(0,0,i,(-90+a)*Su,(-90+a+h)*Su)}get progress(){return this._progress}}async function CS(r={}){const t=await M_(),e=new SS({fillColor:16777215,cullAtZoomThreshold:!0,backgroundColor:0,backgroundAlpha:1,value:50,cap:"round",fillAlpha:1,lineWidth:20,radius:50,...r});r.cullAtZoomThreshold&&t.add(e);function i(n){e.progress=n.value??0;const s=(n.radius+n.lineWidth)*2;return e.width=s,e.height=s,e.position.set(s/2),e}return{element:e,render:i}}const MS="data:image/svg+xml,%3csvg%20viewBox='0%200%2020%2020'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_7_19)'%3e%3cmask%20id='mask0_7_19'%20style='mask-type:luminance'%20maskUnits='userSpaceOnUse'%20x='-1'%20y='-1'%20width='22'%20height='22'%3e%3cpath%20d='M20.9091%20-0.909058H-0.909088V20.9091H20.9091V-0.909058Z'%20fill='white'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_7_19)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M0%2010C0%204.47715%204.47715%200%2010%200C15.5228%200%2020%204.47715%2020%2010C20%2015.5228%2015.5228%2020%2010%2020C4.47715%2020%200%2015.5228%200%2010ZM10%201.81818C5.4813%201.81818%201.81818%205.4813%201.81818%2010C1.81818%2014.5187%205.48131%2018.1818%2010%2018.1818C14.5187%2018.1818%2018.1818%2014.5187%2018.1818%2010C18.1818%205.48131%2014.5187%201.81818%2010%201.81818Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.68182%205.63634C5.68182%205.15937%206.06849%204.77271%206.54546%204.77271H13.4546C13.9316%204.77271%2014.3182%205.15937%2014.3182%205.63634V14.2512C14.3182%2014.8932%2013.6426%2015.3108%2013.0683%2015.0237L11.8182%2014.3986L10.3863%2015.1146C10.1431%2015.2362%209.85691%2015.2362%209.61373%2015.1146L8.18182%2014.3986L6.93169%2015.0237C6.35746%2015.3108%205.68182%2014.8932%205.68182%2014.2512V5.63634ZM7.04546%206.13634V13.4423L7.7956%2013.0672C8.03873%2012.9456%208.32491%2012.9456%208.5681%2013.0672L10%2013.7832L11.4319%2013.0672C11.6751%2012.9456%2011.9613%2012.9456%2012.2045%2013.0672L12.9546%2013.4423V6.13634H7.04546Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.36365%208.63631C6.36365%208.38531%206.56716%208.18176%206.81819%208.18176H6.98566C7.23669%208.18176%207.4402%208.38531%207.4402%208.63631C7.4402%208.88731%207.23669%209.09085%206.98566%209.09085H6.81819C6.56716%209.09085%206.36365%208.88731%206.36365%208.63631ZM7.78709%208.63631C7.78709%208.38531%207.9906%208.18176%208.24165%208.18176H8.57656C8.82765%208.18176%209.0311%208.38531%209.0311%208.63631C9.0311%208.88731%208.82765%209.09085%208.57656%209.09085H8.24165C7.9906%209.09085%207.78709%208.88731%207.78709%208.63631ZM9.37801%208.63631C9.37801%208.38531%209.58147%208.18176%209.83256%208.18176H10.1675C10.4186%208.18176%2010.622%208.38531%2010.622%208.63631C10.622%208.88731%2010.4186%209.09085%2010.1675%209.09085H9.83256C9.58147%209.09085%209.37801%208.88731%209.37801%208.63631ZM10.9689%208.63631C10.9689%208.38531%2011.1724%208.18176%2011.4235%208.18176H11.7584C12.0095%208.18176%2012.2129%208.38531%2012.2129%208.63631C12.2129%208.88731%2012.0095%209.09085%2011.7584%209.09085H11.4235C11.1724%209.09085%2010.9689%208.88731%2010.9689%208.63631ZM12.5598%208.63631C12.5598%208.38531%2012.7633%208.18176%2013.0144%208.18176H13.1818C13.4328%208.18176%2013.6364%208.38531%2013.6364%208.63631C13.6364%208.88731%2013.4328%209.09085%2013.1818%209.09085H13.0144C12.7633%209.09085%2012.5598%208.88731%2012.5598%208.63631Z'%20fill='white'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_7_19'%3e%3crect%20width='20'%20height='20'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",RS="data:image/svg+xml,%3csvg%20viewBox='0%200%2020%2020'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_7_27)'%3e%3cmask%20id='mask0_7_27'%20style='mask-type:luminance'%20maskUnits='userSpaceOnUse'%20x='-1'%20y='-1'%20width='22'%20height='22'%3e%3cpath%20d='M20.9091%20-0.909058H-0.909088V20.9091H20.9091V-0.909058Z'%20fill='white'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_7_27)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M0%2010C0%204.47715%204.47715%200%2010%200C15.5228%200%2020%204.47715%2020%2010C20%2015.5228%2015.5228%2020%2010%2020C4.47715%2020%200%2015.5228%200%2010ZM10%201.81818C5.4813%201.81818%201.81818%205.4813%201.81818%2010C1.81818%2014.5187%205.48131%2018.1818%2010%2018.1818C14.5187%2018.1818%2018.1818%2014.5187%2018.1818%2010C18.1818%205.48131%2014.5187%201.81818%2010%201.81818Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.36365%2010C6.36365%209.49794%206.77067%209.09094%207.27274%209.09094H12.7273C13.2294%209.09094%2013.6364%209.49794%2013.6364%2010C13.6364%2010.5021%2013.2294%2010.9091%2012.7273%2010.9091H7.27274C6.77067%2010.9091%206.36365%2010.5021%206.36365%2010Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.36365%2013.6364C6.36365%2013.1343%206.77067%2012.7273%207.27274%2012.7273H9.09092C9.59301%2012.7273%2010%2013.1343%2010%2013.6364C10%2014.1385%209.59301%2014.5455%209.09092%2014.5455H7.27274C6.77067%2014.5455%206.36365%2014.1385%206.36365%2013.6364Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.36365%206.36368C6.36365%205.86161%206.77067%205.45459%207.27274%205.45459H11.8182C12.3203%205.45459%2012.7273%205.86161%2012.7273%206.36368C12.7273%206.86575%2012.3203%207.27277%2011.8182%207.27277H7.27274C6.77067%207.27277%206.36365%206.86575%206.36365%206.36368Z'%20fill='white'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_7_27'%3e%3crect%20width='20'%20height='20'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",PS="data:image/svg+xml,%3csvg%20viewBox='0%200%2020%2020'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_7_19)'%3e%3cmask%20id='mask0_7_19'%20style='mask-type:luminance'%20maskUnits='userSpaceOnUse'%20x='-1'%20y='-1'%20width='22'%20height='22'%3e%3cpath%20d='M20.9091%20-0.909058H-0.909088V20.9091H20.9091V-0.909058Z'%20fill='white'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_7_19)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M0%2010C0%204.47715%204.47715%200%2010%200C15.5228%200%2020%204.47715%2020%2010C20%2015.5228%2015.5228%2020%2010%2020C4.47715%2020%200%2015.5228%200%2010ZM10%201.81818C5.4813%201.81818%201.81818%205.4813%201.81818%2010C1.81818%2014.5187%205.48131%2018.1818%2010%2018.1818C14.5187%2018.1818%2018.1818%2014.5187%2018.1818%2010C18.1818%205.48131%2014.5187%201.81818%2010%201.81818Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.68182%205.63634C5.68182%205.15937%206.06849%204.77271%206.54546%204.77271H13.4546C13.9316%204.77271%2014.3182%205.15937%2014.3182%205.63634V14.2512C14.3182%2014.8932%2013.6426%2015.3108%2013.0683%2015.0237L11.8182%2014.3986L10.3863%2015.1146C10.1431%2015.2362%209.85691%2015.2362%209.61373%2015.1146L8.18182%2014.3986L6.93169%2015.0237C6.35746%2015.3108%205.68182%2014.8932%205.68182%2014.2512V5.63634ZM7.04546%206.13634V13.4423L7.7956%2013.0672C8.03873%2012.9456%208.32491%2012.9456%208.5681%2013.0672L10%2013.7832L11.4319%2013.0672C11.6751%2012.9456%2011.9613%2012.9456%2012.2045%2013.0672L12.9546%2013.4423V6.13634H7.04546Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.36365%208.63631C6.36365%208.38531%206.56716%208.18176%206.81819%208.18176H6.98566C7.23669%208.18176%207.4402%208.38531%207.4402%208.63631C7.4402%208.88731%207.23669%209.09085%206.98566%209.09085H6.81819C6.56716%209.09085%206.36365%208.88731%206.36365%208.63631ZM7.78709%208.63631C7.78709%208.38531%207.9906%208.18176%208.24165%208.18176H8.57656C8.82765%208.18176%209.0311%208.38531%209.0311%208.63631C9.0311%208.88731%208.82765%209.09085%208.57656%209.09085H8.24165C7.9906%209.09085%207.78709%208.88731%207.78709%208.63631ZM9.37801%208.63631C9.37801%208.38531%209.58147%208.18176%209.83256%208.18176H10.1675C10.4186%208.18176%2010.622%208.38531%2010.622%208.63631C10.622%208.88731%2010.4186%209.09085%2010.1675%209.09085H9.83256C9.58147%209.09085%209.37801%208.88731%209.37801%208.63631ZM10.9689%208.63631C10.9689%208.38531%2011.1724%208.18176%2011.4235%208.18176H11.7584C12.0095%208.18176%2012.2129%208.38531%2012.2129%208.63631C12.2129%208.88731%2012.0095%209.09085%2011.7584%209.09085H11.4235C11.1724%209.09085%2010.9689%208.88731%2010.9689%208.63631ZM12.5598%208.63631C12.5598%208.38531%2012.7633%208.18176%2013.0144%208.18176H13.1818C13.4328%208.18176%2013.6364%208.38531%2013.6364%208.63631C13.6364%208.88731%2013.4328%209.09085%2013.1818%209.09085H13.0144C12.7633%209.09085%2012.5598%208.88731%2012.5598%208.63631Z'%20fill='white'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_7_19'%3e%3crect%20width='20'%20height='20'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",IS="data:image/svg+xml,%3csvg%20viewBox='0%200%2020%2020'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_7_9)'%3e%3cmask%20id='mask0_7_9'%20style='mask-type:luminance'%20maskUnits='userSpaceOnUse'%20x='-1'%20y='-1'%20width='22'%20height='22'%3e%3cpath%20d='M20.9091%20-0.909058H-0.909088V20.9091H20.9091V-0.909058Z'%20fill='white'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_7_9)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M0%2010C0%204.47715%204.47715%200%2010%200C15.5228%200%2020%204.47715%2020%2010C20%2015.5228%2015.5228%2020%2010%2020C4.47715%2020%200%2015.5228%200%2010ZM10%201.81818C5.4813%201.81818%201.81818%205.4813%201.81818%2010C1.81818%2014.5187%205.48131%2018.1818%2010%2018.1818C14.5187%2018.1818%2018.1818%2014.5187%2018.1818%2010C18.1818%205.48131%2014.5187%201.81818%2010%201.81818Z'%20fill='white'/%3e%3cpath%20d='M8.18183%205.45459H6.36365C5.86157%205.45459%205.45456%205.8616%205.45456%206.36368V8.18186C5.45456%208.68394%205.86157%209.09095%206.36365%209.09095H8.18183C8.68391%209.09095%209.09092%208.68394%209.09092%208.18186V6.36368C9.09092%205.8616%208.68391%205.45459%208.18183%205.45459Z'%20fill='white'/%3e%3cpath%20d='M13.6364%205.45459H11.8182C11.3161%205.45459%2010.9091%205.8616%2010.9091%206.36368V8.18186C10.9091%208.68394%2011.3161%209.09095%2011.8182%209.09095H13.6364C14.1384%209.09095%2014.5455%208.68394%2014.5455%208.18186V6.36368C14.5455%205.8616%2014.1384%205.45459%2013.6364%205.45459Z'%20fill='white'/%3e%3cpath%20d='M13.6364%2010.9091H11.8182C11.3161%2010.9091%2010.9091%2011.3161%2010.9091%2011.8181V13.6363C10.9091%2014.1384%2011.3161%2014.5454%2011.8182%2014.5454H13.6364C14.1384%2014.5454%2014.5455%2014.1384%2014.5455%2013.6363V11.8181C14.5455%2011.3161%2014.1384%2010.9091%2013.6364%2010.9091Z'%20fill='white'/%3e%3cpath%20d='M8.18183%2010.9091H6.36365C5.86157%2010.9091%205.45456%2011.3161%205.45456%2011.8181V13.6363C5.45456%2014.1384%205.86157%2014.5454%206.36365%2014.5454H8.18183C8.68391%2014.5454%209.09092%2014.1384%209.09092%2013.6363V11.8181C9.09092%2011.3161%208.68391%2010.9091%208.18183%2010.9091Z'%20fill='white'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_7_9'%3e%3crect%20width='20'%20height='20'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",DS="data:image/svg+xml,%3csvg%20viewBox='0%200%2020%2020'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_7_36)'%3e%3cmask%20id='mask0_7_36'%20style='mask-type:luminance'%20maskUnits='userSpaceOnUse'%20x='-1'%20y='-1'%20width='22'%20height='22'%3e%3cpath%20d='M20.9091%20-0.909058H-0.909088V20.9091H20.9091V-0.909058Z'%20fill='white'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_7_36)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M0%2010C0%204.47715%204.47715%200%2010%200C15.5228%200%2020%204.47715%2020%2010C20%2015.5228%2015.5228%2020%2010%2020C4.47715%2020%200%2015.5228%200%2010ZM10%201.81818C5.4813%201.81818%201.81818%205.4813%201.81818%2010C1.81818%2014.5187%205.48131%2018.1818%2010%2018.1818C14.5187%2018.1818%2018.1818%2014.5187%2018.1818%2010C18.1818%205.48131%2014.5187%201.81818%2010%201.81818Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M11.4718%2010.0244C11.2567%209.97354%2011.0304%2010.0028%2010.8353%2010.1067L2.29995%2014.6522C1.8568%2014.8882%201.68886%2015.4387%201.92486%2015.8818C2.16086%2016.325%202.71143%2016.4929%203.15458%2016.2569L11.3872%2011.8727L17.9726%2013.4302C18.4612%2013.5457%2018.951%2013.2433%2019.0665%2012.7546C19.1821%2012.2661%2018.8796%2011.7764%2018.3911%2011.6607L11.4718%2010.0244Z'%20fill='white'/%3e%3cpath%20d='M6.07329%209.09092C5.32016%209.09092%204.70966%208.48037%204.70966%207.72728C4.70966%206.97417%205.32016%206.36365%206.07329%206.36365C6.82643%206.36365%207.43693%206.97417%207.43693%207.72728C7.43693%208.48037%206.82643%209.09092%206.07329%209.09092Z'%20fill='white'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_7_36'%3e%3crect%20width='20'%20height='20'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",OS="data:image/svg+xml,%3csvg%20viewBox='0%200%2020%2020'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_7_2)'%3e%3cmask%20id='mask0_7_2'%20style='mask-type:luminance'%20maskUnits='userSpaceOnUse'%20x='-1'%20y='-1'%20width='22'%20height='22'%3e%3cpath%20d='M20.9091%20-0.909058H-0.909088V20.9091H20.9091V-0.909058Z'%20fill='white'/%3e%3c/mask%3e%3cg%20mask='url(%23mask0_7_2)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M8.04937%200.190318C8.681%200.0653727%209.33327%200%2010%200C10.6667%200%2011.319%200.0653727%2011.9506%200.190318L11.5978%201.97394C11.0817%201.87185%2010.5475%201.81818%2010%201.81818C9.45245%201.81818%208.91827%201.87185%208.40218%201.97394L8.04937%200.190318ZM15.5568%201.68489C16.6469%202.41471%2017.5853%203.35308%2018.3151%204.4432L16.8043%205.45469C16.2066%204.56206%2015.4379%203.79335%2014.5453%203.19574L15.5568%201.68489ZM1.68489%204.4432C2.41471%203.35308%203.35308%202.41471%204.4432%201.68489L5.45469%203.19574C4.56206%203.79335%203.79335%204.56206%203.19574%205.45469L1.68489%204.4432ZM19.8096%208.04937C19.9346%208.681%2020%209.33327%2020%2010C20%2010.6667%2019.9346%2011.319%2019.8096%2011.9506L18.0261%2011.5978C18.1282%2011.0817%2018.1818%2010.5475%2018.1818%2010C18.1818%209.45245%2018.1282%208.91827%2018.0261%208.40218L19.8096%208.04937ZM0%2010C0%209.33327%200.0653727%208.681%200.190318%208.04937L1.97394%208.40218C1.87185%208.91827%201.81818%209.45245%201.81818%2010C1.81818%2010.5475%201.87185%2011.0817%201.97394%2011.5978L0.190318%2011.9506C0.0653727%2011.319%200%2010.6667%200%2010ZM18.3151%2015.5568C17.5853%2016.6469%2016.6469%2017.5853%2015.5568%2018.3151L14.5453%2016.8043C15.4379%2016.2066%2016.2066%2015.4379%2016.8043%2014.5453L18.3151%2015.5568ZM4.4432%2018.3151C3.35308%2017.5853%202.41471%2016.6469%201.68489%2015.5568L3.19574%2014.5453C3.79335%2015.4379%204.56206%2016.2066%205.45469%2016.8043L4.4432%2018.3151ZM10%2020C9.33327%2020%208.681%2019.9346%208.04937%2019.8096L8.40218%2018.0261C8.91827%2018.1282%209.45245%2018.1818%2010%2018.1818C10.5475%2018.1818%2011.0817%2018.1282%2011.5978%2018.0261L11.9506%2019.8096C11.319%2019.9346%2010.6667%2020%2010%2020Z'%20fill='white'/%3e%3cpath%20d='M10%2011.8181C8.99582%2011.8181%208.18182%2011.0041%208.18182%209.99994C8.18182%208.99576%208.99582%208.18176%2010%208.18176C11.0042%208.18176%2011.8182%208.99576%2011.8182%209.99994C11.8182%2011.0041%2011.0042%2011.8181%2010%2011.8181Z'%20fill='white'/%3e%3c/g%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_7_2'%3e%3crect%20width='20'%20height='20'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",kS=Object.freeze(Object.defineProperty({__proto__:null,Artifact:MS,ArtifactImage:DS,ArtifactMarkdown:RS,ArtifactProgress:OS,ArtifactResult:PS,ArtifactTable:IS},Symbol.toStringTag,{value:"Module"}));function NS(r){const t={resolution:Cg};return ct.from(kS[r],t)}async function FS(r){return await So(NS,[r])}async function LS({cullAtZoomThreshold:r=!0}={}){const t=await M_(),e=new Yt;r&&t.add(e);async function i(n){const s=await FS(n);return e.texture=s,e}return{element:e,render:i}}var Om={exports:{}},km;function BS(){return km||(km=1,(function(r){(function(){function t(m,g){document.addEventListener?m.addEventListener("scroll",g,!1):m.attachEvent("scroll",g)}function e(m){document.body?m():document.addEventListener?document.addEventListener("DOMContentLoaded",function g(){document.removeEventListener("DOMContentLoaded",g),m()}):document.attachEvent("onreadystatechange",function g(){(document.readyState=="interactive"||document.readyState=="complete")&&(document.detachEvent("onreadystatechange",g),m())})}function i(m){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(m)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function n(m,g){m.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+g+";"}function s(m){var g=m.g.offsetWidth,v=g+100;return m.j.style.width=v+"px",m.i.scrollLeft=v,m.h.scrollLeft=m.h.scrollWidth+100,m.l!==g?(m.l=g,!0):!1}function o(m,g){function v(){var _=w;s(_)&&_.g.parentNode!==null&&g(_.l)}var w=m;t(m.h,v),t(m.i,v),s(m)}function a(m,g,v){g=g||{},v=v||window,this.family=m,this.style=g.style||"normal",this.weight=g.weight||"normal",this.stretch=g.stretch||"normal",this.context=v}var h=null,l=null,u=null,c=null;function d(m){return l===null&&(f(m)&&/Apple/.test(window.navigator.vendor)?(m=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),l=!!m&&603>parseInt(m[1],10)):l=!1),l}function f(m){return c===null&&(c=!!m.document.fonts),c}function p(m,g){var v=m.style,w=m.weight;if(u===null){var _=document.createElement("div");try{_.style.font="condensed 100px sans-serif"}catch{}u=_.style.font!==""}return[v,w,u?m.stretch:"","100px",g].join(" ")}a.prototype.load=function(m,g){var v=this,w=m||"BESbswy",_=0,T=g||3e3,b=new Date().getTime();return new Promise(function(x,y){if(f(v.context)&&!d(v.context)){var S=new Promise(function(G,O){function N(){new Date().getTime()-b>=T?O(Error(""+T+"ms timeout exceeded")):v.context.document.fonts.load(p(v,'"'+v.family+'"'),w).then(function(P){1<=P.length?G():setTimeout(N,25)},O)}N()}),D=new Promise(function(G,O){_=setTimeout(function(){O(Error(""+T+"ms timeout exceeded"))},T)});Promise.race([D,S]).then(function(){clearTimeout(_),x(v)},y)}else e(function(){function G(){var k;(k=j!=-1&&E!=-1||j!=-1&&A!=-1||E!=-1&&A!=-1)&&((k=j!=E&&j!=A&&E!=A)||(h===null&&(k=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),h=!!k&&(536>parseInt(k[1],10)||parseInt(k[1],10)===536&&11>=parseInt(k[2],10))),k=h&&(j==C&&E==C&&A==C||j==B&&E==B&&A==B||j==I&&E==I&&A==I)),k=!k),k&&(M.parentNode!==null&&M.parentNode.removeChild(M),clearTimeout(_),x(v))}function O(){if(new Date().getTime()-b>=T)M.parentNode!==null&&M.parentNode.removeChild(M),y(Error(""+T+"ms timeout exceeded"));else{var k=v.context.document.hidden;(k===!0||k===void 0)&&(j=N.g.offsetWidth,E=P.g.offsetWidth,A=F.g.offsetWidth,G()),_=setTimeout(O,50)}}var N=new i(w),P=new i(w),F=new i(w),j=-1,E=-1,A=-1,C=-1,B=-1,I=-1,M=document.createElement("div");M.dir="ltr",n(N,p(v,"sans-serif")),n(P,p(v,"serif")),n(F,p(v,"monospace")),M.appendChild(N.g),M.appendChild(P.g),M.appendChild(F.g),v.context.document.body.appendChild(M),C=N.g.offsetWidth,B=P.g.offsetWidth,I=F.g.offsetWidth,O(),o(N,function(k){j=k,G()}),n(N,p(v,'"'+v.family+'",sans-serif')),o(P,function(k){E=k,G()}),n(P,p(v,'"'+v.family+'",serif')),o(F,function(k){A=k,G()}),n(F,p(v,'"'+v.family+'",monospace'))})})},r.exports=a})()})(Om)),Om.exports}var US=BS();const HS=bo(US);let lh=null;const GS={fontFamily:"Inter Variable",fontSize:16,lineHeight:20,fill:16777215},ou={resolution:Cg,chars:Ve.ASCII},au="sans-serif";async function zS(){const{font:r}=await jt(),t={...GS,fontFamily:r.fontFamily};await jS(t,r.type),lh=XS(t),rt.emit("fontLoaded",lh)}async function jS(r,t){const{fontFamily:e,...i}=r;try{t==="WebFont"?await new HS(e).load():Ve.from(e,{fontFamily:au,...i},ou)}catch(n){console.error(n),console.warn(`fonts: font ${e} failed to load, falling back to ${au}`),Ve.from(e,{fontFamily:au,...i},ou);return}Ve.from(e,r,ou)}function WS(){lh=null}async function _v(){return lh||await Re("fontLoaded")}function XS(r){const{fontFamily:t,...e}=r,i={fontName:t,...e};return n=>new WT(n,i)}async function Hh({cullAtZoomThreshold:r=!0}={}){const t=await _v(),e=await C_(),i=t("");r&&e.add(i);async function n(s){return i.text=s,await i}return{element:i,render:n}}async function xv({cullAtZoomThreshold:r}){const t=await jt(),e=new bt,i=new bt,{element:n,render:s}=await LS({cullAtZoomThreshold:r}),{element:o,render:a}=await CS(),{element:h,render:l}=await Hh({cullAtZoomThreshold:r}),{element:u,render:c}=await TS();let d=!1,f=null,p;i.addChild(h),e.addChild(u),e.addChild(i);async function m(T){const{selected:b,name:x,type:y}=T;return d=b??d,f=x??f,p=y,p==="progress"?i.addChild(o):i.addChild(n),T.type==="progress"?await Promise.all([v(T.data),w()]):await Promise.all([g(),w()]),await _(),e}async function g(){if(p==="progress")return n;const T=hx[p],{artifactIconSize:b,artifactIconColor:x,artifactPaddingLeft:y,artifactPaddingY:S}=t,D=await s(T);return D.position={x:y,y:S},D.width=b,D.height=b,D.tint=x,D}async function v(T){const{artifactPaddingLeft:b,artifactPaddingRight:x,artifactPaddingY:y,artifactIconSize:S}=t,D=20,G=(S-D*2)/2,O=a({value:T,radius:G,lineWidth:D});return f?O.position.x+=b:O.position.x+=(b+x)/2,O.position.y+=y,o}async function w(){if(!f)return h.visible=!1,h;await l(f);const{artifactPaddingLeft:T,artifactPaddingY:b,artifactTextColor:x,artifactIconSize:y,artifactContentGap:S}=t,D=f?S:0,G=T+y+D,O=b;return h.tint=x,h.scale.set(.75),h.position={x:G,y:O},h.visible=!0,h}async function _(){const{artifactPaddingLeft:T,artifactPaddingRight:b,artifactPaddingY:x}=t,y={selected:d,width:i.width+T+b,height:i.height+x*2};return await c(y)}return{element:e,render:m}}let Bt=null,uh=!1;async function VS(){const r=await Jt();r.on("click",()=>li(null)),r.on("drag-start",()=>{uh=!0}),r.on("drag-end",()=>{setTimeout(()=>{uh=!1})})}function $S(){Bt=null,uh=!1}function li(r){if(!uh&&!(!r&&!Bt||r&&ui(r))){if(Bt=r,r===null){rt.emit("itemSelected",null);return}rt.emit("itemSelected",r)}}function ui(r){if(Bt===null)return!1;const{kind:t}=r;switch(t){case"task-run":return gu(Bt)&&Bt.id===r.id;case"flow-run":return gu(Bt)&&Bt.id===r.id;case"artifact":return ux(Bt)&&Bt.id===r.id;case"artifacts":return cx(Bt)&&Bt.ids.length===r.ids.length&&Bt.ids.every(i=>r.ids.includes(i));case"state":return dx(Bt)&&Bt.id===r.id;case"event":return fx(Bt)&&Bt.id===r.id;case"events":return px(Bt)&&Bt.ids.length===r.ids.length&&Bt.ids.every(i=>r.ids.includes(i));default:const e=t;throw new Error(`switch does not have case for value: ${e}`)}}function YS(){return Bt&&gu(Bt)?Bt:null}async function cd(r,{cullAtZoomThreshold:t=!0,enableLocalClickHandling:e=!1}={}){const{element:i,render:n}=await xv({cullAtZoomThreshold:t});let s=!1,o=r;i.eventMode="static",i.cursor="pointer",e&&i.on("click",c=>{c.stopPropagation(),li({kind:"artifact",id:o.id})}),rt.on("itemSelected",()=>{const c=ui({kind:"artifact",id:o.id});c!==s&&(s=c,a(o))});async function a(c){o=c,await n({selected:s,name:o.key,...o})}function h(){return s}function l(){return o.created}function u(){return o.id}return{isArtifact:!0,element:i,render:a,getSelected:h,getDate:l,getId:u}}function wv(r){return r.isArtifact===!0}function qS(r){return typeof r=="function"}function ka(r){return qS(r)?r():r}async function bv(r,t){const e=await Hr(),i=await Ue();let n,s=null;async function o(){try{s=await i.fetchEvents(ka(r)),t(s)}catch(h){console.error(h)}e.end_time||(n=setTimeout(()=>o(),i.fetchEventsInterval))}function a(){clearTimeout(n)}return{start:o,stop:a}}async function Tv(){const r=await jt(),t=await C_(),e=new bt,{element:i,render:n}=await vv(),{element:s,render:o}=await ud(),{element:a,render:h}=await Bh();t.add(e);let l=!1;e.eventMode="static",e.cursor="pointer",e.addChild(s),e.addChild(i),e.addChild(a),e.on("mouseover",c),e.on("mouseout",d);async function u({inside:f,isOpen:p}){l=f;const m={size:10,stroke:2,rotate:p?hh.Up:hh.Down},g=await n(m),v={width:r.nodeToggleSize,height:r.nodeToggleSize,background:r.nodeToggleBgColor,radius:r.nodeToggleBorderRadius},w=await o(v);w.alpha=f?0:.5;const _=await h({width:v.width,height:v.height,radius:v.radius,stroke:1,color:r.nodeToggleBorderColor});_.alpha=f?0:1;const T={y:w.height/2,x:w.width/2},b=m.size/4;return g.x=T.x,g.y=p?T.y+b:T.y-b,e}function c(){s.alpha=l?.5:1}function d(){s.alpha=l?0:.5}return{element:e,render:u}}async function Ev(){const r=await jt(),t=await Kt(),e=new bt,{element:i,render:n}=await ud(),{element:s,render:o}=await Uh();e.addChild(i),e.addChild(s);async function a(l){const{background:u="#fff"}=r.node(l),{nodeHeight:c,nodeRadius:d}=r,f=ui({kind:l.kind,id:l.id}),p=h(l,d),m=l.state_type!=="RUNNING"||t.isDependency();return await Promise.all([n({width:p,height:c,radius:d,background:u,capRight:m}),o({selected:f,width:p,height:c})]),i}function h(l,u){const c=hd();if(ut.isTemporal()||ut.isLeftAligned()){const d=l.start_time,f=l.end_time??new Date,p=mv(f,d)/Pa*c;return Math.max(p,u*2)}return c}return{element:e,render:a}}var hu,Nm;function ZS(){if(Nm)return hu;Nm=1;var r="Expected a function",t=NaN,e="[object Symbol]",i=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt,h=typeof qe=="object"&&qe&&qe.Object===Object&&qe,l=typeof self=="object"&&self&&self.Object===Object&&self,u=h||l||Function("return this")(),c=Object.prototype,d=c.toString,f=Math.max,p=Math.min,m=function(){return u.Date.now()};function g(x,y,S){var D,G,O,N,P,F,j=0,E=!1,A=!1,C=!0;if(typeof x!="function")throw new TypeError(r);y=b(y)||0,w(S)&&(E=!!S.leading,A="maxWait"in S,O=A?f(b(S.maxWait)||0,y):O,C="trailing"in S?!!S.trailing:C);function B(K){var U=D,X=G;return D=G=void 0,j=K,N=x.apply(X,U),N}function I(K){return j=K,P=setTimeout(L,y),E?B(K):N}function M(K){var U=K-F,X=K-j,q=y-U;return A?p(q,O-X):q}function k(K){var U=K-F,X=K-j;return F===void 0||U>=y||U<0||A&&X>=O}function L(){var K=m();if(k(K))return V(K);P=setTimeout(L,M(K))}function V(K){return P=void 0,C&&D?B(K):(D=G=void 0,N)}function $(){P!==void 0&&clearTimeout(P),j=0,D=F=G=P=void 0}function tt(){return P===void 0?N:V(m())}function et(){var K=m(),U=k(K);if(D=arguments,G=this,F=K,U){if(P===void 0)return I(F);if(A)return P=setTimeout(L,y),B(F)}return P===void 0&&(P=setTimeout(L,y)),N}return et.cancel=$,et.flush=tt,et}function v(x,y,S){var D=!0,G=!0;if(typeof x!="function")throw new TypeError(r);return w(S)&&(D="leading"in S?!!S.leading:D,G="trailing"in S?!!S.trailing:G),g(x,y,{leading:D,maxWait:y,trailing:G})}function w(x){var y=typeof x;return!!x&&(y=="object"||y=="function")}function _(x){return!!x&&typeof x=="object"}function T(x){return typeof x=="symbol"||_(x)&&d.call(x)==e}function b(x){if(typeof x=="number")return x;if(T(x))return t;if(w(x)){var y=typeof x.valueOf=="function"?x.valueOf():x;x=w(y)?y+"":y}if(typeof x!="string")return x===0?x:+x;x=x.replace(i,"");var S=s.test(x);return S||o.test(x)?a(x.slice(2),S?2:8):n.test(x)?t:+x}return hu=v,hu}var KS=ZS();const Av=bo(KS);async function Sv(){const{element:r,render:t}=await xv({cullAtZoomThreshold:!1});let e=null,i=[],n=!1;r.eventMode="static",r.cursor="pointer",rt.on("itemSelected",()=>{const l=ui({kind:"artifacts",ids:i});l!==n&&e&&(n=l,s({ids:i,date:e}))});async function s(l){if(!l){e=null,i=[],r.visible=!1;return}const{ids:u,date:c}=l;e=c,i=u,await t({selected:n,type:"unknown",name:u.length.toString()}),r.visible=!0}function o(){return n}function a(){return e}function h(){return i}return{isArtifactCluster:!0,element:r,render:s,getSelected:o,getDate:a,getIds:h,isCluster:!0}}async function QS({radius:r}){const t=await Qt(),e=new ki;return e.beginFill("#fff"),e.drawCircle(0,0,r),e.endFill(),t.renderer.generateTexture(e,{resolution:Sg})}async function JS(r){return await So(QS,[r])}async function Cv(r){const t=await JS(r);return new Yt(t)}async function Mv(r){const t=new bt,e=await jt(),i=await si(),n=await Cv({radius:e.eventRadiusDefault}),{element:s,render:o}=await Uh();let a=!1;t.addChild(i),t.addChild(n),t.addChild(s),t.eventMode="static",t.cursor="pointer",t.on("mouseenter",()=>{a||n.scale.set(1.5)}),t.on("mouseleave",()=>{a||n.scale.set(1)}),rt.on("itemSelected",()=>{const c=ui({kind:"event",id:r.id,occurred:r.occurred});c!==a&&(a=c,n.scale.set(c?1.5:1),h())});function h(){const{eventColor:c,eventTargetSize:d,eventSelectedBorderInset:f}=e;i.alpha=0,i.width=d,i.height=d,n.tint=c,n.anchor.set(.5),n.position.set(d/2,d/2),s.position.set(f,f),o({selected:a,width:d-f*2,height:d-f*2})}function l(){return r.id}function u(){return r.occurred}return{element:t,render:h,getId:l,getDate:u}}async function Rv(){const r=new bt,t=await jt(),e=await si(),i=await Cv({radius:t.eventClusterRadiusDefault}),{element:n,render:s}=await Uh(),{element:o,render:a}=await Hh({cullAtZoomThreshold:!1});let h=null,l=[],u=!1;r.addChild(e),r.addChild(i),r.addChild(o),r.addChild(n),r.eventMode="static",r.cursor="pointer",r.on("mouseenter",()=>{u||i.scale.set(1.5)}),r.on("mouseleave",()=>{u||i.scale.set(1)}),rt.on("itemSelected",()=>{const w=ui({kind:"events",ids:l});w!==u&&(u=w,i.scale.set(w?1.5:1),h&&c({ids:l,date:h}))});async function c(w){if(!w){h=null,l=[],r.visible=!1;return}const{ids:_,date:T}=w;h=T,l=_,d(),f(),m(),await p(_.length.toString()),r.visible=!0}function d(){const{eventTargetSize:w}=t;e.alpha=0,e.width=w,e.height=w}function f(){const{eventClusterColor:w,eventTargetSize:_}=t;i.tint=w,i.anchor.set(.5),i.position.set(_/2,_/2)}async function p(w){if(l.length<2)return;const{eventTargetSize:_}=t;o.scale.set(.6),o.anchor.set(.5),o.position.set(_/2,_/2+-1),await a(w)}function m(){const{eventSelectedBorderInset:w,eventTargetSize:_}=t;n.position.set(w,w),s({selected:u,width:_-w*2,height:_-w*2})}function g(){return l}function v(){return h}return{element:r,render:c,getIds:g,getDate:v}}function Na(r,t){return r==null||t==null?NaN:r<t?-1:r>t?1:r>=t?0:NaN}function tC(r,t){return r==null||t==null?NaN:t<r?-1:t>r?1:t>=r?0:NaN}function dd(r){let t,e,i;r.length!==2?(t=Na,e=(a,h)=>Na(r(a),h),i=(a,h)=>r(a)-h):(t=r===Na||r===tC?r:eC,e=r,i=r);function n(a,h,l=0,u=a.length){if(l<u){if(t(h,h)!==0)return u;do{const c=l+u>>>1;e(a[c],h)<0?l=c+1:u=c}while(l<u)}return l}function s(a,h,l=0,u=a.length){if(l<u){if(t(h,h)!==0)return u;do{const c=l+u>>>1;e(a[c],h)<=0?l=c+1:u=c}while(l<u)}return l}function o(a,h,l=0,u=a.length){const c=n(a,h,l,u-1);return c>l&&i(a[c-1],h)>-i(a[c],h)?c-1:c}return{left:n,center:o,right:s}}function eC(){return 0}function rC(r){return r===null?NaN:+r}const iC=dd(Na),nC=iC.right;dd(rC).center;const sC=Math.sqrt(50),oC=Math.sqrt(10),aC=Math.sqrt(2);function ch(r,t,e){const i=(t-r)/Math.max(0,e),n=Math.floor(Math.log10(i)),s=i/Math.pow(10,n),o=s>=sC?10:s>=oC?5:s>=aC?2:1;let a,h,l;return n<0?(l=Math.pow(10,-n)/o,a=Math.round(r*l),h=Math.round(t*l),a/l<r&&++a,h/l>t&&--h,l=-l):(l=Math.pow(10,n)*o,a=Math.round(r/l),h=Math.round(t/l),a*l<r&&++a,h*l>t&&--h),h<a&&.5<=e&&e<2?ch(r,t,e*2):[a,h,l]}function hC(r,t,e){if(t=+t,r=+r,e=+e,!(e>0))return[];if(r===t)return[r];const i=t<r,[n,s,o]=i?ch(t,r,e):ch(r,t,e);if(!(s>=n))return[];const a=s-n+1,h=new Array(a);if(i)if(o<0)for(let l=0;l<a;++l)h[l]=(s-l)/-o;else for(let l=0;l<a;++l)h[l]=(s-l)*o;else if(o<0)for(let l=0;l<a;++l)h[l]=(n+l)/-o;else for(let l=0;l<a;++l)h[l]=(n+l)*o;return h}function xc(r,t,e){return t=+t,r=+r,e=+e,ch(r,t,e)[2]}function wc(r,t,e){t=+t,r=+r,e=+e;const i=t<r,n=i?xc(t,r,e):xc(r,t,e);return(i?-1:1)*(n<0?1/-n:n)}var lC={value:()=>{}};function Pv(){for(var r=0,t=arguments.length,e={},i;r<t;++r){if(!(i=arguments[r]+"")||i in e||/[\s.]/.test(i))throw new Error("illegal type: "+i);e[i]=[]}return new Fa(e)}function Fa(r){this._=r}function uC(r,t){return r.trim().split(/^|\s+/).map(function(e){var i="",n=e.indexOf(".");if(n>=0&&(i=e.slice(n+1),e=e.slice(0,n)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:i}})}Fa.prototype=Pv.prototype={constructor:Fa,on:function(r,t){var e=this._,i=uC(r+"",e),n,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((n=(r=i[s]).type)&&(n=cC(e[n],r.name)))return n;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(n=(r=i[s]).type)e[n]=Fm(e[n],r.name,t);else if(t==null)for(n in e)e[n]=Fm(e[n],r.name,null);return this},copy:function(){var r={},t=this._;for(var e in t)r[e]=t[e].slice();return new Fa(r)},call:function(r,t){if((n=arguments.length-2)>0)for(var e=new Array(n),i=0,n,s;i<n;++i)e[i]=arguments[i+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(s=this._[r],i=0,n=s.length;i<n;++i)s[i].value.apply(t,e)},apply:function(r,t,e){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var i=this._[r],n=0,s=i.length;n<s;++n)i[n].value.apply(t,e)}};function cC(r,t){for(var e=0,i=r.length,n;e<i;++e)if((n=r[e]).name===t)return n.value}function Fm(r,t,e){for(var i=0,n=r.length;i<n;++i)if(r[i].name===t){r[i]=lC,r=r.slice(0,i).concat(r.slice(i+1));break}return e!=null&&r.push({name:t,value:e}),r}var bc="http://www.w3.org/1999/xhtml";const Lm={svg:"http://www.w3.org/2000/svg",xhtml:bc,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Gh(r){var t=r+="",e=t.indexOf(":");return e>=0&&(t=r.slice(0,e))!=="xmlns"&&(r=r.slice(e+1)),Lm.hasOwnProperty(t)?{space:Lm[t],local:r}:r}function dC(r){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===bc&&t.documentElement.namespaceURI===bc?t.createElement(r):t.createElementNS(e,r)}}function fC(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function Iv(r){var t=Gh(r);return(t.local?fC:dC)(t)}function pC(){}function fd(r){return r==null?pC:function(){return this.querySelector(r)}}function mC(r){typeof r!="function"&&(r=fd(r));for(var t=this._groups,e=t.length,i=new Array(e),n=0;n<e;++n)for(var s=t[n],o=s.length,a=i[n]=new Array(o),h,l,u=0;u<o;++u)(h=s[u])&&(l=r.call(h,h.__data__,u,s))&&("__data__"in h&&(l.__data__=h.__data__),a[u]=l);return new gr(i,this._parents)}function gC(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function yC(){return[]}function Dv(r){return r==null?yC:function(){return this.querySelectorAll(r)}}function vC(r){return function(){return gC(r.apply(this,arguments))}}function _C(r){typeof r=="function"?r=vC(r):r=Dv(r);for(var t=this._groups,e=t.length,i=[],n=[],s=0;s<e;++s)for(var o=t[s],a=o.length,h,l=0;l<a;++l)(h=o[l])&&(i.push(r.call(h,h.__data__,l,o)),n.push(h));return new gr(i,n)}function Ov(r){return function(){return this.matches(r)}}function kv(r){return function(t){return t.matches(r)}}var xC=Array.prototype.find;function wC(r){return function(){return xC.call(this.children,r)}}function bC(){return this.firstElementChild}function TC(r){return this.select(r==null?bC:wC(typeof r=="function"?r:kv(r)))}var EC=Array.prototype.filter;function AC(){return Array.from(this.children)}function SC(r){return function(){return EC.call(this.children,r)}}function CC(r){return this.selectAll(r==null?AC:SC(typeof r=="function"?r:kv(r)))}function MC(r){typeof r!="function"&&(r=Ov(r));for(var t=this._groups,e=t.length,i=new Array(e),n=0;n<e;++n)for(var s=t[n],o=s.length,a=i[n]=[],h,l=0;l<o;++l)(h=s[l])&&r.call(h,h.__data__,l,s)&&a.push(h);return new gr(i,this._parents)}function Nv(r){return new Array(r.length)}function RC(){return new gr(this._enter||this._groups.map(Nv),this._parents)}function dh(r,t){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=t}dh.prototype={constructor:dh,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,t){return this._parent.insertBefore(r,t)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function PC(r){return function(){return r}}function IC(r,t,e,i,n,s){for(var o=0,a,h=t.length,l=s.length;o<l;++o)(a=t[o])?(a.__data__=s[o],i[o]=a):e[o]=new dh(r,s[o]);for(;o<h;++o)(a=t[o])&&(n[o]=a)}function DC(r,t,e,i,n,s,o){var a,h,l=new Map,u=t.length,c=s.length,d=new Array(u),f;for(a=0;a<u;++a)(h=t[a])&&(d[a]=f=o.call(h,h.__data__,a,t)+"",l.has(f)?n[a]=h:l.set(f,h));for(a=0;a<c;++a)f=o.call(r,s[a],a,s)+"",(h=l.get(f))?(i[a]=h,h.__data__=s[a],l.delete(f)):e[a]=new dh(r,s[a]);for(a=0;a<u;++a)(h=t[a])&&l.get(d[a])===h&&(n[a]=h)}function OC(r){return r.__data__}function kC(r,t){if(!arguments.length)return Array.from(this,OC);var e=t?DC:IC,i=this._parents,n=this._groups;typeof r!="function"&&(r=PC(r));for(var s=n.length,o=new Array(s),a=new Array(s),h=new Array(s),l=0;l<s;++l){var u=i[l],c=n[l],d=c.length,f=NC(r.call(u,u&&u.__data__,l,i)),p=f.length,m=a[l]=new Array(p),g=o[l]=new Array(p),v=h[l]=new Array(d);e(u,c,m,g,v,f,t);for(var w=0,_=0,T,b;w<p;++w)if(T=m[w]){for(w>=_&&(_=w+1);!(b=g[_])&&++_<p;);T._next=b||null}}return o=new gr(o,i),o._enter=a,o._exit=h,o}function NC(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function FC(){return new gr(this._exit||this._groups.map(Nv),this._parents)}function LC(r,t,e){var i=this.enter(),n=this,s=this.exit();return typeof r=="function"?(i=r(i),i&&(i=i.selection())):i=i.append(r+""),t!=null&&(n=t(n),n&&(n=n.selection())),e==null?s.remove():e(s),i&&n?i.merge(n).order():n}function BC(r){for(var t=r.selection?r.selection():r,e=this._groups,i=t._groups,n=e.length,s=i.length,o=Math.min(n,s),a=new Array(n),h=0;h<o;++h)for(var l=e[h],u=i[h],c=l.length,d=a[h]=new Array(c),f,p=0;p<c;++p)(f=l[p]||u[p])&&(d[p]=f);for(;h<n;++h)a[h]=e[h];return new gr(a,this._parents)}function UC(){for(var r=this._groups,t=-1,e=r.length;++t<e;)for(var i=r[t],n=i.length-1,s=i[n],o;--n>=0;)(o=i[n])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function HC(r){r||(r=GC);function t(c,d){return c&&d?r(c.__data__,d.__data__):!c-!d}for(var e=this._groups,i=e.length,n=new Array(i),s=0;s<i;++s){for(var o=e[s],a=o.length,h=n[s]=new Array(a),l,u=0;u<a;++u)(l=o[u])&&(h[u]=l);h.sort(t)}return new gr(n,this._parents).order()}function GC(r,t){return r<t?-1:r>t?1:r>=t?0:NaN}function zC(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function jC(){return Array.from(this)}function WC(){for(var r=this._groups,t=0,e=r.length;t<e;++t)for(var i=r[t],n=0,s=i.length;n<s;++n){var o=i[n];if(o)return o}return null}function XC(){let r=0;for(const t of this)++r;return r}function VC(){return!this.node()}function $C(r){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],s=0,o=n.length,a;s<o;++s)(a=n[s])&&r.call(a,a.__data__,s,n);return this}function YC(r){return function(){this.removeAttribute(r)}}function qC(r){return function(){this.removeAttributeNS(r.space,r.local)}}function ZC(r,t){return function(){this.setAttribute(r,t)}}function KC(r,t){return function(){this.setAttributeNS(r.space,r.local,t)}}function QC(r,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttribute(r):this.setAttribute(r,e)}}function JC(r,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,e)}}function tM(r,t){var e=Gh(r);if(arguments.length<2){var i=this.node();return e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}return this.each((t==null?e.local?qC:YC:typeof t=="function"?e.local?JC:QC:e.local?KC:ZC)(e,t))}function Fv(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function eM(r){return function(){this.style.removeProperty(r)}}function rM(r,t,e){return function(){this.style.setProperty(r,t,e)}}function iM(r,t,e){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(r):this.style.setProperty(r,i,e)}}function nM(r,t,e){return arguments.length>1?this.each((t==null?eM:typeof t=="function"?iM:rM)(r,t,e??"")):fs(this.node(),r)}function fs(r,t){return r.style.getPropertyValue(t)||Fv(r).getComputedStyle(r,null).getPropertyValue(t)}function sM(r){return function(){delete this[r]}}function oM(r,t){return function(){this[r]=t}}function aM(r,t){return function(){var e=t.apply(this,arguments);e==null?delete this[r]:this[r]=e}}function hM(r,t){return arguments.length>1?this.each((t==null?sM:typeof t=="function"?aM:oM)(r,t)):this.node()[r]}function Lv(r){return r.trim().split(/^|\s+/)}function pd(r){return r.classList||new Bv(r)}function Bv(r){this._node=r,this._names=Lv(r.getAttribute("class")||"")}Bv.prototype={add:function(r){var t=this._names.indexOf(r);t<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var t=this._names.indexOf(r);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function Uv(r,t){for(var e=pd(r),i=-1,n=t.length;++i<n;)e.add(t[i])}function Hv(r,t){for(var e=pd(r),i=-1,n=t.length;++i<n;)e.remove(t[i])}function lM(r){return function(){Uv(this,r)}}function uM(r){return function(){Hv(this,r)}}function cM(r,t){return function(){(t.apply(this,arguments)?Uv:Hv)(this,r)}}function dM(r,t){var e=Lv(r+"");if(arguments.length<2){for(var i=pd(this.node()),n=-1,s=e.length;++n<s;)if(!i.contains(e[n]))return!1;return!0}return this.each((typeof t=="function"?cM:t?lM:uM)(e,t))}function fM(){this.textContent=""}function pM(r){return function(){this.textContent=r}}function mM(r){return function(){var t=r.apply(this,arguments);this.textContent=t??""}}function gM(r){return arguments.length?this.each(r==null?fM:(typeof r=="function"?mM:pM)(r)):this.node().textContent}function yM(){this.innerHTML=""}function vM(r){return function(){this.innerHTML=r}}function _M(r){return function(){var t=r.apply(this,arguments);this.innerHTML=t??""}}function xM(r){return arguments.length?this.each(r==null?yM:(typeof r=="function"?_M:vM)(r)):this.node().innerHTML}function wM(){this.nextSibling&&this.parentNode.appendChild(this)}function bM(){return this.each(wM)}function TM(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function EM(){return this.each(TM)}function AM(r){var t=typeof r=="function"?r:Iv(r);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function SM(){return null}function CM(r,t){var e=typeof r=="function"?r:Iv(r),i=t==null?SM:typeof t=="function"?t:fd(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)})}function MM(){var r=this.parentNode;r&&r.removeChild(this)}function RM(){return this.each(MM)}function PM(){var r=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(r,this.nextSibling):r}function IM(){var r=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(r,this.nextSibling):r}function DM(r){return this.select(r?IM:PM)}function OM(r){return arguments.length?this.property("__data__",r):this.node().__data__}function kM(r){return function(t){r.call(this,t,this.__data__)}}function NM(r){return r.trim().split(/^|\s+/).map(function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}})}function FM(r){return function(){var t=this.__on;if(t){for(var e=0,i=-1,n=t.length,s;e<n;++e)s=t[e],(!r.type||s.type===r.type)&&s.name===r.name?this.removeEventListener(s.type,s.listener,s.options):t[++i]=s;++i?t.length=i:delete this.__on}}}function LM(r,t,e){return function(){var i=this.__on,n,s=kM(t);if(i){for(var o=0,a=i.length;o<a;++o)if((n=i[o]).type===r.type&&n.name===r.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=s,n.options=e),n.value=t;return}}this.addEventListener(r.type,s,e),n={type:r.type,name:r.name,value:t,listener:s,options:e},i?i.push(n):this.__on=[n]}}function BM(r,t,e){var i=NM(r+""),n,s=i.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var h=0,l=a.length,u;h<l;++h)for(n=0,u=a[h];n<s;++n)if((o=i[n]).type===u.type&&o.name===u.name)return u.value}return}for(a=t?LM:FM,n=0;n<s;++n)this.each(a(i[n],t,e));return this}function Gv(r,t,e){var i=Fv(r),n=i.CustomEvent;typeof n=="function"?n=new n(t,e):(n=i.document.createEvent("Event"),e?(n.initEvent(t,e.bubbles,e.cancelable),n.detail=e.detail):n.initEvent(t,!1,!1)),r.dispatchEvent(n)}function UM(r,t){return function(){return Gv(this,r,t)}}function HM(r,t){return function(){return Gv(this,r,t.apply(this,arguments))}}function GM(r,t){return this.each((typeof t=="function"?HM:UM)(r,t))}function*zM(){for(var r=this._groups,t=0,e=r.length;t<e;++t)for(var i=r[t],n=0,s=i.length,o;n<s;++n)(o=i[n])&&(yield o)}var jM=[null];function gr(r,t){this._groups=r,this._parents=t}function Mo(){return new gr([[document.documentElement]],jM)}function WM(){return this}gr.prototype=Mo.prototype={constructor:gr,select:mC,selectAll:_C,selectChild:TC,selectChildren:CC,filter:MC,data:kC,enter:RC,exit:FC,join:LC,merge:BC,selection:WM,order:UC,sort:HC,call:zC,nodes:jC,node:WC,size:XC,empty:VC,each:$C,attr:tM,style:nM,property:hM,classed:dM,text:gM,html:xM,raise:bM,lower:EM,append:AM,insert:CM,remove:RM,clone:DM,datum:OM,on:BM,dispatch:GM,[Symbol.iterator]:zM};function md(r,t,e){r.prototype=t.prototype=e,e.constructor=r}function zv(r,t){var e=Object.create(r.prototype);for(var i in t)e[i]=t[i];return e}function Ro(){}var yo=.7,fh=1/yo,ss="\\s*([+-]?\\d+)\\s*",vo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Nr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",XM=/^#([0-9a-f]{3,8})$/,VM=new RegExp(`^rgb\\(${ss},${ss},${ss}\\)$`),$M=new RegExp(`^rgb\\(${Nr},${Nr},${Nr}\\)$`),YM=new RegExp(`^rgba\\(${ss},${ss},${ss},${vo}\\)$`),qM=new RegExp(`^rgba\\(${Nr},${Nr},${Nr},${vo}\\)$`),ZM=new RegExp(`^hsl\\(${vo},${Nr},${Nr}\\)$`),KM=new RegExp(`^hsla\\(${vo},${Nr},${Nr},${vo}\\)$`),Bm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};md(Ro,En,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:Um,formatHex:Um,formatHex8:QM,formatHsl:JM,formatRgb:Hm,toString:Hm});function Um(){return this.rgb().formatHex()}function QM(){return this.rgb().formatHex8()}function JM(){return jv(this).formatHsl()}function Hm(){return this.rgb().formatRgb()}function En(r){var t,e;return r=(r+"").trim().toLowerCase(),(t=XM.exec(r))?(e=t[1].length,t=parseInt(t[1],16),e===6?Gm(t):e===3?new Te(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?pa(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?pa(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=VM.exec(r))?new Te(t[1],t[2],t[3],1):(t=$M.exec(r))?new Te(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=YM.exec(r))?pa(t[1],t[2],t[3],t[4]):(t=qM.exec(r))?pa(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ZM.exec(r))?Wm(t[1],t[2]/100,t[3]/100,1):(t=KM.exec(r))?Wm(t[1],t[2]/100,t[3]/100,t[4]):Bm.hasOwnProperty(r)?Gm(Bm[r]):r==="transparent"?new Te(NaN,NaN,NaN,0):null}function Gm(r){return new Te(r>>16&255,r>>8&255,r&255,1)}function pa(r,t,e,i){return i<=0&&(r=t=e=NaN),new Te(r,t,e,i)}function t3(r){return r instanceof Ro||(r=En(r)),r?(r=r.rgb(),new Te(r.r,r.g,r.b,r.opacity)):new Te}function Tc(r,t,e,i){return arguments.length===1?t3(r):new Te(r,t,e,i??1)}function Te(r,t,e,i){this.r=+r,this.g=+t,this.b=+e,this.opacity=+i}md(Te,Tc,zv(Ro,{brighter(r){return r=r==null?fh:Math.pow(fh,r),new Te(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?yo:Math.pow(yo,r),new Te(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Te(vn(this.r),vn(this.g),vn(this.b),ph(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zm,formatHex:zm,formatHex8:e3,formatRgb:jm,toString:jm}));function zm(){return`#${un(this.r)}${un(this.g)}${un(this.b)}`}function e3(){return`#${un(this.r)}${un(this.g)}${un(this.b)}${un((isNaN(this.opacity)?1:this.opacity)*255)}`}function jm(){const r=ph(this.opacity);return`${r===1?"rgb(":"rgba("}${vn(this.r)}, ${vn(this.g)}, ${vn(this.b)}${r===1?")":`, ${r})`}`}function ph(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function vn(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function un(r){return r=vn(r),(r<16?"0":"")+r.toString(16)}function Wm(r,t,e,i){return i<=0?r=t=e=NaN:e<=0||e>=1?r=t=NaN:t<=0&&(r=NaN),new fr(r,t,e,i)}function jv(r){if(r instanceof fr)return new fr(r.h,r.s,r.l,r.opacity);if(r instanceof Ro||(r=En(r)),!r)return new fr;if(r instanceof fr)return r;r=r.rgb();var t=r.r/255,e=r.g/255,i=r.b/255,n=Math.min(t,e,i),s=Math.max(t,e,i),o=NaN,a=s-n,h=(s+n)/2;return a?(t===s?o=(e-i)/a+(e<i)*6:e===s?o=(i-t)/a+2:o=(t-e)/a+4,a/=h<.5?s+n:2-s-n,o*=60):a=h>0&&h<1?0:o,new fr(o,a,h,r.opacity)}function r3(r,t,e,i){return arguments.length===1?jv(r):new fr(r,t,e,i??1)}function fr(r,t,e,i){this.h=+r,this.s=+t,this.l=+e,this.opacity=+i}md(fr,r3,zv(Ro,{brighter(r){return r=r==null?fh:Math.pow(fh,r),new fr(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?yo:Math.pow(yo,r),new fr(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,t=isNaN(r)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*t,n=2*e-i;return new Te(lu(r>=240?r-240:r+120,n,i),lu(r,n,i),lu(r<120?r+240:r-120,n,i),this.opacity)},clamp(){return new fr(Xm(this.h),ma(this.s),ma(this.l),ph(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=ph(this.opacity);return`${r===1?"hsl(":"hsla("}${Xm(this.h)}, ${ma(this.s)*100}%, ${ma(this.l)*100}%${r===1?")":`, ${r})`}`}}));function Xm(r){return r=(r||0)%360,r<0?r+360:r}function ma(r){return Math.max(0,Math.min(1,r||0))}function lu(r,t,e){return(r<60?t+(e-t)*r/60:r<180?e:r<240?t+(e-t)*(240-r)/60:t)*255}const gd=r=>()=>r;function i3(r,t){return function(e){return r+e*t}}function n3(r,t,e){return r=Math.pow(r,e),t=Math.pow(t,e)-r,e=1/e,function(i){return Math.pow(r+i*t,e)}}function s3(r){return(r=+r)==1?Wv:function(t,e){return e-t?n3(t,e,r):gd(isNaN(t)?e:t)}}function Wv(r,t){var e=t-r;return e?i3(r,e):gd(isNaN(r)?t:r)}const mh=(function r(t){var e=s3(t);function i(n,s){var o=e((n=Tc(n)).r,(s=Tc(s)).r),a=e(n.g,s.g),h=e(n.b,s.b),l=Wv(n.opacity,s.opacity);return function(u){return n.r=o(u),n.g=a(u),n.b=h(u),n.opacity=l(u),n+""}}return i.gamma=r,i})(1);function o3(r,t){t||(t=[]);var e=r?Math.min(t.length,r.length):0,i=t.slice(),n;return function(s){for(n=0;n<e;++n)i[n]=r[n]*(1-s)+t[n]*s;return i}}function a3(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function h3(r,t){var e=t?t.length:0,i=r?Math.min(e,r.length):0,n=new Array(i),s=new Array(e),o;for(o=0;o<i;++o)n[o]=yd(r[o],t[o]);for(;o<e;++o)s[o]=t[o];return function(a){for(o=0;o<i;++o)s[o]=n[o](a);return s}}function l3(r,t){var e=new Date;return r=+r,t=+t,function(i){return e.setTime(r*(1-i)+t*i),e}}function cr(r,t){return r=+r,t=+t,function(e){return r*(1-e)+t*e}}function u3(r,t){var e={},i={},n;(r===null||typeof r!="object")&&(r={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in r?e[n]=yd(r[n],t[n]):i[n]=t[n];return function(s){for(n in e)i[n]=e[n](s);return i}}var Ec=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,uu=new RegExp(Ec.source,"g");function c3(r){return function(){return r}}function d3(r){return function(t){return r(t)+""}}function Xv(r,t){var e=Ec.lastIndex=uu.lastIndex=0,i,n,s,o=-1,a=[],h=[];for(r=r+"",t=t+"";(i=Ec.exec(r))&&(n=uu.exec(t));)(s=n.index)>e&&(s=t.slice(e,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,h.push({i:o,x:cr(i,n)})),e=uu.lastIndex;return e<t.length&&(s=t.slice(e),a[o]?a[o]+=s:a[++o]=s),a.length<2?h[0]?d3(h[0].x):c3(t):(t=h.length,function(l){for(var u=0,c;u<t;++u)a[(c=h[u]).i]=c.x(l);return a.join("")})}function yd(r,t){var e=typeof t,i;return t==null||e==="boolean"?gd(t):(e==="number"?cr:e==="string"?(i=En(t))?(t=i,mh):Xv:t instanceof En?mh:t instanceof Date?l3:a3(t)?o3:Array.isArray(t)?h3:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?u3:cr)(r,t)}function f3(r,t){return r=+r,t=+t,function(e){return Math.round(r*(1-e)+t*e)}}var Vm=180/Math.PI,Vv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $v(r,t,e,i,n,s){var o,a,h;return(o=Math.sqrt(r*r+t*t))&&(r/=o,t/=o),(h=r*e+t*i)&&(e-=r*h,i-=t*h),(a=Math.sqrt(e*e+i*i))&&(e/=a,i/=a,h/=a),r*i<t*e&&(r=-r,t=-t,h=-h,o=-o),{translateX:n,translateY:s,rotate:Math.atan2(t,r)*Vm,skewX:Math.atan(h)*Vm,scaleX:o,scaleY:a}}var ga;function p3(r){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return t.isIdentity?Vv:$v(t.a,t.b,t.c,t.d,t.e,t.f)}function m3(r){return r==null||(ga||(ga=document.createElementNS("http://www.w3.org/2000/svg","g")),ga.setAttribute("transform",r),!(r=ga.transform.baseVal.consolidate()))?Vv:(r=r.matrix,$v(r.a,r.b,r.c,r.d,r.e,r.f))}function Yv(r,t,e,i){function n(l){return l.length?l.pop()+" ":""}function s(l,u,c,d,f,p){if(l!==c||u!==d){var m=f.push("translate(",null,t,null,e);p.push({i:m-4,x:cr(l,c)},{i:m-2,x:cr(u,d)})}else(c||d)&&f.push("translate("+c+t+d+e)}function o(l,u,c,d){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),d.push({i:c.push(n(c)+"rotate(",null,i)-2,x:cr(l,u)})):u&&c.push(n(c)+"rotate("+u+i)}function a(l,u,c,d){l!==u?d.push({i:c.push(n(c)+"skewX(",null,i)-2,x:cr(l,u)}):u&&c.push(n(c)+"skewX("+u+i)}function h(l,u,c,d,f,p){if(l!==c||u!==d){var m=f.push(n(f)+"scale(",null,",",null,")");p.push({i:m-4,x:cr(l,c)},{i:m-2,x:cr(u,d)})}else(c!==1||d!==1)&&f.push(n(f)+"scale("+c+","+d+")")}return function(l,u){var c=[],d=[];return l=r(l),u=r(u),s(l.translateX,l.translateY,u.translateX,u.translateY,c,d),o(l.rotate,u.rotate,c,d),a(l.skewX,u.skewX,c,d),h(l.scaleX,l.scaleY,u.scaleX,u.scaleY,c,d),l=u=null,function(f){for(var p=-1,m=d.length,g;++p<m;)c[(g=d[p]).i]=g.x(f);return c.join("")}}}var g3=Yv(p3,"px, ","px)","deg)"),y3=Yv(m3,", ",")",")"),ps=0,Ks=0,Fs=0,qv=1e3,gh,Qs,yh=0,An=0,zh=0,_o=typeof performance=="object"&&performance.now?performance:Date,Zv=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function vd(){return An||(Zv(v3),An=_o.now()+zh)}function v3(){An=0}function vh(){this._call=this._time=this._next=null}vh.prototype=Kv.prototype={constructor:vh,restart:function(r,t,e){if(typeof r!="function")throw new TypeError("callback is not a function");e=(e==null?vd():+e)+(t==null?0:+t),!this._next&&Qs!==this&&(Qs?Qs._next=this:gh=this,Qs=this),this._call=r,this._time=e,Ac()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ac())}};function Kv(r,t,e){var i=new vh;return i.restart(r,t,e),i}function _3(){vd(),++ps;for(var r=gh,t;r;)(t=An-r._time)>=0&&r._call.call(void 0,t),r=r._next;--ps}function $m(){An=(yh=_o.now())+zh,ps=Ks=0;try{_3()}finally{ps=0,w3(),An=0}}function x3(){var r=_o.now(),t=r-yh;t>qv&&(zh-=t,yh=r)}function w3(){for(var r,t=gh,e,i=1/0;t;)t._call?(i>t._time&&(i=t._time),r=t,t=t._next):(e=t._next,t._next=null,t=r?r._next=e:gh=e);Qs=r,Ac(i)}function Ac(r){if(!ps){Ks&&(Ks=clearTimeout(Ks));var t=r-An;t>24?(r<1/0&&(Ks=setTimeout($m,r-_o.now()-zh)),Fs&&(Fs=clearInterval(Fs))):(Fs||(yh=_o.now(),Fs=setInterval(x3,qv)),ps=1,Zv($m))}}function Ym(r,t,e){var i=new vh;return t=t==null?0:+t,i.restart(n=>{i.stop(),r(n+t)},t,e),i}var b3=Pv("start","end","cancel","interrupt"),T3=[],Qv=0,qm=1,Sc=2,La=3,Zm=4,Cc=5,Ba=6;function jh(r,t,e,i,n,s){var o=r.__transition;if(!o)r.__transition={};else if(e in o)return;E3(r,e,{name:t,index:i,group:n,on:b3,tween:T3,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Qv})}function _d(r,t){var e=vr(r,t);if(e.state>Qv)throw new Error("too late; already scheduled");return e}function Ur(r,t){var e=vr(r,t);if(e.state>La)throw new Error("too late; already running");return e}function vr(r,t){var e=r.__transition;if(!e||!(e=e[t]))throw new Error("transition not found");return e}function E3(r,t,e){var i=r.__transition,n;i[t]=e,e.timer=Kv(s,0,e.time);function s(l){e.state=qm,e.timer.restart(o,e.delay,e.time),e.delay<=l&&o(l-e.delay)}function o(l){var u,c,d,f;if(e.state!==qm)return h();for(u in i)if(f=i[u],f.name===e.name){if(f.state===La)return Ym(o);f.state===Zm?(f.state=Ba,f.timer.stop(),f.on.call("interrupt",r,r.__data__,f.index,f.group),delete i[u]):+u<t&&(f.state=Ba,f.timer.stop(),f.on.call("cancel",r,r.__data__,f.index,f.group),delete i[u])}if(Ym(function(){e.state===La&&(e.state=Zm,e.timer.restart(a,e.delay,e.time),a(l))}),e.state=Sc,e.on.call("start",r,r.__data__,e.index,e.group),e.state===Sc){for(e.state=La,n=new Array(d=e.tween.length),u=0,c=-1;u<d;++u)(f=e.tween[u].value.call(r,r.__data__,e.index,e.group))&&(n[++c]=f);n.length=c+1}}function a(l){for(var u=l<e.duration?e.ease.call(null,l/e.duration):(e.timer.restart(h),e.state=Cc,1),c=-1,d=n.length;++c<d;)n[c].call(r,u);e.state===Cc&&(e.on.call("end",r,r.__data__,e.index,e.group),h())}function h(){e.state=Ba,e.timer.stop(),delete i[t];for(var l in i)return;delete r.__transition}}function A3(r,t){var e=r.__transition,i,n,s=!0,o;if(e){t=t==null?null:t+"";for(o in e){if((i=e[o]).name!==t){s=!1;continue}n=i.state>Sc&&i.state<Cc,i.state=Ba,i.timer.stop(),i.on.call(n?"interrupt":"cancel",r,r.__data__,i.index,i.group),delete e[o]}s&&delete r.__transition}}function S3(r){return this.each(function(){A3(this,r)})}function C3(r,t){var e,i;return function(){var n=Ur(this,r),s=n.tween;if(s!==e){i=e=s;for(var o=0,a=i.length;o<a;++o)if(i[o].name===t){i=i.slice(),i.splice(o,1);break}}n.tween=i}}function M3(r,t,e){var i,n;if(typeof e!="function")throw new Error;return function(){var s=Ur(this,r),o=s.tween;if(o!==i){n=(i=o).slice();for(var a={name:t,value:e},h=0,l=n.length;h<l;++h)if(n[h].name===t){n[h]=a;break}h===l&&n.push(a)}s.tween=n}}function R3(r,t){var e=this._id;if(r+="",arguments.length<2){for(var i=vr(this.node(),e).tween,n=0,s=i.length,o;n<s;++n)if((o=i[n]).name===r)return o.value;return null}return this.each((t==null?C3:M3)(e,r,t))}function xd(r,t,e){var i=r._id;return r.each(function(){var n=Ur(this,i);(n.value||(n.value={}))[t]=e.apply(this,arguments)}),function(n){return vr(n,i).value[t]}}function Jv(r,t){var e;return(typeof t=="number"?cr:t instanceof En?mh:(e=En(t))?(t=e,mh):Xv)(r,t)}function P3(r){return function(){this.removeAttribute(r)}}function I3(r){return function(){this.removeAttributeNS(r.space,r.local)}}function D3(r,t,e){var i,n=e+"",s;return function(){var o=this.getAttribute(r);return o===n?null:o===i?s:s=t(i=o,e)}}function O3(r,t,e){var i,n=e+"",s;return function(){var o=this.getAttributeNS(r.space,r.local);return o===n?null:o===i?s:s=t(i=o,e)}}function k3(r,t,e){var i,n,s;return function(){var o,a=e(this),h;return a==null?void this.removeAttribute(r):(o=this.getAttribute(r),h=a+"",o===h?null:o===i&&h===n?s:(n=h,s=t(i=o,a)))}}function N3(r,t,e){var i,n,s;return function(){var o,a=e(this),h;return a==null?void this.removeAttributeNS(r.space,r.local):(o=this.getAttributeNS(r.space,r.local),h=a+"",o===h?null:o===i&&h===n?s:(n=h,s=t(i=o,a)))}}function F3(r,t){var e=Gh(r),i=e==="transform"?y3:Jv;return this.attrTween(r,typeof t=="function"?(e.local?N3:k3)(e,i,xd(this,"attr."+r,t)):t==null?(e.local?I3:P3)(e):(e.local?O3:D3)(e,i,t))}function L3(r,t){return function(e){this.setAttribute(r,t.call(this,e))}}function B3(r,t){return function(e){this.setAttributeNS(r.space,r.local,t.call(this,e))}}function U3(r,t){var e,i;function n(){var s=t.apply(this,arguments);return s!==i&&(e=(i=s)&&B3(r,s)),e}return n._value=t,n}function H3(r,t){var e,i;function n(){var s=t.apply(this,arguments);return s!==i&&(e=(i=s)&&L3(r,s)),e}return n._value=t,n}function G3(r,t){var e="attr."+r;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;var i=Gh(r);return this.tween(e,(i.local?U3:H3)(i,t))}function z3(r,t){return function(){_d(this,r).delay=+t.apply(this,arguments)}}function j3(r,t){return t=+t,function(){_d(this,r).delay=t}}function W3(r){var t=this._id;return arguments.length?this.each((typeof r=="function"?z3:j3)(t,r)):vr(this.node(),t).delay}function X3(r,t){return function(){Ur(this,r).duration=+t.apply(this,arguments)}}function V3(r,t){return t=+t,function(){Ur(this,r).duration=t}}function $3(r){var t=this._id;return arguments.length?this.each((typeof r=="function"?X3:V3)(t,r)):vr(this.node(),t).duration}function Y3(r,t){if(typeof t!="function")throw new Error;return function(){Ur(this,r).ease=t}}function q3(r){var t=this._id;return arguments.length?this.each(Y3(t,r)):vr(this.node(),t).ease}function Z3(r,t){return function(){var e=t.apply(this,arguments);if(typeof e!="function")throw new Error;Ur(this,r).ease=e}}function K3(r){if(typeof r!="function")throw new Error;return this.each(Z3(this._id,r))}function Q3(r){typeof r!="function"&&(r=Ov(r));for(var t=this._groups,e=t.length,i=new Array(e),n=0;n<e;++n)for(var s=t[n],o=s.length,a=i[n]=[],h,l=0;l<o;++l)(h=s[l])&&r.call(h,h.__data__,l,s)&&a.push(h);return new oi(i,this._parents,this._name,this._id)}function J3(r){if(r._id!==this._id)throw new Error;for(var t=this._groups,e=r._groups,i=t.length,n=e.length,s=Math.min(i,n),o=new Array(i),a=0;a<s;++a)for(var h=t[a],l=e[a],u=h.length,c=o[a]=new Array(u),d,f=0;f<u;++f)(d=h[f]||l[f])&&(c[f]=d);for(;a<i;++a)o[a]=t[a];return new oi(o,this._parents,this._name,this._id)}function tR(r){return(r+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||t==="start"})}function eR(r,t,e){var i,n,s=tR(t)?_d:Ur;return function(){var o=s(this,r),a=o.on;a!==i&&(n=(i=a).copy()).on(t,e),o.on=n}}function rR(r,t){var e=this._id;return arguments.length<2?vr(this.node(),e).on.on(r):this.each(eR(e,r,t))}function iR(r){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==r)return;t&&t.removeChild(this)}}function nR(){return this.on("end.remove",iR(this._id))}function sR(r){var t=this._name,e=this._id;typeof r!="function"&&(r=fd(r));for(var i=this._groups,n=i.length,s=new Array(n),o=0;o<n;++o)for(var a=i[o],h=a.length,l=s[o]=new Array(h),u,c,d=0;d<h;++d)(u=a[d])&&(c=r.call(u,u.__data__,d,a))&&("__data__"in u&&(c.__data__=u.__data__),l[d]=c,jh(l[d],t,e,d,l,vr(u,e)));return new oi(s,this._parents,t,e)}function oR(r){var t=this._name,e=this._id;typeof r!="function"&&(r=Dv(r));for(var i=this._groups,n=i.length,s=[],o=[],a=0;a<n;++a)for(var h=i[a],l=h.length,u,c=0;c<l;++c)if(u=h[c]){for(var d=r.call(u,u.__data__,c,h),f,p=vr(u,e),m=0,g=d.length;m<g;++m)(f=d[m])&&jh(f,t,e,m,d,p);s.push(d),o.push(u)}return new oi(s,o,t,e)}var aR=Mo.prototype.constructor;function hR(){return new aR(this._groups,this._parents)}function lR(r,t){var e,i,n;return function(){var s=fs(this,r),o=(this.style.removeProperty(r),fs(this,r));return s===o?null:s===e&&o===i?n:n=t(e=s,i=o)}}function t_(r){return function(){this.style.removeProperty(r)}}function uR(r,t,e){var i,n=e+"",s;return function(){var o=fs(this,r);return o===n?null:o===i?s:s=t(i=o,e)}}function cR(r,t,e){var i,n,s;return function(){var o=fs(this,r),a=e(this),h=a+"";return a==null&&(h=a=(this.style.removeProperty(r),fs(this,r))),o===h?null:o===i&&h===n?s:(n=h,s=t(i=o,a))}}function dR(r,t){var e,i,n,s="style."+t,o="end."+s,a;return function(){var h=Ur(this,r),l=h.on,u=h.value[s]==null?a||(a=t_(t)):void 0;(l!==e||n!==u)&&(i=(e=l).copy()).on(o,n=u),h.on=i}}function fR(r,t,e){var i=(r+="")=="transform"?g3:Jv;return t==null?this.styleTween(r,lR(r,i)).on("end.style."+r,t_(r)):typeof t=="function"?this.styleTween(r,cR(r,i,xd(this,"style."+r,t))).each(dR(this._id,r)):this.styleTween(r,uR(r,i,t),e).on("end.style."+r,null)}function pR(r,t,e){return function(i){this.style.setProperty(r,t.call(this,i),e)}}function mR(r,t,e){var i,n;function s(){var o=t.apply(this,arguments);return o!==n&&(i=(n=o)&&pR(r,o,e)),i}return s._value=t,s}function gR(r,t,e){var i="style."+(r+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,mR(r,t,e??""))}function yR(r){return function(){this.textContent=r}}function vR(r){return function(){var t=r(this);this.textContent=t??""}}function _R(r){return this.tween("text",typeof r=="function"?vR(xd(this,"text",r)):yR(r==null?"":r+""))}function xR(r){return function(t){this.textContent=r.call(this,t)}}function wR(r){var t,e;function i(){var n=r.apply(this,arguments);return n!==e&&(t=(e=n)&&xR(n)),t}return i._value=r,i}function bR(r){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(r==null)return this.tween(t,null);if(typeof r!="function")throw new Error;return this.tween(t,wR(r))}function TR(){for(var r=this._name,t=this._id,e=e_(),i=this._groups,n=i.length,s=0;s<n;++s)for(var o=i[s],a=o.length,h,l=0;l<a;++l)if(h=o[l]){var u=vr(h,t);jh(h,r,e,l,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new oi(i,this._parents,r,e)}function ER(){var r,t,e=this,i=e._id,n=e.size();return new Promise(function(s,o){var a={value:o},h={value:function(){--n===0&&s()}};e.each(function(){var l=Ur(this,i),u=l.on;u!==r&&(t=(r=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(h)),l.on=t}),n===0&&s()})}var AR=0;function oi(r,t,e,i){this._groups=r,this._parents=t,this._name=e,this._id=i}function e_(){return++AR}var Xr=Mo.prototype;oi.prototype={constructor:oi,select:sR,selectAll:oR,selectChild:Xr.selectChild,selectChildren:Xr.selectChildren,filter:Q3,merge:J3,selection:hR,transition:TR,call:Xr.call,nodes:Xr.nodes,node:Xr.node,size:Xr.size,empty:Xr.empty,each:Xr.each,on:rR,attr:F3,attrTween:G3,style:fR,styleTween:gR,text:_R,textTween:bR,remove:nR,tween:R3,delay:W3,duration:$3,ease:q3,easeVarying:K3,end:ER,[Symbol.iterator]:Xr[Symbol.iterator]};function SR(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var CR={time:null,delay:0,duration:250,ease:SR};function MR(r,t){for(var e;!(e=r.__transition)||!(e=e[t]);)if(!(r=r.parentNode))throw new Error(`transition ${t} not found`);return e}function RR(r){var t,e;r instanceof oi?(t=r._id,r=r._name):(t=e_(),(e=CR).time=vd(),r=r==null?null:r+"");for(var i=this._groups,n=i.length,s=0;s<n;++s)for(var o=i[s],a=o.length,h,l=0;l<a;++l)(h=o[l])&&jh(h,r,t,l,o,e||MR(h,t));return new oi(i,this._parents,r,t)}Mo.prototype.interrupt=S3;Mo.prototype.transition=RR;function PR(r){return Math.abs(r=Math.round(r))>=1e21?r.toLocaleString("en").replace(/,/g,""):r.toString(10)}function _h(r,t){if((e=(r=t?r.toExponential(t-1):r.toExponential()).indexOf("e"))<0)return null;var e,i=r.slice(0,e);return[i.length>1?i[0]+i.slice(2):i,+r.slice(e+1)]}function ms(r){return r=_h(Math.abs(r)),r?r[1]:NaN}function IR(r,t){return function(e,i){for(var n=e.length,s=[],o=0,a=r[0],h=0;n>0&&a>0&&(h+a+1>i&&(a=Math.max(1,i-h)),s.push(e.substring(n-=a,n+a)),!((h+=a+1)>i));)a=r[o=(o+1)%r.length];return s.reverse().join(t)}}function DR(r){return function(t){return t.replace(/[0-9]/g,function(e){return r[+e]})}}var OR=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function xh(r){if(!(t=OR.exec(r)))throw new Error("invalid format: "+r);var t;return new wd({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}xh.prototype=wd.prototype;function wd(r){this.fill=r.fill===void 0?" ":r.fill+"",this.align=r.align===void 0?">":r.align+"",this.sign=r.sign===void 0?"-":r.sign+"",this.symbol=r.symbol===void 0?"":r.symbol+"",this.zero=!!r.zero,this.width=r.width===void 0?void 0:+r.width,this.comma=!!r.comma,this.precision=r.precision===void 0?void 0:+r.precision,this.trim=!!r.trim,this.type=r.type===void 0?"":r.type+""}wd.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function kR(r){t:for(var t=r.length,e=1,i=-1,n;e<t;++e)switch(r[e]){case".":i=n=e;break;case"0":i===0&&(i=e),n=e;break;default:if(!+r[e])break t;i>0&&(i=0);break}return i>0?r.slice(0,i)+r.slice(n+1):r}var r_;function NR(r,t){var e=_h(r,t);if(!e)return r+"";var i=e[0],n=e[1],s=n-(r_=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+_h(r,Math.max(0,t+s-1))[0]}function Km(r,t){var e=_h(r,t);if(!e)return r+"";var i=e[0],n=e[1];return n<0?"0."+new Array(-n).join("0")+i:i.length>n+1?i.slice(0,n+1)+"."+i.slice(n+1):i+new Array(n-i.length+2).join("0")}const Qm={"%":(r,t)=>(r*100).toFixed(t),b:r=>Math.round(r).toString(2),c:r=>r+"",d:PR,e:(r,t)=>r.toExponential(t),f:(r,t)=>r.toFixed(t),g:(r,t)=>r.toPrecision(t),o:r=>Math.round(r).toString(8),p:(r,t)=>Km(r*100,t),r:Km,s:NR,X:r=>Math.round(r).toString(16).toUpperCase(),x:r=>Math.round(r).toString(16)};function Jm(r){return r}var tg=Array.prototype.map,eg=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function FR(r){var t=r.grouping===void 0||r.thousands===void 0?Jm:IR(tg.call(r.grouping,Number),r.thousands+""),e=r.currency===void 0?"":r.currency[0]+"",i=r.currency===void 0?"":r.currency[1]+"",n=r.decimal===void 0?".":r.decimal+"",s=r.numerals===void 0?Jm:DR(tg.call(r.numerals,String)),o=r.percent===void 0?"%":r.percent+"",a=r.minus===void 0?"":r.minus+"",h=r.nan===void 0?"NaN":r.nan+"";function l(c){c=xh(c);var d=c.fill,f=c.align,p=c.sign,m=c.symbol,g=c.zero,v=c.width,w=c.comma,_=c.precision,T=c.trim,b=c.type;b==="n"?(w=!0,b="g"):Qm[b]||(_===void 0&&(_=12),T=!0,b="g"),(g||d==="0"&&f==="=")&&(g=!0,d="0",f="=");var x=m==="$"?e:m==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",y=m==="$"?i:/[%p]/.test(b)?o:"",S=Qm[b],D=/[defgprs%]/.test(b);_=_===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function G(O){var N=x,P=y,F,j,E;if(b==="c")P=S(O)+P,O="";else{O=+O;var A=O<0||1/O<0;if(O=isNaN(O)?h:S(Math.abs(O),_),T&&(O=kR(O)),A&&+O==0&&p!=="+"&&(A=!1),N=(A?p==="("?p:a:p==="-"||p==="("?"":p)+N,P=(b==="s"?eg[8+r_/3]:"")+P+(A&&p==="("?")":""),D){for(F=-1,j=O.length;++F<j;)if(E=O.charCodeAt(F),48>E||E>57){P=(E===46?n+O.slice(F+1):O.slice(F))+P,O=O.slice(0,F);break}}}w&&!g&&(O=t(O,1/0));var C=N.length+O.length+P.length,B=C<v?new Array(v-C+1).join(d):"";switch(w&&g&&(O=t(B+O,B.length?v-P.length:1/0),B=""),f){case"<":O=N+O+P+B;break;case"=":O=N+B+O+P;break;case"^":O=B.slice(0,C=B.length>>1)+N+O+P+B.slice(C);break;default:O=B+N+O+P;break}return s(O)}return G.toString=function(){return c+""},G}function u(c,d){var f=l((c=xh(c),c.type="f",c)),p=Math.max(-8,Math.min(8,Math.floor(ms(d)/3)))*3,m=Math.pow(10,-p),g=eg[8+p/3];return function(v){return f(m*v)+g}}return{format:l,formatPrefix:u}}var ya,i_,n_;LR({thousands:",",grouping:[3],currency:["$",""]});function LR(r){return ya=FR(r),i_=ya.format,n_=ya.formatPrefix,ya}function BR(r){return Math.max(0,-ms(Math.abs(r)))}function UR(r,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ms(t)/3)))*3-ms(Math.abs(r)))}function HR(r,t){return r=Math.abs(r),t=Math.abs(t)-r,Math.max(0,ms(t)-ms(r))+1}function s_(r,t){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(t).domain(r);break}return this}function GR(r){return function(){return r}}function zR(r){return+r}var rg=[0,1];function Zn(r){return r}function Mc(r,t){return(t-=r=+r)?function(e){return(e-r)/t}:GR(isNaN(t)?NaN:.5)}function jR(r,t){var e;return r>t&&(e=r,r=t,t=e),function(i){return Math.max(r,Math.min(t,i))}}function WR(r,t,e){var i=r[0],n=r[1],s=t[0],o=t[1];return n<i?(i=Mc(n,i),s=e(o,s)):(i=Mc(i,n),s=e(s,o)),function(a){return s(i(a))}}function XR(r,t,e){var i=Math.min(r.length,t.length)-1,n=new Array(i),s=new Array(i),o=-1;for(r[i]<r[0]&&(r=r.slice().reverse(),t=t.slice().reverse());++o<i;)n[o]=Mc(r[o],r[o+1]),s[o]=e(t[o],t[o+1]);return function(a){var h=nC(r,a,1,i)-1;return s[h](n[h](a))}}function o_(r,t){return t.domain(r.domain()).range(r.range()).interpolate(r.interpolate()).clamp(r.clamp()).unknown(r.unknown())}function VR(){var r=rg,t=rg,e=yd,i,n,s,o=Zn,a,h,l;function u(){var d=Math.min(r.length,t.length);return o!==Zn&&(o=jR(r[0],r[d-1])),a=d>2?XR:WR,h=l=null,c}function c(d){return d==null||isNaN(d=+d)?s:(h||(h=a(r.map(i),t,e)))(i(o(d)))}return c.invert=function(d){return o(n((l||(l=a(t,r.map(i),cr)))(d)))},c.domain=function(d){return arguments.length?(r=Array.from(d,zR),u()):r.slice()},c.range=function(d){return arguments.length?(t=Array.from(d),u()):t.slice()},c.rangeRound=function(d){return t=Array.from(d),e=f3,u()},c.clamp=function(d){return arguments.length?(o=d?!0:Zn,u()):o!==Zn},c.interpolate=function(d){return arguments.length?(e=d,u()):e},c.unknown=function(d){return arguments.length?(s=d,c):s},function(d,f){return i=d,n=f,u()}}function a_(){return VR()(Zn,Zn)}function $R(r,t,e,i){var n=wc(r,t,e),s;switch(i=xh(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(r),Math.abs(t));return i.precision==null&&!isNaN(s=UR(n,o))&&(i.precision=s),n_(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=HR(n,Math.max(Math.abs(r),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=BR(n))&&(i.precision=s-(i.type==="%")*2);break}}return i_(i)}function YR(r){var t=r.domain;return r.ticks=function(e){var i=t();return hC(i[0],i[i.length-1],e??10)},r.tickFormat=function(e,i){var n=t();return $R(n[0],n[n.length-1],e??10,i)},r.nice=function(e){e==null&&(e=10);var i=t(),n=0,s=i.length-1,o=i[n],a=i[s],h,l,u=10;for(a<o&&(l=o,o=a,a=l,l=n,n=s,s=l);u-- >0;){if(l=xc(o,a,e),l===h)return i[n]=o,i[s]=a,t(i);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;h=l}return r},r}function h_(){var r=a_();return r.copy=function(){return o_(r,h_())},s_.apply(r,arguments),YR(r)}function qR(r,t){r=r.slice();var e=0,i=r.length-1,n=r[e],s=r[i],o;return s<n&&(o=e,e=i,i=o,o=n,n=s,s=o),r[e]=t.floor(n),r[i]=t.ceil(s),r}const cu=new Date,du=new Date;function ne(r,t,e,i){function n(s){return r(s=arguments.length===0?new Date:new Date(+s)),s}return n.floor=s=>(r(s=new Date(+s)),s),n.ceil=s=>(r(s=new Date(s-1)),t(s,1),r(s),s),n.round=s=>{const o=n(s),a=n.ceil(s);return s-o<a-s?o:a},n.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),n.range=(s,o,a)=>{const h=[];if(s=n.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return h;let l;do h.push(l=new Date(+s)),t(s,a),r(s);while(l<s&&s<o);return h},n.filter=s=>ne(o=>{if(o>=o)for(;r(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!s(o););else for(;--a>=0;)for(;t(o,1),!s(o););}),e&&(n.count=(s,o)=>(cu.setTime(+s),du.setTime(+o),r(cu),r(du),Math.floor(e(cu,du))),n.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?n.filter(i?o=>i(o)%s===0:o=>n.count(0,o)%s===0):n)),n}const wh=ne(()=>{},(r,t)=>{r.setTime(+r+t)},(r,t)=>t-r);wh.every=r=>(r=Math.floor(r),!isFinite(r)||!(r>0)?null:r>1?ne(t=>{t.setTime(Math.floor(t/r)*r)},(t,e)=>{t.setTime(+t+e*r)},(t,e)=>(e-t)/r):wh);wh.range;const Jr=1e3,Je=Jr*60,ti=Je*60,ai=ti*24,bd=ai*7,ig=ai*30,fu=ai*365,Kn=ne(r=>{r.setTime(r-r.getMilliseconds())},(r,t)=>{r.setTime(+r+t*Jr)},(r,t)=>(t-r)/Jr,r=>r.getUTCSeconds());Kn.range;const Td=ne(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*Jr)},(r,t)=>{r.setTime(+r+t*Je)},(r,t)=>(t-r)/Je,r=>r.getMinutes());Td.range;const ZR=ne(r=>{r.setUTCSeconds(0,0)},(r,t)=>{r.setTime(+r+t*Je)},(r,t)=>(t-r)/Je,r=>r.getUTCMinutes());ZR.range;const Ed=ne(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*Jr-r.getMinutes()*Je)},(r,t)=>{r.setTime(+r+t*ti)},(r,t)=>(t-r)/ti,r=>r.getHours());Ed.range;const KR=ne(r=>{r.setUTCMinutes(0,0,0)},(r,t)=>{r.setTime(+r+t*ti)},(r,t)=>(t-r)/ti,r=>r.getUTCHours());KR.range;const Po=ne(r=>r.setHours(0,0,0,0),(r,t)=>r.setDate(r.getDate()+t),(r,t)=>(t-r-(t.getTimezoneOffset()-r.getTimezoneOffset())*Je)/ai,r=>r.getDate()-1);Po.range;const Ad=ne(r=>{r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCDate(r.getUTCDate()+t)},(r,t)=>(t-r)/ai,r=>r.getUTCDate()-1);Ad.range;const QR=ne(r=>{r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCDate(r.getUTCDate()+t)},(r,t)=>(t-r)/ai,r=>Math.floor(r/ai));QR.range;function In(r){return ne(t=>{t.setDate(t.getDate()-(t.getDay()+7-r)%7),t.setHours(0,0,0,0)},(t,e)=>{t.setDate(t.getDate()+e*7)},(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Je)/bd)}const Wh=In(0),bh=In(1),JR=In(2),tP=In(3),gs=In(4),eP=In(5),rP=In(6);Wh.range;bh.range;JR.range;tP.range;gs.range;eP.range;rP.range;function Dn(r){return ne(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-r)%7),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e*7)},(t,e)=>(e-t)/bd)}const l_=Dn(0),Th=Dn(1),iP=Dn(2),nP=Dn(3),ys=Dn(4),sP=Dn(5),oP=Dn(6);l_.range;Th.range;iP.range;nP.range;ys.range;sP.range;oP.range;const Sd=ne(r=>{r.setDate(1),r.setHours(0,0,0,0)},(r,t)=>{r.setMonth(r.getMonth()+t)},(r,t)=>t.getMonth()-r.getMonth()+(t.getFullYear()-r.getFullYear())*12,r=>r.getMonth());Sd.range;const aP=ne(r=>{r.setUTCDate(1),r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCMonth(r.getUTCMonth()+t)},(r,t)=>t.getUTCMonth()-r.getUTCMonth()+(t.getUTCFullYear()-r.getUTCFullYear())*12,r=>r.getUTCMonth());aP.range;const hi=ne(r=>{r.setMonth(0,1),r.setHours(0,0,0,0)},(r,t)=>{r.setFullYear(r.getFullYear()+t)},(r,t)=>t.getFullYear()-r.getFullYear(),r=>r.getFullYear());hi.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:ne(t=>{t.setFullYear(Math.floor(t.getFullYear()/r)*r),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e*r)});hi.range;const Sn=ne(r=>{r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCFullYear(r.getUTCFullYear()+t)},(r,t)=>t.getUTCFullYear()-r.getUTCFullYear(),r=>r.getUTCFullYear());Sn.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:ne(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/r)*r),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e*r)});Sn.range;function hP(r,t,e,i,n,s){const o=[[Kn,1,Jr],[Kn,5,5*Jr],[Kn,15,15*Jr],[Kn,30,30*Jr],[s,1,Je],[s,5,5*Je],[s,15,15*Je],[s,30,30*Je],[n,1,ti],[n,3,3*ti],[n,6,6*ti],[n,12,12*ti],[i,1,ai],[i,2,2*ai],[e,1,bd],[t,1,ig],[t,3,3*ig],[r,1,fu]];function a(l,u,c){const d=u<l;d&&([l,u]=[u,l]);const f=c&&typeof c.range=="function"?c:h(l,u,c),p=f?f.range(l,+u+1):[];return d?p.reverse():p}function h(l,u,c){const d=Math.abs(u-l)/c,f=dd(([,,g])=>g).right(o,d);if(f===o.length)return r.every(wc(l/fu,u/fu,c));if(f===0)return wh.every(Math.max(wc(l,u,c),1));const[p,m]=o[d/o[f-1][2]<o[f][2]/d?f-1:f];return p.every(m)}return[a,h]}const[lP,uP]=hP(hi,Sd,Wh,Po,Ed,Td);function pu(r){if(0<=r.y&&r.y<100){var t=new Date(-1,r.m,r.d,r.H,r.M,r.S,r.L);return t.setFullYear(r.y),t}return new Date(r.y,r.m,r.d,r.H,r.M,r.S,r.L)}function mu(r){if(0<=r.y&&r.y<100){var t=new Date(Date.UTC(-1,r.m,r.d,r.H,r.M,r.S,r.L));return t.setUTCFullYear(r.y),t}return new Date(Date.UTC(r.y,r.m,r.d,r.H,r.M,r.S,r.L))}function Ls(r,t,e){return{y:r,m:t,d:e,H:0,M:0,S:0,L:0}}function cP(r){var t=r.dateTime,e=r.date,i=r.time,n=r.periods,s=r.days,o=r.shortDays,a=r.months,h=r.shortMonths,l=Bs(n),u=Us(n),c=Bs(s),d=Us(s),f=Bs(o),p=Us(o),m=Bs(a),g=Us(a),v=Bs(h),w=Us(h),_={a:A,A:C,b:B,B:I,c:null,d:lg,e:lg,f:kP,g:WP,G:VP,H:IP,I:DP,j:OP,L:u_,m:NP,M:FP,p:M,q:k,Q:dg,s:fg,S:LP,u:BP,U:UP,V:HP,w:GP,W:zP,x:null,X:null,y:jP,Y:XP,Z:$P,"%":cg},T={a:L,A:V,b:$,B:tt,c:null,d:ug,e:ug,f:KP,g:aI,G:lI,H:YP,I:qP,j:ZP,L:d_,m:QP,M:JP,p:et,q:K,Q:dg,s:fg,S:tI,u:eI,U:rI,V:iI,w:nI,W:sI,x:null,X:null,y:oI,Y:hI,Z:uI,"%":cg},b={a:G,A:O,b:N,B:P,c:F,d:ag,e:ag,f:CP,g:og,G:sg,H:hg,I:hg,j:TP,L:SP,m:bP,M:EP,p:D,q:wP,Q:RP,s:PP,S:AP,u:gP,U:yP,V:vP,w:mP,W:_P,x:j,X:E,y:og,Y:sg,Z:xP,"%":MP};_.x=x(e,_),_.X=x(i,_),_.c=x(t,_),T.x=x(e,T),T.X=x(i,T),T.c=x(t,T);function x(U,X){return function(q){var z=[],at=-1,nt=0,J=U.length,ht,Ct,Pt;for(q instanceof Date||(q=new Date(+q));++at<J;)U.charCodeAt(at)===37&&(z.push(U.slice(nt,at)),(Ct=ng[ht=U.charAt(++at)])!=null?ht=U.charAt(++at):Ct=ht==="e"?" ":"0",(Pt=X[ht])&&(ht=Pt(q,Ct)),z.push(ht),nt=at+1);return z.push(U.slice(nt,at)),z.join("")}}function y(U,X){return function(q){var z=Ls(1900,void 0,1),at=S(z,U,q+="",0),nt,J;if(at!=q.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(z.s*1e3+("L"in z?z.L:0));if(X&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+z.p*12),z.m===void 0&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(nt=mu(Ls(z.y,0,1)),J=nt.getUTCDay(),nt=J>4||J===0?Th.ceil(nt):Th(nt),nt=Ad.offset(nt,(z.V-1)*7),z.y=nt.getUTCFullYear(),z.m=nt.getUTCMonth(),z.d=nt.getUTCDate()+(z.w+6)%7):(nt=pu(Ls(z.y,0,1)),J=nt.getDay(),nt=J>4||J===0?bh.ceil(nt):bh(nt),nt=Po.offset(nt,(z.V-1)*7),z.y=nt.getFullYear(),z.m=nt.getMonth(),z.d=nt.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),J="Z"in z?mu(Ls(z.y,0,1)).getUTCDay():pu(Ls(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+z.W*7-(J+5)%7:z.w+z.U*7-(J+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,mu(z)):pu(z)}}function S(U,X,q,z){for(var at=0,nt=X.length,J=q.length,ht,Ct;at<nt;){if(z>=J)return-1;if(ht=X.charCodeAt(at++),ht===37){if(ht=X.charAt(at++),Ct=b[ht in ng?X.charAt(at++):ht],!Ct||(z=Ct(U,q,z))<0)return-1}else if(ht!=q.charCodeAt(z++))return-1}return z}function D(U,X,q){var z=l.exec(X.slice(q));return z?(U.p=u.get(z[0].toLowerCase()),q+z[0].length):-1}function G(U,X,q){var z=f.exec(X.slice(q));return z?(U.w=p.get(z[0].toLowerCase()),q+z[0].length):-1}function O(U,X,q){var z=c.exec(X.slice(q));return z?(U.w=d.get(z[0].toLowerCase()),q+z[0].length):-1}function N(U,X,q){var z=v.exec(X.slice(q));return z?(U.m=w.get(z[0].toLowerCase()),q+z[0].length):-1}function P(U,X,q){var z=m.exec(X.slice(q));return z?(U.m=g.get(z[0].toLowerCase()),q+z[0].length):-1}function F(U,X,q){return S(U,t,X,q)}function j(U,X,q){return S(U,e,X,q)}function E(U,X,q){return S(U,i,X,q)}function A(U){return o[U.getDay()]}function C(U){return s[U.getDay()]}function B(U){return h[U.getMonth()]}function I(U){return a[U.getMonth()]}function M(U){return n[+(U.getHours()>=12)]}function k(U){return 1+~~(U.getMonth()/3)}function L(U){return o[U.getUTCDay()]}function V(U){return s[U.getUTCDay()]}function $(U){return h[U.getUTCMonth()]}function tt(U){return a[U.getUTCMonth()]}function et(U){return n[+(U.getUTCHours()>=12)]}function K(U){return 1+~~(U.getUTCMonth()/3)}return{format:function(U){var X=x(U+="",_);return X.toString=function(){return U},X},parse:function(U){var X=y(U+="",!1);return X.toString=function(){return U},X},utcFormat:function(U){var X=x(U+="",T);return X.toString=function(){return U},X},utcParse:function(U){var X=y(U+="",!0);return X.toString=function(){return U},X}}}var ng={"-":"",_:" ",0:"0"},le=/^\s*\d+/,dP=/^%/,fP=/[\\^$*+?|[\]().{}]/g;function Mt(r,t,e){var i=r<0?"-":"",n=(i?-r:r)+"",s=n.length;return i+(s<e?new Array(e-s+1).join(t)+n:n)}function pP(r){return r.replace(fP,"\\$&")}function Bs(r){return new RegExp("^(?:"+r.map(pP).join("|")+")","i")}function Us(r){return new Map(r.map((t,e)=>[t.toLowerCase(),e]))}function mP(r,t,e){var i=le.exec(t.slice(e,e+1));return i?(r.w=+i[0],e+i[0].length):-1}function gP(r,t,e){var i=le.exec(t.slice(e,e+1));return i?(r.u=+i[0],e+i[0].length):-1}function yP(r,t,e){var i=le.exec(t.slice(e,e+2));return i?(r.U=+i[0],e+i[0].length):-1}function vP(r,t,e){var i=le.exec(t.slice(e,e+2));return i?(r.V=+i[0],e+i[0].length):-1}function _P(r,t,e){var i=le.exec(t.slice(e,e+2));return i?(r.W=+i[0],e+i[0].length):-1}function sg(r,t,e){var i=le.exec(t.slice(e,e+4));return i?(r.y=+i[0],e+i[0].length):-1}function og(r,t,e){var i=le.exec(t.slice(e,e+2));return i?(r.y=+i[0]+(+i[0]>68?1900:2e3),e+i[0].length):-1}function xP(r,t,e){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(e,e+6));return i?(r.Z=i[1]?0:-(i[2]+(i[3]||"00")),e+i[0].length):-1}function wP(r,t,e){var i=le.exec(t.slice(e,e+1));return i?(r.q=i[0]*3-3,e+i[0].length):-1}function bP(r,t,e){var i=le.exec(t.slice(e,e+2));return i?(r.m=i[0]-1,e+i[0].length):-1}function ag(r,t,e){var i=le.exec(t.slice(e,e+2));return i?(r.d=+i[0],e+i[0].length):-1}function TP(r,t,e){var i=le.exec(t.slice(e,e+3));return i?(r.m=0,r.d=+i[0],e+i[0].length):-1}function hg(r,t,e){var i=le.exec(t.slice(e,e+2));return i?(r.H=+i[0],e+i[0].length):-1}function EP(r,t,e){var i=le.exec(t.slice(e,e+2));return i?(r.M=+i[0],e+i[0].length):-1}function AP(r,t,e){var i=le.exec(t.slice(e,e+2));return i?(r.S=+i[0],e+i[0].length):-1}function SP(r,t,e){var i=le.exec(t.slice(e,e+3));return i?(r.L=+i[0],e+i[0].length):-1}function CP(r,t,e){var i=le.exec(t.slice(e,e+6));return i?(r.L=Math.floor(i[0]/1e3),e+i[0].length):-1}function MP(r,t,e){var i=dP.exec(t.slice(e,e+1));return i?e+i[0].length:-1}function RP(r,t,e){var i=le.exec(t.slice(e));return i?(r.Q=+i[0],e+i[0].length):-1}function PP(r,t,e){var i=le.exec(t.slice(e));return i?(r.s=+i[0],e+i[0].length):-1}function lg(r,t){return Mt(r.getDate(),t,2)}function IP(r,t){return Mt(r.getHours(),t,2)}function DP(r,t){return Mt(r.getHours()%12||12,t,2)}function OP(r,t){return Mt(1+Po.count(hi(r),r),t,3)}function u_(r,t){return Mt(r.getMilliseconds(),t,3)}function kP(r,t){return u_(r,t)+"000"}function NP(r,t){return Mt(r.getMonth()+1,t,2)}function FP(r,t){return Mt(r.getMinutes(),t,2)}function LP(r,t){return Mt(r.getSeconds(),t,2)}function BP(r){var t=r.getDay();return t===0?7:t}function UP(r,t){return Mt(Wh.count(hi(r)-1,r),t,2)}function c_(r){var t=r.getDay();return t>=4||t===0?gs(r):gs.ceil(r)}function HP(r,t){return r=c_(r),Mt(gs.count(hi(r),r)+(hi(r).getDay()===4),t,2)}function GP(r){return r.getDay()}function zP(r,t){return Mt(bh.count(hi(r)-1,r),t,2)}function jP(r,t){return Mt(r.getFullYear()%100,t,2)}function WP(r,t){return r=c_(r),Mt(r.getFullYear()%100,t,2)}function XP(r,t){return Mt(r.getFullYear()%1e4,t,4)}function VP(r,t){var e=r.getDay();return r=e>=4||e===0?gs(r):gs.ceil(r),Mt(r.getFullYear()%1e4,t,4)}function $P(r){var t=r.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Mt(t/60|0,"0",2)+Mt(t%60,"0",2)}function ug(r,t){return Mt(r.getUTCDate(),t,2)}function YP(r,t){return Mt(r.getUTCHours(),t,2)}function qP(r,t){return Mt(r.getUTCHours()%12||12,t,2)}function ZP(r,t){return Mt(1+Ad.count(Sn(r),r),t,3)}function d_(r,t){return Mt(r.getUTCMilliseconds(),t,3)}function KP(r,t){return d_(r,t)+"000"}function QP(r,t){return Mt(r.getUTCMonth()+1,t,2)}function JP(r,t){return Mt(r.getUTCMinutes(),t,2)}function tI(r,t){return Mt(r.getUTCSeconds(),t,2)}function eI(r){var t=r.getUTCDay();return t===0?7:t}function rI(r,t){return Mt(l_.count(Sn(r)-1,r),t,2)}function f_(r){var t=r.getUTCDay();return t>=4||t===0?ys(r):ys.ceil(r)}function iI(r,t){return r=f_(r),Mt(ys.count(Sn(r),r)+(Sn(r).getUTCDay()===4),t,2)}function nI(r){return r.getUTCDay()}function sI(r,t){return Mt(Th.count(Sn(r)-1,r),t,2)}function oI(r,t){return Mt(r.getUTCFullYear()%100,t,2)}function aI(r,t){return r=f_(r),Mt(r.getUTCFullYear()%100,t,2)}function hI(r,t){return Mt(r.getUTCFullYear()%1e4,t,4)}function lI(r,t){var e=r.getUTCDay();return r=e>=4||e===0?ys(r):ys.ceil(r),Mt(r.getUTCFullYear()%1e4,t,4)}function uI(){return"+0000"}function cg(){return"%"}function dg(r){return+r}function fg(r){return Math.floor(+r/1e3)}var Un,p_;cI({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function cI(r){return Un=cP(r),p_=Un.format,Un.parse,Un.utcFormat,Un.utcParse,Un}function dI(r){return new Date(r)}function fI(r){return r instanceof Date?+r:+new Date(+r)}function m_(r,t,e,i,n,s,o,a,h,l){var u=a_(),c=u.invert,d=u.domain,f=l(".%L"),p=l(":%S"),m=l("%I:%M"),g=l("%I %p"),v=l("%a %d"),w=l("%b %d"),_=l("%B"),T=l("%Y");function b(x){return(h(x)<x?f:a(x)<x?p:o(x)<x?m:s(x)<x?g:i(x)<x?n(x)<x?v:w:e(x)<x?_:T)(x)}return u.invert=function(x){return new Date(c(x))},u.domain=function(x){return arguments.length?d(Array.from(x,fI)):d().map(dI)},u.ticks=function(x){var y=d();return r(y[0],y[y.length-1],x??10)},u.tickFormat=function(x,y){return y==null?b:l(y)},u.nice=function(x){var y=d();return(!x||typeof x.range!="function")&&(x=t(y[0],y[y.length-1],x??10)),x?d(qR(y,x)):u},u.copy=function(){return o_(u,m_(r,t,e,i,n,s,o,a,h,l))},u}function pI(){return s_.apply(m_(lP,uP,hi,Sd,Wh,Po,Ed,Td,Kn,p_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Js(r,t,e){this.k=r,this.x=t,this.y=e}Js.prototype={constructor:Js,scale:function(r){return r===1?this:new Js(this.k*r,this.x,this.y)},translate:function(r,t){return r===0&t===0?this:new Js(this.k,this.x+this.k*r,this.y+this.k*t)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Js.prototype;function g_(r){return r.mode==="temporal"||r.mode==="left-aligned"?mI(r):gI(r)}function mI({domain:r,range:t}){return pI().domain(r).range(t)}function gI({domain:r,range:t}){return h_().domain(r).range(t)}function Rc(r){return{mode:ut.horizontal,range:dS(),domain:fS(r)}}function yI(){return{mode:ut.vertical}}let so=null;async function vI(){const r=await Hr();pg(r.start_time),rt.on("layoutSettingsUpdated",()=>pg(r.start_time))}function _I(){so=null}async function rr(){return so||await Re("scaleCreated")}async function pg(r){await Kt();const t=so?"scaleUpdated":"scaleCreated",e=Rc(r);so=g_(e),rt.emit(t,so)}function Ri(r){return"getIds"in r}async function y_({items:r,createCluster:t}){const e=[...r.values()].sort((o,a)=>o.element.x-a.element.x);async function i(o){let a,h=null,l=null;for(let u=o??0;u<e.length;u++){const c=e[u],d=c.element.x;if(c.element.visible=!0,h!==null&&a&&d<a){l=u;break}h=u,a=d+c.element.width}if(l!==null&&h!==null){const u=e[h],c=e[l];u.element.visible=!1,c.element.visible=!1;const d=await n(u,c);d&&(e.splice(h,1,d),e.splice(l,1)),i(h)}}async function n(o,a){const h=o.getDate(),l=a.getDate(),u=Ri(o)?o.getIds():[o.getId()],c=Ri(a)?a.getIds():[a.getId()];if(!h||!l)return console.error("flowRunArtifacts: visible item is missing date"),null;let d;Ri(o)?d=o:Ri(a)?d=a:d=await t();const f=[...u,...c],p=s(f);return await d.render({ids:f,date:p}),d}function s(o){const a=o.reduce((u,c)=>{const d=r.get(c)?.getDate();return d&&u.push(d.getTime()),u},[]),h=Math.min(...a),l=Math.max(...a);return new Date((h+l)/2)}await i()}async function mg(r){const t=await Qt(),e=await Jt(),i=await jt(),n=await Kt();let s=await rr();const o=await h();o.element.on("click",u=>{u.stopPropagation();const{element:c}=o,d={x:c.position.x,y:c.position.y,width:c.width,height:c.height},f=Ri(o)?{kind:"events",ids:o.getIds(),occurred:o.getDate(),position:d}:{kind:"event",id:o.getId(),occurred:o.getDate(),position:d};li(f)}),rt.on("scaleUpdated",u=>{s=u,l()}),rt.on("viewportMoved",()=>l());async function a(u){await o.render(u),l()}async function h(){return r.type==="event"?await Mv(r.event):await Rv()}function l(){const u=o.getDate();if(!u||n.disableEvents||!ut.isTemporal())return;const{element:c}=o,d=s(u)*e.scale._x+e.worldTransform.tx-c.width/2,f=t.screen.height-c.height-i.eventBottomMargin;c.position.set(d,f)}return{...o,render:a}}async function gg(r){const t=await Jt(),e=await Kt();let i=await rr();const n=await o();n.element.on("click",h=>{h.stopPropagation();const{element:l}=n,u=l.getGlobalPosition(),c={x:u.x,y:u.y,width:l.width*t.scale.x,height:l.height*t.scale.y},d=Ri(n)?{kind:"events",ids:n.getIds(),occurred:n.getDate(),position:c}:{kind:"event",id:n.getId(),occurred:n.getDate(),position:c};li(d)}),rt.on("scaleUpdated",h=>{i=h,a()});async function s(h){await n.render(h),a()}async function o(){return r.type==="event"?await Mv(r.event):await Rv()}function a(){const h=n.getDate(),{parentStartDate:l}=r;if(!h||e.disableEvents||!ut.isTemporal()||!l)return;const{element:u}=n,c=i(h)-i(l)-u.width/2,d=-u.height;u.position.set(c,d)}return{...n,render:s}}async function v_({isRoot:r,parentStartDate:t}={}){const e=await Kt(),i=new Map,n=new Map,s=[];let o=[];const a=new bt;let h=null;rt.on("scaleUpdated",()=>c());async function l(p){if(p&&(h=p),!h)return;const m=[];for(const g of h)m.push(u(g));await Promise.all(m),c()}async function u(p){if(i.has(p.id))return i.get(p.id).render();if(n.has(p.id))return await n.get(p.id);const m=(async()=>{const g=r?await mg({type:"event",event:p}):await gg({type:"event",event:p,parentStartDate:t});i.set(p.id,g),a.addChild(g.element)})();return n.set(p.id,m),await m,n.delete(p.id),i.get(p.id).render()}function c(){e.disableEvents||!ut.isTemporal()||d()}const d=Av(async()=>{o=[...s],await y_({items:i,createCluster:f});for(const p of o)p.render()},Rg);async function f(){if(o.length>0)return o.pop();const p=r?await mg({type:"cluster"}):await gg({type:"cluster",parentStartDate:t});return a.addChild(p.element),s.push(p),p}return{element:a,render:l,update:c}}let Pc=null,oo=null;async function xI(){const r=await Qt(),t=await Ue(),e=await Kt(),i=await Hr(),{element:n,render:s,update:o}=await v_({isRoot:!0});n.zIndex=Ax;async function a(l){if(!ut.isTemporal()||e.disableEvents){r.stage.removeChild(n);return}r.stage.addChild(n),await s(l)}const h=await bv(()=>({nodeId:t.runId,since:i.start_time,until:i.end_time??new Date}),l=>{const u=oo?"eventDataUpdated":"eventDataCreated";oo=l,rt.emit(u,oo),a(l)});rt.on("configUpdated",()=>a()),rt.on("viewportMoved",()=>o()),rt.on("layoutSettingsUpdated",()=>a()),Pc=h.stop,h.start()}function wI(){Pc?.(),Pc=null,oo=null}async function bI(){return oo||await Re("eventDataCreated")}async function yg(r){const t=await Qt(),e=await Jt(),i=await jt(),n=await Kt(),s=await bI();let o=await rr(),a=s&&s.length>0;const h=await u();h.element.on("click",d=>{d.stopPropagation();const{element:f}=h,p=f.getGlobalPosition(),m={x:p.x,y:p.y,width:f.width,height:f.height},g=Ri(h)?{kind:"artifacts",ids:h.getIds(),position:m}:{kind:"artifact",id:h.getId()};li(g)}),rt.on("scaleUpdated",d=>{o=d,c()}),rt.on("viewportMoved",()=>c()),rt.on("eventDataCreated",d=>{a=d.length>0,c()}),rt.on("eventDataUpdated",d=>{a=d.length>0,c()});async function l(d){if(wv(h)){if(r.type!=="artifact")throw new Error(`ArtifactFactory attempted to render a ${r.type}`);await h.render(r.artifact)}else await h.render(d);c()}async function u(){return r.type==="artifact"?await cd(r.artifact,{cullAtZoomThreshold:!1}):await Sv()}function c(){const d=h.getDate();if(!d||!ut.isTemporal()||n.disableArtifacts)return;const f=h.getSelected(),{element:p}=h,{eventTargetSize:m,flowStateSelectedBarHeight:g}=i;let v=0;if(f){const{selectedBorderOffset:b,selectedBorderWidth:x}=i;v=b+x*2}const w=o(d)*e.scale._x+e.worldTransform.tx-(p.width-v)/2,_=a&&!n.disableEvents?m:g,T=t.screen.height-(p.height-v)-_;p.position.set(w,T)}return{...h,render:l}}async function vg(r){const t=await Jt(),e=await jt(),i=await Kt();let n=await rr();const s=await a();s.element.on("click",l=>{l.stopPropagation();const{element:u}=s,c=u.getGlobalPosition(),d={x:c.x,y:c.y,width:u.width*t.scale.x,height:u.height*t.scale.y},f=Ri(s)?{kind:"artifacts",ids:s.getIds(),position:d}:{kind:"artifact",id:s.getId()};li(f)}),rt.on("scaleUpdated",l=>{n=l,h()});async function o(l){if(wv(s)){if(r.type!=="artifact")throw new Error(`ArtifactFactory attempted to render a ${r.type}`);await s.render(r.artifact)}else await s.render(l);h()}async function a(){return r.type==="artifact"?await cd(r.artifact):await Sv()}function h(){const l=s.getDate(),{parentStartDate:u}=r;if(!l||!ut.isTemporal()||i.disableArtifacts||!u)return;const c=s.getSelected(),{element:d}=s;let f=0;if(c){const{selectedBorderOffset:g,selectedBorderWidth:v}=e;f=g+v*2}const p=n(l)-n(u)-(d.width-f)/2,m=-(d.height-f);d.position.set(p,m)}return{...s,render:o}}async function __({isRoot:r,parentStartDate:t}={}){const e=await Kt(),i=new Map,n=new Map,s=[];let o=[];const a=new bt;let h=null;async function l(p){if(p&&(h=p),!h)return;const m=[];for(const g of h)m.push(u(g));await Promise.all(m),c()}async function u(p){if(i.has(p.id))return i.get(p.id).render(p);n.has(p.id)&&await n.get(p.id);const m=(async()=>{const g=r?await yg({type:"artifact",artifact:p}):await vg({type:"artifact",artifact:p,parentStartDate:t});i.set(p.id,g),a.addChild(g.element)})();return n.set(p.id,m),await m,n.delete(p.id),i.get(p.id).render(p)}function c(){if(!(e.disableArtifacts||!ut.isTemporal())){if(!ut.isTemporal()){a.visible=!1;return}a.visible=!0,a.position.x=0,d()}}const d=Av(async()=>{o=[...s],await y_({items:i,createCluster:f});for(const p of o)p.render()},Rg);async function f(){if(o.length>0)return o.pop();const p=r?await yg({type:"cluster"}):await vg({type:"cluster",parentStartDate:t});return a.addChild(p.element),s.push(p),p}return{element:a,render:l,update:c}}async function TI(r){const t=await Qt(),e=await Jt(),i=await jt(),n=await Hr();let s=await rr();const o=new bt,a=await si(),h=await si();let l=null,u=!1,c=!1;t.stage.addChild(h),o.addChild(a),a.eventMode="static",a.cursor="pointer",a.on("mouseover",()=>{u=!0,d()}),a.on("mouseleave",()=>{u=!1,d()}),a.on("click",()=>{const _={x:a.position.x,y:a.position.y,width:a.width,height:a.height};li({...r,kind:"state",position:_})}),rt.on("viewportMoved",()=>d()),rt.on("scaleUpdated",_=>{s=_,d()}),rt.on("itemSelected",()=>{const _=ui({kind:"state",...r});_!==c&&(c=_,u=!1,d())}),r.type==="RUNNING"&&!n.end_time&&g();function d(_){const{end:T}=_??{};if(T&&(l=T),n.end_time&&v(),!ut.isTemporal()){h.visible=!1,o.visible=!1;return}const b=f();p(b),m(b),h.visible=!0,o.visible=!0}function f(){const{background:_="#fff"}=i.state(r),T=Math.max(s(r.timestamp)*e.scale._x+e.worldTransform.tx,0);let b=0;return r.type==="RUNNING"&&!n.end_time?b=s(new Date)*e.scale._x+e.worldTransform.tx-T:l?b=s(l)*e.scale._x+e.worldTransform.tx-T:b=t.screen.width-T,{x:T,width:Math.max(b,0),background:_}}function p({x:_,width:T,background:b}){const{flowStateBarHeight:x,flowStateSelectedBarHeight:y}=i,S=u||c?y:x;a.x=_,a.y=t.screen.height-S,a.width=T,a.height=S,a.tint=b}function m({x:_,width:T,background:b}){if(r.type==="RUNNING"){h.visible=!1;return}const{flowStateBarHeight:x,flowStateAreaAlpha:y}=i;h.x=_,h.y=0,h.width=T,h.height=t.screen.height-x,h.tint=b,h.alpha=y}function g(){t.ticker.add(w)}function v(){t.ticker.remove(w)}function w(){d()}return{element:o,render:d}}function EI(r){return"isNodesFlowRunStateFactory"in r}async function AI(r){const t=await Qt(),e=await Jt(),i=await jt(),n=await Hr();let s=await rr();const o=new bt,a=await si(),h=await si();let l=null,u=null,c=0,d=0,f=!1,p=!1;o.visible=!1,o.addChild(h),o.addChild(a),a.eventMode="static",a.cursor="pointer",a.on("mouseover",()=>{f=!0,m()}),a.on("mouseleave",()=>{f=!1,m()}),a.on("click",x=>{x.stopPropagation();const y=a.getGlobalPosition(),S={x:y.x,y:y.y,width:a.width*e.scale.x,height:a.height*e.scale.y};li({...r,kind:"state",position:S})}),h.eventMode="none",h.cursor="default",rt.on("scaleUpdated",x=>{s=x,m()}),rt.on("itemSelected",()=>{const x=ui({kind:"state",...r});x!==p&&(p=x,f=!1,m())}),r.type==="RUNNING"&&!n.end_time&&_();function m(x){const{end:y,parentStartDate:S,width:D,height:G}=x??{};if(y&&(l=y),S&&(u=S),D&&(c=D),G&&(d=G),n.end_time&&T(),!ut.isTemporal()){o.visible=!1;return}if(!u||c<=0){o.visible=!1;return}const O=g();if(O.width<=0){o.visible=!1;return}v(O),w(O),o.visible=!0}function g(){const{background:x="#fff"}=i.state(r);if(!u)return{x:0,width:0,background:x};const y=s(u);let S=s(r.timestamp)-y;if(S>=c)return{x:c,width:0,background:x};S<0&&(S=0);let D=s(l??new Date)-y;D>c&&(D=c);const G=Math.max(D-S,0);return{x:S,width:G,background:x}}function v({x,width:y,background:S}){const{flowStateBarHeight:D,flowStateSelectedBarHeight:G}=i,O=f||p?G:D;a.x=x,a.y=d-O,a.width=y,a.height=O,a.tint=S}function w({x,width:y,background:S}){const{flowStateBarHeight:D,flowStateAreaAlpha:G,nodeHeight:O}=i,N=O/2;h.x=x,h.y=N,h.width=y,h.height=d-D-N,h.tint=S,h.alpha=G}function _(){t.ticker.add(b)}function T(){t.ticker.remove(b)}function b(){m()}return{element:o,render:m,isNodesFlowRunStateFactory:!0}}function x_({isRoot:r}={}){const t=new bt,e=new Map,i=new Map;let n=null;async function s(a,h){if(a&&(n=a),!n)return;const l=[];for(let u=0;u<n.length;u++)l.push(o(n[u],u,h));await Promise.all(l)}async function o(a,h,l){const u=n&&n.length>=h+1&&n[h+1],c=u?u.timestamp:void 0;let d;if(i.has(a.id)&&await i.get(a.id),e.has(a.id))d=e.get(a.id);else{const f=(async()=>{const p=r?await TI(a):await AI(a);e.set(a.id,p),t.addChild(p.element)})();i.set(a.id,f),await f,i.delete(a.id),d=e.get(a.id)}EI(d)?await d.render({end:c,...l}):await d.render(c?{end:c}:void 0)}return{element:t,render:s}}class w_ extends bt{updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t)this.children[t].updateTransform()}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(const t of this.children)if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds);this._bounds.updateID=this._boundsID}}async function SI(r){const t=new w_,e=await Ue(),i=await jt(),n=await Kt(),{element:s,render:o}=await Ev(),{element:a,render:h}=await Hh(),{element:l,render:u}=await Tv(),{element:c,render:d}=await Bh(),{element:f,render:p,getSize:m,stopWorker:g}=await Cd(),{element:v,render:w}=await x_(),{element:_,render:T,update:b}=await v_({parentStartDate:r.start_time}),{element:x,render:y,update:S}=await __({parentStartDate:r.start_time});let D=!1,G=!1,O=r,N=!1;t.sortableChildren=!0,c.zIndex=Pg,s.zIndex=Dg,a.zIndex=Ha,l.zIndex=Ha,f.zIndex=Ig,_.zIndex=Mx,v.zIndex=Rx,x.zIndex=Px,c.eventMode="none",c.cursor="default";const{start:P,stop:F}=await fy(O.id,U=>{G=!!U.artifacts&&U.artifacts.length>0,p(U),I(U.states),k(U.artifacts),B()}),{start:j,stop:E}=await bv(()=>({nodeId:O.id,since:O.start_time,until:O.end_time??new Date}),U=>{D=U.length>0,M(U)});t.addChild(s),t.addChild(a),t.addChild(l),l.on("click",U=>{U.stopPropagation(),C()}),f.position={x:0,y:i.nodeHeight+i.nodesPadding},f.on("rendered",()=>{Io(),et()});async function A(U){return O=U,await o(U),await $(),await tt(),N&&(await I(),await M(),await k(),await B()),t}async function C(){N?await V():await L()}async function B(){const{background:U="#fff"}=i.node(O),{width:X,height:q}=m(),{height:z}=K(),{nodeBorderRadius:at}=i,nt=2;c.position={x:-nt,y:-nt};const J=ut.isTemporal()?z+nt*2:q+nt*2;await d({width:X+nt*2,height:J,stroke:nt,radius:[at,at,0,0],color:U})}async function I(U){const{height:X}=K(),{width:q}=s;await w(U??void 0,{parentStartDate:O.start_time,width:q,height:X})}async function M(U){if(!N||!ut.isTemporal()||n.disableEvents){t.removeChild(_);return}t.addChild(_);const{height:X}=K();if(_.position={x:0,y:X-i.eventBottomMargin},U){await T(U);return}await b()}async function k(U){if(!N||!ut.isTemporal()||n.disableArtifacts){t.removeChild(x);return}t.addChild(x);const{eventTargetSize:X,flowStateSelectedBarHeight:q}=i,{height:z}=K(),at=z-(D&&!n.disableEvents?X:q);if(x.position={x:0,y:at},U){await y(U);return}await S()}async function L(){N=!0,t.addChild(v),t.addChild(f),t.addChild(c),await Promise.all([P(),j(),A(O)]),et()}async function V(){N=!1,t.removeChild(v),t.removeChild(f),t.removeChild(c),t.removeChild(_),t.removeChild(x),g(),await Promise.all([F(),E(),A(O)]),et()}async function $(){const U=i.nodeToggleSize,X=i.nodeHeight-U,q=s.width>U,z=await u({inside:q,isOpen:N});return z.x=q?X/2:s.width+i.nodePadding,z.y=X/2,z}async function tt(){const U=await h(O.label),X=e.theme==="dark"?i.textDefault:i.textInverse,q=i.nodePadding,z=l.x+l.width+q,at=s.width+q,nt=s.width>z+U.width+q,J=i.nodeHeight/2-U.height/2,ht=nt?z:Math.max(at,z);return U.position={x:ht,y:J},U.tint=nt?X:i.textDefault,U}function et(){N&&(I(),M(),k(),B());const U=K();t.emit("resized",U)}function K(){const U=m(),{nodeHeight:X,nodesPadding:q,eventTargetSize:z,eventBottomMargin:at,artifactPaddingY:nt,artifactIconSize:J}=i,ht=G&&ut.isTemporal()&&!n.disableArtifacts?J+nt*2:0,Ct=D&&ut.isTemporal()&&!n.disableEvents?z+at:0,Pt=N?U.height+ht+Ct+q*2:0,ir=N?U.width:0;return{height:X+Pt,width:Math.max(ir,t.width)}}return{kind:"flow-run",element:t,bar:s,render:A}}async function CI(r,t){const e=await Ue(),i=await jt(),n=new w_,{element:s,render:o}=await Hh(),{element:a,render:h}=await Bh(),{element:l,render:u}=await Ev(),{element:c,render:d}=await Tv(),{element:f,render:p,getSize:m,stopWorker:g}=await Cd();n.addChild(l),n.addChild(s);let v=!1,w=r,_=t;n.sortableChildren=!0,a.zIndex=Pg,l.zIndex=Dg,s.zIndex=Ha,c.zIndex=Ha,f.zIndex=Ig,a.eventMode="none",a.cursor="default",f.position={x:0,y:i.nodeHeight+i.nodesPadding},f.on("rendered",()=>{Io(),N()}),c.on("click",P=>{P.stopPropagation(),S()});async function T(P,F){return w=P,_=F,F&&n.addChild(c),await u(P),F&&await b(),v&&(F&&p(F),await y()),await x(),n}async function b(){const P=i.nodeToggleSize,F=i.nodeHeight-P,j=l.width>P,E=await d({inside:j,isOpen:v});return E.x=j?F/2:l.width+i.nodePadding,E.y=F/2,E}async function x(){const P=await o(w.label),F=e.theme==="dark"?i.textDefault:i.textInverse,j=i.nodePadding,E=c.x+c.width+j,A=l.width+j,C=l.width>E+P.width+j,B=i.nodeHeight/2-P.height/2,I=C?E:Math.max(A,E);return P.position={x:I,y:B},P.tint=C?F:i.textDefault,P}async function y(){const{background:P="#fff"}=i.node(w),{width:F,height:j}=m(),{height:E}=O(),{nodeBorderRadius:A}=i,C=2;a.position={x:-C,y:-C};const B=ut.isTemporal()?E+C*2:j+C*2;await h({width:F+C*2,height:B,stroke:C,radius:[A,A,0,0],color:P})}async function S(){v?await G():await D()}async function D(){if(v=!0,n.addChild(f),n.addChild(a),!_)throw new Error("Attempted to open without nested graph data");await Promise.all([p(_),T(w,_)]),N()}async function G(){v=!1,n.removeChild(f),n.removeChild(a),g(),await T(w,_),N()}function O(){const P=m(),{nodeHeight:F,nodesPadding:j}=i,E=v?P.height+j*2:0,A=v?P.width:0;return{height:F+E,width:Math.max(A,n.width)}}function N(){v&&y();const P=O();n.emit("resized",P)}return{kind:"task-run",element:n,render:T,bar:l}}async function MI(r,t){const e=await Ue(),i=await jt(),n=await Qt(),s=await S_(),o=await Kt();let a=null;const h=new Map,{animate:l}=await yv(),{element:u,render:c,bar:d}=await G(r,t);let f=r,p=t,m=null,g=!1,v=!1;s.add(u),u.eventMode="static",u.cursor="pointer",u.name=mx,u.on("click",P=>{P.stopPropagation(),li({kind:f.kind,id:f.id})}),f.end_time||y(),rt.on("itemSelected",()=>{const P=ui({kind:f.kind,id:f.id});P!==g&&(g=P,c(f,p))});async function w(P,F){f=P,p=F;const j=O(P);return j===m||(m=j,await Promise.all([c(P,F),_(P.artifacts)]),P.end_time&&S()),u}async function _(P){if(!P||(b(),o.disableArtifacts||!ut.isTemporal()))return;const F=[];for(const j of P)F.push(T(j));await Promise.all(F),x()}async function T(P){if(h.has(P.id))return h.get(P.id).render(P);const F=await cd(P,{enableLocalClickHandling:!0});return h.set(P.id,F),a.addChild(F.element),F.render(P)}function b(){if(ut.isTemporal()&&!o.disableArtifacts){a||(a=new bt),u.addChild(a);return}a&&u.removeChild(a)}function x(){if(!a)return;const{artifactsGap:P,artifactsNodeOverlap:F}=i;let j=0;for(const E of h.values())E.element.position.x=j,j+=E.element.width+P;a.position.y=-a.height+F,a.width<d.width&&(a.position.x=d.width-a.width)}function y(){n.ticker.add(D)}function S(){n.ticker.remove(D)}function D(){w(f,p)}async function G(P,F){const{kind:j}=P;switch(j){case"task-run":return await CI(P,F);case"flow-run":return await SI(P);default:const E=j;throw new Error(`switch does not have case for value: ${E}`)}}function O(P){const F=P.end_time??new Date,j=P.artifacts?.map(A=>A.type==="progress"?`${A.id}-${A.data}`:A.id).join("|"),E=!!p;return[P.state_type,F.getTime(),ut.horizontal,ut.horizontalScaleMultiplier,e.theme,o.disableArtifacts||j,E].join("-")}function N({x:P,y:F}){l(u,{x:P,y:F},!v),v=!0}return{element:u,render:w,bar:d,setPosition:N}}function _g({gap:r=0,minimum:t=0}={}){const e=new Map;function i(u){const c=e.get(u)??[];return Math.max(...c.values(),ka(t))+ka(r)}function n(u){let c=0;for(let d=0;d<u;d++)c+=i(d);return c}function s(u){return n(u+1)-ka(r)}function o({axis:u,nodeId:c,offset:d}){const f=e.get(u)??new Map;f.set(c,d),e.set(u,f)}function a({axis:u,nodeId:c}){let d,f;for(const[p,m]of e.entries())if(m.has(c)){d=p,f=m.get(c);break}d===u||d===void 0||f===void 0||(h({axis:d,nodeId:c}),o({axis:u,nodeId:c,offset:f}))}function h({axis:u,nodeId:c}){e.get(u)?.delete(c)}function l(){e.clear()}return{getOffset:i,getTotalOffset:n,getTotalValue:s,setOffset:o,updateNodeAxis:a,removeOffset:h,clear:l}}function RI(r){throw new Error(`switch does not have case for value: ${r}`)}const b_='(function(){"use strict";function sr(t){throw new Error(`switch does not have case for value: ${t}`)}function Ht(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function cr(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function cn(t){let n,e,r;t.length!==2?(n=Ht,e=(u,c)=>Ht(t(u),c),r=(u,c)=>t(u)-c):(n=t===Ht||t===cr?t:fr,e=t,r=t);function i(u,c,s=0,f=u.length){if(s<f){if(n(c,c)!==0)return f;do{const l=s+f>>>1;e(u[l],c)<0?s=l+1:f=l}while(s<f)}return s}function o(u,c,s=0,f=u.length){if(s<f){if(n(c,c)!==0)return f;do{const l=s+f>>>1;e(u[l],c)<=0?s=l+1:f=l}while(s<f)}return s}function a(u,c,s=0,f=u.length){const l=i(u,c,s,f-1);return l>s&&r(u[l-1],c)>-r(u[l],c)?l-1:l}return{left:i,center:a,right:o}}function fr(){return 0}function lr(t){return t===null?NaN:+t}const hr=cn(Ht).right;cn(lr).center;const gr=Math.sqrt(50),dr=Math.sqrt(10),mr=Math.sqrt(2);function Yt(t,n,e){const r=(n-t)/Math.max(0,e),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=gr?10:o>=dr?5:o>=mr?2:1;let u,c,s;return i<0?(s=Math.pow(10,-i)/a,u=Math.round(t*s),c=Math.round(n*s),u/s<t&&++u,c/s>n&&--c,s=-s):(s=Math.pow(10,i)*a,u=Math.round(t/s),c=Math.round(n/s),u*s<t&&++u,c*s>n&&--c),c<u&&.5<=e&&e<2?Yt(t,n,e*2):[u,c,s]}function pr(t,n,e){if(n=+n,t=+t,e=+e,!(e>0))return[];if(t===n)return[t];const r=n<t,[i,o,a]=r?Yt(n,t,e):Yt(t,n,e);if(!(o>=i))return[];const u=o-i+1,c=new Array(u);if(r)if(a<0)for(let s=0;s<u;++s)c[s]=(o-s)/-a;else for(let s=0;s<u;++s)c[s]=(o-s)*a;else if(a<0)for(let s=0;s<u;++s)c[s]=(i+s)/-a;else for(let s=0;s<u;++s)c[s]=(i+s)*a;return c}function fn(t,n,e){return n=+n,t=+t,e=+e,Yt(t,n,e)[2]}function ln(t,n,e){n=+n,t=+t,e=+e;const r=n<t,i=r?fn(n,t,e):fn(t,n,e);return(r?-1:1)*(i<0?1/-i:i)}var yr={value:()=>{}};function zn(){for(var t=0,n=arguments.length,e={},r;t<n;++t){if(!(r=arguments[t]+"")||r in e||/[\\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new Rt(e)}function Rt(t){this._=t}function wr(t,n){return t.trim().split(/^|\\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}Rt.prototype=zn.prototype={constructor:Rt,on:function(t,n){var e=this._,r=wr(t+"",e),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=vr(e[i],t.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<a;)if(i=(t=r[o]).type)e[i]=Xn(e[i],t.name,n);else if(n==null)for(i in e)e[i]=Xn(e[i],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new Rt(t)},call:function(t,n){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,o;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};function vr(t,n){for(var e=0,r=t.length,i;e<r;++e)if((i=t[e]).name===n)return i.value}function Xn(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=yr,t=t.slice(0,r).concat(t.slice(r+1));break}return e!=null&&t.push({name:n,value:e}),t}var hn="http://www.w3.org/1999/xhtml",qn={svg:"http://www.w3.org/2000/svg",xhtml:hn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function It(t){var n=t+="",e=n.indexOf(":");return e>=0&&(n=t.slice(0,e))!=="xmlns"&&(t=t.slice(e+1)),qn.hasOwnProperty(n)?{space:qn[n],local:t}:t}function xr(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===hn&&n.documentElement.namespaceURI===hn?n.createElement(t):n.createElementNS(e,t)}}function _r(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Vn(t){var n=It(t);return(n.local?_r:xr)(n)}function Mr(){}function gn(t){return t==null?Mr:function(){return this.querySelector(t)}}function Tr(t){typeof t!="function"&&(t=gn(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o=n[i],a=o.length,u=r[i]=new Array(a),c,s,f=0;f<a;++f)(c=o[f])&&(s=t.call(c,c.__data__,f,o))&&("__data__"in c&&(s.__data__=c.__data__),u[f]=s);return new X(r,this._parents)}function Nr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Cr(){return[]}function Bn(t){return t==null?Cr:function(){return this.querySelectorAll(t)}}function br(t){return function(){return Nr(t.apply(this,arguments))}}function Sr(t){typeof t=="function"?t=br(t):t=Bn(t);for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a=n[o],u=a.length,c,s=0;s<u;++s)(c=a[s])&&(r.push(t.call(c,c.__data__,s,a)),i.push(c));return new X(r,i)}function Zn(t){return function(){return this.matches(t)}}function Gn(t){return function(n){return n.matches(t)}}var Dr=Array.prototype.find;function kr(t){return function(){return Dr.call(this.children,t)}}function Ar(){return this.firstElementChild}function Ur(t){return this.select(t==null?Ar:kr(typeof t=="function"?t:Gn(t)))}var Fr=Array.prototype.filter;function $r(){return Array.from(this.children)}function Lr(t){return function(){return Fr.call(this.children,t)}}function Pr(t){return this.selectAll(t==null?$r:Lr(typeof t=="function"?t:Gn(t)))}function Er(t){typeof t!="function"&&(t=Zn(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o=n[i],a=o.length,u=r[i]=[],c,s=0;s<a;++s)(c=o[s])&&t.call(c,c.__data__,s,o)&&u.push(c);return new X(r,this._parents)}function Qn(t){return new Array(t.length)}function Hr(){return new X(this._enter||this._groups.map(Qn),this._parents)}function Ot(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}Ot.prototype={constructor:Ot,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Yr(t){return function(){return t}}function Rr(t,n,e,r,i,o){for(var a=0,u,c=n.length,s=o.length;a<s;++a)(u=n[a])?(u.__data__=o[a],r[a]=u):e[a]=new Ot(t,o[a]);for(;a<c;++a)(u=n[a])&&(i[a]=u)}function Ir(t,n,e,r,i,o,a){var u,c,s=new Map,f=n.length,l=o.length,h=new Array(f),p;for(u=0;u<f;++u)(c=n[u])&&(h[u]=p=a.call(c,c.__data__,u,n)+"",s.has(p)?i[u]=c:s.set(p,c));for(u=0;u<l;++u)p=a.call(t,o[u],u,o)+"",(c=s.get(p))?(r[u]=c,c.__data__=o[u],s.delete(p)):e[u]=new Ot(t,o[u]);for(u=0;u<f;++u)(c=n[u])&&s.get(h[u])===c&&(i[u]=c)}function Or(t){return t.__data__}function Wr(t,n){if(!arguments.length)return Array.from(this,Or);var e=n?Ir:Rr,r=this._parents,i=this._groups;typeof t!="function"&&(t=Yr(t));for(var o=i.length,a=new Array(o),u=new Array(o),c=new Array(o),s=0;s<o;++s){var f=r[s],l=i[s],h=l.length,p=zr(t.call(f,f&&f.__data__,s,r)),x=p.length,b=u[s]=new Array(x),U=a[s]=new Array(x),I=c[s]=new Array(h);e(f,l,b,U,I,p,n);for(var E=0,k=0,H,m;E<x;++E)if(H=b[E]){for(E>=k&&(k=E+1);!(m=U[k])&&++k<x;);H._next=m||null}}return a=new X(a,r),a._enter=u,a._exit=c,a}function zr(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Xr(){return new X(this._exit||this._groups.map(Qn),this._parents)}function qr(t,n,e){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),n!=null&&(i=n(i),i&&(i=i.selection())),e==null?o.remove():e(o),r&&i?r.merge(i).order():i}function Vr(t){for(var n=t.selection?t.selection():t,e=this._groups,r=n._groups,i=e.length,o=r.length,a=Math.min(i,o),u=new Array(i),c=0;c<a;++c)for(var s=e[c],f=r[c],l=s.length,h=u[c]=new Array(l),p,x=0;x<l;++x)(p=s[x]||f[x])&&(h[x]=p);for(;c<i;++c)u[c]=e[c];return new X(u,this._parents)}function Br(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r=t[n],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Zr(t){t||(t=Gr);function n(l,h){return l&&h?t(l.__data__,h.__data__):!l-!h}for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a=e[o],u=a.length,c=i[o]=new Array(u),s,f=0;f<u;++f)(s=a[f])&&(c[f]=s);c.sort(n)}return new X(i,this._parents).order()}function Gr(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function Qr(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Jr(){return Array.from(this)}function Kr(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function jr(){let t=0;for(const n of this)++t;return t}function ti(){return!this.node()}function ni(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i=n[e],o=0,a=i.length,u;o<a;++o)(u=i[o])&&t.call(u,u.__data__,o,i);return this}function ei(t){return function(){this.removeAttribute(t)}}function ri(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ii(t,n){return function(){this.setAttribute(t,n)}}function oi(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function ai(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttribute(t):this.setAttribute(t,e)}}function ui(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function si(t,n){var e=It(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((n==null?e.local?ri:ei:typeof n=="function"?e.local?ui:ai:e.local?oi:ii)(e,n))}function Jn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ci(t){return function(){this.style.removeProperty(t)}}function fi(t,n,e){return function(){this.style.setProperty(t,n,e)}}function li(t,n,e){return function(){var r=n.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function hi(t,n,e){return arguments.length>1?this.each((n==null?ci:typeof n=="function"?li:fi)(t,n,e??"")):lt(this.node(),t)}function lt(t,n){return t.style.getPropertyValue(n)||Jn(t).getComputedStyle(t,null).getPropertyValue(n)}function gi(t){return function(){delete this[t]}}function di(t,n){return function(){this[t]=n}}function mi(t,n){return function(){var e=n.apply(this,arguments);e==null?delete this[t]:this[t]=e}}function pi(t,n){return arguments.length>1?this.each((n==null?gi:typeof n=="function"?mi:di)(t,n)):this.node()[t]}function Kn(t){return t.trim().split(/^|\\s+/)}function dn(t){return t.classList||new jn(t)}function jn(t){this._node=t,this._names=Kn(t.getAttribute("class")||"")}jn.prototype={add:function(t){var n=this._names.indexOf(t);n<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function te(t,n){for(var e=dn(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function ne(t,n){for(var e=dn(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function yi(t){return function(){te(this,t)}}function wi(t){return function(){ne(this,t)}}function vi(t,n){return function(){(n.apply(this,arguments)?te:ne)(this,t)}}function xi(t,n){var e=Kn(t+"");if(arguments.length<2){for(var r=dn(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each((typeof n=="function"?vi:n?yi:wi)(e,n))}function _i(){this.textContent=""}function Mi(t){return function(){this.textContent=t}}function Ti(t){return function(){var n=t.apply(this,arguments);this.textContent=n??""}}function Ni(t){return arguments.length?this.each(t==null?_i:(typeof t=="function"?Ti:Mi)(t)):this.node().textContent}function Ci(){this.innerHTML=""}function bi(t){return function(){this.innerHTML=t}}function Si(t){return function(){var n=t.apply(this,arguments);this.innerHTML=n??""}}function Di(t){return arguments.length?this.each(t==null?Ci:(typeof t=="function"?Si:bi)(t)):this.node().innerHTML}function ki(){this.nextSibling&&this.parentNode.appendChild(this)}function Ai(){return this.each(ki)}function Ui(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Fi(){return this.each(Ui)}function $i(t){var n=typeof t=="function"?t:Vn(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function Li(){return null}function Pi(t,n){var e=typeof t=="function"?t:Vn(t),r=n==null?Li:typeof n=="function"?n:gn(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)})}function Ei(){var t=this.parentNode;t&&t.removeChild(this)}function Hi(){return this.each(Ei)}function Yi(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Ri(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Ii(t){return this.select(t?Ri:Yi)}function Oi(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Wi(t){return function(n){t.call(this,n,this.__data__)}}function zi(t){return t.trim().split(/^|\\s+/).map(function(n){var e="",r=n.indexOf(".");return r>=0&&(e=n.slice(r+1),n=n.slice(0,r)),{type:n,name:e}})}function Xi(t){return function(){var n=this.__on;if(n){for(var e=0,r=-1,i=n.length,o;e<i;++e)o=n[e],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):n[++r]=o;++r?n.length=r:delete this.__on}}}function qi(t,n,e){return function(){var r=this.__on,i,o=Wi(n);if(r){for(var a=0,u=r.length;a<u;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=e),i.value=n;return}}this.addEventListener(t.type,o,e),i={type:t.type,name:t.name,value:n,listener:o,options:e},r?r.push(i):this.__on=[i]}}function Vi(t,n,e){var r=zi(t+""),i,o=r.length,a;if(arguments.length<2){var u=this.node().__on;if(u){for(var c=0,s=u.length,f;c<s;++c)for(i=0,f=u[c];i<o;++i)if((a=r[i]).type===f.type&&a.name===f.name)return f.value}return}for(u=n?qi:Xi,i=0;i<o;++i)this.each(u(r[i],n,e));return this}function ee(t,n,e){var r=Jn(t),i=r.CustomEvent;typeof i=="function"?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function Bi(t,n){return function(){return ee(this,t,n)}}function Zi(t,n){return function(){return ee(this,t,n.apply(this,arguments))}}function Gi(t,n){return this.each((typeof n=="function"?Zi:Bi)(t,n))}function*Qi(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var Ji=[null];function X(t,n){this._groups=t,this._parents=n}function Nt(){return new X([[document.documentElement]],Ji)}function Ki(){return this}X.prototype=Nt.prototype={constructor:X,select:Tr,selectAll:Sr,selectChild:Ur,selectChildren:Pr,filter:Er,data:Wr,enter:Hr,exit:Xr,join:qr,merge:Vr,selection:Ki,order:Br,sort:Zr,call:Qr,nodes:Jr,node:Kr,size:jr,empty:ti,each:ni,attr:si,style:hi,property:pi,classed:xi,text:Ni,html:Di,raise:Ai,lower:Fi,append:$i,insert:Pi,remove:Hi,clone:Ii,datum:Oi,on:Vi,dispatch:Gi,[Symbol.iterator]:Qi};function mn(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function re(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Ct(){}var bt=.7,Wt=1/bt,ht="\\\\s*([+-]?\\\\d+)\\\\s*",St="\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*",G="\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*",ji=/^#([0-9a-f]{3,8})$/,to=new RegExp(`^rgb\\\\(${ht},${ht},${ht}\\\\)$`),no=new RegExp(`^rgb\\\\(${G},${G},${G}\\\\)$`),eo=new RegExp(`^rgba\\\\(${ht},${ht},${ht},${St}\\\\)$`),ro=new RegExp(`^rgba\\\\(${G},${G},${G},${St}\\\\)$`),io=new RegExp(`^hsl\\\\(${St},${G},${G}\\\\)$`),oo=new RegExp(`^hsla\\\\(${St},${G},${G},${St}\\\\)$`),ie={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};mn(Ct,rt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:oe,formatHex:oe,formatHex8:ao,formatHsl:uo,formatRgb:ae,toString:ae});function oe(){return this.rgb().formatHex()}function ao(){return this.rgb().formatHex8()}function uo(){return le(this).formatHsl()}function ae(){return this.rgb().formatRgb()}function rt(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=ji.exec(t))?(e=n[1].length,n=parseInt(n[1],16),e===6?ue(n):e===3?new Y(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):e===8?zt(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):e===4?zt(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=to.exec(t))?new Y(n[1],n[2],n[3],1):(n=no.exec(t))?new Y(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=eo.exec(t))?zt(n[1],n[2],n[3],n[4]):(n=ro.exec(t))?zt(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=io.exec(t))?fe(n[1],n[2]/100,n[3]/100,1):(n=oo.exec(t))?fe(n[1],n[2]/100,n[3]/100,n[4]):ie.hasOwnProperty(t)?ue(ie[t]):t==="transparent"?new Y(NaN,NaN,NaN,0):null}function ue(t){return new Y(t>>16&255,t>>8&255,t&255,1)}function zt(t,n,e,r){return r<=0&&(t=n=e=NaN),new Y(t,n,e,r)}function so(t){return t instanceof Ct||(t=rt(t)),t?(t=t.rgb(),new Y(t.r,t.g,t.b,t.opacity)):new Y}function pn(t,n,e,r){return arguments.length===1?so(t):new Y(t,n,e,r??1)}function Y(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}mn(Y,pn,re(Ct,{brighter(t){return t=t==null?Wt:Math.pow(Wt,t),new Y(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?bt:Math.pow(bt,t),new Y(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Y(it(this.r),it(this.g),it(this.b),Xt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:se,formatHex:se,formatHex8:co,formatRgb:ce,toString:ce}));function se(){return`#${ot(this.r)}${ot(this.g)}${ot(this.b)}`}function co(){return`#${ot(this.r)}${ot(this.g)}${ot(this.b)}${ot((isNaN(this.opacity)?1:this.opacity)*255)}`}function ce(){const t=Xt(this.opacity);return`${t===1?"rgb(":"rgba("}${it(this.r)}, ${it(this.g)}, ${it(this.b)}${t===1?")":`, ${t})`}`}function Xt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function it(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ot(t){return t=it(t),(t<16?"0":"")+t.toString(16)}function fe(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new q(t,n,e,r)}function le(t){if(t instanceof q)return new q(t.h,t.s,t.l,t.opacity);if(t instanceof Ct||(t=rt(t)),!t)return new q;if(t instanceof q)return t;t=t.rgb();var n=t.r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=NaN,u=o-i,c=(o+i)/2;return u?(n===o?a=(e-r)/u+(e<r)*6:e===o?a=(r-n)/u+2:a=(n-e)/u+4,u/=c<.5?o+i:2-o-i,a*=60):u=c>0&&c<1?0:a,new q(a,u,c,t.opacity)}function fo(t,n,e,r){return arguments.length===1?le(t):new q(t,n,e,r??1)}function q(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}mn(q,fo,re(Ct,{brighter(t){return t=t==null?Wt:Math.pow(Wt,t),new q(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?bt:Math.pow(bt,t),new q(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new Y(yn(t>=240?t-240:t+120,i,r),yn(t,i,r),yn(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new q(he(this.h),qt(this.s),qt(this.l),Xt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Xt(this.opacity);return`${t===1?"hsl(":"hsla("}${he(this.h)}, ${qt(this.s)*100}%, ${qt(this.l)*100}%${t===1?")":`, ${t})`}`}}));function he(t){return t=(t||0)%360,t<0?t+360:t}function qt(t){return Math.max(0,Math.min(1,t||0))}function yn(t,n,e){return(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)*255}var wn=t=>()=>t;function lo(t,n){return function(e){return t+e*n}}function ho(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}function go(t){return(t=+t)==1?ge:function(n,e){return e-n?ho(n,e,t):wn(isNaN(n)?e:n)}}function ge(t,n){var e=n-t;return e?lo(t,e):wn(isNaN(t)?n:t)}var Vt=(function t(n){var e=go(n);function r(i,o){var a=e((i=pn(i)).r,(o=pn(o)).r),u=e(i.g,o.g),c=e(i.b,o.b),s=ge(i.opacity,o.opacity);return function(f){return i.r=a(f),i.g=u(f),i.b=c(f),i.opacity=s(f),i+""}}return r.gamma=t,r})(1);function mo(t,n){n||(n=[]);var e=t?Math.min(n.length,t.length):0,r=n.slice(),i;return function(o){for(i=0;i<e;++i)r[i]=t[i]*(1-o)+n[i]*o;return r}}function po(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function yo(t,n){var e=n?n.length:0,r=t?Math.min(e,t.length):0,i=new Array(r),o=new Array(e),a;for(a=0;a<r;++a)i[a]=_n(t[a],n[a]);for(;a<e;++a)o[a]=n[a];return function(u){for(a=0;a<r;++a)o[a]=i[a](u);return o}}function wo(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function V(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function vo(t,n){var e={},r={},i;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(i in n)i in t?e[i]=_n(t[i],n[i]):r[i]=n[i];return function(o){for(i in e)r[i]=e[i](o);return r}}var vn=/[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,xn=new RegExp(vn.source,"g");function xo(t){return function(){return t}}function _o(t){return function(n){return t(n)+""}}function de(t,n){var e=vn.lastIndex=xn.lastIndex=0,r,i,o,a=-1,u=[],c=[];for(t=t+"",n=n+"";(r=vn.exec(t))&&(i=xn.exec(n));)(o=i.index)>e&&(o=n.slice(e,o),u[a]?u[a]+=o:u[++a]=o),(r=r[0])===(i=i[0])?u[a]?u[a]+=i:u[++a]=i:(u[++a]=null,c.push({i:a,x:V(r,i)})),e=xn.lastIndex;return e<n.length&&(o=n.slice(e),u[a]?u[a]+=o:u[++a]=o),u.length<2?c[0]?_o(c[0].x):xo(n):(n=c.length,function(s){for(var f=0,l;f<n;++f)u[(l=c[f]).i]=l.x(s);return u.join("")})}function _n(t,n){var e=typeof n,r;return n==null||e==="boolean"?wn(n):(e==="number"?V:e==="string"?(r=rt(n))?(n=r,Vt):de:n instanceof rt?Vt:n instanceof Date?wo:po(n)?mo:Array.isArray(n)?yo:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?vo:V)(t,n)}function Mo(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}var me=180/Math.PI,Mn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function pe(t,n,e,r,i,o){var a,u,c;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(c=t*e+n*r)&&(e-=t*c,r-=n*c),(u=Math.sqrt(e*e+r*r))&&(e/=u,r/=u,c/=u),t*r<n*e&&(t=-t,n=-n,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*me,skewX:Math.atan(c)*me,scaleX:a,scaleY:u}}var Bt;function To(t){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?Mn:pe(n.a,n.b,n.c,n.d,n.e,n.f)}function No(t){return t==null||(Bt||(Bt=document.createElementNS("http://www.w3.org/2000/svg","g")),Bt.setAttribute("transform",t),!(t=Bt.transform.baseVal.consolidate()))?Mn:(t=t.matrix,pe(t.a,t.b,t.c,t.d,t.e,t.f))}function ye(t,n,e,r){function i(s){return s.length?s.pop()+" ":""}function o(s,f,l,h,p,x){if(s!==l||f!==h){var b=p.push("translate(",null,n,null,e);x.push({i:b-4,x:V(s,l)},{i:b-2,x:V(f,h)})}else(l||h)&&p.push("translate("+l+n+h+e)}function a(s,f,l,h){s!==f?(s-f>180?f+=360:f-s>180&&(s+=360),h.push({i:l.push(i(l)+"rotate(",null,r)-2,x:V(s,f)})):f&&l.push(i(l)+"rotate("+f+r)}function u(s,f,l,h){s!==f?h.push({i:l.push(i(l)+"skewX(",null,r)-2,x:V(s,f)}):f&&l.push(i(l)+"skewX("+f+r)}function c(s,f,l,h,p,x){if(s!==l||f!==h){var b=p.push(i(p)+"scale(",null,",",null,")");x.push({i:b-4,x:V(s,l)},{i:b-2,x:V(f,h)})}else(l!==1||h!==1)&&p.push(i(p)+"scale("+l+","+h+")")}return function(s,f){var l=[],h=[];return s=t(s),f=t(f),o(s.translateX,s.translateY,f.translateX,f.translateY,l,h),a(s.rotate,f.rotate,l,h),u(s.skewX,f.skewX,l,h),c(s.scaleX,s.scaleY,f.scaleX,f.scaleY,l,h),s=f=null,function(p){for(var x=-1,b=h.length,U;++x<b;)l[(U=h[x]).i]=U.x(p);return l.join("")}}}var Co=ye(To,"px, ","px)","deg)"),bo=ye(No,", ",")",")"),gt=0,Dt=0,kt=0,we=1e3,Zt,At,Gt=0,at=0,Qt=0,Ut=typeof performance=="object"&&performance.now?performance:Date,ve=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Tn(){return at||(ve(So),at=Ut.now()+Qt)}function So(){at=0}function Jt(){this._call=this._time=this._next=null}Jt.prototype=xe.prototype={constructor:Jt,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?Tn():+e)+(n==null?0:+n),!this._next&&At!==this&&(At?At._next=this:Zt=this,At=this),this._call=t,this._time=e,Nn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nn())}};function xe(t,n,e){var r=new Jt;return r.restart(t,n,e),r}function Do(){Tn(),++gt;for(var t=Zt,n;t;)(n=at-t._time)>=0&&t._call.call(void 0,n),t=t._next;--gt}function _e(){at=(Gt=Ut.now())+Qt,gt=Dt=0;try{Do()}finally{gt=0,Ao(),at=0}}function ko(){var t=Ut.now(),n=t-Gt;n>we&&(Qt-=n,Gt=t)}function Ao(){for(var t,n=Zt,e,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Zt=e);At=t,Nn(r)}function Nn(t){if(!gt){Dt&&(Dt=clearTimeout(Dt));var n=t-at;n>24?(t<1/0&&(Dt=setTimeout(_e,t-Ut.now()-Qt)),kt&&(kt=clearInterval(kt))):(kt||(Gt=Ut.now(),kt=setInterval(ko,we)),gt=1,ve(_e))}}function Me(t,n,e){var r=new Jt;return n=n==null?0:+n,r.restart(i=>{r.stop(),t(i+n)},n,e),r}var Uo=zn("start","end","cancel","interrupt"),Fo=[],Te=0,Ne=1,Cn=2,Kt=3,Ce=4,bn=5,jt=6;function tn(t,n,e,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(e in a)return;$o(t,e,{name:n,index:r,group:i,on:Uo,tween:Fo,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Te})}function Sn(t,n){var e=B(t,n);if(e.state>Te)throw new Error("too late; already scheduled");return e}function Q(t,n){var e=B(t,n);if(e.state>Kt)throw new Error("too late; already running");return e}function B(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function $o(t,n,e){var r=t.__transition,i;r[n]=e,e.timer=xe(o,0,e.time);function o(s){e.state=Ne,e.timer.restart(a,e.delay,e.time),e.delay<=s&&a(s-e.delay)}function a(s){var f,l,h,p;if(e.state!==Ne)return c();for(f in r)if(p=r[f],p.name===e.name){if(p.state===Kt)return Me(a);p.state===Ce?(p.state=jt,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete r[f]):+f<n&&(p.state=jt,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete r[f])}if(Me(function(){e.state===Kt&&(e.state=Ce,e.timer.restart(u,e.delay,e.time),u(s))}),e.state=Cn,e.on.call("start",t,t.__data__,e.index,e.group),e.state===Cn){for(e.state=Kt,i=new Array(h=e.tween.length),f=0,l=-1;f<h;++f)(p=e.tween[f].value.call(t,t.__data__,e.index,e.group))&&(i[++l]=p);i.length=l+1}}function u(s){for(var f=s<e.duration?e.ease.call(null,s/e.duration):(e.timer.restart(c),e.state=bn,1),l=-1,h=i.length;++l<h;)i[l].call(t,f);e.state===bn&&(e.on.call("end",t,t.__data__,e.index,e.group),c())}function c(){e.state=jt,e.timer.stop(),delete r[n];for(var s in r)return;delete t.__transition}}function Lo(t,n){var e=t.__transition,r,i,o=!0,a;if(e){n=n==null?null:n+"";for(a in e){if((r=e[a]).name!==n){o=!1;continue}i=r.state>Cn&&r.state<bn,r.state=jt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete e[a]}o&&delete t.__transition}}function Po(t){return this.each(function(){Lo(this,t)})}function Eo(t,n){var e,r;return function(){var i=Q(this,t),o=i.tween;if(o!==e){r=e=o;for(var a=0,u=r.length;a<u;++a)if(r[a].name===n){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function Ho(t,n,e){var r,i;if(typeof e!="function")throw new Error;return function(){var o=Q(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var u={name:n,value:e},c=0,s=i.length;c<s;++c)if(i[c].name===n){i[c]=u;break}c===s&&i.push(u)}o.tween=i}}function Yo(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r=B(this.node(),e).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((n==null?Eo:Ho)(e,t,n))}function Dn(t,n,e){var r=t._id;return t.each(function(){var i=Q(this,r);(i.value||(i.value={}))[n]=e.apply(this,arguments)}),function(i){return B(i,r).value[n]}}function be(t,n){var e;return(typeof n=="number"?V:n instanceof rt?Vt:(e=rt(n))?(n=e,Vt):de)(t,n)}function Ro(t){return function(){this.removeAttribute(t)}}function Io(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Oo(t,n,e){var r,i=e+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=n(r=a,e)}}function Wo(t,n,e){var r,i=e+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=n(r=a,e)}}function zo(t,n,e){var r,i,o;return function(){var a,u=e(this),c;return u==null?void this.removeAttribute(t):(a=this.getAttribute(t),c=u+"",a===c?null:a===r&&c===i?o:(i=c,o=n(r=a,u)))}}function Xo(t,n,e){var r,i,o;return function(){var a,u=e(this),c;return u==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),c=u+"",a===c?null:a===r&&c===i?o:(i=c,o=n(r=a,u)))}}function qo(t,n){var e=It(t),r=e==="transform"?bo:be;return this.attrTween(t,typeof n=="function"?(e.local?Xo:zo)(e,r,Dn(this,"attr."+t,n)):n==null?(e.local?Io:Ro)(e):(e.local?Wo:Oo)(e,r,n))}function Vo(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function Bo(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function Zo(t,n){var e,r;function i(){var o=n.apply(this,arguments);return o!==r&&(e=(r=o)&&Bo(t,o)),e}return i._value=n,i}function Go(t,n){var e,r;function i(){var o=n.apply(this,arguments);return o!==r&&(e=(r=o)&&Vo(t,o)),e}return i._value=n,i}function Qo(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;var r=It(t);return this.tween(e,(r.local?Zo:Go)(r,n))}function Jo(t,n){return function(){Sn(this,t).delay=+n.apply(this,arguments)}}function Ko(t,n){return n=+n,function(){Sn(this,t).delay=n}}function jo(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?Jo:Ko)(n,t)):B(this.node(),n).delay}function ta(t,n){return function(){Q(this,t).duration=+n.apply(this,arguments)}}function na(t,n){return n=+n,function(){Q(this,t).duration=n}}function ea(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?ta:na)(n,t)):B(this.node(),n).duration}function ra(t,n){if(typeof n!="function")throw new Error;return function(){Q(this,t).ease=n}}function ia(t){var n=this._id;return arguments.length?this.each(ra(n,t)):B(this.node(),n).ease}function oa(t,n){return function(){var e=n.apply(this,arguments);if(typeof e!="function")throw new Error;Q(this,t).ease=e}}function aa(t){if(typeof t!="function")throw new Error;return this.each(oa(this._id,t))}function ua(t){typeof t!="function"&&(t=Zn(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o=n[i],a=o.length,u=r[i]=[],c,s=0;s<a;++s)(c=o[s])&&t.call(c,c.__data__,s,o)&&u.push(c);return new J(r,this._parents,this._name,this._id)}function sa(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var c=n[u],s=e[u],f=c.length,l=a[u]=new Array(f),h,p=0;p<f;++p)(h=c[p]||s[p])&&(l[p]=h);for(;u<r;++u)a[u]=n[u];return new J(a,this._parents,this._name,this._id)}function ca(t){return(t+"").trim().split(/^|\\s+/).every(function(n){var e=n.indexOf(".");return e>=0&&(n=n.slice(0,e)),!n||n==="start"})}function fa(t,n,e){var r,i,o=ca(n)?Sn:Q;return function(){var a=o(this,t),u=a.on;u!==r&&(i=(r=u).copy()).on(n,e),a.on=i}}function la(t,n){var e=this._id;return arguments.length<2?B(this.node(),e).on.on(t):this.each(fa(e,t,n))}function ha(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}function ga(){return this.on("end.remove",ha(this._id))}function da(t){var n=this._name,e=this._id;typeof t!="function"&&(t=gn(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var u=r[a],c=u.length,s=o[a]=new Array(c),f,l,h=0;h<c;++h)(f=u[h])&&(l=t.call(f,f.__data__,h,u))&&("__data__"in f&&(l.__data__=f.__data__),s[h]=l,tn(s[h],n,e,h,s,B(f,e)));return new J(o,this._parents,n,e)}function ma(t){var n=this._name,e=this._id;typeof t!="function"&&(t=Bn(t));for(var r=this._groups,i=r.length,o=[],a=[],u=0;u<i;++u)for(var c=r[u],s=c.length,f,l=0;l<s;++l)if(f=c[l]){for(var h=t.call(f,f.__data__,l,c),p,x=B(f,e),b=0,U=h.length;b<U;++b)(p=h[b])&&tn(p,n,e,b,h,x);o.push(h),a.push(f)}return new J(o,a,n,e)}var pa=Nt.prototype.constructor;function ya(){return new pa(this._groups,this._parents)}function wa(t,n){var e,r,i;return function(){var o=lt(this,t),a=(this.style.removeProperty(t),lt(this,t));return o===a?null:o===e&&a===r?i:i=n(e=o,r=a)}}function Se(t){return function(){this.style.removeProperty(t)}}function va(t,n,e){var r,i=e+"",o;return function(){var a=lt(this,t);return a===i?null:a===r?o:o=n(r=a,e)}}function xa(t,n,e){var r,i,o;return function(){var a=lt(this,t),u=e(this),c=u+"";return u==null&&(c=u=(this.style.removeProperty(t),lt(this,t))),a===c?null:a===r&&c===i?o:(i=c,o=n(r=a,u))}}function _a(t,n){var e,r,i,o="style."+n,a="end."+o,u;return function(){var c=Q(this,t),s=c.on,f=c.value[o]==null?u||(u=Se(n)):void 0;(s!==e||i!==f)&&(r=(e=s).copy()).on(a,i=f),c.on=r}}function Ma(t,n,e){var r=(t+="")=="transform"?Co:be;return n==null?this.styleTween(t,wa(t,r)).on("end.style."+t,Se(t)):typeof n=="function"?this.styleTween(t,xa(t,r,Dn(this,"style."+t,n))).each(_a(this._id,t)):this.styleTween(t,va(t,r,n),e).on("end.style."+t,null)}function Ta(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}function Na(t,n,e){var r,i;function o(){var a=n.apply(this,arguments);return a!==i&&(r=(i=a)&&Ta(t,a,e)),r}return o._value=n,o}function Ca(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;return this.tween(r,Na(t,n,e??""))}function ba(t){return function(){this.textContent=t}}function Sa(t){return function(){var n=t(this);this.textContent=n??""}}function Da(t){return this.tween("text",typeof t=="function"?Sa(Dn(this,"text",t)):ba(t==null?"":t+""))}function ka(t){return function(n){this.textContent=t.call(this,n)}}function Aa(t){var n,e;function r(){var i=t.apply(this,arguments);return i!==e&&(n=(e=i)&&ka(i)),n}return r._value=t,r}function Ua(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,Aa(t))}function Fa(){for(var t=this._name,n=this._id,e=De(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],u=a.length,c,s=0;s<u;++s)if(c=a[s]){var f=B(c,n);tn(c,t,e,s,a,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new J(r,this._parents,t,e)}function $a(){var t,n,e=this,r=e._id,i=e.size();return new Promise(function(o,a){var u={value:a},c={value:function(){--i===0&&o()}};e.each(function(){var s=Q(this,r),f=s.on;f!==t&&(n=(t=f).copy(),n._.cancel.push(u),n._.interrupt.push(u),n._.end.push(c)),s.on=n}),i===0&&o()})}var La=0;function J(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function De(){return++La}var K=Nt.prototype;J.prototype={constructor:J,select:da,selectAll:ma,selectChild:K.selectChild,selectChildren:K.selectChildren,filter:ua,merge:sa,selection:ya,transition:Fa,call:K.call,nodes:K.nodes,node:K.node,size:K.size,empty:K.empty,each:K.each,on:la,attr:qo,attrTween:Qo,style:Ma,styleTween:Ca,text:Da,textTween:Ua,remove:ga,tween:Yo,delay:jo,duration:ea,ease:ia,easeVarying:aa,end:$a,[Symbol.iterator]:K[Symbol.iterator]};function Pa(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Ea={time:null,delay:0,duration:250,ease:Pa};function Ha(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}function Ya(t){var n,e;t instanceof J?(n=t._id,t=t._name):(n=De(),(e=Ea).time=Tn(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],u=a.length,c,s=0;s<u;++s)(c=a[s])&&tn(c,t,n,s,a,e||Ha(c,n));return new J(r,this._parents,t,n)}Nt.prototype.interrupt=Po,Nt.prototype.transition=Ya;function Ra(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function nn(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function dt(t){return t=nn(Math.abs(t)),t?t[1]:NaN}function Ia(t,n){return function(e,r){for(var i=e.length,o=[],a=0,u=t[0],c=0;i>0&&u>0&&(c+u+1>r&&(u=Math.max(1,r-c)),o.push(e.substring(i-=u,i+u)),!((c+=u+1)>r));)u=t[a=(a+1)%t.length];return o.reverse().join(n)}}function Oa(t){return function(n){return n.replace(/[0-9]/g,function(e){return t[+e]})}}var Wa=/^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;function en(t){if(!(n=Wa.exec(t)))throw new Error("invalid format: "+t);var n;return new kn({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}en.prototype=kn.prototype;function kn(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}kn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function za(t){t:for(var n=t.length,e=1,r=-1,i;e<n;++e)switch(t[e]){case".":r=i=e;break;case"0":r===0&&(r=e),i=e;break;default:if(!+t[e])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var ke;function Xa(t,n){var e=nn(t,n);if(!e)return t+"";var r=e[0],i=e[1],o=i-(ke=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+nn(t,Math.max(0,n+o-1))[0]}function Ae(t,n){var e=nn(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Ue={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Ra,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>Ae(t*100,n),r:Ae,s:Xa,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Fe(t){return t}var $e=Array.prototype.map,Le=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function qa(t){var n=t.grouping===void 0||t.thousands===void 0?Fe:Ia($e.call(t.grouping,Number),t.thousands+""),e=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Fe:Oa($e.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function s(l){l=en(l);var h=l.fill,p=l.align,x=l.sign,b=l.symbol,U=l.zero,I=l.width,E=l.comma,k=l.precision,H=l.trim,m=l.type;m==="n"?(E=!0,m="g"):Ue[m]||(k===void 0&&(k=12),H=!0,m="g"),(U||h==="0"&&p==="=")&&(U=!0,h="0",p="=");var g=b==="$"?e:b==="#"&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",v=b==="$"?r:/[%p]/.test(m)?a:"",_=Ue[m],A=/[defgprs%]/.test(m);k=k===void 0?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function N(w){var S=g,F=v,$,xt,_t;if(m==="c")F=_(w)+F,w="";else{w=+w;var Mt=w<0||1/w<0;if(w=isNaN(w)?c:_(Math.abs(w),k),H&&(w=za(w)),Mt&&+w==0&&x!=="+"&&(Mt=!1),S=(Mt?x==="("?x:u:x==="-"||x==="("?"":x)+S,F=(m==="s"?Le[8+ke/3]:"")+F+(Mt&&x==="("?")":""),A){for($=-1,xt=w.length;++$<xt;)if(_t=w.charCodeAt($),48>_t||_t>57){F=(_t===46?i+w.slice($+1):w.slice($))+F,w=w.slice(0,$);break}}}E&&!U&&(w=n(w,1/0));var Tt=S.length+w.length+F.length,Z=Tt<I?new Array(I-Tt+1).join(h):"";switch(E&&U&&(w=n(Z+w,Z.length?I-F.length:1/0),Z=""),p){case"<":w=S+w+F+Z;break;case"=":w=S+Z+w+F;break;case"^":w=Z.slice(0,Tt=Z.length>>1)+S+w+F+Z.slice(Tt);break;default:w=Z+S+w+F;break}return o(w)}return N.toString=function(){return l+""},N}function f(l,h){var p=s((l=en(l),l.type="f",l)),x=Math.max(-8,Math.min(8,Math.floor(dt(h)/3)))*3,b=Math.pow(10,-x),U=Le[8+x/3];return function(I){return p(b*I)+U}}return{format:s,formatPrefix:f}}var rn,Pe,Ee;Va({thousands:",",grouping:[3],currency:["$",""]});function Va(t){return rn=qa(t),Pe=rn.format,Ee=rn.formatPrefix,rn}function Ba(t){return Math.max(0,-dt(Math.abs(t)))}function Za(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(dt(n)/3)))*3-dt(Math.abs(t)))}function Ga(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,dt(n)-dt(t))+1}function He(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}function Qa(t){return function(){return t}}function Ja(t){return+t}var Ye=[0,1];function mt(t){return t}function An(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:Qa(isNaN(n)?NaN:.5)}function Ka(t,n){var e;return t>n&&(e=t,t=n,n=e),function(r){return Math.max(t,Math.min(n,r))}}function ja(t,n,e){var r=t[0],i=t[1],o=n[0],a=n[1];return i<r?(r=An(i,r),o=e(a,o)):(r=An(r,i),o=e(o,a)),function(u){return o(r(u))}}function tu(t,n,e){var r=Math.min(t.length,n.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++a<r;)i[a]=An(t[a],t[a+1]),o[a]=e(n[a],n[a+1]);return function(u){var c=hr(t,u,1,r)-1;return o[c](i[c](u))}}function Re(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function nu(){var t=Ye,n=Ye,e=_n,r,i,o,a=mt,u,c,s;function f(){var h=Math.min(t.length,n.length);return a!==mt&&(a=Ka(t[0],t[h-1])),u=h>2?tu:ja,c=s=null,l}function l(h){return h==null||isNaN(h=+h)?o:(c||(c=u(t.map(r),n,e)))(r(a(h)))}return l.invert=function(h){return a(i((s||(s=u(n,t.map(r),V)))(h)))},l.domain=function(h){return arguments.length?(t=Array.from(h,Ja),f()):t.slice()},l.range=function(h){return arguments.length?(n=Array.from(h),f()):n.slice()},l.rangeRound=function(h){return n=Array.from(h),e=Mo,f()},l.clamp=function(h){return arguments.length?(a=h?!0:mt,f()):a!==mt},l.interpolate=function(h){return arguments.length?(e=h,f()):e},l.unknown=function(h){return arguments.length?(o=h,l):o},function(h,p){return r=h,i=p,f()}}function Ie(){return nu()(mt,mt)}function eu(t,n,e,r){var i=ln(t,n,e),o;switch(r=en(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(n));return r.precision==null&&!isNaN(o=Za(i,a))&&(r.precision=o),Ee(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Ga(i,Math.max(Math.abs(t),Math.abs(n))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Ba(i))&&(r.precision=o-(r.type==="%")*2);break}}return Pe(r)}function ru(t){var n=t.domain;return t.ticks=function(e){var r=n();return pr(r[0],r[r.length-1],e??10)},t.tickFormat=function(e,r){var i=n();return eu(i[0],i[i.length-1],e??10,r)},t.nice=function(e){e==null&&(e=10);var r=n(),i=0,o=r.length-1,a=r[i],u=r[o],c,s,f=10;for(u<a&&(s=a,a=u,u=s,s=i,i=o,o=s);f-- >0;){if(s=fn(a,u,e),s===c)return r[i]=a,r[o]=u,n(r);if(s>0)a=Math.floor(a/s)*s,u=Math.ceil(u/s)*s;else if(s<0)a=Math.ceil(a*s)/s,u=Math.floor(u*s)/s;else break;c=s}return t},t}function Oe(){var t=Ie();return t.copy=function(){return Re(t,Oe())},He.apply(t,arguments),ru(t)}function iu(t,n){t=t.slice();var e=0,r=t.length-1,i=t[e],o=t[r],a;return o<i&&(a=e,e=r,r=a,a=i,i=o,o=a),t[e]=n.floor(i),t[r]=n.ceil(o),t}const Un=new Date,Fn=new Date;function L(t,n,e,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),n(o,1),t(o),o),i.round=o=>{const a=i(o),u=i.ceil(o);return o-a<u-o?a:u},i.offset=(o,a)=>(n(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,u)=>{const c=[];if(o=i.ceil(o),u=u==null?1:Math.floor(u),!(o<a)||!(u>0))return c;let s;do c.push(s=new Date(+o)),n(o,u),t(o);while(s<o&&o<a);return c},i.filter=o=>L(a=>{if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},(a,u)=>{if(a>=a)if(u<0)for(;++u<=0;)for(;n(a,-1),!o(a););else for(;--u>=0;)for(;n(a,1),!o(a););}),e&&(i.count=(o,a)=>(Un.setTime(+o),Fn.setTime(+a),t(Un),t(Fn),Math.floor(e(Un,Fn))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?a=>r(a)%o===0:a=>i.count(0,a)%o===0):i)),i}const on=L(()=>{},(t,n)=>{t.setTime(+t+n)},(t,n)=>n-t);on.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?L(n=>{n.setTime(Math.floor(n/t)*t)},(n,e)=>{n.setTime(+n+e*t)},(n,e)=>(e-n)/t):on),on.range;const j=1e3,z=j*60,tt=z*60,nt=tt*24,$n=nt*7,We=nt*30,Ln=nt*365,pt=L(t=>{t.setTime(t-t.getMilliseconds())},(t,n)=>{t.setTime(+t+n*j)},(t,n)=>(n-t)/j,t=>t.getUTCSeconds());pt.range;const Pn=L(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*j)},(t,n)=>{t.setTime(+t+n*z)},(t,n)=>(n-t)/z,t=>t.getMinutes());Pn.range,L(t=>{t.setUTCSeconds(0,0)},(t,n)=>{t.setTime(+t+n*z)},(t,n)=>(n-t)/z,t=>t.getUTCMinutes()).range;const En=L(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*j-t.getMinutes()*z)},(t,n)=>{t.setTime(+t+n*tt)},(t,n)=>(n-t)/tt,t=>t.getHours());En.range,L(t=>{t.setUTCMinutes(0,0,0)},(t,n)=>{t.setTime(+t+n*tt)},(t,n)=>(n-t)/tt,t=>t.getUTCHours()).range;const Ft=L(t=>t.setHours(0,0,0,0),(t,n)=>t.setDate(t.getDate()+n),(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*z)/nt,t=>t.getDate()-1);Ft.range;const Hn=L(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/nt,t=>t.getUTCDate()-1);Hn.range,L(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/nt,t=>Math.floor(t/nt)).range;function ut(t){return L(n=>{n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},(n,e)=>{n.setDate(n.getDate()+e*7)},(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*z)/$n)}const an=ut(0),un=ut(1),ou=ut(2),au=ut(3),yt=ut(4),uu=ut(5),su=ut(6);an.range,un.range,ou.range,au.range,yt.range,uu.range,su.range;function st(t){return L(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCDate(n.getUTCDate()+e*7)},(n,e)=>(e-n)/$n)}const ze=st(0),sn=st(1),cu=st(2),fu=st(3),wt=st(4),lu=st(5),hu=st(6);ze.range,sn.range,cu.range,fu.range,wt.range,lu.range,hu.range;const Yn=L(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,n)=>{t.setMonth(t.getMonth()+n)},(t,n)=>n.getMonth()-t.getMonth()+(n.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Yn.range,L(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCMonth(t.getUTCMonth()+n)},(t,n)=>n.getUTCMonth()-t.getUTCMonth()+(n.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth()).range;const et=L(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n)},(t,n)=>n.getFullYear()-t.getFullYear(),t=>t.getFullYear());et.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:L(n=>{n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,e)=>{n.setFullYear(n.getFullYear()+e*t)}),et.range;const ct=L(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n)},(t,n)=>n.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ct.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:L(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCFullYear(n.getUTCFullYear()+e*t)}),ct.range;function gu(t,n,e,r,i,o){const a=[[pt,1,j],[pt,5,5*j],[pt,15,15*j],[pt,30,30*j],[o,1,z],[o,5,5*z],[o,15,15*z],[o,30,30*z],[i,1,tt],[i,3,3*tt],[i,6,6*tt],[i,12,12*tt],[r,1,nt],[r,2,2*nt],[e,1,$n],[n,1,We],[n,3,3*We],[t,1,Ln]];function u(s,f,l){const h=f<s;h&&([s,f]=[f,s]);const p=l&&typeof l.range=="function"?l:c(s,f,l),x=p?p.range(s,+f+1):[];return h?x.reverse():x}function c(s,f,l){const h=Math.abs(f-s)/l,p=cn(([,,U])=>U).right(a,h);if(p===a.length)return t.every(ln(s/Ln,f/Ln,l));if(p===0)return on.every(Math.max(ln(s,f,l),1));const[x,b]=a[h/a[p-1][2]<a[p][2]/h?p-1:p];return x.every(b)}return[u,c]}const[du,mu]=gu(et,Yn,an,Ft,En,Pn);function Rn(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function In(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function $t(t,n,e){return{y:t,m:n,d:e,H:0,M:0,S:0,L:0}}function pu(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,u=t.months,c=t.shortMonths,s=Lt(i),f=Pt(i),l=Lt(o),h=Pt(o),p=Lt(a),x=Pt(a),b=Lt(u),U=Pt(u),I=Lt(c),E=Pt(c),k={a:Mt,A:Tt,b:Z,B:Ps,c:null,d:Ge,e:Ge,f:Ru,g:Gu,G:Ju,H:Eu,I:Hu,j:Yu,L:Qe,m:Iu,M:Ou,p:Es,q:Hs,Q:er,s:rr,S:Wu,u:zu,U:Xu,V:qu,w:Vu,W:Bu,x:null,X:null,y:Zu,Y:Qu,Z:Ku,"%":nr},H={a:Ys,A:Rs,b:Is,B:Os,c:null,d:Ke,e:Ke,f:es,g:hs,G:ds,H:ju,I:ts,j:ns,L:je,m:rs,M:is,p:Ws,q:zs,Q:er,s:rr,S:os,u:as,U:us,V:ss,w:cs,W:fs,x:null,X:null,y:ls,Y:gs,Z:ms,"%":nr},m={a:N,A:w,b:S,B:F,c:$,d:Be,e:Be,f:Fu,g:Ve,G:qe,H:Ze,I:Ze,j:Du,L:Uu,m:Su,M:ku,p:A,q:bu,Q:Lu,s:Pu,S:Au,u:_u,U:Mu,V:Tu,w:xu,W:Nu,x:xt,X:_t,y:Ve,Y:qe,Z:Cu,"%":$u};k.x=g(e,k),k.X=g(r,k),k.c=g(n,k),H.x=g(e,H),H.X=g(r,H),H.c=g(n,H);function g(y,M){return function(C){var d=[],R=-1,D=0,O=y.length,W,ft,ur;for(C instanceof Date||(C=new Date(+C));++R<O;)y.charCodeAt(R)===37&&(d.push(y.slice(D,R)),(ft=Xe[W=y.charAt(++R)])!=null?W=y.charAt(++R):ft=W==="e"?" ":"0",(ur=M[W])&&(W=ur(C,ft)),d.push(W),D=R+1);return d.push(y.slice(D,R)),d.join("")}}function v(y,M){return function(C){var d=$t(1900,void 0,1),R=_(d,y,C+="",0),D,O;if(R!=C.length)return null;if("Q"in d)return new Date(d.Q);if("s"in d)return new Date(d.s*1e3+("L"in d?d.L:0));if(M&&!("Z"in d)&&(d.Z=0),"p"in d&&(d.H=d.H%12+d.p*12),d.m===void 0&&(d.m="q"in d?d.q:0),"V"in d){if(d.V<1||d.V>53)return null;"w"in d||(d.w=1),"Z"in d?(D=In($t(d.y,0,1)),O=D.getUTCDay(),D=O>4||O===0?sn.ceil(D):sn(D),D=Hn.offset(D,(d.V-1)*7),d.y=D.getUTCFullYear(),d.m=D.getUTCMonth(),d.d=D.getUTCDate()+(d.w+6)%7):(D=Rn($t(d.y,0,1)),O=D.getDay(),D=O>4||O===0?un.ceil(D):un(D),D=Ft.offset(D,(d.V-1)*7),d.y=D.getFullYear(),d.m=D.getMonth(),d.d=D.getDate()+(d.w+6)%7)}else("W"in d||"U"in d)&&("w"in d||(d.w="u"in d?d.u%7:"W"in d?1:0),O="Z"in d?In($t(d.y,0,1)).getUTCDay():Rn($t(d.y,0,1)).getDay(),d.m=0,d.d="W"in d?(d.w+6)%7+d.W*7-(O+5)%7:d.w+d.U*7-(O+6)%7);return"Z"in d?(d.H+=d.Z/100|0,d.M+=d.Z%100,In(d)):Rn(d)}}function _(y,M,C,d){for(var R=0,D=M.length,O=C.length,W,ft;R<D;){if(d>=O)return-1;if(W=M.charCodeAt(R++),W===37){if(W=M.charAt(R++),ft=m[W in Xe?M.charAt(R++):W],!ft||(d=ft(y,C,d))<0)return-1}else if(W!=C.charCodeAt(d++))return-1}return d}function A(y,M,C){var d=s.exec(M.slice(C));return d?(y.p=f.get(d[0].toLowerCase()),C+d[0].length):-1}function N(y,M,C){var d=p.exec(M.slice(C));return d?(y.w=x.get(d[0].toLowerCase()),C+d[0].length):-1}function w(y,M,C){var d=l.exec(M.slice(C));return d?(y.w=h.get(d[0].toLowerCase()),C+d[0].length):-1}function S(y,M,C){var d=I.exec(M.slice(C));return d?(y.m=E.get(d[0].toLowerCase()),C+d[0].length):-1}function F(y,M,C){var d=b.exec(M.slice(C));return d?(y.m=U.get(d[0].toLowerCase()),C+d[0].length):-1}function $(y,M,C){return _(y,n,M,C)}function xt(y,M,C){return _(y,e,M,C)}function _t(y,M,C){return _(y,r,M,C)}function Mt(y){return a[y.getDay()]}function Tt(y){return o[y.getDay()]}function Z(y){return c[y.getMonth()]}function Ps(y){return u[y.getMonth()]}function Es(y){return i[+(y.getHours()>=12)]}function Hs(y){return 1+~~(y.getMonth()/3)}function Ys(y){return a[y.getUTCDay()]}function Rs(y){return o[y.getUTCDay()]}function Is(y){return c[y.getUTCMonth()]}function Os(y){return u[y.getUTCMonth()]}function Ws(y){return i[+(y.getUTCHours()>=12)]}function zs(y){return 1+~~(y.getUTCMonth()/3)}return{format:function(y){var M=g(y+="",k);return M.toString=function(){return y},M},parse:function(y){var M=v(y+="",!1);return M.toString=function(){return y},M},utcFormat:function(y){var M=g(y+="",H);return M.toString=function(){return y},M},utcParse:function(y){var M=v(y+="",!0);return M.toString=function(){return y},M}}}var Xe={"-":"",_:" ",0:"0"},P=/^\\s*\\d+/,yu=/^%/,wu=/[\\\\^$*+?|[\\]().{}]/g;function T(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function vu(t){return t.replace(wu,"\\\\$&")}function Lt(t){return new RegExp("^(?:"+t.map(vu).join("|")+")","i")}function Pt(t){return new Map(t.map((n,e)=>[n.toLowerCase(),e]))}function xu(t,n,e){var r=P.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function _u(t,n,e){var r=P.exec(n.slice(e,e+1));return r?(t.u=+r[0],e+r[0].length):-1}function Mu(t,n,e){var r=P.exec(n.slice(e,e+2));return r?(t.U=+r[0],e+r[0].length):-1}function Tu(t,n,e){var r=P.exec(n.slice(e,e+2));return r?(t.V=+r[0],e+r[0].length):-1}function Nu(t,n,e){var r=P.exec(n.slice(e,e+2));return r?(t.W=+r[0],e+r[0].length):-1}function qe(t,n,e){var r=P.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function Ve(t,n,e){var r=P.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function Cu(t,n,e){var r=/^(Z)|([+-]\\d\\d)(?::?(\\d\\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function bu(t,n,e){var r=P.exec(n.slice(e,e+1));return r?(t.q=r[0]*3-3,e+r[0].length):-1}function Su(t,n,e){var r=P.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function Be(t,n,e){var r=P.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function Du(t,n,e){var r=P.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function Ze(t,n,e){var r=P.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function ku(t,n,e){var r=P.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function Au(t,n,e){var r=P.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function Uu(t,n,e){var r=P.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function Fu(t,n,e){var r=P.exec(n.slice(e,e+6));return r?(t.L=Math.floor(r[0]/1e3),e+r[0].length):-1}function $u(t,n,e){var r=yu.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function Lu(t,n,e){var r=P.exec(n.slice(e));return r?(t.Q=+r[0],e+r[0].length):-1}function Pu(t,n,e){var r=P.exec(n.slice(e));return r?(t.s=+r[0],e+r[0].length):-1}function Ge(t,n){return T(t.getDate(),n,2)}function Eu(t,n){return T(t.getHours(),n,2)}function Hu(t,n){return T(t.getHours()%12||12,n,2)}function Yu(t,n){return T(1+Ft.count(et(t),t),n,3)}function Qe(t,n){return T(t.getMilliseconds(),n,3)}function Ru(t,n){return Qe(t,n)+"000"}function Iu(t,n){return T(t.getMonth()+1,n,2)}function Ou(t,n){return T(t.getMinutes(),n,2)}function Wu(t,n){return T(t.getSeconds(),n,2)}function zu(t){var n=t.getDay();return n===0?7:n}function Xu(t,n){return T(an.count(et(t)-1,t),n,2)}function Je(t){var n=t.getDay();return n>=4||n===0?yt(t):yt.ceil(t)}function qu(t,n){return t=Je(t),T(yt.count(et(t),t)+(et(t).getDay()===4),n,2)}function Vu(t){return t.getDay()}function Bu(t,n){return T(un.count(et(t)-1,t),n,2)}function Zu(t,n){return T(t.getFullYear()%100,n,2)}function Gu(t,n){return t=Je(t),T(t.getFullYear()%100,n,2)}function Qu(t,n){return T(t.getFullYear()%1e4,n,4)}function Ju(t,n){var e=t.getDay();return t=e>=4||e===0?yt(t):yt.ceil(t),T(t.getFullYear()%1e4,n,4)}function Ku(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+T(n/60|0,"0",2)+T(n%60,"0",2)}function Ke(t,n){return T(t.getUTCDate(),n,2)}function ju(t,n){return T(t.getUTCHours(),n,2)}function ts(t,n){return T(t.getUTCHours()%12||12,n,2)}function ns(t,n){return T(1+Hn.count(ct(t),t),n,3)}function je(t,n){return T(t.getUTCMilliseconds(),n,3)}function es(t,n){return je(t,n)+"000"}function rs(t,n){return T(t.getUTCMonth()+1,n,2)}function is(t,n){return T(t.getUTCMinutes(),n,2)}function os(t,n){return T(t.getUTCSeconds(),n,2)}function as(t){var n=t.getUTCDay();return n===0?7:n}function us(t,n){return T(ze.count(ct(t)-1,t),n,2)}function tr(t){var n=t.getUTCDay();return n>=4||n===0?wt(t):wt.ceil(t)}function ss(t,n){return t=tr(t),T(wt.count(ct(t),t)+(ct(t).getUTCDay()===4),n,2)}function cs(t){return t.getUTCDay()}function fs(t,n){return T(sn.count(ct(t)-1,t),n,2)}function ls(t,n){return T(t.getUTCFullYear()%100,n,2)}function hs(t,n){return t=tr(t),T(t.getUTCFullYear()%100,n,2)}function gs(t,n){return T(t.getUTCFullYear()%1e4,n,4)}function ds(t,n){var e=t.getUTCDay();return t=e>=4||e===0?wt(t):wt.ceil(t),T(t.getUTCFullYear()%1e4,n,4)}function ms(){return"+0000"}function nr(){return"%"}function er(t){return+t}function rr(t){return Math.floor(+t/1e3)}var vt,ir;ps({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ps(t){return vt=pu(t),ir=vt.format,vt.parse,vt.utcFormat,vt.utcParse,vt}function ys(t){return new Date(t)}function ws(t){return t instanceof Date?+t:+new Date(+t)}function or(t,n,e,r,i,o,a,u,c,s){var f=Ie(),l=f.invert,h=f.domain,p=s(".%L"),x=s(":%S"),b=s("%I:%M"),U=s("%I %p"),I=s("%a %d"),E=s("%b %d"),k=s("%B"),H=s("%Y");function m(g){return(c(g)<g?p:u(g)<g?x:a(g)<g?b:o(g)<g?U:r(g)<g?i(g)<g?I:E:e(g)<g?k:H)(g)}return f.invert=function(g){return new Date(l(g))},f.domain=function(g){return arguments.length?h(Array.from(g,ws)):h().map(ys)},f.ticks=function(g){var v=h();return t(v[0],v[v.length-1],g??10)},f.tickFormat=function(g,v){return v==null?m:s(v)},f.nice=function(g){var v=h();return(!g||typeof g.range!="function")&&(g=n(v[0],v[v.length-1],g??10)),g?h(iu(v,g)):f},f.copy=function(){return Re(f,or(t,n,e,r,i,o,a,u,c,s))},f}function vs(){return He.apply(or(du,mu,et,Yn,an,Ft,En,Pn,pt,ir).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Et(t,n,e){this.k=t,this.x=n,this.y=e}Et.prototype={constructor:Et,scale:function(t){return t===1?this:new Et(this.k*t,this.x,this.y)},translate:function(t,n){return t===0&n===0?this:new Et(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},Et.prototype;function On(t){return t.mode==="temporal"||t.mode==="left-aligned"?xs(t):_s(t)}function xs({domain:t,range:n}){return vs().domain(t).range(n)}function _s({domain:t,range:n}){return Oe().domain(t).range(n)}function Ms({root_node_ids:t,nodes:n}){try{return Ts(t,n)}catch(e){return console.error(e),ar(t,n)}}function Ts(t,n){const e=new Map,r=[];for(const i of t){e.set(i,0);const o=n.get(i);for(const{id:a}of o.children)r.push(a)}return Wn(r,n,e)}function Wn(t,n,e){for(const r of t){if(e.has(r))continue;const i=n.get(r);if(!i)throw new Error("Node id not found in nodes");const o=[];for(const c of i.parents){const s=e.get(c.id);if(s!==void 0){o.push(s);continue}Wn([c.id],n,e);const f=e.get(c.id);if(f===void 0)throw new Error("Could not determine parent column");o.push(f)}const a=Math.max(...o);e.set(r,a+1);const u=i.children.map(({id:c})=>c);u.length&&Wn(u,n,e)}return e}function ar(t,n,e=0,r=new Map){for(const i of t){const o=r.get(i);(!o||o<e)&&r.set(i,e);const a=n.get(i);for(const{id:u}of a.children)ar([u],n,e+1,r)}return r}function Ns(t){return t.horizontalSettings.mode==="dependency"?Cs(t):t.horizontalSettings.mode==="left-aligned"?Ss(t):bs(t)}function Cs({data:t,horizontalSettings:n}){const e=Ms(t),r=On(n),i=new Map;for(const[o]of t.nodes){const a=e.get(o);if(a===void 0){console.warn(`Node not found in columns: Skipping ${o}`);continue}i.set(o,{x:r(a),column:a})}return i}function bs({data:t,horizontalSettings:n}){const e=On(n),r=new Map;for(const[i,o]of t.nodes){const a=e(o.start_time);r.set(i,{column:a,x:a})}return r}function Ss({data:t,horizontalSettings:n}){const e=On(n),r=new Map;for(const[i]of t.nodes)r.set(i,{column:0,x:e(t.start_time)});return r}async function Ds(t,n){const i=new Map,o=new Map;let a=0;const u=new Map;for await(const[m]of t.data.nodes){const g=t.data.nodes.get(m);if(!g){console.warn("NearestParentLayout: Node was not found in the data",m);continue}const v=await c(g);k(m,v)}return H(),u;async function c(m){const{x:g}=n.get(m.id)??{};if(g===void 0)return console.warn("NearestParentLayout: Node was not found in the horizontal layout",m.id),0;if(m.parents.length===1)return u.has(m.parents[0].id)?await f(m.parents[0].id,g):(console.warn("NearestParentLayout: Parent node not found in layout",m.parents[0].id),0);if(m.parents.length>0){const v=m.parents.map(({id:w})=>{const S=u.get(w);return S===void 0?(console.warn("NearestParentLayout: Parent node not found in layout",w),0):S}),A=v.reduce((w,S)=>w+S,0)/v.length,N=Math.round(A);if(l(g,N)){const w=x(g,N),S=m.parents.map(({id:$})=>$),F=w.filter($=>S.includes($));if(F.length>0||w.length>1){const[$]=F.length>0?F:w,xt=b(v,N,i.get($));return i.set($,xt),await f($,g)}return await U({competingNodeId:w[0],upstreamRows:v,nodeStartX:g,desiredRow:N})}}return s(g,0)}function s(m,g){return l(m,g)?s(m,g+1):g}async function f(m,g){const v=u.get(m);if(v===void 0)return console.warn("NearestParentLayout: Upstream node not found in layout",m),0;i.get(m)||i.set(m,1);const _=i.get(m);return l(g,v)?_===1&&!l(g,v+1)?(i.set(m,-1),v+1):l(g,v-1)?(await h({direction:_,nodeStartX:g,desiredRow:v+_}),i.set(m,_===1?-1:1),v+_):(i.set(m,1),v-1):v}function l(m,g){if(u.size===0)return!1;let v=!1;const _=o.get(g)??[];for(const A of _){const N=u.get(A),w=E(A);if(p({firstNodeEndX:w,firstNodeRow:N,lastNodeStartX:m,lastNodeRow:g})){v=!0;break}}return v}async function h({direction:m,nodeStartX:g,desiredRow:v}){const _=x(g,v);if(_)for await(const A of _){const N=u.get(A),{x:w}=n.get(A)??{};if(N===void 0||w===void 0){console.warn("NearestParentLayout - shove: Node was not found in the vertical or horizontal layout",A);continue}const S=N+m;await h({direction:m,nodeStartX:w,desiredRow:S}),k(A,S)}}function p({firstNodeEndX:m,firstNodeRow:g,lastNodeStartX:v,lastNodeRow:_}){return g===_&&m+16>=v}function x(m,g){const v=[],_=o.get(g)??[];for(const A of _){const N=E(A),w=u.get(A);if(w===void 0){console.warn("NearestParentLayout - getOverlappingNodeIds: Node was not found in the layout",A);continue}p({firstNodeEndX:N,firstNodeRow:w,lastNodeStartX:m,lastNodeRow:g})&&v.push(A)}if(v.length!==0)return v.sort((A,N)=>{const w=E(A),S=E(N);return w<S?1:w>S?-1:0}),v}function b(m,g,v){const _=m.filter(N=>N<g).length,A=m.filter(N=>N>g).length;return _>A?-1:v??1}async function U({desiredRow:m,nodeStartX:g,upstreamRows:v,competingNodeId:_}){if(u.get(_)===void 0)return console.warn("NearestParentLayout - argueWithCompetingUpstreamPlacement: Competitor node was not found in the layout",_),m;const[N,w]=I(_),S=v.filter($=>$<m).length,F=v.filter($=>$>m).length;if(S>F){if(N>w&&N>S)return await h({direction:-1,nodeStartX:g,desiredRow:m}),m;if(w>N)return await h({direction:1,nodeStartX:g,desiredRow:m}),m;i.set(_,-1)}if(F>S){if(w>N&&w>F)return await h({direction:1,nodeStartX:g,desiredRow:m}),m;if(N>w)return await h({direction:-1,nodeStartX:g,desiredRow:m}),m;i.set(_,1)}return await f(_,g)}function I(m){const g=t.data.nodes.get(m),v=u.get(m);return!g||v===void 0?(console.warn("NearestParentLayout: Node was not found in either the data or layout",m),[0,0]):g.parents.reduce((_,A)=>{const N=u.get(A.id);return N===void 0?(console.warn("NearestParentLayout - getNodeParentDirectionCounts: Parent node not found on layout data",m),_):(N<v&&(_[0]+=1),N>v&&(_[1]+=1),_)},[0,0])}function E(m){const{x:g}=n.get(m)??{},v=t.widths.get(m);return g===void 0||v===void 0?(console.warn("NearestParentLayout: Node was not found in the horizontal layout and/or widths",m),0):g+v}function k(m,g){if(g<a&&(a=g),u.has(m)){const v=u.get(m);o.get(v)?.delete(m)}o.has(g)||o.set(g,new Set),o.get(g)?.add(m),u.set(m,g)}function H(){if(a<0)for(const[m]of u){const g=u.get(m);u.set(m,g+Math.abs(a))}}}async function ks(t,n){return t.verticalSettings.mode==="nearest-parent"?await Ds(t,n):t.verticalSettings.mode==="duration-sorted"?Us(t):As(t)}function As(t){const n=new Map;let e=0;for(const[r]of t.data.nodes)n.set(r,e++);return n}function Us(t){const n=new Map,e=[...t.data.nodes.values()].sort((i,o)=>{const a=(i.end_time?i.end_time.getTime():new Date().getTime())-i.start_time.getTime();return(o.end_time?o.end_time.getTime():new Date().getTime())-o.start_time.getTime()-a});let r=0;for(const i of e)n.set(i.id,r++);return n}onmessage=Fs;function Fs({data:t}){const{type:n}=t;if(n==="layout"){Ls(t);return}else sr(n)}function $s(t){postMessage(t)}async function Ls(t){const{data:n}=t,e=Ns(t),r=await ks(t,e),i=new Map;let o=0,a=0;for(const[u,c]of n.nodes){const s=e.get(u),f=r.get(u);if(s===void 0){console.warn(`NodeId not found in horizontal layout: Skipping ${c.label}`);continue}if(f===void 0){console.warn(`NodeId not found in vertical layout: Skipping ${c.label}`);continue}o=Math.max(o,f),a=Math.max(a,s.column),i.set(u,{...s,y:f,row:f})}$s({type:"layout",layout:{maxRow:o,maxColumn:a,positions:i}})}})();\n//# sourceMappingURL=runGraph.worker-ChmCiswU.js.map\n',xg=typeof self<"u"&&self.Blob&&new Blob(["(self.URL || self.webkitURL).revokeObjectURL(self.location.href);",b_],{type:"text/javascript;charset=utf-8"});function PI(r){let t;try{if(t=xg&&(self.URL||self.webkitURL).createObjectURL(xg),!t)throw"";const e=new Worker(t,{name:r?.name});return e.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),e}catch{return new Worker("data:text/javascript;charset=utf-8,"+encodeURIComponent(b_),{name:r?.name})}}function II(r){const t=new PI;return t.onmessage=r,t}async function Cd(){const r=new Map,t=new Map,e=new Map,i=new bt,n=new bt,s=await jt();let o=null;const a=_g({gap:()=>s.rowGap,minimum:()=>s.nodeHeight}),h=_g({gap:()=>s.columnGap,minimum:()=>hd()});let l=null,u=null;i.name=Eg,rt.on("layoutUpdated",()=>{a.clear(),h.clear()}),rt.on("layoutSettingsUpdated",()=>{u&&i.parent&&c(u),j()}),rt.on("itemSelected",()=>{j()});async function c(M){d(),u=M,l=null,await Promise.all([p(M),g(M)]),w(M)}function d(){o||(o=II(P))}function f(){o&&(o.terminate(),o=null)}async function p(M){const k=[];for(const L of M.nodes.values())k.push(m(L));await Promise.all(k)}async function m(M){const{render:k}=await b(M),L=y(M.id);return await k(M,L)}async function g(M){if((await Kt()).disableEdges){i.removeChild(n);return}i.addChildAt(n,0);const k=[];for(const[L,{children:V}]of M.nodes)for(const{id:$}of V)k.push(v(L,$));await Promise.all(k)}async function v(M,k){const L=`${M}_${k}`;if(e.has(L))return;const V=await vS();e.has(L)||(e.set(L,V),n.addChild(V.element))}function w(M){if(!o)throw new Error("Layout worker not initialized");const k=new Map;for(const[L,{element:V}]of t)k.set(L,V.width);o.postMessage({type:"layout",data:M,widths:k,horizontalSettings:Rc(M.start_time),verticalSettings:yI()})}function _(){if(l)for(const[M,k]of e){const[L,V]=M.split("_"),$=l.positions.get(L),tt=l.positions.get(V),et=t.get(L);if(!$||!tt){console.warn(`Could not find edge in layout: Skipping ${M}`);continue}if(!et){console.warn(`Could not find parent node in nodes: Skipping ${L}`);continue}const K=et.bar.width,U=S($),X={x:U.x+K,y:U.y+s.nodeHeight/2},q=S(tt),z={x:q.x-X.x,y:q.y-X.y+s.nodeHeight/2};k.setPosition(X,z)}}function T(){if(l){for(const[M,k]of t){const L=l.positions.get(M);if(!L){console.warn(`Could not find node in layout: Skipping ${M}`);continue}const V=S(L);k.setPosition(V),a.updateNodeAxis({nodeId:M,axis:L.y}),h.updateNodeAxis({nodeId:M,axis:L.column})}_(),i.emit("rendered"),i.emit("resized",N())}}async function b(M){const k=r.get(M.id);if(k)return k;const L=y(M.id),V=MI(M,L);r.set(M.id,V);const $=await V;return $.element.on("resized",tt=>x(M.id,tt)),i.addChild($.element),t.set(M.id,$),$}function x(M,k){if(!l)return;const L=t.get(M),V=l.positions.get(M);!L||!V||(a.setOffset({nodeId:M,axis:V.y,offset:k.height}),h.setOffset({nodeId:M,axis:V.column,offset:k.width}),T())}function y(M){return u?.nested_task_run_graphs?.get(M)}function S(M){const k=a.getTotalOffset(M.y);return{x:D(M),y:k}}function D(M){return ut.isDependency()?h.getTotalOffset(M.column):M.x}function G(){return l?a.getTotalValue(l.maxRow):0}function O(){if(!l||!u)return 0;if(ut.isDependency())return h.getTotalValue(l.maxColumn);const M=Rc(u.start_time),k=g_(M),L=k(u.end_time??new Date),V=k(u.start_time);return L-V}function N(){return{width:O(),height:G()}}function P({data:M}){const{type:k}=M;if(k==="layout"){F(M);return}else RI(k)}function F(M){l=M.layout,T()}async function j(){const M=await Kt(),k=YS();if(M.disableEdges||!k||!u?.nodes.has(k.id)){E([]);return}const L=B(k.id);E(L)}function E(M){A(M),C(M)}function A(M){for(const[k,{element:L}]of t){if(M.length===0||M.includes(k)){L.alpha=1;continue}L.alpha=s.nodeUnselectedAlpha}}function C(M){for(const[k,{element:L}]of e){const[V,$]=k.split("_");if(M.length===0||M.includes(V)&&M.includes($)){L.alpha=1;continue}L.alpha=s.nodeUnselectedAlpha}}function B(M){const k=I(M,"parents"),L=I(M,"children");return[M,...k,...L]}function I(M,k){const L=u?.nodes.get(M);if(!L)return[];const V=[];for(const{id:$}of L[k])V.push($),V.push(...I($,k));return V}return{element:i,stopWorker:f,getSize:N,render:c}}let Ic=null,hn=null,Cn=null;async function DI(){const r=await Jt(),t=await Ue(),{element:e,render:i}=await Cd();r.addChild(e),e.alpha=0;const n=await fy(t.runId,async s=>{const o=hn?"runDataUpdated":"runDataCreated";hn=s,rt.emit(o,hn),await Kt(),i(s)});rt.on("configUpdated",()=>{hn&&i(hn)}),Cn=e,Ic=n.stop,Cn.once("rendered",()=>kI()),rt.on("layoutUpdated",()=>NI()),n.start()}function OI(){Ic?.(),Ic=null,Cn=null,hn=null}async function Hr(){return hn||await Re("runDataCreated")}function kI(){T_(),_e.shared.addOnce(()=>{Cn&&(Cn.alpha=1)})}async function NI(){if(!Cn)return;const r=await Ue();Cn.once("rendered",()=>{setTimeout(()=>{T_({animate:!0})},r.animationDuration)})}let ke=null,Dc=null;async function FI(){const r=await Qt(),t=await Wc();ke=new UE({screenHeight:t.clientHeight,screenWidth:t.clientWidth,events:r.renderer.events,passiveWheel:!1}),ke.zIndex=Ex,ke.drag().pinch().wheel({trackpadPinch:!0}).decelerate({friction:.9}).clampZoom({minWidth:t.clientWidth/2}),ke.on("moved",()=>{rt.emit("viewportMoved",null)}).on("moved-end",()=>{rt.emit("viewportMoved",null)}),r.stage.addChild(ke),rt.emit("viewportCreated",ke),rt.on("applicationResized",zI),rt.on("scaleUpdated",()=>xo()),GI()}function LI(){ke=null,Dc=null}async function T_({animate:r}={}){const t=(await Jt()).getChildByName(Eg);if(!t)throw new Error("Nodes container not found");XI();const{x:e,y:i,width:n,height:s}=t.getLocalBounds();if(!n||!s){UI({animate:r});return}BI({x:e,y:i,width:n,height:s,animate:r})}async function BI({x:r,y:t,width:e,height:i,animate:n}){const s=await Ue(),o=await jt(),a=await Jt(),{guideTextSize:h,guideTextTopPadding:l,columnGap:u,rowGap:c,eventTargetSize:d}=o,f=h+l,p=e+u*2,m=i+c*4+f+d,g=a.findFit(p,m);a.animate({position:{x:r+e/2,y:t+i/2+f},scale:Math.min(g,1),time:n?s.animationDuration:0,ease:"easeInOutQuad",removeOnInterrupt:!0,callbackOnComplete:()=>{Io(),xo()}})}async function UI({animate:r}){const t=await Hr(),e=await Ue(),i=await jt(),n=await Jt(),s=await rr();let o=s(t.start_time)-i.columnGap,a=s(t.end_time??new Date)+i.columnGap;if(o>a){const c=o;o=a,a=c}const h=a-o,l=o+h/2,u=n.findFit(h,0);n.animate({position:{x:l,y:0},scale:u,time:r?e.animationDuration:0,ease:"easeInOutQuad",removeOnInterrupt:!0,callbackOnComplete:()=>{Io(),xo()}})}async function Jt(){return ke||await Re("viewportCreated")}function E_(r){cy(Dc,r)||(Dc=r,rt.emit("viewportDateRangeUpdated",r))}function HI({xOffset:r,yOffset:t}){if(!ke)return;const{x:e,y:i}=ke.transform.position;ke.setTransform(e+r,i+t,ke.transform.scale.x,ke.transform.scale.y)}async function GI(){const r=await Jt();xo(),r.on("moved",()=>xo())}async function xo(){const r=await A_();r&&E_(r)}async function A_(){const r=await Jt(),t=await rr(),e=t.invert(r.left),i=t.invert(r.right);return e instanceof Date&&i instanceof Date?[e,i]:null}async function pD(r){const t=await A_(),e=await Kt();if(r===void 0||e.isDependency()||cy(r,t))return;const i=await Jt(),n=await rr(),[s,o]=r,a=n(s),h=n(o),l=a+(h-a)/2;E_(r),i.fitWidth(h-a,!0),i.moveCenter(l,i.center.y)}async function zI(){const r=await Qt(),t=await Jt(),e=await Wc(),i=t.screenWidth,n=t.screenHeight,s=e.clientWidth,o=e.clientHeight,a=(s-i)/2,h=(o-n)/2;t.resize(r.screen.width,r.screen.height),HI({xOffset:a,yOffset:h})}class va{status="visible";labels=new Set;get visible(){return this.status==="visible"}get hidden(){return this.status==="hidden"}show(){if(this.status!=="visible"){for(const t of this.labels)t.visible=!0;this.status="visible"}}hide(){if(this.status!=="hidden"){for(const t of this.labels)t.visible=!1;this.status="hidden"}}toggle(t){t?this.show():this.hide()}add(t){this.labels.add(t),t.visible=this.visible}clear(){this.labels.clear()}}let _n=null,cn=null,wo=null,ao=null,os=null;async function jI(){const r=await Jt(),t=await Qt();_n=new oE({toggle:"renderable"}),cn=new va,wo=new va,os=new va,ao=new va,t.ticker.add(()=>{if(r.dirty){const e=r.scale.x>bx,i=r.scale.x>_x,n=r.scale.x>xx,s=r.scale.x>wx;os?.toggle(e),cn?.toggle(i),wo?.toggle(n),ao?.toggle(s),_n?.cull(t.renderer.screen),r.dirty=!1}}),rt.emit("cullCreated",_n),rt.emit("labelCullCreated",cn),rt.emit("iconCullCreated",cn),rt.emit("edgeCullCreated",os),rt.emit("toggleCullCreated",ao)}function WI(){_n=null,cn?.clear(),cn=null,wo?.clear(),wo=null,os?.clear(),os=null,ao?.clear(),ao=null}async function Io(){const r=await Jt();r.dirty=!0}function XI(){_n&&_n.uncull()}async function S_(){return _n||await Re("cullCreated")}async function VI(){return os||await Re("edgeCullCreated")}async function C_(){return cn||await Re("labelCullCreated")}async function M_(){return wo||await Re("iconCullCreated")}async function $I(){const r=await Qt(),t=await Hr(),e=await Kt(),{element:i,render:n,update:s}=await __({isRoot:!0});i.zIndex=Cx;function o(a){if(ut.isTemporal()&&!e.disableArtifacts){r.stage.addChild(i),n(a?.artifacts);return}r.stage.removeChild(i)}t.artifacts&&o(t),rt.on("viewportMoved",()=>s()),rt.on("runDataCreated",a=>o(a)),rt.on("runDataUpdated",a=>o(a)),rt.on("configUpdated",()=>o()),rt.on("layoutSettingsUpdated",()=>o())}async function YI(){const r=await Qt(),t=await Hr(),{element:e,render:i}=await x_({isRoot:!0});e.zIndex=Sx,r.stage.addChild(e);function n(s){i(s?.states)}t.states&&n(t),rt.on("runDataUpdated",s=>n(s)),rt.on("configUpdated",()=>n()),rt.on("layoutSettingsUpdated",()=>n())}async function qI(){const r=await Qt(),t=await Jt(),e=await Kt(),i=await jt(),n=await _v(),s=new bt,o=await si();s.addChild(o);const a=n("");s.addChild(a);let h=await rr(),l,u;rt.on("scaleUpdated",m=>{h=m,p()}),rt.on("viewportMoved",()=>{e.disableGuides||(p(),s.height!==r.screen.height&&d())});function c(m,g){l=m,u=g,d(),f(m)}function d(){o.width=i.guideLineWidth,o.height=r.screen.height,o.tint=i.guideLineColor}function f(m){a.text=u(m),a.fontSize=i.guideTextSize,a.tint=i.guideTextColor,a.position.set(i.guideTextLeftPadding,i.guideTextTopPadding)}function p(){l!==void 0&&(s.position.x=h(l)*t.scale._x+t.worldTransform.tx)}return{element:s,render:c}}class wg extends Error{constructor(){super("Layout is not temporal")}}function ZI(r){return r.toLocaleTimeString()}function bg(r){const t=navigator.language;return new Intl.DateTimeFormat(t,{timeStyle:"short"}).format(r)}function KI(r){const t=navigator.language;return new Intl.DateTimeFormat(t,{dateStyle:"short"}).format(r)}function QI(r){return r.getHours()===0&&r.getMinutes()===0?`${Ua.date(r)}
${bg(r)}`:bg(r)}const Ua={timeBySeconds:ZI,timeByMinutesWithDates:QI,date:KI},ee={seconds:"seconds",minutes:"minutes",date:"date"},Hs={day:r=>{const t=new Date(r.getTime());return t.setHours(0,0,0,0),t.getTime()},week:r=>{const t=new Date(r.getTime());return t.setHours(0,0,0,0),t.setDate(r.getDate()-r.getDay()+1),t.getTime()}},St={second:1e3,minute:1e3*60,hour:1e3*60*60,day:1e3*60*60*24,week:1e3*60*60*24*7},Tg=[{ceiling:St.second*4,increment:St.second,labelFormat:ee.seconds},{ceiling:St.second*8,increment:St.second*5,labelFormat:ee.seconds},{ceiling:St.second*13,increment:St.second*10,labelFormat:ee.seconds},{ceiling:St.second*20,increment:St.second*15,labelFormat:ee.seconds},{ceiling:St.second*45,increment:St.second*30,labelFormat:ee.seconds},{ceiling:St.minute*4,increment:St.minute,labelFormat:ee.minutes},{ceiling:St.minute*8,increment:St.minute*5,labelFormat:ee.minutes},{ceiling:St.minute*13,increment:St.minute*10,labelFormat:ee.minutes},{ceiling:St.minute*28,increment:St.minute*15,labelFormat:ee.minutes},{ceiling:St.hour*1.24,increment:St.minute*30,labelFormat:ee.minutes},{ceiling:St.hour*3,increment:St.hour,labelFormat:ee.minutes},{ceiling:St.hour*8,increment:St.hour*2,getAnchor:Hs.day,labelFormat:ee.minutes},{ceiling:St.hour*13,increment:St.hour*6,getAnchor:Hs.day,labelFormat:ee.minutes},{ceiling:St.hour*22,increment:St.hour*12,getAnchor:Hs.day,labelFormat:ee.minutes},{ceiling:St.day*4,increment:St.day,getAnchor:Hs.day,labelFormat:ee.date},{ceiling:St.week*2,increment:St.week,getAnchor:Hs.week,labelFormat:ee.date},{ceiling:1/0,increment:St.week*4,labelFormat:ee.date}],JI=300;async function tD(){const r=await Jt(),t=await Kt(),e=new bt,i=new Map;let n=await rr();rt.on("scaleUpdated",d=>n=d),await o();function s(){if(e.visible=!t.disableGuides,!t.disableGuides)try{const{anchor:d,increment:f,labelFormat:p}=a(),m=c(d,f);u(m,p)}catch(d){if(d instanceof wg)return;console.error(d)}}async function o(){const d=[];_c(Ud,async f=>{const p=qI();d.push(p);const m=await p;e.addChild(m.element),i.set(f,m)}),await Promise.all(d)}function a(){const d=r.left-JI,f=n.invert(d),p=n.invert(d+Tx/r.scale.x);if(!(f instanceof Date)||!(p instanceof Date))throw new wg;const m=p.getTime()-f.getTime(),{increment:g,getAnchor:v,labelFormat:w}=h(m);return{anchor:v(f),increment:g,labelFormat:l(w)}}function h(d){const f=Tg.find(p=>p.ceiling>d)??Tg[0];return f.getAnchor||(f.getAnchor=p=>Math.floor(p.getTime()/f.increment)*f.increment),f}function l(d){switch(d){case ee.minutes:return Ua.timeByMinutesWithDates;case ee.date:return Ua.date;default:return Ua.timeBySeconds}}function u(d,f){const p=new Map(i.entries()),m=Array.from(p.keys()).filter(g=>!d.includes(g));i.clear();for(const g of d){if(p.has(g)){const w=p.get(g);i.set(g,w),w.render(new Date(g),f);continue}const v=p.get(m.pop()??-1);if(v===void 0){console.warn("Guides: No unused guides available to render.");continue}v.render(new Date(g),f),i.set(g,v)}}function c(d,f){return _c(Ud,p=>d+f*p)}return{element:e,render:s}}async function eD(){const r=await Qt(),{element:t,render:e}=await tD();r.stage.addChild(t),e(),rt.on("viewportDateRangeUpdated",()=>e()),rt.on("layoutSettingsUpdated",()=>e()),rt.on("configUpdated",()=>e())}const rD=80;async function iD(){const r=await Qt(),t=await Jt(),e=await Kt(),i=await jt(),n=await si();let s=await rr();rt.on("scaleUpdated",h=>s=h);function o(){if(!e.isTemporal()){n.visible=!1;return}n.width=i.playheadWidth,n.height=r.stage.height,n.tint=i.playheadColor,n.position.x=s(new Date)*t.scale.x+t.worldTransform.tx,a()}function a(){if(t.moving||!(n.position.x>0&&n.position.x<r.screen.width)||!(n.position.x>r.screen.width-rD))return;const h=t.left;t.zoomPercent(-.1,!0),t.left=h}return{element:n,render:o}}async function nD(){const r=await Qt(),t=await Hr(),{element:e,render:i}=await iD();t.end_time||(r.stage.addChild(e),r.ticker.add(i)),rt.on("runDataUpdated",({end_time:n})=>{n&&(r.ticker.remove(i),r.stage.removeChild(e))})}function mD({stage:r,config:t}){ZT(),FI(),vI(),eD(),DI(),$I(),xI(),YI(),nD(),zS(),YT(r),iE(t),oS(),jI(),uS(),VS()}function gD(){rt.clear();try{KT(),LI(),_I(),qT(),OI(),wI(),sE(),aS(),WS(),WI(),cS(),$S(),tE()}catch(r){console.error(r)}}export{T_ as A,gu as U,gv as _,aD as a,li as b,pD as c,hD as d,rt as e,lD as f,dD as g,sD as h,nE as i,dx as j,fx as k,oD as l,cD as m,px as n,cx as o,uD as p,ut as u,mD as v,gD as x,fD as y};
//# sourceMappingURL=vendor-graphs-_sWgqfe-.js.map
