{"version":3,"file":"use-delete-automation-confirmation-dialog-DpdsLH4t.js","sources":["../../src/api/automations/use-get-automation-action-resources/use-get-automation-action-resources.ts","../../src/components/automations/action-details/action-details.tsx","../../src/components/automations/trigger-details/trigger-details-compound.tsx","../../src/components/automations/trigger-details/trigger-details-custom.tsx","../../src/components/deployments/deployment-link.tsx","../../src/components/automations/trigger-details/trigger-utils.ts","../../src/components/automations/trigger-details/trigger-details-deployment-status.tsx","../../src/components/automations/trigger-details/trigger-details-flow-run-state.tsx","../../src/components/automations/trigger-details/trigger-details-sequence.tsx","../../src/components/automations/trigger-details/trigger-details-work-pool-status.tsx","../../src/components/automations/trigger-details/trigger-details-work-queue-status.tsx","../../src/components/automations/trigger-details/trigger-details.tsx","../../src/components/automations/automation-details.tsx","../../src/components/automations/automation-enable-toggle/automation-enable-toggle.tsx","../../src/components/automations/automations-actions-menu/automations-actions-menu.tsx","../../src/components/automations/use-delete-automation-confirmation-dialog.ts"],"sourcesContent":["import { useQueries } from \"@tanstack/react-query\";\nimport { type Automation, buildGetAutomationQuery } from \"@/api/automations\";\nimport { buildListFilterBlockDocumentsQuery } from \"@/api/block-documents\";\nimport { buildFilterDeploymentsQuery } from \"@/api/deployments\";\nimport { buildFilterWorkPoolsQuery } from \"@/api/work-pools\";\nimport { buildFilterWorkQueuesQuery } from \"@/api/work-queues\";\n\n/**\n *\n * @param automation\n * @returns an object of maps to get information about an action's selected source (automations, deployments, work pools, and work queues)\n *\n * @example\n * ```ts\n * const { loading, data } = useGetAutomationActionResources(MY_AUTOMATION);\n *\n *\n * if (loading) {\n *   return \"Loading...\"\n * }\n *\n * const { automationsMap, blockDocumentsMap, deploymentsMap, workPoolsMap, workQueuesMap } = data\n * return (\n * \t\t<ActionDetails\n *\t\t\tautomation={MY_AUTOMATION}\n *\t\t\tautomations={automationsMap}\n *\t\t\tblockDocumentsMap={blockDocumentsMap}\n *\t\t\tdeployments={deploymentsMap}\n *\t\t\tworkPools={workPoolsMap}\n *\t\t\tworkQueues={workQueuesMap}\n *\t\t/>)\n * ```\n */\nexport const useGetAutomationActionResources = (automation: Automation) => {\n\tconst {\n\t\tautomationIds,\n\t\tblockDocumentIds,\n\t\tdeploymentIds,\n\t\tworkPoolIds,\n\t\tworkQueueIds,\n\t} = getResourceSets(automation.actions);\n\n\t// nb: Automations /filter doesn't support `id`. Need to do it per GET call\n\tconst { data: automationsData, loading: automationsLoading } =\n\t\tuseListAutomationsQueries(Array.from(automationIds));\n\n\t// Need to do deployments filter API\n\tconst remainingQueries = useQueries({\n\t\tqueries: [\n\t\t\tbuildListFilterBlockDocumentsQuery(\n\t\t\t\t{\n\t\t\t\t\toffset: 0,\n\t\t\t\t\tsort: \"BLOCK_TYPE_AND_NAME_ASC\",\n\t\t\t\t\tinclude_secrets: false,\n\t\t\t\t\tblock_documents: {\n\t\t\t\t\t\toperator: \"and_\",\n\t\t\t\t\t\tid: { any_: Array.from(blockDocumentIds) },\n\t\t\t\t\t\tis_anonymous: {},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{ enabled: blockDocumentIds.size > 0 },\n\t\t\t),\n\t\t\tbuildFilterDeploymentsQuery(\n\t\t\t\t{\n\t\t\t\t\toffset: 0,\n\t\t\t\t\tsort: \"CREATED_DESC\",\n\t\t\t\t\tdeployments: {\n\t\t\t\t\t\tid: { any_: Array.from(deploymentIds) },\n\t\t\t\t\t\toperator: \"and_\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{ enabled: deploymentIds.size > 0 },\n\t\t\t),\n\t\t\tbuildFilterWorkPoolsQuery(\n\t\t\t\t{\n\t\t\t\t\toffset: 0,\n\t\t\t\t\twork_pools: {\n\t\t\t\t\t\tid: { any_: Array.from(workPoolIds) },\n\t\t\t\t\t\toperator: \"and_\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{ enabled: workPoolIds.size > 0 },\n\t\t\t),\n\t\t\tbuildFilterWorkQueuesQuery(\n\t\t\t\t{\n\t\t\t\t\toffset: 0,\n\t\t\t\t\twork_queues: {\n\t\t\t\t\t\tid: { any_: Array.from(workQueueIds) },\n\t\t\t\t\t\toperator: \"and_\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{ enabled: workQueueIds.size > 0 },\n\t\t\t),\n\t\t],\n\t\tcombine: (results) => {\n\t\t\tconst [blockDocuments, deployments, workPools, workQueues] = results;\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\tblockDocuments: blockDocuments.data,\n\t\t\t\t\tdeployments: deployments.data,\n\t\t\t\t\tworkPools: workPools.data,\n\t\t\t\t\tworkQueues: workQueues.data,\n\t\t\t\t},\n\t\t\t\tloading: results.some((result) => result.isLoading),\n\t\t\t};\n\t\t},\n\t});\n\n\treturn {\n\t\tloading: automationsLoading || remainingQueries.loading,\n\t\tdata: {\n\t\t\tautomationsMap: automationsData,\n\t\t\tblockDocumentsMap: listToMap(remainingQueries.data.blockDocuments),\n\t\t\tdeploymentsMap: listToMap(remainingQueries.data.deployments),\n\t\t\tworkPoolsMap: listToMap(remainingQueries.data.workPools),\n\t\t\tworkQueuesMap: listToMap(remainingQueries.data.workQueues),\n\t\t},\n\t};\n};\n\nconst useListAutomationsQueries = (automationIds: Array<string>) =>\n\tuseQueries({\n\t\tqueries: Array.from(automationIds).map((automationId) =>\n\t\t\tbuildGetAutomationQuery(automationId),\n\t\t),\n\t\tcombine: (results) => {\n\t\t\tconst retMap = new Map<string, Automation>();\n\t\t\tfor (const result of results) {\n\t\t\t\tif (result.data) {\n\t\t\t\t\tretMap.set(result.data.id, result.data);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tdata: retMap,\n\t\t\t\tloading: results.some((result) => result.isLoading),\n\t\t\t};\n\t\t},\n\t});\n\nexport const getResourceSets = (actions: Automation[\"actions\"]) => {\n\tconst automationIds = new Set<string>();\n\tconst blockDocumentIds = new Set<string>();\n\tconst deploymentIds = new Set<string>();\n\tconst workPoolIds = new Set<string>();\n\tconst workQueueIds = new Set<string>();\n\n\tfor (const action of actions) {\n\t\tswitch (action.type) {\n\t\t\tcase \"run-deployment\":\n\t\t\tcase \"pause-deployment\":\n\t\t\tcase \"resume-deployment\":\n\t\t\t\tif (action.deployment_id) {\n\t\t\t\t\tdeploymentIds.add(action.deployment_id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"pause-work-queue\":\n\t\t\tcase \"resume-work-queue\":\n\t\t\t\tif (action.work_queue_id) {\n\t\t\t\t\tworkQueueIds.add(action.work_queue_id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"pause-automation\":\n\t\t\tcase \"resume-automation\":\n\t\t\t\tif (action.automation_id) {\n\t\t\t\t\tautomationIds.add(action.automation_id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"pause-work-pool\":\n\t\t\tcase \"resume-work-pool\":\n\t\t\t\tif (action.work_pool_id) {\n\t\t\t\t\tworkPoolIds.add(action.work_pool_id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"send-notification\":\n\t\t\tcase \"call-webhook\":\n\t\t\t\tif (action.block_document_id) {\n\t\t\t\t\tblockDocumentIds.add(action.block_document_id);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t// TODO: add these back when the corresponding actions are implemented\n\t\t\t// case \"do-nothing\":\n\t\t\t// case \"cancel-flow-run\":\n\t\t\t// case \"change-flow-run-state\":\n\t\t\t// case \"suspend-flow-run\":\n\t\t\t// case \"resume-flow-run\":\n\t\t}\n\t}\n\n\treturn {\n\t\tautomationIds,\n\t\tblockDocumentIds,\n\t\tdeploymentIds,\n\t\tworkPoolIds,\n\t\tworkQueueIds,\n\t};\n};\n\nfunction listToMap<T extends { id: string }>(\n\tlist: T[] | undefined,\n): Map<T[\"id\"], T> {\n\tconst map = new Map<T[\"id\"], T>();\n\tfor (const item of list ?? []) {\n\t\tmap.set(item.id, item);\n\t}\n\treturn map;\n}\n","import { Link } from \"@tanstack/react-router\";\nimport type { Automation } from \"@/api/automations\";\nimport type { BlockDocument } from \"@/api/block-documents\";\nimport type { Deployment } from \"@/api/deployments\";\nimport type { components } from \"@/api/prefect\";\nimport type { WorkPool } from \"@/api/work-pools\";\nimport type { WorkQueue } from \"@/api/work-queues\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport {\n\tDialog,\n\tDialogContent,\n\tDialogHeader,\n\tDialogTitle,\n\tDialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Icon, type IconId } from \"@/components/ui/icons\";\nimport { LazyJsonInput as JsonInput } from \"@/components/ui/json-input-lazy\";\nimport { StateBadge } from \"@/components/ui/state-badge\";\nimport { Typography } from \"@/components/ui/typography\";\nimport { capitalize } from \"@/utils\";\n\nconst ACTION_TYPE_TO_STRING = {\n\t\"cancel-flow-run\": \"Cancel flow run\",\n\t\"suspend-flow-run\": \"Suspend flow run\",\n\t\"resume-flow-run\": \"Resume a flow run\",\n\t\"change-flow-run-state\": \"Change state of a flow run\",\n\t\"run-deployment\": \"Run deployment\",\n\t\"pause-deployment\": \"Pause deployment\",\n\t\"resume-deployment\": \"Resume deployment\",\n\t\"pause-work-queue\": \"Pause work queue\",\n\t\"resume-work-queue\": \"Resume work queue\",\n\t\"pause-work-pool\": \"Pause work pool\",\n\t\"resume-work-pool\": \"Resume work pool\",\n\t\"pause-automation\": \"Pause automation\",\n\t\"resume-automation\": \"Resume automation\",\n\t\"call-webhook\": \"Call webhook using\",\n\t/** Default string if `block_type_name` is not found. */\n\t\"send-notification\": \"Send a notification using\",\n\t\"do-nothing\": \"Do nothing\",\n} as const;\ntype ActionLabel =\n\t(typeof ACTION_TYPE_TO_STRING)[keyof typeof ACTION_TYPE_TO_STRING];\n\ntype AutomationAction = Automation[\"actions\"][number];\n\ntype ActionDetailsProps = {\n\taction: AutomationAction;\n\tautomationsMap: Map<string, Automation>;\n\tblockDocumentsMap: Map<string, BlockDocument>;\n\tdeploymentsMap: Map<string, Deployment>;\n\tworkPoolsMap: Map<string, WorkPool>;\n\tworkQueuesMap: Map<string, WorkQueue>;\n};\nexport const ActionDetails = ({\n\taction,\n\tautomationsMap,\n\tblockDocumentsMap,\n\tdeploymentsMap,\n\tworkPoolsMap,\n\tworkQueuesMap,\n}: ActionDetailsProps) => (\n\t<Card className=\"p-4\">\n\t\t<ActionDetailsType\n\t\t\taction={action}\n\t\t\tautomationsMap={automationsMap}\n\t\t\tblockDocumentsMap={blockDocumentsMap}\n\t\t\tdeploymentsMap={deploymentsMap}\n\t\t\tworkPoolsMap={workPoolsMap}\n\t\t\tworkQueuesMap={workQueuesMap}\n\t\t/>\n\t</Card>\n);\n\nconst ActionDetailsType = ({\n\taction,\n\tautomationsMap,\n\tblockDocumentsMap,\n\tdeploymentsMap,\n\tworkPoolsMap,\n\tworkQueuesMap,\n}: ActionDetailsProps) => {\n\tconst label = ACTION_TYPE_TO_STRING[action.type];\n\tswitch (action.type) {\n\t\t// Non-inferrable Actions\n\t\tcase \"cancel-flow-run\":\n\t\tcase \"suspend-flow-run\":\n\t\tcase \"resume-flow-run\":\n\t\tcase \"do-nothing\":\n\t\t\treturn <NoninferredAction label={label} />;\n\t\t// Inferable actions\n\t\tcase \"run-deployment\":\n\t\t\tif (action.deployment_id && action.source === \"selected\") {\n\t\t\t\tconst deployment = deploymentsMap.get(action.deployment_id);\n\t\t\t\tif (!deployment) {\n\t\t\t\t\treturn <Typography>Deployment not found</Typography>;\n\t\t\t\t}\n\t\t\t\treturn (\n\t\t\t\t\t<DeploymentActionDetails\n\t\t\t\t\t\tlabel={label}\n\t\t\t\t\t\tdeployment={deployment}\n\t\t\t\t\t\tparameters={action.parameters}\n\t\t\t\t\t\tjob_variables={action.job_variables}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn <InferredAction label={label} />;\n\t\tcase \"pause-deployment\":\n\t\tcase \"resume-deployment\":\n\t\t\tif (action.deployment_id && action.source === \"selected\") {\n\t\t\t\tconst deployment = deploymentsMap.get(action.deployment_id);\n\t\t\t\tif (!deployment) {\n\t\t\t\t\treturn <Typography>Deployment not found</Typography>;\n\t\t\t\t}\n\t\t\t\treturn (\n\t\t\t\t\t<DeploymentActionDetails label={label} deployment={deployment} />\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn <InferredAction label={label} />;\n\t\tcase \"pause-work-queue\":\n\t\tcase \"resume-work-queue\":\n\t\t\tif (action.work_queue_id && action.source === \"selected\") {\n\t\t\t\tconst workQueue = workQueuesMap.get(action.work_queue_id);\n\t\t\t\tif (!workQueue) {\n\t\t\t\t\treturn <Typography>Work queue not found</Typography>;\n\t\t\t\t}\n\t\t\t\treturn <WorkQueueActionDetails label={label} workQueue={workQueue} />;\n\t\t\t}\n\t\t\treturn <InferredAction label={label} />;\n\t\tcase \"pause-automation\":\n\t\tcase \"resume-automation\":\n\t\t\tif (action.automation_id && action.source === \"selected\") {\n\t\t\t\tconst automation = automationsMap.get(action.automation_id);\n\t\t\t\tif (!automation) {\n\t\t\t\t\treturn <Typography>Automation not found</Typography>;\n\t\t\t\t}\n\t\t\t\treturn (\n\t\t\t\t\t<AutomationActionDetails label={label} automation={automation} />\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn <InferredAction label={label} />;\n\t\tcase \"pause-work-pool\":\n\t\tcase \"resume-work-pool\":\n\t\t\tif (action.work_pool_id && action.source === \"selected\") {\n\t\t\t\tconst workPool = workPoolsMap.get(action.work_pool_id);\n\t\t\t\tif (!workPool) {\n\t\t\t\t\treturn <Typography>Workpool not found</Typography>;\n\t\t\t\t}\n\t\t\t\treturn <WorkPoolActionDetails label={label} workPool={workPool} />;\n\t\t\t}\n\t\t\treturn <InferredAction label={label} />;\n\t\t// Other actions\n\t\tcase \"send-notification\": {\n\t\t\tconst blockDocument = blockDocumentsMap.get(action.block_document_id);\n\t\t\tif (!blockDocument) {\n\t\t\t\treturn <Typography>Block document not found</Typography>;\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<BlockDocumentActionDetails\n\t\t\t\t\tlabel={label}\n\t\t\t\t\tblockDocument={blockDocument}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tcase \"call-webhook\": {\n\t\t\tconst blockDocument = blockDocumentsMap.get(action.block_document_id);\n\t\t\tif (!blockDocument) {\n\t\t\t\treturn <Typography>Block document not found</Typography>;\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<CallWebhookActionDetails label={label} blockDocument={blockDocument} />\n\t\t\t);\n\t\t}\n\t\tcase \"change-flow-run-state\":\n\t\t\treturn (\n\t\t\t\t<ChangeFlowRunStateActionDetails\n\t\t\t\t\tlabel={label}\n\t\t\t\t\ttype={action.state}\n\t\t\t\t\tname={action.name}\n\t\t\t\t/>\n\t\t\t);\n\t\tdefault:\n\t\t\treturn null;\n\t}\n};\n\nconst ActionResource = ({ children }: { children: React.ReactNode }) => (\n\t<div className=\"text-sm flex items-center gap-1\">{children}</div>\n);\n\nconst ActionResourceName = ({\n\ticonId,\n\tname,\n}: {\n\tname: string;\n\ticonId: IconId;\n}) => (\n\t<div className=\"text-xs flex items-center\">\n\t\t<Icon id={iconId} className=\"size-4 mr-1\" />\n\t\t{name}\n\t</div>\n);\n\nconst NoninferredAction = ({ label }: { label: ActionLabel }) => (\n\t<Typography variant=\"bodySmall\">{label} from the triggering event</Typography>\n);\n\nconst InferredAction = ({ label }: { label: ActionLabel }) => (\n\t<Typography variant=\"bodySmall\">\n\t\t{label} inferred from the triggering event\n\t</Typography>\n);\n\ntype ChangeFlowRunStateActionDetailsProps = {\n\tlabel: ActionLabel;\n\ttype: components[\"schemas\"][\"StateType\"];\n\tname?: string | null;\n};\n\nexport const ChangeFlowRunStateActionDetails = ({\n\tlabel,\n\ttype,\n\tname,\n}: ChangeFlowRunStateActionDetailsProps) => {\n\treturn (\n\t\t<ActionResource>\n\t\t\t<InferredAction label={label} /> to <StateBadge type={type} name={name} />\n\t\t</ActionResource>\n\t);\n};\n\n// Selected resources\ntype DeploymentActionDetailsProps = {\n\tlabel: ActionLabel;\n\tdeployment: Deployment;\n\tparameters?: Record<string, unknown> | null;\n\tjob_variables?: Record<string, unknown> | null;\n};\nexport const DeploymentActionDetails = ({\n\tlabel,\n\tdeployment,\n\tparameters,\n\tjob_variables,\n}: DeploymentActionDetailsProps) => {\n\treturn (\n\t\t<ActionResource>\n\t\t\t<label htmlFor={`${label}-${deployment.id}`}>{label}:</label>\n\t\t\t<Link\n\t\t\t\tto=\"/deployments/deployment/$id\"\n\t\t\t\tparams={{ id: deployment.id }}\n\t\t\t\taria-label={deployment.name}\n\t\t\t>\n\t\t\t\t<ActionResourceName iconId=\"Rocket\" name={deployment.name} />\n\t\t\t</Link>\n\t\t\t{parameters !== undefined && (\n\t\t\t\t<RunDeploymentJsonDialog title=\"Parameters\" payload={parameters} />\n\t\t\t)}\n\t\t\t{job_variables !== undefined && (\n\t\t\t\t<RunDeploymentJsonDialog\n\t\t\t\t\ttitle=\"Job Variables\"\n\t\t\t\t\tpayload={job_variables}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</ActionResource>\n\t);\n};\n\ntype RunDeploymentJsonDialogProps = {\n\ttitle: string;\n\tpayload: Record<string, unknown> | null | undefined;\n};\n\nconst RunDeploymentJsonDialog = ({\n\ttitle,\n\tpayload,\n}: RunDeploymentJsonDialogProps) => {\n\treturn (\n\t\t<Dialog>\n\t\t\t<DialogTrigger asChild>\n\t\t\t\t<Button variant=\"secondary\" size=\"sm\">\n\t\t\t\t\tShow {capitalize(title)}\n\t\t\t\t</Button>\n\t\t\t</DialogTrigger>\n\t\t\t<DialogContent aria-describedby={undefined}>\n\t\t\t\t<DialogHeader>\n\t\t\t\t\t<DialogTitle>{title}</DialogTitle>\n\t\t\t\t</DialogHeader>\n\t\t\t\t<JsonInput value={JSON.stringify(payload)} disabled />\n\t\t\t</DialogContent>\n\t\t</Dialog>\n\t);\n};\n\ntype AutomationActionDetailsProps = {\n\tlabel: ActionLabel;\n\tautomation: Automation;\n};\nexport const AutomationActionDetails = ({\n\tlabel,\n\tautomation,\n}: AutomationActionDetailsProps) => {\n\treturn (\n\t\t<ActionResource>\n\t\t\t<label htmlFor={`${label}-${automation.id}`}>{label}:</label>\n\t\t\t<Link\n\t\t\t\tto=\"/automations/automation/$id\"\n\t\t\t\tparams={{ id: automation.id }}\n\t\t\t\taria-label={automation.name}\n\t\t\t>\n\t\t\t\t<ActionResourceName iconId=\"Bot\" name={automation.name} />\n\t\t\t</Link>\n\t\t</ActionResource>\n\t);\n};\n\ntype BlockDocumentActionDetailsProps = {\n\tlabel: ActionLabel;\n\tblockDocument: BlockDocument;\n};\nexport const BlockDocumentActionDetails = ({\n\tlabel,\n\tblockDocument,\n}: BlockDocumentActionDetailsProps) => {\n\tif (!blockDocument.name) {\n\t\treturn <Typography>Block not found</Typography>;\n\t}\n\n\tconst _label = blockDocument.block_type_name\n\t\t? `Send a ${blockDocument.block_type_name.toLowerCase()} using`\n\t\t: label;\n\n\treturn (\n\t\t<ActionResource>\n\t\t\t<label htmlFor={`${label}-${blockDocument.id}`}>{_label}</label>\n\t\t\t<Link\n\t\t\t\tto=\"/blocks/block/$id\"\n\t\t\t\tparams={{ id: blockDocument.id }}\n\t\t\t\taria-label={blockDocument.name}\n\t\t\t>\n\t\t\t\t<ActionResourceName iconId=\"Box\" name={blockDocument.name} />\n\t\t\t</Link>\n\t\t</ActionResource>\n\t);\n};\n\ntype CallWebhookActionDetailsProps = {\n\tlabel: ActionLabel;\n\tblockDocument: BlockDocument;\n};\nexport const CallWebhookActionDetails = ({\n\tlabel,\n\tblockDocument,\n}: CallWebhookActionDetailsProps) => {\n\tif (!blockDocument.name) {\n\t\treturn <Typography>Block not found</Typography>;\n\t}\n\n\treturn (\n\t\t<ActionResource>\n\t\t\t<label htmlFor={`${label}-${blockDocument.id}`}>{label}</label>\n\t\t\t<Link\n\t\t\t\tto=\"/blocks/block/$id\"\n\t\t\t\tparams={{ id: blockDocument.id }}\n\t\t\t\taria-label={blockDocument.name}\n\t\t\t>\n\t\t\t\t<ActionResourceName iconId=\"Box\" name={blockDocument.name} />\n\t\t\t</Link>\n\t\t</ActionResource>\n\t);\n};\n\ntype WorkPoolActionDetailsProps = {\n\tlabel: ActionLabel;\n\tworkPool: WorkPool;\n};\nexport const WorkPoolActionDetails = ({\n\tlabel,\n\tworkPool,\n}: WorkPoolActionDetailsProps) => {\n\treturn (\n\t\t<ActionResource>\n\t\t\t<label htmlFor={`${label}-${workPool.id}`}>{label}:</label>\n\t\t\t<Link\n\t\t\t\tto=\"/work-pools/work-pool/$workPoolName\"\n\t\t\t\tparams={{ workPoolName: workPool.name }}\n\t\t\t\taria-label={workPool.name}\n\t\t\t>\n\t\t\t\t<ActionResourceName iconId=\"Cpu\" name={workPool.name} />\n\t\t\t</Link>\n\t\t</ActionResource>\n\t);\n};\n\ntype WorkQueueActionDetailsProps = {\n\tlabel: ActionLabel;\n\tworkQueue: WorkQueue;\n};\nexport const WorkQueueActionDetails = ({\n\tlabel,\n\tworkQueue,\n}: WorkQueueActionDetailsProps) => {\n\treturn (\n\t\t<ActionResource>\n\t\t\t<label htmlFor={`${label}-${workQueue.id}`}>{label}:</label>\n\t\t\t<Link\n\t\t\t\tto=\"/work-pools/work-pool/$workPoolName/queue/$workQueueName\"\n\t\t\t\tparams={{\n\t\t\t\t\tworkPoolName: workQueue.name,\n\t\t\t\t\tworkQueueName: workQueue.name,\n\t\t\t\t}}\n\t\t\t\taria-label={workQueue.name}\n\t\t\t>\n\t\t\t\t<ActionResourceName iconId=\"Cpu\" name={workQueue.name} />\n\t\t\t</Link>\n\t\t</ActionResource>\n\t);\n};\n","import { Typography } from \"@/components/ui/typography\";\nimport type { CompoundTrigger } from \"./trigger-utils\";\n\ntype TriggerDetailsCompoundProps = {\n\ttrigger: CompoundTrigger;\n};\n\nexport const TriggerDetailsCompound = ({\n\ttrigger,\n}: TriggerDetailsCompoundProps) => {\n\tconst triggerCount = trigger.triggers?.length ?? 0;\n\tconst requireValue = trigger.require;\n\n\tlet requireLabel: string;\n\tif (requireValue === \"all\") {\n\t\trequireLabel = \"all\";\n\t} else if (requireValue === \"any\") {\n\t\trequireLabel = \"any\";\n\t} else if (typeof requireValue === \"number\") {\n\t\trequireLabel = `at least ${requireValue}`;\n\t} else {\n\t\trequireLabel = \"all\";\n\t}\n\n\treturn (\n\t\t<div className=\"flex flex-wrap gap-1 items-center\">\n\t\t\t<Typography variant=\"bodySmall\">\n\t\t\t\tA compound trigger requiring {requireLabel} of {triggerCount} nested{\" \"}\n\t\t\t\t{triggerCount === 1 ? \"trigger\" : \"triggers\"} to fire\n\t\t\t</Typography>\n\t\t</div>\n\t);\n};\n","import { Typography } from \"@/components/ui/typography\";\n\nexport const TriggerDetailsCustom = () => {\n\treturn <Typography variant=\"bodySmall\">A custom trigger</Typography>;\n};\n","import { useSuspenseQuery } from \"@tanstack/react-query\";\nimport { Link } from \"@tanstack/react-router\";\nimport { Suspense } from \"react\";\nimport { buildDeploymentDetailsQuery } from \"@/api/deployments\";\nimport { Icon } from \"@/components/ui/icons\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\ntype DeploymentLinkProps = {\n\tdeploymentId: string;\n};\n\nexport const DeploymentLink = ({ deploymentId }: DeploymentLinkProps) => {\n\treturn (\n\t\t<Suspense fallback={<Skeleton className=\"h-4 w-full\" />}>\n\t\t\t<DeploymentLinkImplementation deploymentId={deploymentId} />\n\t\t</Suspense>\n\t);\n};\n\nconst DeploymentLinkImplementation = ({\n\tdeploymentId,\n}: DeploymentLinkProps) => {\n\tconst { data: deployment } = useSuspenseQuery(\n\t\tbuildDeploymentDetailsQuery(deploymentId),\n\t);\n\n\treturn (\n\t\t<div className=\"flex items-center gap-1 text-xs\">\n\t\t\tDeployment\n\t\t\t<Link\n\t\t\t\tto=\"/deployments/deployment/$id\"\n\t\t\t\tparams={{ id: deployment.id }}\n\t\t\t\tclassName=\"flex items-center gap-1\"\n\t\t\t>\n\t\t\t\t<Icon id=\"Rocket\" className=\"size-4\" />\n\t\t\t\t{deployment.name}\n\t\t\t</Link>\n\t\t</div>\n\t);\n};\n","import type { components } from \"@/api/prefect\";\n\n// Type aliases for OpenAPI schema types\nexport type EventTrigger = components[\"schemas\"][\"EventTrigger\"];\nexport type CompoundTrigger = components[\"schemas\"][\"CompoundTrigger-Input\"];\nexport type SequenceTrigger = components[\"schemas\"][\"SequenceTrigger-Input\"];\n\n// Union type for all automation triggers\nexport type AutomationTrigger =\n\t| EventTrigger\n\t| CompoundTrigger\n\t| SequenceTrigger;\n\n// Template constants - following Vue implementation (5 templates)\nexport const AUTOMATION_TRIGGER_TEMPLATES = [\n\t\"deployment-status\",\n\t\"flow-run-state\",\n\t\"work-pool-status\",\n\t\"work-queue-status\",\n\t\"custom\",\n] as const;\n\nexport type AutomationTriggerTemplate =\n\t(typeof AUTOMATION_TRIGGER_TEMPLATES)[number];\n\n// Event posture types\nexport type AutomationTriggerEventPosture = \"Reactive\" | \"Proactive\";\n\n// Default threshold for event triggers (from Vue implementation)\nexport const DEFAULT_EVENT_TRIGGER_THRESHOLD = 1;\n\n// Event constants for each template type\nexport const DEPLOYMENT_STATUS_EVENTS = [\n\t\"prefect.deployment.ready\",\n\t\"prefect.deployment.not-ready\",\n\t\"prefect.deployment.disabled\",\n] as const;\n\nexport const WORK_POOL_STATUS_EVENTS = [\n\t\"prefect.work-pool.ready\",\n\t\"prefect.work-pool.not-ready\",\n\t\"prefect.work-pool.paused\",\n\t\"prefect.work-pool.not_ready\",\n] as const;\n\nexport const WORK_QUEUE_STATUS_EVENTS = [\n\t\"prefect.work-queue.ready\",\n\t\"prefect.work-queue.not-ready\",\n\t\"prefect.work-queue.paused\",\n] as const;\n\n// Type guard helper - check if value is a record/object\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n\treturn typeof value === \"object\" && value !== null && !Array.isArray(value);\n}\n\n// Primary type guards for trigger types\nexport function isEventTrigger(trigger: unknown): trigger is EventTrigger {\n\treturn (\n\t\tisRecord(trigger) &&\n\t\ttrigger.type === \"event\" &&\n\t\t(trigger.posture === \"Reactive\" || trigger.posture === \"Proactive\")\n\t);\n}\n\nexport function isCompoundTrigger(\n\ttrigger: unknown,\n): trigger is CompoundTrigger {\n\treturn (\n\t\tisRecord(trigger) &&\n\t\ttrigger.type === \"compound\" &&\n\t\tArray.isArray(trigger.triggers)\n\t);\n}\n\nexport function isSequenceTrigger(\n\ttrigger: unknown,\n): trigger is SequenceTrigger {\n\treturn (\n\t\tisRecord(trigger) &&\n\t\ttrigger.type === \"sequence\" &&\n\t\tArray.isArray(trigger.triggers)\n\t);\n}\n\nexport function isAutomationTrigger(\n\ttrigger: unknown,\n): trigger is AutomationTrigger {\n\treturn (\n\t\tisEventTrigger(trigger) ||\n\t\tisCompoundTrigger(trigger) ||\n\t\tisSequenceTrigger(trigger)\n\t);\n}\n\n// Helper to convert value to array (handles undefined, single value, or array)\nfunction asArray<T>(value: T | T[] | undefined | null): T[] {\n\tif (value === undefined || value === null) {\n\t\treturn [];\n\t}\n\treturn Array.isArray(value) ? value : [value];\n}\n\n// Get match value from trigger (handles snake_case field names from OpenAPI)\nfunction getTriggerMatchValue(\n\ttrigger: AutomationTrigger,\n\tkey: string,\n): string[] {\n\tif (isEventTrigger(trigger)) {\n\t\tconst match = trigger.match;\n\t\tif (match && typeof match === \"object\") {\n\t\t\tconst value = (match as Record<string, unknown>)[key];\n\t\t\treturn value ? asArray(value as string | string[]) : [];\n\t\t}\n\t}\n\treturn [];\n}\n\n// Validation helper: check if match resource satisfies predicate\nexport function isMatchResource(\n\ttrigger: AutomationTrigger,\n\tpredicate: (resourceIds: string[]) => boolean,\n): boolean {\n\tconst prefectResourceIds = getTriggerMatchValue(\n\t\ttrigger,\n\t\t\"prefect.resource.id\",\n\t);\n\n\tif (prefectResourceIds.length === 0) {\n\t\treturn false;\n\t}\n\n\treturn predicate(prefectResourceIds);\n}\n\n// Validation helper: check if for_each contains the expected resource\nexport function isForEachResource(\n\ttrigger: AutomationTrigger,\n\tresource: string,\n): boolean {\n\tif (isEventTrigger(trigger)) {\n\t\tconst forEach = trigger.for_each ?? [];\n\t\treturn forEach.every((value) => value.startsWith(resource));\n\t}\n\treturn false;\n}\n\n// Validation helper: check if after events satisfy predicate\nexport function isAfterResource(\n\ttrigger: AutomationTrigger,\n\tpredicate: (events: string[]) => boolean,\n): boolean {\n\tif (isEventTrigger(trigger)) {\n\t\treturn predicate(trigger.after ?? []);\n\t}\n\treturn false;\n}\n\n// Validation helper: check if expect events satisfy predicate\nexport function isExpectResource(\n\ttrigger: AutomationTrigger,\n\tpredicate: (events: string[]) => boolean,\n): boolean {\n\tif (isEventTrigger(trigger)) {\n\t\treturn predicate(trigger.expect ?? []);\n\t}\n\treturn false;\n}\n\n// Event type checkers\nfunction isDeploymentStatusEvent(event: string): boolean {\n\treturn (DEPLOYMENT_STATUS_EVENTS as readonly string[]).includes(event);\n}\n\nfunction isWorkPoolStatusEvent(event: string): boolean {\n\treturn (WORK_POOL_STATUS_EVENTS as readonly string[]).includes(event);\n}\n\nfunction isWorkQueueStatusEvent(event: string): boolean {\n\treturn (WORK_QUEUE_STATUS_EVENTS as readonly string[]).includes(event);\n}\n\n// Template-specific type guards\n\n/**\n * Check if trigger is a deployment-status template\n * Validates:\n * - Is an event trigger\n * - match['prefect.resource.id'] starts with 'prefect.deployment'\n * - for_each contains 'prefect.resource.id'\n * - after events are deployment status events\n * - expect events are deployment status events\n * - threshold === 1\n */\nexport function isDeploymentStatusTrigger(trigger: unknown): boolean {\n\treturn (\n\t\tisEventTrigger(trigger) &&\n\t\tisMatchResource(trigger, (prefectResourceIds) =>\n\t\t\tprefectResourceIds.every((value) =>\n\t\t\t\tvalue.startsWith(\"prefect.deployment\"),\n\t\t\t),\n\t\t) &&\n\t\tisForEachResource(trigger, \"prefect.resource.id\") &&\n\t\tisAfterResource(trigger, (triggerAfters) =>\n\t\t\ttriggerAfters.every((after) => isDeploymentStatusEvent(after)),\n\t\t) &&\n\t\tisExpectResource(trigger, (triggerExpects) =>\n\t\t\ttriggerExpects.every((expect) => isDeploymentStatusEvent(expect)),\n\t\t) &&\n\t\ttrigger.threshold === DEFAULT_EVENT_TRIGGER_THRESHOLD\n\t);\n}\n\n// Helper functions for flow-run-state template validation\nfunction getTriggerMatchRelatedValue(\n\ttrigger: EventTrigger,\n\tkey: string,\n): string[] {\n\tconst matchRelated = trigger.match_related;\n\tif (!matchRelated) {\n\t\treturn [];\n\t}\n\n\t// match_related can be a single object or an array of objects\n\tconst matchRelatedArray = Array.isArray(matchRelated)\n\t\t? matchRelated\n\t\t: [matchRelated];\n\n\tconst values: string[] = [];\n\tfor (const match of matchRelatedArray) {\n\t\tif (match && typeof match === \"object\") {\n\t\t\tconst value = (match as Record<string, unknown>)[key];\n\t\t\tif (value) {\n\t\t\t\tvalues.push(...asArray(value as string | string[]));\n\t\t\t}\n\t\t}\n\t}\n\treturn values;\n}\n\nfunction isEmptyMatchRelated(trigger: EventTrigger): boolean {\n\tconst matchRelated = trigger.match_related;\n\tif (!matchRelated) {\n\t\treturn true;\n\t}\n\tif (Array.isArray(matchRelated)) {\n\t\treturn matchRelated.length === 0;\n\t}\n\treturn Object.keys(matchRelated).length === 0;\n}\n\nfunction isMatchRelatedResource(\n\ttrigger: EventTrigger,\n\tresource: string,\n): boolean {\n\tconst prefectResourceIds = getTriggerMatchRelatedValue(\n\t\ttrigger,\n\t\t\"prefect.resource.id\",\n\t);\n\n\tif (prefectResourceIds.length === 0) {\n\t\treturn false;\n\t}\n\n\treturn prefectResourceIds.every((value) => value.startsWith(resource));\n}\n\nfunction isFlowRunStateTriggerMatchRelated(trigger: EventTrigger): boolean {\n\treturn (\n\t\tisEmptyMatchRelated(trigger) ||\n\t\tisMatchRelatedResource(trigger, \"prefect.flow\") ||\n\t\tisMatchRelatedResource(trigger, \"prefect.tag\")\n\t);\n}\n\n/**\n * Check if trigger is a flow-run-state template\n * Validates:\n * - Is an event trigger\n * - match['prefect.resource.id'] starts with 'prefect.flow-run'\n * - for_each contains 'prefect.resource.id'\n * - after events start with 'prefect.flow-run'\n * - expect events start with 'prefect.flow-run'\n * - matchRelated is empty OR contains flow/tag patterns\n * - threshold === 1\n */\nexport function isFlowRunStateTrigger(trigger: unknown): boolean {\n\treturn (\n\t\tisEventTrigger(trigger) &&\n\t\tisMatchResource(trigger, (prefectResourceIds) =>\n\t\t\tprefectResourceIds.every((value) => value.startsWith(\"prefect.flow-run\")),\n\t\t) &&\n\t\tisForEachResource(trigger, \"prefect.resource.id\") &&\n\t\tisAfterResource(trigger, (triggerAfters) =>\n\t\t\ttriggerAfters.every((after) => after.startsWith(\"prefect.flow-run\")),\n\t\t) &&\n\t\tisExpectResource(trigger, (triggerExpects) =>\n\t\t\ttriggerExpects.every((expect) => expect.startsWith(\"prefect.flow-run\")),\n\t\t) &&\n\t\tisFlowRunStateTriggerMatchRelated(trigger) &&\n\t\ttrigger.threshold === DEFAULT_EVENT_TRIGGER_THRESHOLD\n\t);\n}\n\n/**\n * Check if trigger is a work-pool-status template\n * Validates:\n * - Is an event trigger\n * - match['prefect.resource.id'] starts with 'prefect.work-pool'\n * - for_each contains 'prefect.resource.id'\n * - after events are work pool status events\n * - expect events are work pool status events\n * - threshold === 1\n */\nexport function isWorkPoolStatusTrigger(trigger: unknown): boolean {\n\treturn (\n\t\tisEventTrigger(trigger) &&\n\t\tisMatchResource(trigger, (prefectResourceIds) =>\n\t\t\tprefectResourceIds.every((value) =>\n\t\t\t\tvalue.startsWith(\"prefect.work-pool\"),\n\t\t\t),\n\t\t) &&\n\t\tisForEachResource(trigger, \"prefect.resource.id\") &&\n\t\tisAfterResource(trigger, (triggerAfters) =>\n\t\t\ttriggerAfters.every((after) => isWorkPoolStatusEvent(after)),\n\t\t) &&\n\t\tisExpectResource(trigger, (triggerExpects) =>\n\t\t\ttriggerExpects.every((expect) => isWorkPoolStatusEvent(expect)),\n\t\t) &&\n\t\ttrigger.threshold === DEFAULT_EVENT_TRIGGER_THRESHOLD\n\t);\n}\n\n/**\n * Check if trigger is a work-queue-status template\n * Validates:\n * - Is an event trigger\n * - match['prefect.resource.id'] starts with 'prefect.work-queue'\n * - for_each contains 'prefect.resource.id'\n * - after events are work queue status events\n * - expect events are work queue status events\n * - threshold === 1\n */\nexport function isWorkQueueStatusTrigger(trigger: unknown): boolean {\n\treturn (\n\t\tisEventTrigger(trigger) &&\n\t\tisMatchResource(trigger, (prefectResourceIds) =>\n\t\t\tprefectResourceIds.every((value) =>\n\t\t\t\tvalue.startsWith(\"prefect.work-queue\"),\n\t\t\t),\n\t\t) &&\n\t\tisForEachResource(trigger, \"prefect.resource.id\") &&\n\t\tisAfterResource(trigger, (triggerAfters) =>\n\t\t\ttriggerAfters.every((after) => isWorkQueueStatusEvent(after)),\n\t\t) &&\n\t\tisExpectResource(trigger, (triggerExpects) =>\n\t\t\ttriggerExpects.every((expect) => isWorkQueueStatusEvent(expect)),\n\t\t) &&\n\t\ttrigger.threshold === DEFAULT_EVENT_TRIGGER_THRESHOLD\n\t);\n}\n\n// Template check registry (excluding 'custom' which is the default)\nconst automationTriggerTemplateChecks: Record<\n\tExclude<AutomationTriggerTemplate, \"custom\">,\n\t(trigger: unknown) => boolean\n> = {\n\t\"deployment-status\": isDeploymentStatusTrigger,\n\t\"flow-run-state\": isFlowRunStateTrigger,\n\t\"work-pool-status\": isWorkPoolStatusTrigger,\n\t\"work-queue-status\": isWorkQueueStatusTrigger,\n};\n\n/**\n * Detect the template type of an automation trigger\n * Returns 'custom' if no template matches\n */\nexport function getAutomationTriggerTemplate(\n\ttrigger: AutomationTrigger,\n): AutomationTriggerTemplate {\n\tfor (const [type, guard] of Object.entries(automationTriggerTemplateChecks)) {\n\t\tif (guard(trigger)) {\n\t\t\treturn type as AutomationTriggerTemplate;\n\t\t}\n\t}\n\n\treturn \"custom\";\n}\n\n// Template labels\nconst automationTriggerTemplateLabels: Record<\n\tAutomationTriggerTemplate,\n\tstring\n> = {\n\t\"deployment-status\": \"Deployment status\",\n\t\"flow-run-state\": \"Flow run state\",\n\t\"work-pool-status\": \"Work pool status\",\n\t\"work-queue-status\": \"Work queue status\",\n\tcustom: \"Custom\",\n};\n\n/**\n * Get human-readable label for a trigger template\n */\nexport function getAutomationTriggerTemplateLabel(\n\ttemplate: AutomationTriggerTemplate,\n): string {\n\treturn automationTriggerTemplateLabels[template];\n}\n\n/**\n * Get human-readable label for event posture\n * \"Reactive\" -> \"enters\"\n * \"Proactive\" -> \"stays in\"\n */\nexport function getAutomationTriggerEventPostureLabel(\n\tposture: AutomationTriggerEventPosture,\n): string {\n\tswitch (posture) {\n\t\tcase \"Reactive\":\n\t\t\treturn \"enters\";\n\t\tcase \"Proactive\":\n\t\t\treturn \"stays in\";\n\t}\n}\n\n/**\n * Check if a string is a valid automation trigger template\n */\nexport function isAutomationTriggerTemplate(\n\tvalue: string,\n): value is AutomationTriggerTemplate {\n\treturn (AUTOMATION_TRIGGER_TEMPLATES as readonly string[]).includes(value);\n}\n\n// Work queue status types and labels\nexport type WorkQueueStatusTriggerStatus = \"READY\" | \"NOT_READY\" | \"PAUSED\";\n\n/**\n * Get human-readable label for work queue status\n * \"READY\" -> \"Ready\"\n * \"NOT_READY\" -> \"Not Ready\"\n * \"PAUSED\" -> \"Paused\"\n */\nexport function getWorkQueueStatusLabel(\n\tstatus: WorkQueueStatusTriggerStatus,\n): string {\n\tswitch (status) {\n\t\tcase \"READY\":\n\t\t\treturn \"Ready\";\n\t\tcase \"NOT_READY\":\n\t\t\treturn \"Not Ready\";\n\t\tcase \"PAUSED\":\n\t\t\treturn \"Paused\";\n\t\tdefault: {\n\t\t\tconst exhaustive: never = status;\n\t\t\tthrow new Error(\n\t\t\t\t`getWorkQueueStatusLabel missing case for ${exhaustive as string}`,\n\t\t\t);\n\t\t}\n\t}\n}\n","import { DeploymentLink } from \"@/components/deployments/deployment-link\";\nimport { secondsToString } from \"@/utils/seconds\";\nimport {\n\ttype AutomationTriggerEventPosture,\n\tgetAutomationTriggerEventPostureLabel,\n} from \"./trigger-utils\";\n\ntype DeploymentStatus = \"ready\" | \"not_ready\";\n\ntype TriggerDetailsDeploymentStatusProps = {\n\tdeploymentIds: string[];\n\tposture: AutomationTriggerEventPosture;\n\tstatus: DeploymentStatus;\n\ttime?: number;\n};\n\nfunction getDeploymentStatusLabel(status: DeploymentStatus): string {\n\tswitch (status) {\n\t\tcase \"ready\":\n\t\t\treturn \"ready\";\n\t\tcase \"not_ready\":\n\t\t\treturn \"not ready\";\n\t}\n}\n\nexport const TriggerDetailsDeploymentStatus = ({\n\tdeploymentIds,\n\tposture,\n\tstatus,\n\ttime,\n}: TriggerDetailsDeploymentStatusProps) => {\n\tconst isAnyDeployment = deploymentIds.length === 0;\n\tconst postureLabel = getAutomationTriggerEventPostureLabel(posture);\n\tconst statusLabel = getDeploymentStatusLabel(status);\n\n\treturn (\n\t\t<div className=\"flex flex-wrap gap-1 items-center\">\n\t\t\t<span>When</span>\n\n\t\t\t{isAnyDeployment ? (\n\t\t\t\t<span>any deployment</span>\n\t\t\t) : (\n\t\t\t\tdeploymentIds.map((deploymentId, index) => (\n\t\t\t\t\t<span key={deploymentId} className=\"flex items-center gap-1\">\n\t\t\t\t\t\t<DeploymentLink deploymentId={deploymentId} />\n\t\t\t\t\t\t{index === deploymentIds.length - 2 && <span>or</span>}\n\t\t\t\t\t</span>\n\t\t\t\t))\n\t\t\t)}\n\n\t\t\t<span>{postureLabel}</span>\n\t\t\t<span>{statusLabel}</span>\n\n\t\t\t{posture === \"Proactive\" && time !== undefined && time > 0 && (\n\t\t\t\t<span>for {secondsToString(time)}</span>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n","import type { components } from \"@/api/prefect\";\nimport { FlowLink } from \"@/components/flows/flow-link\";\nimport { StateBadge } from \"@/components/ui/state-badge\";\nimport { TagBadgeGroup } from \"@/components/ui/tag-badge-group\";\nimport { secondsToApproximateString } from \"@/utils\";\nimport {\n\ttype AutomationTriggerEventPosture,\n\tgetAutomationTriggerEventPostureLabel,\n} from \"./trigger-utils\";\n\ntype StateType = components[\"schemas\"][\"StateType\"];\n\ntype TriggerDetailsFlowRunStateProps = {\n\tflowIds: string[];\n\ttags: string[];\n\tposture: AutomationTriggerEventPosture;\n\tstates: string[];\n\ttime?: number;\n};\n\n/**\n * Maps a state name string to a StateType enum value.\n * Handles various state name formats (e.g., \"Completed\", \"COMPLETED\", \"completed\")\n * and maps them to the uppercase StateType values expected by StateBadge.\n */\nfunction mapStateNameToStateType(stateName: string): StateType | null {\n\tconst normalizedName = stateName.toUpperCase();\n\n\tconst validStateTypes: StateType[] = [\n\t\t\"COMPLETED\",\n\t\t\"FAILED\",\n\t\t\"RUNNING\",\n\t\t\"CANCELLED\",\n\t\t\"CANCELLING\",\n\t\t\"CRASHED\",\n\t\t\"PAUSED\",\n\t\t\"PENDING\",\n\t\t\"SCHEDULED\",\n\t];\n\n\tif (validStateTypes.includes(normalizedName as StateType)) {\n\t\treturn normalizedName as StateType;\n\t}\n\n\treturn null;\n}\n\nexport const TriggerDetailsFlowRunState = ({\n\tflowIds,\n\ttags,\n\tposture,\n\tstates,\n\ttime,\n}: TriggerDetailsFlowRunStateProps) => {\n\tconst postureLabel = getAutomationTriggerEventPostureLabel(posture);\n\n\treturn (\n\t\t<div className=\"flex flex-wrap gap-1 items-center\">\n\t\t\t<span>When any flow run</span>\n\n\t\t\t{flowIds.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<span>of flow</span>\n\t\t\t\t\t{flowIds.map((flowId, index) => (\n\t\t\t\t\t\t<span key={flowId} className=\"flex items-center gap-1\">\n\t\t\t\t\t\t\t<FlowLink flowId={flowId} />\n\t\t\t\t\t\t\t{index === flowIds.length - 2 && <span>or</span>}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t))}\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{tags.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<span>with the tag</span>\n\t\t\t\t\t<TagBadgeGroup tags={tags} />\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t<span>{postureLabel}</span>\n\n\t\t\t{states.length > 0 ? (\n\t\t\t\tstates.map((state) => {\n\t\t\t\t\tconst stateType = mapStateNameToStateType(state);\n\t\t\t\t\tif (stateType) {\n\t\t\t\t\t\treturn <StateBadge key={state} type={stateType} />;\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t})\n\t\t\t) : (\n\t\t\t\t<span>any state</span>\n\t\t\t)}\n\n\t\t\t{posture === \"Proactive\" && time !== undefined && time > 0 && (\n\t\t\t\t<span>for {secondsToApproximateString(time)}</span>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n","import { Typography } from \"@/components/ui/typography\";\nimport type { SequenceTrigger } from \"./trigger-utils\";\n\ntype TriggerDetailsSequenceProps = {\n\ttrigger: SequenceTrigger;\n};\n\nexport const TriggerDetailsSequence = ({\n\ttrigger,\n}: TriggerDetailsSequenceProps) => {\n\tconst triggerCount = trigger.triggers?.length ?? 0;\n\n\treturn (\n\t\t<div className=\"flex flex-wrap gap-1 items-center\">\n\t\t\t<Typography variant=\"bodySmall\">\n\t\t\t\tA sequence trigger with {triggerCount} nested{\" \"}\n\t\t\t\t{triggerCount === 1 ? \"trigger\" : \"triggers\"} that must fire in order\n\t\t\t</Typography>\n\t\t</div>\n\t);\n};\n","import { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"@tanstack/react-router\";\nimport { buildFilterWorkPoolsQuery, type WorkPool } from \"@/api/work-pools\";\nimport { Icon } from \"@/components/ui/icons\";\nimport { pluralize } from \"@/utils\";\nimport { secondsToString } from \"@/utils/seconds\";\nimport type { AutomationTriggerEventPosture } from \"./trigger-utils\";\n\ntype WorkPoolStatusType = \"READY\" | \"NOT_READY\" | \"PAUSED\";\n\nexport type TriggerDetailsWorkPoolStatusProps = {\n\tworkPoolIds: string[];\n\tposture: AutomationTriggerEventPosture;\n\tstatus: WorkPoolStatusType;\n\ttime?: number;\n};\n\nconst getStatusLabel = (status: WorkPoolStatusType): string => {\n\tswitch (status) {\n\t\tcase \"READY\":\n\t\t\treturn \"Ready\";\n\t\tcase \"NOT_READY\":\n\t\t\treturn \"Not Ready\";\n\t\tcase \"PAUSED\":\n\t\t\treturn \"Paused\";\n\t}\n};\n\nconst WorkPoolLinkInline = ({ workPoolName }: { workPoolName: string }) => {\n\treturn (\n\t\t<Link\n\t\t\tto=\"/work-pools/work-pool/$workPoolName\"\n\t\t\tparams={{ workPoolName }}\n\t\t\tclassName=\"inline-flex items-center gap-1\"\n\t\t>\n\t\t\t<Icon id=\"Cpu\" className=\"size-4\" />\n\t\t\t{workPoolName}\n\t\t</Link>\n\t);\n};\n\nconst renderWorkPoolLinks = (workPools: WorkPool[]) => {\n\tif (workPools.length === 0) {\n\t\treturn null;\n\t}\n\n\treturn workPools.map((workPool, index) => (\n\t\t<span key={workPool.id} className=\"inline-flex items-center gap-1\">\n\t\t\t<WorkPoolLinkInline workPoolName={workPool.name} />\n\t\t\t{index === workPools.length - 2 && \" or \"}\n\t\t\t{index < workPools.length - 2 && \", \"}\n\t\t</span>\n\t));\n};\n\nexport const TriggerDetailsWorkPoolStatus = ({\n\tworkPoolIds,\n\tposture,\n\tstatus,\n\ttime,\n}: TriggerDetailsWorkPoolStatusProps) => {\n\tconst { data: workPools = [] } = useQuery(\n\t\tbuildFilterWorkPoolsQuery(\n\t\t\t{\n\t\t\t\toffset: 0,\n\t\t\t\twork_pools: { id: { any_: workPoolIds }, operator: \"and_\" },\n\t\t\t},\n\t\t\t{ enabled: workPoolIds.length > 0 },\n\t\t),\n\t);\n\n\tconst postureLabel = posture === \"Reactive\" ? \"enters\" : \"stays in\";\n\tconst statusLabel = getStatusLabel(status).toLowerCase();\n\n\tconst workPoolLabel =\n\t\tworkPoolIds.length === 0\n\t\t\t? \"any work pool\"\n\t\t\t: `${pluralize(workPoolIds.length, \"work pool\")} `;\n\n\treturn (\n\t\t<div className=\"flex flex-wrap gap-1 items-center\">\n\t\t\t<span>When</span>\n\t\t\t<span>{workPoolLabel}</span>\n\t\t\t{workPoolIds.length > 0 && renderWorkPoolLinks(workPools)}\n\t\t\t<span>{postureLabel}</span>\n\t\t\t<span>{statusLabel}</span>\n\t\t\t{posture === \"Proactive\" && time !== undefined && (\n\t\t\t\t<span>for {secondsToString(time)}</span>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n","import { useSuspenseQueries } from \"@tanstack/react-query\";\nimport { Suspense } from \"react\";\nimport { buildGetWorkQueueQuery } from \"@/api/work-queues\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { WorkPoolLink } from \"@/components/work-pools/work-pool-link\";\nimport { WorkQueueIconText } from \"@/components/work-pools/work-queue-icon-text\";\nimport { pluralize } from \"@/utils\";\nimport { secondsToString } from \"@/utils/seconds\";\nimport {\n\ttype AutomationTriggerEventPosture,\n\tgetAutomationTriggerEventPostureLabel,\n\tgetWorkQueueStatusLabel,\n\ttype WorkQueueStatusTriggerStatus,\n} from \"./trigger-utils\";\n\nexport type TriggerDetailsWorkQueueStatusProps = {\n\tworkQueueIds: string[];\n\tworkPoolNames: string[];\n\tposture: AutomationTriggerEventPosture;\n\tstatus: WorkQueueStatusTriggerStatus;\n\ttime?: number;\n};\n\nexport const TriggerDetailsWorkQueueStatus = (\n\tprops: TriggerDetailsWorkQueueStatusProps,\n) => {\n\treturn (\n\t\t<Suspense fallback={<Skeleton className=\"h-4 w-full\" />}>\n\t\t\t<TriggerDetailsWorkQueueStatusImplementation {...props} />\n\t\t</Suspense>\n\t);\n};\n\nconst TriggerDetailsWorkQueueStatusImplementation = ({\n\tworkQueueIds,\n\tworkPoolNames,\n\tposture,\n\tstatus,\n\ttime,\n}: TriggerDetailsWorkQueueStatusProps) => {\n\tconst anyWorkQueue = workQueueIds.length === 0;\n\tconst anyWorkPool = workPoolNames.length === 0;\n\n\tconst workQueueQueries = useSuspenseQueries({\n\t\tqueries: workQueueIds.map((id) => buildGetWorkQueueQuery(id)),\n\t});\n\n\tconst workQueues = workQueueQueries.map((query) => query.data);\n\n\treturn (\n\t\t<div className=\"flex flex-wrap gap-1 items-center text-sm\">\n\t\t\t<span>When</span>\n\n\t\t\t{anyWorkQueue ? (\n\t\t\t\t<span>any work queue</span>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t<span>{pluralize(workQueues.length, \"work queue\")}</span>\n\t\t\t\t\t{workQueues.map((workQueue, index) => (\n\t\t\t\t\t\t<span key={workQueue.id} className=\"flex items-center gap-1\">\n\t\t\t\t\t\t\t<WorkQueueIconText\n\t\t\t\t\t\t\t\tworkPoolName={workQueue.work_pool_name ?? \"\"}\n\t\t\t\t\t\t\t\tworkQueueName={workQueue.name}\n\t\t\t\t\t\t\t\tshowLabel\n\t\t\t\t\t\t\t\tshowStatus\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{index === workQueues.length - 2 && <span>or</span>}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t))}\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{!anyWorkPool && (\n\t\t\t\t<>\n\t\t\t\t\t<span>from the {pluralize(workPoolNames.length, \"work pool\")}</span>\n\t\t\t\t\t{workPoolNames.map((workPoolName, index) => (\n\t\t\t\t\t\t<span key={workPoolName} className=\"flex items-center gap-1\">\n\t\t\t\t\t\t\t<WorkPoolLink workPoolName={workPoolName} />\n\t\t\t\t\t\t\t{index === workPoolNames.length - 2 && <span>or</span>}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t))}\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t<span>{getAutomationTriggerEventPostureLabel(posture)}</span>\n\t\t\t<span>{getWorkQueueStatusLabel(status).toLowerCase()}</span>\n\n\t\t\t{posture === \"Proactive\" && time !== undefined && (\n\t\t\t\t<span>for {secondsToString(time)}</span>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n","import { TriggerDetailsCompound } from \"./trigger-details-compound\";\nimport { TriggerDetailsCustom } from \"./trigger-details-custom\";\nimport { TriggerDetailsDeploymentStatus } from \"./trigger-details-deployment-status\";\nimport { TriggerDetailsFlowRunState } from \"./trigger-details-flow-run-state\";\nimport { TriggerDetailsSequence } from \"./trigger-details-sequence\";\nimport { TriggerDetailsWorkPoolStatus } from \"./trigger-details-work-pool-status\";\nimport { TriggerDetailsWorkQueueStatus } from \"./trigger-details-work-queue-status\";\nimport {\n\ttype AutomationTrigger,\n\ttype AutomationTriggerEventPosture,\n\ttype EventTrigger,\n\tgetAutomationTriggerTemplate,\n\tisCompoundTrigger,\n\tisEventTrigger,\n\tisSequenceTrigger,\n\ttype WorkQueueStatusTriggerStatus,\n} from \"./trigger-utils\";\n\ntype TriggerDetailsProps = {\n\ttrigger: AutomationTrigger;\n};\n\ntype DeploymentStatus = \"ready\" | \"not_ready\";\ntype WorkPoolStatusType = \"READY\" | \"NOT_READY\" | \"PAUSED\";\n\nfunction asArray<T>(value: T | T[] | undefined | null): T[] {\n\tif (value === undefined || value === null) {\n\t\treturn [];\n\t}\n\treturn Array.isArray(value) ? value : [value];\n}\n\nfunction getMatchValue(\n\ttrigger: EventTrigger,\n\tkey: string,\n): string | string[] | undefined {\n\tconst match = trigger.match;\n\tif (match && typeof match === \"object\") {\n\t\treturn (match as Record<string, string | string[] | undefined>)[key];\n\t}\n\treturn undefined;\n}\n\nfunction getMatchRelatedValue(trigger: EventTrigger, key: string): string[] {\n\tconst matchRelated = trigger.match_related;\n\tif (!matchRelated) {\n\t\treturn [];\n\t}\n\n\tconst matchRelatedArray = Array.isArray(matchRelated)\n\t\t? matchRelated\n\t\t: [matchRelated];\n\n\tconst values: string[] = [];\n\tfor (const match of matchRelatedArray) {\n\t\tif (match && typeof match === \"object\") {\n\t\t\tconst value = (match as Record<string, unknown>)[key];\n\t\t\tif (value) {\n\t\t\t\tvalues.push(...asArray(value as string | string[]));\n\t\t\t}\n\t\t}\n\t}\n\treturn values;\n}\n\nfunction fromResourceId(resource: string, value: unknown): string[] {\n\tif (value === undefined || value === null) {\n\t\treturn [];\n\t}\n\n\tconst values = asArray(value as string | string[]);\n\n\tif (values.includes(`${resource}.*`)) {\n\t\treturn [];\n\t}\n\n\treturn values\n\t\t.filter((v) => v.startsWith(resource))\n\t\t.map((v) => {\n\t\t\tconst parts = v.split(`${resource}.`);\n\t\t\treturn parts[1] ?? \"\";\n\t\t})\n\t\t.filter((id) => id !== \"\" && id !== \"*\");\n}\n\nfunction fromStateNameEvents(events: string[]): string[] {\n\tif (events.includes(\"prefect.flow-run.*\")) {\n\t\treturn [];\n\t}\n\n\treturn events\n\t\t.filter((event) => event.startsWith(\"prefect.flow-run.\"))\n\t\t.map((event) => {\n\t\t\tconst parts = event.split(\"prefect.flow-run.\");\n\t\t\treturn parts[1] ?? \"\";\n\t\t})\n\t\t.filter((name) => name !== \"\");\n}\n\nfunction extractFlowRunStateProps(trigger: EventTrigger): {\n\tflowIds: string[];\n\ttags: string[];\n\tposture: AutomationTriggerEventPosture;\n\tstates: string[];\n\ttime?: number;\n} {\n\tconst matchRelatedResourceIds = getMatchRelatedValue(\n\t\ttrigger,\n\t\t\"prefect.resource.id\",\n\t);\n\n\tconst flowIds = fromResourceId(\"prefect.flow\", matchRelatedResourceIds);\n\tconst tags = fromResourceId(\"prefect.tag\", matchRelatedResourceIds);\n\n\tconst posture = trigger.posture;\n\tconst states =\n\t\tposture === \"Reactive\"\n\t\t\t? fromStateNameEvents(trigger.expect ?? [])\n\t\t\t: fromStateNameEvents(trigger.after ?? []);\n\n\treturn {\n\t\tflowIds,\n\t\ttags,\n\t\tposture,\n\t\tstates,\n\t\ttime: trigger.within,\n\t};\n}\n\nconst DEPLOYMENT_STATUS_EVENT_TO_STATUS: Record<string, DeploymentStatus> = {\n\t\"prefect.deployment.ready\": \"ready\",\n\t\"prefect.deployment.not-ready\": \"not_ready\",\n\t\"prefect.deployment.disabled\": \"not_ready\",\n};\n\nfunction extractDeploymentStatusProps(trigger: EventTrigger): {\n\tdeploymentIds: string[];\n\tposture: AutomationTriggerEventPosture;\n\tstatus: DeploymentStatus;\n\ttime?: number;\n} {\n\tconst resourceIdValue = getMatchValue(trigger, \"prefect.resource.id\");\n\tconst deploymentIds = fromResourceId(\"prefect.deployment\", resourceIdValue);\n\n\tconst posture = trigger.posture;\n\tconst statusEvents = posture === \"Reactive\" ? trigger.expect : trigger.after;\n\n\tlet status: DeploymentStatus = \"ready\";\n\tfor (const event of statusEvents ?? []) {\n\t\tif (event in DEPLOYMENT_STATUS_EVENT_TO_STATUS) {\n\t\t\tstatus = DEPLOYMENT_STATUS_EVENT_TO_STATUS[event];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn {\n\t\tdeploymentIds,\n\t\tposture,\n\t\tstatus,\n\t\ttime: trigger.within,\n\t};\n}\n\nconst WORK_POOL_STATUS_EVENT_TO_STATUS: Record<string, WorkPoolStatusType> = {\n\t\"prefect.work-pool.ready\": \"READY\",\n\t\"prefect.work-pool.not-ready\": \"NOT_READY\",\n\t\"prefect.work-pool.not_ready\": \"NOT_READY\",\n\t\"prefect.work-pool.paused\": \"PAUSED\",\n};\n\nfunction extractWorkPoolStatusProps(trigger: EventTrigger): {\n\tworkPoolIds: string[];\n\tposture: AutomationTriggerEventPosture;\n\tstatus: WorkPoolStatusType;\n\ttime?: number;\n} {\n\tconst resourceIdValue = getMatchValue(trigger, \"prefect.resource.id\");\n\tconst workPoolIds = fromResourceId(\"prefect.work-pool\", resourceIdValue);\n\n\tconst posture = trigger.posture;\n\tconst statusEvents = posture === \"Reactive\" ? trigger.expect : trigger.after;\n\n\tlet status: WorkPoolStatusType = \"READY\";\n\tfor (const event of statusEvents ?? []) {\n\t\tif (event in WORK_POOL_STATUS_EVENT_TO_STATUS) {\n\t\t\tstatus = WORK_POOL_STATUS_EVENT_TO_STATUS[event];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn {\n\t\tworkPoolIds,\n\t\tposture,\n\t\tstatus,\n\t\ttime: trigger.within,\n\t};\n}\n\nconst WORK_QUEUE_STATUS_EVENT_TO_STATUS: Record<\n\tstring,\n\tWorkQueueStatusTriggerStatus\n> = {\n\t\"prefect.work-queue.ready\": \"READY\",\n\t\"prefect.work-queue.not-ready\": \"NOT_READY\",\n\t\"prefect.work-queue.paused\": \"PAUSED\",\n};\n\nfunction extractWorkQueueStatusProps(trigger: EventTrigger): {\n\tworkQueueIds: string[];\n\tworkPoolNames: string[];\n\tposture: AutomationTriggerEventPosture;\n\tstatus: WorkQueueStatusTriggerStatus;\n\ttime?: number;\n} {\n\tconst resourceIdValue = getMatchValue(trigger, \"prefect.resource.id\");\n\tconst workQueueIds = fromResourceId(\"prefect.work-queue\", resourceIdValue);\n\n\tconst matchRelatedResourceIds = getMatchRelatedValue(\n\t\ttrigger,\n\t\t\"prefect.resource.id\",\n\t);\n\tconst workPoolNames = fromResourceId(\n\t\t\"prefect.work-pool\",\n\t\tmatchRelatedResourceIds,\n\t);\n\n\tconst posture = trigger.posture;\n\tconst statusEvents = posture === \"Reactive\" ? trigger.expect : trigger.after;\n\n\tlet status: WorkQueueStatusTriggerStatus = \"READY\";\n\tfor (const event of statusEvents ?? []) {\n\t\tif (event in WORK_QUEUE_STATUS_EVENT_TO_STATUS) {\n\t\t\tstatus = WORK_QUEUE_STATUS_EVENT_TO_STATUS[event];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn {\n\t\tworkQueueIds,\n\t\tworkPoolNames,\n\t\tposture,\n\t\tstatus,\n\t\ttime: trigger.within,\n\t};\n}\n\nexport const TriggerDetails = ({ trigger }: TriggerDetailsProps) => {\n\tif (isCompoundTrigger(trigger)) {\n\t\treturn <TriggerDetailsCompound trigger={trigger} />;\n\t}\n\n\tif (isSequenceTrigger(trigger)) {\n\t\treturn <TriggerDetailsSequence trigger={trigger} />;\n\t}\n\n\tif (!isEventTrigger(trigger)) {\n\t\treturn <TriggerDetailsCustom />;\n\t}\n\n\tconst template = getAutomationTriggerTemplate(trigger);\n\n\tswitch (template) {\n\t\tcase \"flow-run-state\":\n\t\t\treturn (\n\t\t\t\t<TriggerDetailsFlowRunState {...extractFlowRunStateProps(trigger)} />\n\t\t\t);\n\t\tcase \"deployment-status\":\n\t\t\treturn (\n\t\t\t\t<TriggerDetailsDeploymentStatus\n\t\t\t\t\t{...extractDeploymentStatusProps(trigger)}\n\t\t\t\t/>\n\t\t\t);\n\t\tcase \"work-pool-status\":\n\t\t\treturn (\n\t\t\t\t<TriggerDetailsWorkPoolStatus\n\t\t\t\t\t{...extractWorkPoolStatusProps(trigger)}\n\t\t\t\t/>\n\t\t\t);\n\t\tcase \"work-queue-status\":\n\t\t\treturn (\n\t\t\t\t<TriggerDetailsWorkQueueStatus\n\t\t\t\t\t{...extractWorkQueueStatusProps(trigger)}\n\t\t\t\t/>\n\t\t\t);\n\t\tdefault:\n\t\t\treturn <TriggerDetailsCustom />;\n\t}\n};\n","import type { Automation } from \"@/api/automations\";\nimport { useGetAutomationActionResources } from \"@/api/automations/use-get-automation-action-resources\";\nimport { ActionDetails } from \"@/components/automations/action-details\";\nimport { TriggerDetails } from \"@/components/automations/trigger-details\";\nimport { Card } from \"@/components/ui/card\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Typography } from \"@/components/ui/typography\";\nimport { pluralize } from \"@/utils\";\n\ntype AutomationDetailsProps = {\n\tautomation: Automation;\n};\n\nexport const AutomationDescription = ({\n\tautomation,\n}: AutomationDetailsProps) => {\n\treturn (\n\t\t<div className=\"flex flex-col gap-1\">\n\t\t\t<Typography className=\"text-muted-foreground\" variant=\"bodySmall\">\n\t\t\t\tDescription\n\t\t\t</Typography>\n\t\t\t<Typography className=\"text-muted-foreground\">\n\t\t\t\t{automation.description || \"None\"}\n\t\t\t</Typography>\n\t\t</div>\n\t);\n};\n\nexport const AutomationTrigger = ({ automation }: AutomationDetailsProps) => {\n\tconst { trigger } = automation;\n\treturn (\n\t\t<div className=\"flex flex-col gap-1\">\n\t\t\t<Typography>Trigger</Typography>\n\t\t\t<TriggerDetails trigger={trigger} />\n\t\t</div>\n\t);\n};\n\nexport const AutomationActions = ({ automation }: AutomationDetailsProps) => {\n\tconst { data: resources, loading } =\n\t\tuseGetAutomationActionResources(automation);\n\n\tconst {\n\t\tautomationsMap,\n\t\tblockDocumentsMap,\n\t\tdeploymentsMap,\n\t\tworkPoolsMap,\n\t\tworkQueuesMap,\n\t} = resources;\n\n\treturn (\n\t\t<div className=\"flex flex-col gap-1\">\n\t\t\t<Typography>{pluralize(automation.actions.length, \"Action\")}</Typography>\n\t\t\t<ul className=\"flex flex-col gap-2\">\n\t\t\t\t{loading\n\t\t\t\t\t? Array.from({ length: automation.actions.length }, (_, i) => (\n\t\t\t\t\t\t\t// biome-ignore lint/suspicious/noArrayIndexKey: ok for loading skeletons\n\t\t\t\t\t\t\t<Card className=\"p-4\" key={i}>\n\t\t\t\t\t\t\t\t<Skeleton className=\"p-2 h-2 w-full\" />\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t))\n\t\t\t\t\t: automation.actions.map((action) => (\n\t\t\t\t\t\t\t<li key={action.type}>\n\t\t\t\t\t\t\t\t<ActionDetails\n\t\t\t\t\t\t\t\t\taction={action}\n\t\t\t\t\t\t\t\t\tautomationsMap={automationsMap}\n\t\t\t\t\t\t\t\t\tblockDocumentsMap={blockDocumentsMap}\n\t\t\t\t\t\t\t\t\tdeploymentsMap={deploymentsMap}\n\t\t\t\t\t\t\t\t\tworkPoolsMap={workPoolsMap}\n\t\t\t\t\t\t\t\t\tworkQueuesMap={workQueuesMap}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t</ul>\n\t\t</div>\n\t);\n};\n","import { toast } from \"sonner\";\nimport { type Automation, useUpdateAutomation } from \"@/api/automations\";\nimport { Switch } from \"@/components/ui/switch\";\n\ntype AutomationEnableToggleProps = {\n\tautomation: Automation;\n};\nexport const AutomationEnableToggle = ({\n\tautomation,\n}: AutomationEnableToggleProps) => {\n\tconst { updateAutomation } = useUpdateAutomation();\n\n\tconst handleCheckedChange = (checked: boolean, id: string) => {\n\t\tupdateAutomation(\n\t\t\t{\n\t\t\t\tenabled: checked,\n\t\t\t\tid,\n\t\t\t},\n\t\t\t{\n\t\t\t\tonSuccess: () => {\n\t\t\t\t\ttoast.success(`Automation ${checked ? \"enabled\" : \"disabled\"}`);\n\t\t\t\t},\n\t\t\t\tonError: (error) => {\n\t\t\t\t\tconst message =\n\t\t\t\t\t\terror.message || \"Unknown error while updating automation\";\n\t\t\t\t\tconsole.error(message);\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t};\n\n\treturn (\n\t\t<Switch\n\t\t\taria-label=\"toggle automation\"\n\t\t\tchecked={automation.enabled}\n\t\t\tonCheckedChange={(checked) => handleCheckedChange(checked, automation.id)}\n\t\t/>\n\t);\n};\n","import { Link } from \"@tanstack/react-router\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport { DOCS_LINKS } from \"@/components/ui/docs-link\";\nimport {\n\tDropdownMenu,\n\tDropdownMenuContent,\n\tDropdownMenuItem,\n\tDropdownMenuLabel,\n\tDropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Icon } from \"@/components/ui/icons\";\n\ntype Props = {\n\tid: string;\n\tonDelete: () => void;\n};\n\nexport const AutomationsActionsMenu = ({ id, onDelete }: Props) => {\n\tconst handleCopyId = (id: string) => {\n\t\tvoid navigator.clipboard.writeText(id);\n\t\ttoast.success(\"ID copied\");\n\t};\n\n\treturn (\n\t\t<DropdownMenu>\n\t\t\t<DropdownMenuTrigger asChild>\n\t\t\t\t<Button variant=\"outline\" className=\"size-8 p-0\">\n\t\t\t\t\t<span className=\"sr-only\">Open menu</span>\n\t\t\t\t\t<Icon id=\"MoreVertical\" className=\"size-4\" />\n\t\t\t\t</Button>\n\t\t\t</DropdownMenuTrigger>\n\t\t\t<DropdownMenuContent align=\"end\">\n\t\t\t\t<DropdownMenuLabel>Actions</DropdownMenuLabel>\n\t\t\t\t<DropdownMenuItem onClick={() => handleCopyId(id)}>\n\t\t\t\t\tCopy ID\n\t\t\t\t</DropdownMenuItem>\n\t\t\t\t<DropdownMenuItem asChild>\n\t\t\t\t\t<Link to=\"/automations/automation/$id/edit\" params={{ id }}>\n\t\t\t\t\t\tEdit\n\t\t\t\t\t</Link>\n\t\t\t\t</DropdownMenuItem>\n\t\t\t\t<DropdownMenuItem onClick={onDelete}>Delete</DropdownMenuItem>\n\t\t\t\t<DropdownMenuItem asChild>\n\t\t\t\t\t<a\n\t\t\t\t\t\thref={DOCS_LINKS[\"automations-guide\"]}\n\t\t\t\t\t\tclassName=\"flex items-center\"\n\t\t\t\t\t>\n\t\t\t\t\t\tDocumentation <Icon id=\"ExternalLink\" className=\"ml-2 size-4\" />\n\t\t\t\t\t</a>\n\t\t\t\t</DropdownMenuItem>\n\t\t\t</DropdownMenuContent>\n\t\t</DropdownMenu>\n\t);\n};\n","import { useNavigate } from \"@tanstack/react-router\";\nimport { toast } from \"sonner\";\nimport { type Automation, useDeleteAutomation } from \"@/api/automations\";\nimport { useDeleteConfirmationDialog } from \"@/components/ui/delete-confirmation-dialog\";\n\nexport const useDeleteAutomationConfirmationDialog = () => {\n\tconst navigate = useNavigate();\n\tconst [dialogState, confirmDelete] = useDeleteConfirmationDialog();\n\n\tconst { deleteAutomation } = useDeleteAutomation();\n\n\tconst handleConfirmDelete = (\n\t\tautomation: Automation,\n\t\t{\n\t\t\tshouldNavigate = false,\n\t\t}: {\n\t\t\t/** Should navigate back to /automations */\n\t\t\tshouldNavigate?: boolean;\n\t\t} = {},\n\t) =>\n\t\tconfirmDelete({\n\t\t\ttitle: \"Delete Automation\",\n\t\t\tdescription: `Are you sure you want to delete ${automation.name}?`,\n\t\t\tonConfirm: () => {\n\t\t\t\tdeleteAutomation(automation.id, {\n\t\t\t\t\tonSuccess: () => {\n\t\t\t\t\t\ttoast.success(\"Automation deleted\");\n\t\t\t\t\t\tif (shouldNavigate) {\n\t\t\t\t\t\t\tvoid navigate({ to: \"/automations\" });\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonError: (error) => {\n\t\t\t\t\t\tconst message =\n\t\t\t\t\t\t\terror.message || \"Unknown error while deleting automation.\";\n\t\t\t\t\t\ttoast.error(message);\n\t\t\t\t\t\tconsole.error(message);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\n\treturn [dialogState, handleConfirmDelete] as const;\n};\n"],"names":["useGetAutomationActionResources","automation","automationIds","blockDocumentIds","deploymentIds","workPoolIds","workQueueIds","getResourceSets","automationsData","automationsLoading","useListAutomationsQueries","remainingQueries","useQueries","buildListFilterBlockDocumentsQuery","buildFilterDeploymentsQuery","buildFilterWorkPoolsQuery","buildFilterWorkQueuesQuery","results","blockDocuments","deployments","workPools","workQueues","result","listToMap","automationId","buildGetAutomationQuery","retMap","actions","action","list","map","item","ACTION_TYPE_TO_STRING","ActionDetails","automationsMap","blockDocumentsMap","deploymentsMap","workPoolsMap","workQueuesMap","jsx","Card","ActionDetailsType","label","NoninferredAction","deployment","DeploymentActionDetails","Typography","InferredAction","workQueue","WorkQueueActionDetails","AutomationActionDetails","workPool","WorkPoolActionDetails","blockDocument","BlockDocumentActionDetails","CallWebhookActionDetails","ChangeFlowRunStateActionDetails","ActionResource","children","ActionResourceName","iconId","name","jsxs","Icon","type","StateBadge","parameters","job_variables","Link","RunDeploymentJsonDialog","title","payload","Dialog","DialogTrigger","Button","capitalize","DialogContent","DialogHeader","DialogTitle","JsonInput","_label","TriggerDetailsCompound","trigger","triggerCount","requireValue","requireLabel","TriggerDetailsCustom","DeploymentLink","deploymentId","Suspense","Skeleton","DeploymentLinkImplementation","useSuspenseQuery","buildDeploymentDetailsQuery","DEFAULT_EVENT_TRIGGER_THRESHOLD","DEPLOYMENT_STATUS_EVENTS","WORK_POOL_STATUS_EVENTS","WORK_QUEUE_STATUS_EVENTS","isRecord","value","isEventTrigger","isCompoundTrigger","isSequenceTrigger","asArray","getTriggerMatchValue","key","match","isMatchResource","predicate","prefectResourceIds","isForEachResource","resource","isAfterResource","isExpectResource","isDeploymentStatusEvent","event","isWorkPoolStatusEvent","isWorkQueueStatusEvent","isDeploymentStatusTrigger","triggerAfters","after","triggerExpects","expect","getTriggerMatchRelatedValue","matchRelated","matchRelatedArray","values","isEmptyMatchRelated","isMatchRelatedResource","isFlowRunStateTriggerMatchRelated","isFlowRunStateTrigger","isWorkPoolStatusTrigger","isWorkQueueStatusTrigger","automationTriggerTemplateChecks","getAutomationTriggerTemplate","guard","getAutomationTriggerEventPostureLabel","posture","getWorkQueueStatusLabel","status","exhaustive","getDeploymentStatusLabel","TriggerDetailsDeploymentStatus","time","isAnyDeployment","postureLabel","statusLabel","index","secondsToString","mapStateNameToStateType","stateName","normalizedName","TriggerDetailsFlowRunState","flowIds","tags","states","Fragment","flowId","FlowLink","TagBadgeGroup","state","stateType","secondsToApproximateString","TriggerDetailsSequence","getStatusLabel","WorkPoolLinkInline","workPoolName","renderWorkPoolLinks","TriggerDetailsWorkPoolStatus","useQuery","workPoolLabel","pluralize","TriggerDetailsWorkQueueStatus","props","TriggerDetailsWorkQueueStatusImplementation","workPoolNames","anyWorkQueue","anyWorkPool","useSuspenseQueries","id","buildGetWorkQueueQuery","query","WorkQueueIconText","WorkPoolLink","getMatchValue","getMatchRelatedValue","fromResourceId","v","fromStateNameEvents","events","extractFlowRunStateProps","matchRelatedResourceIds","DEPLOYMENT_STATUS_EVENT_TO_STATUS","extractDeploymentStatusProps","resourceIdValue","statusEvents","WORK_POOL_STATUS_EVENT_TO_STATUS","extractWorkPoolStatusProps","WORK_QUEUE_STATUS_EVENT_TO_STATUS","extractWorkQueueStatusProps","TriggerDetails","AutomationDescription","AutomationTrigger","AutomationActions","resources","loading","_","i","AutomationEnableToggle","updateAutomation","useUpdateAutomation","handleCheckedChange","checked","toast","error","message","Switch","AutomationsActionsMenu","onDelete","handleCopyId","DropdownMenu","DropdownMenuTrigger","DropdownMenuContent","DropdownMenuLabel","DropdownMenuItem","DOCS_LINKS","useDeleteAutomationConfirmationDialog","navigate","useNavigate","dialogState","confirmDelete","useDeleteConfirmationDialog","deleteAutomation","useDeleteAutomation","shouldNavigate"],"mappings":"ilBAiCO,MAAMA,GAAmCC,GAA2B,CAC1E,KAAM,CACL,cAAAC,EACA,iBAAAC,EACA,cAAAC,EACA,YAAAC,EACA,aAAAC,CAAA,EACGC,GAAgBN,EAAW,OAAO,EAGhC,CAAE,KAAMO,EAAiB,QAASC,GACvCC,GAA0B,MAAM,KAAKR,CAAa,CAAC,EAG9CS,EAAmBC,EAAW,CACnC,QAAS,CACRC,GACC,CACC,OAAQ,EACR,KAAM,0BACN,gBAAiB,GACjB,gBAAiB,CAChB,SAAU,OACV,GAAI,CAAE,KAAM,MAAM,KAAKV,CAAgB,CAAA,EACvC,aAAc,CAAA,CAAC,CAChB,EAED,CAAE,QAASA,EAAiB,KAAO,CAAA,CAAE,EAEtCW,GACC,CACC,OAAQ,EACR,KAAM,eACN,YAAa,CACZ,GAAI,CAAE,KAAM,MAAM,KAAKV,CAAa,CAAA,EACpC,SAAU,MAAA,CACX,EAED,CAAE,QAASA,EAAc,KAAO,CAAA,CAAE,EAEnCW,EACC,CACC,OAAQ,EACR,WAAY,CACX,GAAI,CAAE,KAAM,MAAM,KAAKV,CAAW,CAAA,EAClC,SAAU,MAAA,CACX,EAED,CAAE,QAASA,EAAY,KAAO,CAAA,CAAE,EAEjCW,GACC,CACC,OAAQ,EACR,YAAa,CACZ,GAAI,CAAE,KAAM,MAAM,KAAKV,CAAY,CAAA,EACnC,SAAU,MAAA,CACX,EAED,CAAE,QAASA,EAAa,KAAO,CAAA,CAAE,CAClC,EAED,QAAUW,GAAY,CACrB,KAAM,CAACC,EAAgBC,GAAaC,GAAWC,EAAU,EAAIJ,EAC7D,MAAO,CACN,KAAM,CACL,eAAgBC,EAAe,KAC/B,YAAaC,GAAY,KACzB,UAAWC,GAAU,KACrB,WAAYC,GAAW,IAAA,EAExB,QAASJ,EAAQ,KAAMK,IAAWA,GAAO,SAAS,CAAA,CAEpD,CAAA,CACA,EAED,MAAO,CACN,QAASb,GAAsBE,EAAiB,QAChD,KAAM,CACL,eAAgBH,EAChB,kBAAmBe,EAAUZ,EAAiB,KAAK,cAAc,EACjE,eAAgBY,EAAUZ,EAAiB,KAAK,WAAW,EAC3D,aAAcY,EAAUZ,EAAiB,KAAK,SAAS,EACvD,cAAeY,EAAUZ,EAAiB,KAAK,UAAU,CAAA,CAC1D,CAEF,EAEMD,GAA6BR,GAClCU,EAAW,CACV,QAAS,MAAM,KAAKV,CAAa,EAAE,IAAKsB,GACvCC,GAAwBD,CAAY,CAAA,EAErC,QAAUP,GAAY,CACrB,MAAMS,MAAa,IACnB,UAAWJ,KAAUL,EAChBK,EAAO,MACVI,EAAO,IAAIJ,EAAO,KAAK,GAAIA,EAAO,IAAI,EAGxC,MAAO,CACN,KAAMI,EACN,QAAST,EAAQ,KAAMK,GAAWA,EAAO,SAAS,CAAA,CAEpD,CACD,CAAC,EAEWf,GAAmBoB,GAAmC,CAClE,MAAMzB,MAAoB,IACpBC,MAAuB,IACvBC,MAAoB,IACpBC,MAAkB,IAClBC,MAAmB,IAEzB,UAAWsB,KAAUD,EACpB,OAAQC,EAAO,KAAA,CACd,IAAK,iBACL,IAAK,mBACL,IAAK,oBACAA,EAAO,eACVxB,EAAc,IAAIwB,EAAO,aAAa,EAEvC,MACD,IAAK,mBACL,IAAK,oBACAA,EAAO,eACVtB,EAAa,IAAIsB,EAAO,aAAa,EAEtC,MACD,IAAK,mBACL,IAAK,oBACAA,EAAO,eACV1B,EAAc,IAAI0B,EAAO,aAAa,EAEvC,MACD,IAAK,kBACL,IAAK,mBACAA,EAAO,cACVvB,EAAY,IAAIuB,EAAO,YAAY,EAEpC,MACD,IAAK,oBACL,IAAK,eACAA,EAAO,mBACVzB,EAAiB,IAAIyB,EAAO,iBAAiB,EAE9C,KAAA,CAUH,MAAO,CACN,cAAA1B,EACA,iBAAAC,EACA,cAAAC,EACA,YAAAC,EACA,aAAAC,CAAA,CAEF,EAEA,SAASiB,EACRM,EACkB,CAClB,MAAMC,MAAU,IAChB,UAAWC,KAAQF,GAAQ,GAC1BC,EAAI,IAAIC,EAAK,GAAIA,CAAI,EAEtB,OAAOD,CACR,CCvLA,MAAME,GAAwB,CAC7B,kBAAmB,kBACnB,mBAAoB,mBACpB,kBAAmB,oBACnB,wBAAyB,6BACzB,iBAAkB,iBAClB,mBAAoB,mBACpB,oBAAqB,oBACrB,mBAAoB,mBACpB,oBAAqB,oBACrB,kBAAmB,kBACnB,mBAAoB,mBACpB,mBAAoB,mBACpB,oBAAqB,oBACrB,eAAgB,qBAEhB,oBAAqB,4BACrB,aAAc,YACf,EAcaC,GAAgB,CAAC,CAC7B,OAAAL,EACA,eAAAM,EACA,kBAAAC,EACA,eAAAC,EACA,aAAAC,EACA,cAAAC,CACD,IACCC,EAAAA,IAACC,EAAA,CAAK,UAAU,MACf,SAAAD,EAAAA,IAACE,GAAA,CACA,OAAAb,EACA,eAAAM,EACA,kBAAAC,EACA,eAAAC,EACA,aAAAC,EACA,cAAAC,CAAA,CACD,EACD,EAGKG,GAAoB,CAAC,CAC1B,OAAAb,EACA,eAAAM,EACA,kBAAAC,EACA,eAAAC,EACA,aAAAC,EACA,cAAAC,CACD,IAA0B,CACzB,MAAMI,EAAQV,GAAsBJ,EAAO,IAAI,EAC/C,OAAQA,EAAO,KAAA,CAEd,IAAK,kBACL,IAAK,mBACL,IAAK,kBACL,IAAK,aACJ,OAAOW,MAACI,IAAkB,MAAAD,EAAc,EAEzC,IAAK,iBACJ,GAAId,EAAO,eAAiBA,EAAO,SAAW,WAAY,CACzD,MAAMgB,EAAaR,EAAe,IAAIR,EAAO,aAAa,EAC1D,OAAKgB,EAIJL,EAAAA,IAACM,EAAA,CACA,MAAAH,EACA,WAAAE,EACA,WAAYhB,EAAO,WACnB,cAAeA,EAAO,aAAA,CAAA,EAPhBW,EAAAA,IAACO,GAAW,SAAA,sBAAA,CAAoB,CAUzC,CACA,OAAOP,MAACQ,GAAe,MAAAL,EAAc,EACtC,IAAK,mBACL,IAAK,oBACJ,GAAId,EAAO,eAAiBA,EAAO,SAAW,WAAY,CACzD,MAAMgB,EAAaR,EAAe,IAAIR,EAAO,aAAa,EAC1D,OAAKgB,EAIJL,EAAAA,IAACM,EAAA,CAAwB,MAAAH,EAAc,WAAAE,CAAA,CAAwB,EAHxDL,EAAAA,IAACO,GAAW,SAAA,sBAAA,CAAoB,CAKzC,CACA,OAAOP,MAACQ,GAAe,MAAAL,EAAc,EACtC,IAAK,mBACL,IAAK,oBACJ,GAAId,EAAO,eAAiBA,EAAO,SAAW,WAAY,CACzD,MAAMoB,EAAYV,EAAc,IAAIV,EAAO,aAAa,EACxD,OAAKoB,EAGET,EAAAA,IAACU,GAAA,CAAuB,MAAAP,EAAc,UAAAM,CAAA,CAAsB,EAF3DT,EAAAA,IAACO,GAAW,SAAA,sBAAA,CAAoB,CAGzC,CACA,OAAOP,MAACQ,GAAe,MAAAL,EAAc,EACtC,IAAK,mBACL,IAAK,oBACJ,GAAId,EAAO,eAAiBA,EAAO,SAAW,WAAY,CACzD,MAAM3B,EAAaiC,EAAe,IAAIN,EAAO,aAAa,EAC1D,OAAK3B,EAIJsC,EAAAA,IAACW,GAAA,CAAwB,MAAAR,EAAc,WAAAzC,CAAA,CAAwB,EAHxDsC,EAAAA,IAACO,GAAW,SAAA,sBAAA,CAAoB,CAKzC,CACA,OAAOP,MAACQ,GAAe,MAAAL,EAAc,EACtC,IAAK,kBACL,IAAK,mBACJ,GAAId,EAAO,cAAgBA,EAAO,SAAW,WAAY,CACxD,MAAMuB,EAAWd,EAAa,IAAIT,EAAO,YAAY,EACrD,OAAKuB,EAGEZ,EAAAA,IAACa,GAAA,CAAsB,MAAAV,EAAc,SAAAS,CAAA,CAAoB,EAFxDZ,EAAAA,IAACO,GAAW,SAAA,oBAAA,CAAkB,CAGvC,CACA,OAAOP,MAACQ,GAAe,MAAAL,EAAc,EAEtC,IAAK,oBAAqB,CACzB,MAAMW,EAAgBlB,EAAkB,IAAIP,EAAO,iBAAiB,EACpE,OAAKyB,EAIJd,EAAAA,IAACe,GAAA,CACA,MAAAZ,EACA,cAAAW,CAAA,CAAA,EALMd,EAAAA,IAACO,GAAW,SAAA,0BAAA,CAAwB,CAQ7C,CACA,IAAK,eAAgB,CACpB,MAAMO,EAAgBlB,EAAkB,IAAIP,EAAO,iBAAiB,EACpE,OAAKyB,EAIJd,EAAAA,IAACgB,GAAA,CAAyB,MAAAb,EAAc,cAAAW,CAAA,CAA8B,EAH/Dd,EAAAA,IAACO,GAAW,SAAA,0BAAA,CAAwB,CAK7C,CACA,IAAK,wBACJ,OACCP,EAAAA,IAACiB,GAAA,CACA,MAAAd,EACA,KAAMd,EAAO,MACb,KAAMA,EAAO,IAAA,CAAA,EAGhB,QACC,OAAO,IAAA,CAEV,EAEM6B,EAAiB,CAAC,CAAE,SAAAC,CAAA,IACzBnB,EAAAA,IAAC,MAAA,CAAI,UAAU,kCAAmC,SAAAmB,EAAS,EAGtDC,EAAqB,CAAC,CAC3B,OAAAC,EACA,KAAAC,CACD,IAICC,EAAAA,KAAC,MAAA,CAAI,UAAU,4BACd,SAAA,CAAAvB,EAAAA,IAACwB,EAAA,CAAK,GAAIH,EAAQ,UAAU,cAAc,EACzCC,CAAA,EACF,EAGKlB,GAAoB,CAAC,CAAE,MAAAD,KAC5BoB,EAAAA,KAAChB,EAAA,CAAW,QAAQ,YAAa,SAAA,CAAAJ,EAAM,4BAAA,EAA0B,EAG5DK,EAAiB,CAAC,CAAE,MAAAL,KACzBoB,EAAAA,KAAChB,EAAA,CAAW,QAAQ,YAClB,SAAA,CAAAJ,EAAM,qCAAA,EACR,EASYc,GAAkC,CAAC,CAC/C,MAAAd,EACA,KAAAsB,EACA,KAAAH,CACD,WAEGJ,EAAA,CACA,SAAA,CAAAlB,MAACQ,GAAe,MAAAL,EAAc,EAAE,OAAIH,EAAAA,IAAC0B,EAAA,CAAW,KAAAD,EAAY,KAAAH,CAAA,CAAY,CAAA,EACzE,EAWWhB,EAA0B,CAAC,CACvC,MAAAH,EACA,WAAAE,EACA,WAAAsB,EACA,cAAAC,CACD,WAEGV,EAAA,CACA,SAAA,CAAAK,EAAAA,KAAC,SAAM,QAAS,GAAGpB,CAAK,IAAIE,EAAW,EAAE,GAAK,SAAA,CAAAF,EAAM,GAAA,EAAC,EACrDH,EAAAA,IAAC6B,EAAA,CACA,GAAG,8BACH,OAAQ,CAAE,GAAIxB,EAAW,EAAA,EACzB,aAAYA,EAAW,KAEvB,eAACe,EAAA,CAAmB,OAAO,SAAS,KAAMf,EAAW,IAAA,CAAM,CAAA,CAAA,EAE3DsB,IAAe,QACf3B,EAAAA,IAAC8B,GAAwB,MAAM,aAAa,QAASH,EAAY,EAEjEC,IAAkB,QAClB5B,EAAAA,IAAC8B,EAAA,CACA,MAAM,gBACN,QAASF,CAAA,CAAA,CACV,EAEF,EASIE,EAA0B,CAAC,CAChC,MAAAC,EACA,QAAAC,CACD,WAEGC,GAAA,CACA,SAAA,CAAAjC,EAAAA,IAACkC,GAAA,CAAc,QAAO,GACrB,SAAAX,EAAAA,KAACY,GAAO,QAAQ,YAAY,KAAK,KAAK,SAAA,CAAA,QAC/BC,GAAWL,CAAK,CAAA,CAAA,CACvB,CAAA,CACD,EACAR,EAAAA,KAACc,GAAA,CAAc,mBAAkB,OAChC,SAAA,CAAArC,MAACsC,GAAA,CACA,SAAAtC,EAAAA,IAACuC,GAAA,CAAa,SAAAR,CAAA,CAAM,EACrB,EACA/B,MAACwC,IAAU,MAAO,KAAK,UAAUR,CAAO,EAAG,SAAQ,EAAA,CAAC,CAAA,CAAA,CACrD,CAAA,EACD,EAQWrB,GAA0B,CAAC,CACvC,MAAAR,EACA,WAAAzC,CACD,WAEGwD,EAAA,CACA,SAAA,CAAAK,EAAAA,KAAC,SAAM,QAAS,GAAGpB,CAAK,IAAIzC,EAAW,EAAE,GAAK,SAAA,CAAAyC,EAAM,GAAA,EAAC,EACrDH,EAAAA,IAAC6B,EAAA,CACA,GAAG,8BACH,OAAQ,CAAE,GAAInE,EAAW,EAAA,EACzB,aAAYA,EAAW,KAEvB,eAAC0D,EAAA,CAAmB,OAAO,MAAM,KAAM1D,EAAW,IAAA,CAAM,CAAA,CAAA,CACzD,EACD,EAQWqD,GAA6B,CAAC,CAC1C,MAAAZ,EACA,cAAAW,CACD,IAAuC,CACtC,GAAI,CAACA,EAAc,KAClB,OAAOd,EAAAA,IAACO,GAAW,SAAA,iBAAA,CAAe,EAGnC,MAAMkC,EAAS3B,EAAc,gBAC1B,UAAUA,EAAc,gBAAgB,YAAA,CAAa,SACrDX,EAEH,cACEe,EAAA,CACA,SAAA,CAAAlB,EAAAA,IAAC,QAAA,CAAM,QAAS,GAAGG,CAAK,IAAIW,EAAc,EAAE,GAAK,SAAA2B,CAAA,CAAO,EACxDzC,EAAAA,IAAC6B,EAAA,CACA,GAAG,oBACH,OAAQ,CAAE,GAAIf,EAAc,EAAA,EAC5B,aAAYA,EAAc,KAE1B,eAACM,EAAA,CAAmB,OAAO,MAAM,KAAMN,EAAc,IAAA,CAAM,CAAA,CAAA,CAC5D,EACD,CAEF,EAMaE,GAA2B,CAAC,CACxC,MAAAb,EACA,cAAAW,CACD,IACMA,EAAc,YAKjBI,EAAA,CACA,SAAA,CAAAlB,EAAAA,IAAC,QAAA,CAAM,QAAS,GAAGG,CAAK,IAAIW,EAAc,EAAE,GAAK,SAAAX,CAAA,CAAM,EACvDH,EAAAA,IAAC6B,EAAA,CACA,GAAG,oBACH,OAAQ,CAAE,GAAIf,EAAc,EAAA,EAC5B,aAAYA,EAAc,KAE1B,eAACM,EAAA,CAAmB,OAAO,MAAM,KAAMN,EAAc,IAAA,CAAM,CAAA,CAAA,CAC5D,EACD,EAbOd,EAAAA,IAACO,GAAW,SAAA,iBAAA,CAAe,EAqBvBM,GAAwB,CAAC,CACrC,MAAAV,EACA,SAAAS,CACD,WAEGM,EAAA,CACA,SAAA,CAAAK,EAAAA,KAAC,SAAM,QAAS,GAAGpB,CAAK,IAAIS,EAAS,EAAE,GAAK,SAAA,CAAAT,EAAM,GAAA,EAAC,EACnDH,EAAAA,IAAC6B,EAAA,CACA,GAAG,sCACH,OAAQ,CAAE,aAAcjB,EAAS,IAAA,EACjC,aAAYA,EAAS,KAErB,eAACQ,EAAA,CAAmB,OAAO,MAAM,KAAMR,EAAS,IAAA,CAAM,CAAA,CAAA,CACvD,EACD,EAQWF,GAAyB,CAAC,CACtC,MAAAP,EACA,UAAAM,CACD,WAEGS,EAAA,CACA,SAAA,CAAAK,EAAAA,KAAC,SAAM,QAAS,GAAGpB,CAAK,IAAIM,EAAU,EAAE,GAAK,SAAA,CAAAN,EAAM,GAAA,EAAC,EACpDH,EAAAA,IAAC6B,EAAA,CACA,GAAG,2DACH,OAAQ,CACP,aAAcpB,EAAU,KACxB,cAAeA,EAAU,IAAA,EAE1B,aAAYA,EAAU,KAEtB,eAACW,EAAA,CAAmB,OAAO,MAAM,KAAMX,EAAU,IAAA,CAAM,CAAA,CAAA,CACxD,EACD,ECvZWiC,GAAyB,CAAC,CACtC,QAAAC,CACD,IAAmC,CAClC,MAAMC,EAAeD,EAAQ,UAAU,QAAU,EAC3CE,EAAeF,EAAQ,QAE7B,IAAIG,EACJ,OAAID,IAAiB,MACpBC,EAAe,MACLD,IAAiB,MAC3BC,EAAe,MACL,OAAOD,GAAiB,SAClCC,EAAe,YAAYD,CAAY,GAEvCC,EAAe,YAId,MAAA,CAAI,UAAU,oCACd,SAAAvB,EAAAA,KAAChB,EAAA,CAAW,QAAQ,YAAY,SAAA,CAAA,gCACDuC,EAAa,OAAKF,EAAa,UAAQ,IACpEA,IAAiB,EAAI,UAAY,WAAW,UAAA,CAAA,CAC9C,CAAA,CACD,CAEF,EC9BaG,EAAuB,IAC5B/C,EAAAA,IAACO,EAAA,CAAW,QAAQ,YAAY,SAAA,mBAAgB,ECQ3CyC,GAAiB,CAAC,CAAE,aAAAC,KAE/BjD,EAAAA,IAACkD,EAAAA,SAAA,CAAS,SAAUlD,EAAAA,IAACmD,EAAA,CAAS,UAAU,YAAA,CAAa,EACpD,SAAAnD,EAAAA,IAACoD,GAAA,CAA6B,aAAAH,CAAA,CAA4B,EAC3D,EAIIG,GAA+B,CAAC,CACrC,aAAAH,CACD,IAA2B,CAC1B,KAAM,CAAE,KAAM5C,CAAA,EAAegD,GAC5BC,GAA4BL,CAAY,CAAA,EAGzC,OACC1B,EAAAA,KAAC,MAAA,CAAI,UAAU,kCAAkC,SAAA,CAAA,aAEhDA,EAAAA,KAACM,EAAA,CACA,GAAG,8BACH,OAAQ,CAAE,GAAIxB,EAAW,EAAA,EACzB,UAAU,0BAEV,SAAA,CAAAL,EAAAA,IAACwB,EAAA,CAAK,GAAG,SAAS,UAAU,SAAS,EACpCnB,EAAW,IAAA,CAAA,CAAA,CACb,EACD,CAEF,ECVakD,EAAkC,EAGlCC,GAA2B,CACvC,2BACA,+BACA,6BACD,EAEaC,GAA0B,CACtC,0BACA,8BACA,2BACA,6BACD,EAEaC,GAA2B,CACvC,2BACA,+BACA,2BACD,EAGA,SAASC,EAASC,EAAkD,CACnE,OAAO,OAAOA,GAAU,UAAYA,IAAU,MAAQ,CAAC,MAAM,QAAQA,CAAK,CAC3E,CAGO,SAASC,EAAelB,EAA2C,CACzE,OACCgB,EAAShB,CAAO,GAChBA,EAAQ,OAAS,UAChBA,EAAQ,UAAY,YAAcA,EAAQ,UAAY,YAEzD,CAEO,SAASmB,GACfnB,EAC6B,CAC7B,OACCgB,EAAShB,CAAO,GAChBA,EAAQ,OAAS,YACjB,MAAM,QAAQA,EAAQ,QAAQ,CAEhC,CAEO,SAASoB,GACfpB,EAC6B,CAC7B,OACCgB,EAAShB,CAAO,GAChBA,EAAQ,OAAS,YACjB,MAAM,QAAQA,EAAQ,QAAQ,CAEhC,CAaA,SAASqB,EAAWJ,EAAwC,CAC3D,OAA2BA,GAAU,KAC7B,CAAA,EAED,MAAM,QAAQA,CAAK,EAAIA,EAAQ,CAACA,CAAK,CAC7C,CAGA,SAASK,GACRtB,EACAuB,EACW,CACX,GAAIL,EAAelB,CAAO,EAAG,CAC5B,MAAMwB,EAAQxB,EAAQ,MACtB,GAAIwB,GAAS,OAAOA,GAAU,SAAU,CACvC,MAAMP,EAASO,EAAkCD,CAAG,EACpD,OAAON,EAAQI,EAAQJ,CAA0B,EAAI,CAAA,CACtD,CACD,CACA,MAAO,CAAA,CACR,CAGO,SAASQ,EACfzB,EACA0B,EACU,CACV,MAAMC,EAAqBL,GAC1BtB,EACA,qBAAA,EAGD,OAAI2B,EAAmB,SAAW,EAC1B,GAGDD,EAAUC,CAAkB,CACpC,CAGO,SAASC,EACf5B,EACA6B,EACU,CACV,OAAIX,EAAelB,CAAO,GACTA,EAAQ,UAAY,CAAA,GACrB,MAAOiB,GAAUA,EAAM,WAAWY,CAAQ,CAAC,EAEpD,EACR,CAGO,SAASC,EACf9B,EACA0B,EACU,CACV,OAAIR,EAAelB,CAAO,EAClB0B,EAAU1B,EAAQ,OAAS,EAAE,EAE9B,EACR,CAGO,SAAS+B,EACf/B,EACA0B,EACU,CACV,OAAIR,EAAelB,CAAO,EAClB0B,EAAU1B,EAAQ,QAAU,EAAE,EAE/B,EACR,CAGA,SAASgC,EAAwBC,EAAwB,CACxD,OAAQpB,GAA+C,SAASoB,CAAK,CACtE,CAEA,SAASC,EAAsBD,EAAwB,CACtD,OAAQnB,GAA8C,SAASmB,CAAK,CACrE,CAEA,SAASE,EAAuBF,EAAwB,CACvD,OAAQlB,GAA+C,SAASkB,CAAK,CACtE,CAcO,SAASG,GAA0BpC,EAA2B,CACpE,OACCkB,EAAelB,CAAO,GACtByB,EAAgBzB,EAAU2B,GACzBA,EAAmB,MAAOV,GACzBA,EAAM,WAAW,oBAAoB,CAAA,CACtC,GAEDW,EAAkB5B,EAAS,qBAAqB,GAChD8B,EAAgB9B,EAAUqC,GACzBA,EAAc,MAAOC,GAAUN,EAAwBM,CAAK,CAAC,CAAA,GAE9DP,EAAiB/B,EAAUuC,GAC1BA,EAAe,MAAOC,GAAWR,EAAwBQ,CAAM,CAAC,CAAA,GAEjExC,EAAQ,YAAcY,CAExB,CAGA,SAAS6B,GACRzC,EACAuB,EACW,CACX,MAAMmB,EAAe1C,EAAQ,cAC7B,GAAI,CAAC0C,EACJ,MAAO,CAAA,EAIR,MAAMC,EAAoB,MAAM,QAAQD,CAAY,EACjDA,EACA,CAACA,CAAY,EAEVE,EAAmB,CAAA,EACzB,UAAWpB,KAASmB,EACnB,GAAInB,GAAS,OAAOA,GAAU,SAAU,CACvC,MAAMP,EAASO,EAAkCD,CAAG,EAChDN,GACH2B,EAAO,KAAK,GAAGvB,EAAQJ,CAA0B,CAAC,CAEpD,CAED,OAAO2B,CACR,CAEA,SAASC,GAAoB7C,EAAgC,CAC5D,MAAM0C,EAAe1C,EAAQ,cAC7B,OAAK0C,EAGD,MAAM,QAAQA,CAAY,EACtBA,EAAa,SAAW,EAEzB,OAAO,KAAKA,CAAY,EAAE,SAAW,EALpC,EAMT,CAEA,SAASI,EACR9C,EACA6B,EACU,CACV,MAAMF,EAAqBc,GAC1BzC,EACA,qBAAA,EAGD,OAAI2B,EAAmB,SAAW,EAC1B,GAGDA,EAAmB,MAAOV,GAAUA,EAAM,WAAWY,CAAQ,CAAC,CACtE,CAEA,SAASkB,GAAkC/C,EAAgC,CAC1E,OACC6C,GAAoB7C,CAAO,GAC3B8C,EAAuB9C,EAAS,cAAc,GAC9C8C,EAAuB9C,EAAS,aAAa,CAE/C,CAaO,SAASgD,GAAsBhD,EAA2B,CAChE,OACCkB,EAAelB,CAAO,GACtByB,EAAgBzB,EAAU2B,GACzBA,EAAmB,MAAOV,GAAUA,EAAM,WAAW,kBAAkB,CAAC,CAAA,GAEzEW,EAAkB5B,EAAS,qBAAqB,GAChD8B,EAAgB9B,EAAUqC,GACzBA,EAAc,MAAOC,GAAUA,EAAM,WAAW,kBAAkB,CAAC,CAAA,GAEpEP,EAAiB/B,EAAUuC,GAC1BA,EAAe,MAAOC,GAAWA,EAAO,WAAW,kBAAkB,CAAC,CAAA,GAEvEO,GAAkC/C,CAAO,GACzCA,EAAQ,YAAcY,CAExB,CAYO,SAASqC,GAAwBjD,EAA2B,CAClE,OACCkB,EAAelB,CAAO,GACtByB,EAAgBzB,EAAU2B,GACzBA,EAAmB,MAAOV,GACzBA,EAAM,WAAW,mBAAmB,CAAA,CACrC,GAEDW,EAAkB5B,EAAS,qBAAqB,GAChD8B,EAAgB9B,EAAUqC,GACzBA,EAAc,MAAOC,GAAUJ,EAAsBI,CAAK,CAAC,CAAA,GAE5DP,EAAiB/B,EAAUuC,GAC1BA,EAAe,MAAOC,GAAWN,EAAsBM,CAAM,CAAC,CAAA,GAE/DxC,EAAQ,YAAcY,CAExB,CAYO,SAASsC,GAAyBlD,EAA2B,CACnE,OACCkB,EAAelB,CAAO,GACtByB,EAAgBzB,EAAU2B,GACzBA,EAAmB,MAAOV,GACzBA,EAAM,WAAW,oBAAoB,CAAA,CACtC,GAEDW,EAAkB5B,EAAS,qBAAqB,GAChD8B,EAAgB9B,EAAUqC,GACzBA,EAAc,MAAOC,GAAUH,EAAuBG,CAAK,CAAC,CAAA,GAE7DP,EAAiB/B,EAAUuC,GAC1BA,EAAe,MAAOC,GAAWL,EAAuBK,CAAM,CAAC,CAAA,GAEhExC,EAAQ,YAAcY,CAExB,CAGA,MAAMuC,GAGF,CACH,oBAAqBf,GACrB,iBAAkBY,GAClB,mBAAoBC,GACpB,oBAAqBC,EACtB,EAMO,SAASE,GACfpD,EAC4B,CAC5B,SAAW,CAAClB,EAAMuE,CAAK,IAAK,OAAO,QAAQF,EAA+B,EACzE,GAAIE,EAAMrD,CAAO,EAChB,OAAOlB,EAIT,MAAO,QACR,CA4BO,SAASwE,EACfC,EACS,CACT,OAAQA,EAAA,CACP,IAAK,WACJ,MAAO,SACR,IAAK,YACJ,MAAO,UAAA,CAEV,CAoBO,SAASC,GACfC,EACS,CACT,OAAQA,EAAA,CACP,IAAK,QACJ,MAAO,QACR,IAAK,YACJ,MAAO,YACR,IAAK,SACJ,MAAO,SACR,QAAS,CACR,MAAMC,EAAoBD,EAC1B,MAAM,IAAI,MACT,4CAA4CC,CAAoB,EAAA,CAElE,CAAA,CAEF,CC7bA,SAASC,GAAyBF,EAAkC,CACnE,OAAQA,EAAA,CACP,IAAK,QACJ,MAAO,QACR,IAAK,YACJ,MAAO,WAAA,CAEV,CAEO,MAAMG,GAAiC,CAAC,CAC9C,cAAA1I,EACA,QAAAqI,EACA,OAAAE,EACA,KAAAI,CACD,IAA2C,CAC1C,MAAMC,EAAkB5I,EAAc,SAAW,EAC3C6I,EAAeT,EAAsCC,CAAO,EAC5DS,EAAcL,GAAyBF,CAAM,EAEnD,OACC7E,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACd,SAAA,CAAAvB,EAAAA,IAAC,QAAK,SAAA,MAAA,CAAI,EAETyG,EACAzG,EAAAA,IAAC,OAAA,CAAK,SAAA,gBAAA,CAAc,EAEpBnC,EAAc,IAAI,CAACoF,EAAc2D,IAChCrF,OAAC,OAAA,CAAwB,UAAU,0BAClC,SAAA,CAAAvB,MAACgD,IAAe,aAAAC,EAA4B,EAC3C2D,IAAU/I,EAAc,OAAS,GAAKmC,EAAAA,IAAC,QAAK,SAAA,IAAA,CAAE,CAAA,CAAA,EAFrCiD,CAGX,CACA,EAGFjD,EAAAA,IAAC,QAAM,SAAA0G,CAAA,CAAa,EACpB1G,EAAAA,IAAC,QAAM,SAAA2G,CAAA,CAAY,EAElBT,IAAY,aAAeM,IAAS,QAAaA,EAAO,UACvD,OAAA,CAAK,SAAA,CAAA,OAAKK,EAAgBL,CAAI,CAAA,CAAA,CAAE,CAAA,EAEnC,CAEF,ECjCA,SAASM,GAAwBC,EAAqC,CACrE,MAAMC,EAAiBD,EAAU,YAAA,EAcjC,MAZqC,CACpC,YACA,SACA,UACA,YACA,aACA,UACA,SACA,UACA,WAAA,EAGmB,SAASC,CAA2B,EAChDA,EAGD,IACR,CAEO,MAAMC,GAA6B,CAAC,CAC1C,QAAAC,EACA,KAAAC,EACA,QAAAjB,EACA,OAAAkB,EACA,KAAAZ,CACD,IAAuC,CACtC,MAAME,EAAeT,EAAsCC,CAAO,EAElE,OACC3E,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACd,SAAA,CAAAvB,EAAAA,IAAC,QAAK,SAAA,mBAAA,CAAiB,EAEtBkH,EAAQ,OAAS,GACjB3F,EAAAA,KAAA8F,EAAAA,SAAA,CACC,SAAA,CAAArH,EAAAA,IAAC,QAAK,SAAA,SAAA,CAAO,EACZkH,EAAQ,IAAI,CAACI,EAAQV,IACrBrF,OAAC,OAAA,CAAkB,UAAU,0BAC5B,SAAA,CAAAvB,MAACuH,IAAS,OAAAD,EAAgB,EACzBV,IAAUM,EAAQ,OAAS,GAAKlH,EAAAA,IAAC,QAAK,SAAA,IAAA,CAAE,CAAA,CAAA,EAF/BsH,CAGX,CACA,CAAA,EACF,EAGAH,EAAK,OAAS,GACd5F,EAAAA,KAAA8F,EAAAA,SAAA,CACC,SAAA,CAAArH,EAAAA,IAAC,QAAK,SAAA,cAAA,CAAY,EAClBA,MAACwH,IAAc,KAAAL,CAAA,CAAY,CAAA,EAC5B,EAGDnH,EAAAA,IAAC,QAAM,SAAA0G,CAAA,CAAa,EAEnBU,EAAO,OAAS,EAChBA,EAAO,IAAKK,GAAU,CACrB,MAAMC,EAAYZ,GAAwBW,CAAK,EAC/C,OAAIC,EACI1H,EAAAA,IAAC0B,EAAA,CAAuB,KAAMgG,CAAA,EAAbD,CAAwB,EAE1C,IACR,CAAC,EAEDzH,EAAAA,IAAC,OAAA,CAAK,SAAA,WAAA,CAAS,EAGfkG,IAAY,aAAeM,IAAS,QAAaA,EAAO,UACvD,OAAA,CAAK,SAAA,CAAA,OAAKmB,GAA2BnB,CAAI,CAAA,CAAA,CAAE,CAAA,EAE9C,CAEF,EC3FaoB,GAAyB,CAAC,CACtC,QAAAjF,CACD,IAAmC,CAClC,MAAMC,EAAeD,EAAQ,UAAU,QAAU,EAEjD,aACE,MAAA,CAAI,UAAU,oCACd,SAAApB,EAAAA,KAAChB,EAAA,CAAW,QAAQ,YAAY,SAAA,CAAA,2BACNqC,EAAa,UAAQ,IAC7CA,IAAiB,EAAI,UAAY,WAAW,0BAAA,CAAA,CAC9C,CAAA,CACD,CAEF,ECHMiF,GAAkBzB,GAAuC,CAC9D,OAAQA,EAAA,CACP,IAAK,QACJ,MAAO,QACR,IAAK,YACJ,MAAO,YACR,IAAK,SACJ,MAAO,QAAA,CAEV,EAEM0B,GAAqB,CAAC,CAAE,aAAAC,KAE5BxG,EAAAA,KAACM,EAAA,CACA,GAAG,sCACH,OAAQ,CAAE,aAAAkG,CAAA,EACV,UAAU,iCAEV,SAAA,CAAA/H,EAAAA,IAACwB,EAAA,CAAK,GAAG,MAAM,UAAU,SAAS,EACjCuG,CAAA,CAAA,CAAA,EAKEC,GAAuBnJ,GACxBA,EAAU,SAAW,EACjB,KAGDA,EAAU,IAAI,CAAC+B,EAAUgG,IAC/BrF,OAAC,OAAA,CAAuB,UAAU,iCACjC,SAAA,CAAAvB,EAAAA,IAAC8H,GAAA,CAAmB,aAAclH,EAAS,IAAA,CAAM,EAChDgG,IAAU/H,EAAU,OAAS,GAAK,OAClC+H,EAAQ/H,EAAU,OAAS,GAAK,IAAA,GAHvB+B,EAAS,EAIpB,CACA,EAGWqH,GAA+B,CAAC,CAC5C,YAAAnK,EACA,QAAAoI,EACA,OAAAE,EACA,KAAAI,CACD,IAAyC,CACxC,KAAM,CAAE,KAAM3H,EAAY,CAAA,GAAOqJ,GAChC1J,EACC,CACC,OAAQ,EACR,WAAY,CAAE,GAAI,CAAE,KAAMV,CAAA,EAAe,SAAU,MAAA,CAAO,EAE3D,CAAE,QAASA,EAAY,OAAS,CAAA,CAAE,CACnC,EAGK4I,EAAeR,IAAY,WAAa,SAAW,WACnDS,EAAckB,GAAezB,CAAM,EAAE,YAAA,EAErC+B,EACLrK,EAAY,SAAW,EACpB,gBACA,GAAGsK,EAAUtK,EAAY,OAAQ,WAAW,CAAC,IAEjD,OACCyD,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACd,SAAA,CAAAvB,EAAAA,IAAC,QAAK,SAAA,MAAA,CAAI,EACVA,EAAAA,IAAC,QAAM,SAAAmI,CAAA,CAAc,EACpBrK,EAAY,OAAS,GAAKkK,GAAoBnJ,CAAS,EACxDmB,EAAAA,IAAC,QAAM,SAAA0G,CAAA,CAAa,EACpB1G,EAAAA,IAAC,QAAM,SAAA2G,CAAA,CAAY,EAClBT,IAAY,aAAeM,IAAS,eACnC,OAAA,CAAK,SAAA,CAAA,OAAKK,EAAgBL,CAAI,CAAA,CAAA,CAAE,CAAA,EAEnC,CAEF,ECpEa6B,GACZC,GAGCtI,EAAAA,IAACkD,EAAAA,SAAA,CAAS,SAAUlD,EAAAA,IAACmD,EAAA,CAAS,UAAU,YAAA,CAAa,EACpD,SAAAnD,MAACuI,GAAA,CAA6C,GAAGD,CAAA,CAAO,EACzD,EAIIC,GAA8C,CAAC,CACpD,aAAAxK,EACA,cAAAyK,EACA,QAAAtC,EACA,OAAAE,EACA,KAAAI,CACD,IAA0C,CACzC,MAAMiC,EAAe1K,EAAa,SAAW,EACvC2K,EAAcF,EAAc,SAAW,EAMvC1J,EAJmB6J,GAAmB,CAC3C,QAAS5K,EAAa,IAAK6K,GAAOC,GAAuBD,CAAE,CAAC,CAAA,CAC5D,EAEmC,IAAKE,GAAUA,EAAM,IAAI,EAE7D,OACCvH,EAAAA,KAAC,MAAA,CAAI,UAAU,4CACd,SAAA,CAAAvB,EAAAA,IAAC,QAAK,SAAA,MAAA,CAAI,EAETyI,EACAzI,EAAAA,IAAC,OAAA,CAAK,SAAA,gBAAA,CAAc,EAEpBuB,EAAAA,KAAA8F,WAAA,CACC,SAAA,CAAArH,MAAC,OAAA,CAAM,SAAAoI,EAAUtJ,EAAW,OAAQ,YAAY,EAAE,EACjDA,EAAW,IAAI,CAAC2B,EAAWmG,IAC3BrF,OAAC,OAAA,CAAwB,UAAU,0BAClC,SAAA,CAAAvB,EAAAA,IAAC+I,GAAA,CACA,aAActI,EAAU,gBAAkB,GAC1C,cAAeA,EAAU,KACzB,UAAS,GACT,WAAU,EAAA,CAAA,EAEVmG,IAAU9H,EAAW,OAAS,GAAKkB,EAAAA,IAAC,QAAK,SAAA,IAAA,CAAE,CAAA,CAAA,EAPlCS,EAAU,EAQrB,CACA,CAAA,EACF,EAGA,CAACiI,GACDnH,EAAAA,KAAA8F,EAAAA,SAAA,CACC,SAAA,CAAA9F,OAAC,OAAA,CAAK,SAAA,CAAA,YAAU6G,EAAUI,EAAc,OAAQ,WAAW,CAAA,EAAE,EAC5DA,EAAc,IAAI,CAACT,EAAcnB,IACjCrF,OAAC,OAAA,CAAwB,UAAU,0BAClC,SAAA,CAAAvB,MAACgJ,IAAa,aAAAjB,EAA4B,EACzCnB,IAAU4B,EAAc,OAAS,GAAKxI,EAAAA,IAAC,QAAK,SAAA,IAAA,CAAE,CAAA,CAAA,EAFrC+H,CAGX,CACA,CAAA,EACF,EAGD/H,EAAAA,IAAC,OAAA,CAAM,SAAAiG,EAAsCC,CAAO,CAAA,CAAE,QACrD,OAAA,CAAM,SAAAC,GAAwBC,CAAM,EAAE,cAAc,EAEpDF,IAAY,aAAeM,IAAS,eACnC,OAAA,CAAK,SAAA,CAAA,OAAKK,EAAgBL,CAAI,CAAA,CAAA,CAAE,CAAA,EAEnC,CAEF,ECnEA,SAASxC,EAAWJ,EAAwC,CAC3D,OAA2BA,GAAU,KAC7B,CAAA,EAED,MAAM,QAAQA,CAAK,EAAIA,EAAQ,CAACA,CAAK,CAC7C,CAEA,SAASqF,EACRtG,EACAuB,EACgC,CAChC,MAAMC,EAAQxB,EAAQ,MACtB,GAAIwB,GAAS,OAAOA,GAAU,SAC7B,OAAQA,EAAwDD,CAAG,CAGrE,CAEA,SAASgF,EAAqBvG,EAAuBuB,EAAuB,CAC3E,MAAMmB,EAAe1C,EAAQ,cAC7B,GAAI,CAAC0C,EACJ,MAAO,CAAA,EAGR,MAAMC,EAAoB,MAAM,QAAQD,CAAY,EACjDA,EACA,CAACA,CAAY,EAEVE,EAAmB,CAAA,EACzB,UAAWpB,KAASmB,EACnB,GAAInB,GAAS,OAAOA,GAAU,SAAU,CACvC,MAAMP,EAASO,EAAkCD,CAAG,EAChDN,GACH2B,EAAO,KAAK,GAAGvB,EAAQJ,CAA0B,CAAC,CAEpD,CAED,OAAO2B,CACR,CAEA,SAAS4D,EAAe3E,EAAkBZ,EAA0B,CACnE,GAA2BA,GAAU,KACpC,MAAO,CAAA,EAGR,MAAM2B,EAASvB,EAAQJ,CAA0B,EAEjD,OAAI2B,EAAO,SAAS,GAAGf,CAAQ,IAAI,EAC3B,CAAA,EAGDe,EACL,OAAQ6D,GAAMA,EAAE,WAAW5E,CAAQ,CAAC,EACpC,IAAK4E,GACSA,EAAE,MAAM,GAAG5E,CAAQ,GAAG,EACvB,CAAC,GAAK,EACnB,EACA,OAAQoE,GAAOA,IAAO,IAAMA,IAAO,GAAG,CACzC,CAEA,SAASS,EAAoBC,EAA4B,CACxD,OAAIA,EAAO,SAAS,oBAAoB,EAChC,CAAA,EAGDA,EACL,OAAQ1E,GAAUA,EAAM,WAAW,mBAAmB,CAAC,EACvD,IAAKA,GACSA,EAAM,MAAM,mBAAmB,EAChC,CAAC,GAAK,EACnB,EACA,OAAQtD,GAASA,IAAS,EAAE,CAC/B,CAEA,SAASiI,GAAyB5G,EAMhC,CACD,MAAM6G,EAA0BN,EAC/BvG,EACA,qBAAA,EAGKuE,EAAUiC,EAAe,eAAgBK,CAAuB,EAChErC,EAAOgC,EAAe,cAAeK,CAAuB,EAE5DtD,EAAUvD,EAAQ,QAClByE,EAEFiC,EADHnD,IAAY,WACWvD,EAAQ,QAAU,CAAA,EAClBA,EAAQ,OAAS,CAAA,CADG,EAG5C,MAAO,CACN,QAAAuE,EACA,KAAAC,EACA,QAAAjB,EACA,OAAAkB,EACA,KAAMzE,EAAQ,MAAA,CAEhB,CAEA,MAAM8G,EAAsE,CAC3E,2BAA4B,QAC5B,+BAAgC,YAChC,8BAA+B,WAChC,EAEA,SAASC,GAA6B/G,EAKpC,CACD,MAAMgH,EAAkBV,EAActG,EAAS,qBAAqB,EAC9D9E,EAAgBsL,EAAe,qBAAsBQ,CAAe,EAEpEzD,EAAUvD,EAAQ,QAClBiH,EAAe1D,IAAY,WAAavD,EAAQ,OAASA,EAAQ,MAEvE,IAAIyD,EAA2B,QAC/B,UAAWxB,KAASgF,GAAgB,GACnC,GAAIhF,KAAS6E,EAAmC,CAC/CrD,EAASqD,EAAkC7E,CAAK,EAChD,KACD,CAGD,MAAO,CACN,cAAA/G,EACA,QAAAqI,EACA,OAAAE,EACA,KAAMzD,EAAQ,MAAA,CAEhB,CAEA,MAAMkH,EAAuE,CAC5E,0BAA2B,QAC3B,8BAA+B,YAC/B,8BAA+B,YAC/B,2BAA4B,QAC7B,EAEA,SAASC,GAA2BnH,EAKlC,CACD,MAAMgH,EAAkBV,EAActG,EAAS,qBAAqB,EAC9D7E,EAAcqL,EAAe,oBAAqBQ,CAAe,EAEjEzD,EAAUvD,EAAQ,QAClBiH,EAAe1D,IAAY,WAAavD,EAAQ,OAASA,EAAQ,MAEvE,IAAIyD,EAA6B,QACjC,UAAWxB,KAASgF,GAAgB,GACnC,GAAIhF,KAASiF,EAAkC,CAC9CzD,EAASyD,EAAiCjF,CAAK,EAC/C,KACD,CAGD,MAAO,CACN,YAAA9G,EACA,QAAAoI,EACA,OAAAE,EACA,KAAMzD,EAAQ,MAAA,CAEhB,CAEA,MAAMoH,EAGF,CACH,2BAA4B,QAC5B,+BAAgC,YAChC,4BAA6B,QAC9B,EAEA,SAASC,GAA4BrH,EAMnC,CACD,MAAMgH,EAAkBV,EAActG,EAAS,qBAAqB,EAC9D5E,EAAeoL,EAAe,qBAAsBQ,CAAe,EAEnEH,EAA0BN,EAC/BvG,EACA,qBAAA,EAEK6F,EAAgBW,EACrB,oBACAK,CAAA,EAGKtD,EAAUvD,EAAQ,QAClBiH,EAAe1D,IAAY,WAAavD,EAAQ,OAASA,EAAQ,MAEvE,IAAIyD,EAAuC,QAC3C,UAAWxB,KAASgF,GAAgB,GACnC,GAAIhF,KAASmF,EAAmC,CAC/C3D,EAAS2D,EAAkCnF,CAAK,EAChD,KACD,CAGD,MAAO,CACN,aAAA7G,EACA,cAAAyK,EACA,QAAAtC,EACA,OAAAE,EACA,KAAMzD,EAAQ,MAAA,CAEhB,CAEO,MAAMsH,GAAiB,CAAC,CAAE,QAAAtH,KAAmC,CACnE,GAAImB,GAAkBnB,CAAO,EAC5B,OAAO3C,MAAC0C,IAAuB,QAAAC,EAAkB,EAGlD,GAAIoB,GAAkBpB,CAAO,EAC5B,OAAO3C,MAAC4H,IAAuB,QAAAjF,EAAkB,EAGlD,GAAI,CAACkB,EAAelB,CAAO,EAC1B,aAAQI,EAAA,EAAqB,EAK9B,OAFiBgD,GAA6BpD,CAAO,EAE7C,CACP,IAAK,iBACJ,OACC3C,EAAAA,IAACiH,GAAA,CAA4B,GAAGsC,GAAyB5G,CAAO,CAAA,CAAG,EAErE,IAAK,oBACJ,OACC3C,EAAAA,IAACuG,GAAA,CACC,GAAGmD,GAA6B/G,CAAO,CAAA,CAAA,EAG3C,IAAK,mBACJ,OACC3C,EAAAA,IAACiI,GAAA,CACC,GAAG6B,GAA2BnH,CAAO,CAAA,CAAA,EAGzC,IAAK,oBACJ,OACC3C,EAAAA,IAACqI,GAAA,CACC,GAAG2B,GAA4BrH,CAAO,CAAA,CAAA,EAG1C,QACC,aAAQI,EAAA,EAAqB,CAAA,CAEhC,EClRamH,GAAwB,CAAC,CACrC,WAAAxM,CACD,IAEE6D,EAAAA,KAAC,MAAA,CAAI,UAAU,sBACd,SAAA,CAAAvB,MAACO,EAAA,CAAW,UAAU,wBAAwB,QAAQ,YAAY,SAAA,cAElE,QACCA,EAAA,CAAW,UAAU,wBACpB,SAAA7C,EAAW,aAAe,MAAA,CAC5B,CAAA,EACD,EAIWyM,GAAoB,CAAC,CAAE,WAAAzM,KAAyC,CAC5E,KAAM,CAAE,QAAAiF,GAAYjF,EACpB,OACC6D,EAAAA,KAAC,MAAA,CAAI,UAAU,sBACd,SAAA,CAAAvB,EAAAA,IAACO,GAAW,SAAA,SAAA,CAAO,EACnBP,MAACiK,IAAe,QAAAtH,CAAA,CAAkB,CAAA,EACnC,CAEF,EAEayH,GAAoB,CAAC,CAAE,WAAA1M,KAAyC,CAC5E,KAAM,CAAE,KAAM2M,EAAW,QAAAC,CAAA,EACxB7M,GAAgCC,CAAU,EAErC,CACL,eAAAiC,EACA,kBAAAC,EACA,eAAAC,EACA,aAAAC,EACA,cAAAC,CAAA,EACGsK,EAEJ,OACC9I,EAAAA,KAAC,MAAA,CAAI,UAAU,sBACd,SAAA,CAAAvB,MAACO,GAAY,SAAA6H,EAAU1K,EAAW,QAAQ,OAAQ,QAAQ,EAAE,EAC5DsC,EAAAA,IAAC,KAAA,CAAG,UAAU,sBACZ,WACE,MAAM,KAAK,CAAE,OAAQtC,EAAW,QAAQ,MAAA,EAAU,CAAC6M,EAAGC,IAEtDxK,EAAAA,IAACC,GAAK,UAAU,MACf,eAACkD,EAAA,CAAS,UAAU,gBAAA,CAAiB,CAAA,EADXqH,CAE3B,CACA,EACA9M,EAAW,QAAQ,IAAK2B,SACvB,KAAA,CACA,SAAAW,EAAAA,IAACN,GAAA,CACA,OAAAL,EACA,eAAAM,EACA,kBAAAC,EACA,eAAAC,EACA,aAAAC,EACA,cAAAC,CAAA,CAAA,GAPOV,EAAO,IAShB,CACA,CAAA,CACJ,CAAA,EACD,CAEF,ECrEaoL,GAAyB,CAAC,CACtC,WAAA/M,CACD,IAAmC,CAClC,KAAM,CAAE,iBAAAgN,CAAA,EAAqBC,GAAA,EAEvBC,EAAsB,CAACC,EAAkBjC,IAAe,CAC7D8B,EACC,CACC,QAASG,EACT,GAAAjC,CAAA,EAED,CACC,UAAW,IAAM,CAChBkC,EAAM,QAAQ,cAAcD,EAAU,UAAY,UAAU,EAAE,CAC/D,EACA,QAAUE,GAAU,CACnB,MAAMC,EACLD,EAAM,SAAW,0CAClB,QAAQ,MAAMC,CAAO,CACtB,CAAA,CACD,CAEF,EAEA,OACChL,EAAAA,IAACiL,GAAA,CACA,aAAW,oBACX,QAASvN,EAAW,QACpB,gBAAkBmN,GAAYD,EAAoBC,EAASnN,EAAW,EAAE,CAAA,CAAA,CAG3E,ECpBawN,GAAyB,CAAC,CAAE,GAAAtC,EAAI,SAAAuC,KAAsB,CAClE,MAAMC,EAAgBxC,GAAe,CAC/B,UAAU,UAAU,UAAUA,CAAE,EACrCkC,EAAM,QAAQ,WAAW,CAC1B,EAEA,cACEO,GAAA,CACA,SAAA,CAAArL,EAAAA,IAACsL,GAAA,CAAoB,QAAO,GAC3B,SAAA/J,EAAAA,KAACY,GAAO,QAAQ,UAAU,UAAU,aACnC,SAAA,CAAAnC,EAAAA,IAAC,OAAA,CAAK,UAAU,UAAU,SAAA,YAAS,EACnCA,EAAAA,IAACwB,EAAA,CAAK,GAAG,eAAe,UAAU,QAAA,CAAS,CAAA,CAAA,CAC5C,CAAA,CACD,EACAD,EAAAA,KAACgK,GAAA,CAAoB,MAAM,MAC1B,SAAA,CAAAvL,EAAAA,IAACwL,IAAkB,SAAA,SAAA,CAAO,QACzBC,EAAA,CAAiB,QAAS,IAAML,EAAaxC,CAAE,EAAG,SAAA,UAEnD,EACA5I,EAAAA,IAACyL,EAAA,CAAiB,QAAO,GACxB,SAAAzL,EAAAA,IAAC6B,EAAA,CAAK,GAAG,mCAAmC,OAAQ,CAAE,GAAA+G,CAAA,EAAM,gBAE5D,EACD,EACA5I,EAAAA,IAACyL,EAAA,CAAiB,QAASN,EAAU,SAAA,SAAM,EAC3CnL,EAAAA,IAACyL,EAAA,CAAiB,QAAO,GACxB,SAAAlK,EAAAA,KAAC,IAAA,CACA,KAAMmK,GAAW,mBAAmB,EACpC,UAAU,oBACV,SAAA,CAAA,iBACc1L,EAAAA,IAACwB,EAAA,CAAK,GAAG,eAAe,UAAU,aAAA,CAAc,CAAA,CAAA,CAAA,CAC/D,CACD,CAAA,CAAA,CACD,CAAA,EACD,CAEF,ECjDamK,GAAwC,IAAM,CAC1D,MAAMC,EAAWC,GAAA,EACX,CAACC,EAAaC,CAAa,EAAIC,GAAA,EAE/B,CAAE,iBAAAC,CAAA,EAAqBC,GAAA,EAgC7B,MAAO,CAACJ,EA9BoB,CAC3BpO,EACA,CACC,eAAAyO,EAAiB,EAAA,EAId,CAAA,IAEJJ,EAAc,CACb,MAAO,oBACP,YAAa,mCAAmCrO,EAAW,IAAI,IAC/D,UAAW,IAAM,CAChBuO,EAAiBvO,EAAW,GAAI,CAC/B,UAAW,IAAM,CAChBoN,EAAM,QAAQ,oBAAoB,EAC9BqB,GACEP,EAAS,CAAE,GAAI,eAAgB,CAEtC,EACA,QAAUb,GAAU,CACnB,MAAMC,EACLD,EAAM,SAAW,2CAClBD,EAAM,MAAME,CAAO,EACnB,QAAQ,MAAMA,CAAO,CACtB,CAAA,CACA,CACF,CAAA,CACA,CAEsC,CACzC"}